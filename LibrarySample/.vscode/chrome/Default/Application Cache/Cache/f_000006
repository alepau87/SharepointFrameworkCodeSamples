define("Viva.Controls/Util/Viva.Util.Private",["require","exports"],function(){"use strict";var n;return function(n){var t=null,i,r=window,u=function(){function n(n){this._prefixCode=";;;";this._dataTransfer=n}return Object.defineProperty(n.prototype,"dropEffect",{get:function(){return this._dataTransfer.dropEffect},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="link"&&n!=="move")throw new Error("Drop effect must be either none, copy, link, or move.");this._dataTransfer.dropEffect=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"effectAllowed",{get:function(){return this._dataTransfer.effectAllowed},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="copyLink"&&n!=="copyMove"&&n!=="link"&&n!=="linkMove"&&n!=="move"&&n!=="all"&&n!=="uninitialized")throw new Error("Effect allowed must be either none, copy, copyLink, copyMove, link, linkMove, move, all, or uninitialized.");this._dataTransfer.effectAllowed=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,
"types",{get:function(){var n=this._dataTransfer.types,u,f,r,e,o;if(t===null&&this.getData(""),t){f=!1;r=this._getLegacyData();for(o in r)if(r.hasOwnProperty(o)&&r[o]!==""){f=!0;break}return Object.keys(f?r:i)}if(n&&!n.forEach)for(e=n,n=[],u=0;u<e.length;u++)n.push(e[u]);return n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"files",{get:function(){return this._dataTransfer.files},enumerable:!0,configurable:!0}),n.isLegacyDataTransfer=function(){if(t===null){var n=r.DataTransfer||r.Clipboard;return!n.prototype.setDragImage}return t},n.prototype.setDragImage=function(n,t,i){this._dataTransfer.setDragImage&&this._dataTransfer.setDragImage(n,t,i)},n.prototype.addElement=function(n){this._dataTransfer.addElement&&this._dataTransfer.addElement(n)},n.prototype.getData=function(n){if(this._checkFormat(n),t)return this._getLegacyDataTransfer(n);try{return t=!1,this._dataTransfer.getData(n)}catch(i){return t=!0,this.getData(n)}},n.prototype.setData=function(n,i){if(this._checkFormat(
n),t)this._setLegacyDataTransfer(n,i);else try{t=!1;this._dataTransfer.setData(n,i)}catch(r){t=!0;this.setData(n,i)}},n.prototype.clearData=function(n){if(this._checkFormat(n),t)this._clearLegacyDataTransfer(n);else try{t=!1;this._dataTransfer.clearData(n)}catch(i){t=!0;this.clearData(n)}},n.prototype._checkFormat=function(n){if(n&&n.toLowerCase()!==n)throw new Error("Format must be in lowercase.");},n.prototype._getLegacyData=function(){var n=this._dataTransfer.getData("Text");return n&&n.substr(0,this._prefixCode.length)===this._prefixCode?JSON.parse(n.substr(this._prefixCode.length)):{Text:n}},n.prototype._stringifyLegacyData=function(n){return this._prefixCode+JSON.stringify(n)},n.prototype._getLegacyDataTransfer=function(n){return this._getLegacyData()[n]||""},n.prototype._setLegacyDataTransfer=function(n,t){var r=this._getLegacyData();r[n]=t;i=r;this._dataTransfer.setData("Text",this._stringifyLegacyData(r))},n.prototype._clearLegacyDataTransfer=function(n){if(i={},n){var t=this.
_getLegacyData();delete t[n];i=t}this._dataTransfer.setData("Text",this._stringifyLegacyData(i))},n}();n.DataTransfer2=u;document.addEventListener("dragend",function(){i={}},!1)}(n||(n={})),n});define("Viva.Controls/Util/Viva.Util",["require","exports","f","./Viva.Util.Private"],function(n,t,i,r){"use strict";var u;return function(n){function w(n,t){var f=n.tagName,i,r,u;switch(f){case"TABLE":i="tr";break;case"TR":i="td";break;case"UL":i="li";break;default:i="span"}t&&(u=n.getAttribute(e),n.setAttribute(e,"assertive"));r=document.createElement(i);n.appendChild(r);n.removeChild(r);t&&(u?n.setAttribute(e,u):n.removeAttribute(e))}function b(n,t){var i=n.parents().filter(function(){var n=f(this),t=n.css("overflow-x"),i=n.css("overflow-y");return(t!=="hidden"||i!=="hidden")&&(t!=="visible"||i!=="visible")});return t&&(i=i.add(window)),i}function k(n){if(n){var r=f(n),i;if(r.attr(t.dataControlAttribute))return n;if(i=r.closest("["+t.dataControlAttribute+"='true']"),i.length>0)return i[0]}return null}
function c(n){var r=f(n),i;return r.attr(t.dataCanFocusAttribute)&&(i=n[t.dataCanFocusAttribute],i)?i():!1}function o(n,t,i){var f=0,r,e,u;do{if(r=null,u=n.find(t+":eq("+f+")"),u.length>0&&(r=u[0],e=i(r),e&&c(r)))return!0;f++}while(!l(r));return!1}function d(n,t){t===void 0&&(t=!0);var i=Object.keys(n);return t?i.sort(function(n,t){return n<t?1:-1}):i}function g(n,t){var i,r,u;if(t.length<=n.length){for(i=-1,r=0;r<t.length;r++)if(u=t[r],i=n.firstIndex(function(n){return n===u},i+1),i<0)return!1;return!0}return!1}function nt(n,i){var f="["+t.dataFocusFirstAttribute+"='true']",e=":not("+f+")",u="["+t.dataCanFocusAttribute+"='true']",s=function(n){return n},r=!1;return i&&(r=o(n,u+f,i),r||(r=o(n,u+e,i))),r||(r=o(n,u+f,s),r||(r=o(n,u+e,s))),r}function tt(n,t){var i=t||n.type;return f.Event(n,{type:i,target:n.target,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,currentTarget:n.currentTarget,isImmediatePropagationStopped:n.isImmediatePropagationStopped,isPropagationStopped:n.isPropagationStopped,preventDefault:
n.preventDefault,stopImmediatePropagation:n.stopImmediatePropagation,stopPropagation:n.stopPropagation})}function it(n,t,i){for(var o=i?i.length:0,u=0,r,e,f,u=0;u<o;u++)r=i[u],e=t[r]||a(),f=n[r],e(ko.isObservable(f)?f.peek():f),t[r]||(t[r]=e)}function rt(n,t){var i=n.indexOf(t)<0;return i&&n.push(t),!i}function ut(n){var t=n.getAttribute("class");return t?new s(t):new s}function ft(n,t){n.setAttribute("class",t._fields.join(" "))}function et(){return typeof Hammer=="function"}var l=i.isNullOrUndefined,f=jQuery,a=ko.observable,u="data-",e="aria-live",t,s;(function(n){n.dataCanFocusAttribute=u+"canfocus";n.dataFocusFirstAttribute=u+"focus-first";n.dataEditableAttribute=u+"editable";n.dataControlAttribute=u+"control";n.dataActivatableAttribute=u+"activatable";n.dataActivateInfoAttribute=u+"activate-info"})(t=n.Constants||(n.Constants={}));var h={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&#34;","`":"&#96;"},v=55296,y=56320,p=65536;n.forceScreenRead=w;n.getScrollableParents=b;n.findContainingControl=
k;n.executeSetFocusOn=c;n.getObjectBasicShape=d;n.shapeContains=g;n.setFocusToFirstFocusableChild=nt;n.cloneEvent=tt;n.fillObserableFields=it;n.existsOrRegisterId=rt;s=function(){function n(n){n===void 0&&(n=null);this._fields=n?n.split(" "):[]}return n.prototype.add=function(n){this._fields.indexOf(n)<0&&this._fields.push(n)},n.prototype.remove=function(n){while(this._fields.indexOf(n)>=0)this._fields.splice(this._fields.indexOf(n),1)},n.prototype.contains=function(n){return this._fields.indexOf(n)>=0},Object.defineProperty(n.prototype,"length",{get:function(){return this._fields.length},enumerable:!0,configurable:!0}),n.prototype.toggle=function(n){return this._fields.indexOf(n)>=0?(this.remove(n),!1):(this.add(n),!0)},n.prototype.item=function(n){return this._fields[n]},n.prototype.toString=function(){return this._fields.toString()},n}();n.DOMTokenListShim=s;n.getClassList=ut;n.setClassList=ft;n.DataTransfer=r.DataTransfer2;n.hammerLoaded=et}(u||(u={})),u});define("_generated/Less/MsPortalImpl.Controls/Controls/Base.css",
["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxc-base-fill-container-width{width:100%}.fxc-base-fill-container-height{height:100%}.fxc-base-loading{position:relative;height:100%}.fxc-base-loading .fxc-base-loadingImage{position:absolute;top:calc(50% - 30px / 2);left:calc(50% - 30px / 2)}")});define("Viva.Controls/Controls/Base/Viva.Image",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function r(n,t,i){return n===void 0&&(n=0),t===void 0&&(t=""),i===void 0&&(i=0),f(n,t,i)}function o(){var n=r();return u.fromImage(n)}var t=["type","data","palette"],f=i.applyStringMapFunc(t),e=i.getStringMapFunc("height","width","x","y"),u;n.createImage=r,function(n){function r(n){var r=e(0,0,0,0);return i.shallowCopyFromObject(r,n,t),r}n.fromImage=r}(u=n.SvgImage||(n.SvgImage={}));n.createSvgImage=o}(r||(r={})),r});define("MsPortalImpl/Base/Base.UriHelper",["require","exports","f"],function(n,t,i){"use strict";var r;return function(
n){function d(n,t){t=t||{};var i=t.requireHttps||!1,r=i?w:p;return r.test(n)}function u(n){n===void 0&&(n="");var t={},i=n.indexOf("?"),r=i>-1?n.substr(i+1):n,u=r.split("&");return u.forEach(function(n){if(n&&!n.match(/^\=+$/)){var i=n.split("="),r=i.shift(),u=i.length>0?i.join("="):"";t[r]=u}}),t}function f(n){var i="",t="";return b(n,function(n,r){i+="{0}{1}={2}".format(t,n,r);t||(t="&")}),i}function t(n){var t=n.toString().match(/^([^\:\/]+)\:\/\//);return t?t[1]+":":""}function r(n){var i;if(n=n.toString(),i=t(n),!i)return"";var r=n.substr(i.length+2),f=r.indexOf("/"),u=f>0?r.substr(0,f):r;return!u||u.indexOf("@")>0?"":u.replace(/\:.*/,"")}function l(n){var i=a(n),f=r(i),o=e(i),u=t(i),s=(u?u.length+2:0)+f.length+(o?o.length+1:0);return!f||!u?"":i.substr(s)}function e(n){var u=t(n),f=r(n),e,i;return!u||!f?"":(e=u.length+2+f.length,i=n.toString().substring(e).match(/^\:([0-9]+)/),!i)?"":i[1]}function a(n){var i=n.toString().replace(/\#.*/g,"").replace(/\?.*/,"");return!r(i)||!t(i)?"":
i}function v(n){return(n=n.toString().replace(/\#.*/g,""),!n.match(/\?/))?"":n.replace(/.*\?/,"?")}function o(n){return(n=n.toString(),!n.match(/\#/))?"":n.replace(/[^\#]*\#/,"#").replace(/\?.*/,"")}function y(n){var t=n.indexOf("#"),i=t===-1?-1:n.substr(t).indexOf("?");return t===-1?"":i===-1?"":n.substr(t+i)}var s="^([Hh][Tt][Tt][Pp][Ss]",h="://(?::)?@?(([dw.-]+)(?::(d+))?)?)([/\\w.()-]*)?(?:([?][^#]*)?(#.*)?).*$",p=new RegExp(s+"?"+h),w=new RegExp(s+h),b=i.forEachKey,k=i.isEmpty,c;n.validateAbsoluteHttpUri=d;c=function(){function n(n){return n===void 0&&(n=""),this._hashQs={},this._qs={},this.setHref(n),this}return n.prototype.setHref=function(n){return n===void 0&&(n=""),n=n.toString(),this._protocol=t(n),this._host=r(n),this._port=e(n),this._pathname=l(n),this._hash=o(n),this.setQueryString(n),this.setHashQueryString(n),this},n.prototype.setQueryString=function(n){return this._qsPart=v(n),this._qs=u(this._qsPart),this},n.prototype.setQueryStringValue=function(n,t){return this._qs[
n]=t,this},n.prototype.deleteQueryStringValue=function(n){return delete this._qs[n],this},n.prototype.getQueryStringValue=function(n){return this._qs[n]||""},n.prototype.setHashQueryString=function(n){return this._hashQsPart=y(n),this._hashQs=u(this._hashQsPart),this},n.prototype.setHashQueryStringValue=function(n,t){return this._hashQs[n]=t,this},n.prototype.deleteHashQueryStringValue=function(n){return delete this._hashQs[n],this},n.prototype.clearHashQueryStringIfEmpty=function(){return k(this._hashQs)&&(this._hashQsPart=""),this},n.prototype.getHashQueryStringValue=function(n){return this._hashQs[n]||""},n.prototype.setHash=function(n){return this._hash=n,this},n.prototype.setHashAndHashQueryString=function(n){return this._hash=o(n),this.setHashQueryString(n),this},n.prototype.isHashEmpty=function(){return this.hash===""||this.hash==="#"},n.prototype.toString=function(){return this.href},Object.defineProperty(n.prototype,"href",{get:function(){return this.path+this.queryString+this.
hash+this.hashQueryString},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),n.prototype.setHost=function(n){return this._host=n,this},Object.defineProperty(n.prototype,"path",{get:function(){return(this.protocol?this.protocol+"//":"")+this.host+(this.port?":"+this.port:"")+this.pathname},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pathname",{get:function(){return this._pathname},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightSide",{get:function(){return this.pathname+this.queryString+this.hashWithHashQueryString},enumerable:!0,configurable:!0}),n.prototype.setPathname=function(n){return this._pathname=n,this},Object.defineProperty(n.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),n.prototype.setPort=function(n){return this._port=n,this},Object.defineProperty(n.prototype,"protocol",{get:function(){return this._protocol}
,enumerable:!0,configurable:!0}),n.prototype.setProtocol=function(n){return this._protocol=n,this},Object.defineProperty(n.prototype,"queryString",{get:function(){var n=f(this._qs);return n||this._qsPart?"?"+n:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hash",{get:function(){return this._hash||this.hashQueryString?"#"+(this._hash||"").replace(/^\#/,""):""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hashQueryString",{get:function(){var n=f(this._hashQs);return this._hashQsPart||n?"?"+n:""},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hashWithHashQueryString",{get:function(){return this.hash+this.hashQueryString},enumerable:!0,configurable:!0}),n.prototype.getFirstHashPart=function(){return this.hash.replace(/^\#/,"").replace(/\/.*/,"")},n.prototype.getRestOfHashParts=function(){return this.hash.replace(/^[^\/]*/,"").replace(/^\//,"")},n}();n.Uri=c;n.queryStringToMap=u;n.mapToQueryString=f;n.getProtocol=t;n.getHost=
r;n.getPathnameSegment=l;n.getPort=e;n.getPathSegment=a;n.getQueryStringSegment=v;n.getHashSegment=o;n.getHashQueryStringSegment=y}(r||(r={})),r});define("MsPortalImpl/Base/Base.Sanitization",["require","exports","f","MsPortalImpl/Base/Base.UriHelper"],function(n,t,i,r){"use strict";var u;return function(t){function a(){}function v(){}function u(n){return n===""||r.validateAbsoluteHttpUri(n)||s.test(n)}function y(n){return u(n)||f.test(n)}function p(n){return n===""||f.test(n)}function w(n){return n===""||h.test(n)}function b(n){var t=u(n);return t||c.error("Disallowed URI: "+n),t}var o=i.Base.Diagnostics,s=/^(vstfs:|ftp:|ftps:|sftp:|)\/\/|mailto:/,f=/^#/,h=/^(data:image)\//,c=o.createLog(n),l=function(){function n(n,t){this.sanitizedMarkup=n;this.errors=t}return n}(),e;t.SanitizerResult=l;e=function(){function n(n,t,i,r,u,f){this.sourceDescription=n;this.reason=t;this.tag=i;this.attr=r;this.binding=u;this.val=f}return n.prototype.toString=function(){var n="";return this.sourceDescription&&
(n+="Sanitization error found in: "+this.sourceDescription+"\n"),n+=this.reason+" -",this.tag&&(n+=' Tag: "{0}";'.format(this.tag)),this.attr&&(n+=' Attribute: "{0}";'.format(this.attr)),this.binding&&(n+=' Binding: "{0}";'.format(this.binding)),this.val&&(n+=" Value: {0}".format(this.val)),n},n.Reasons={InvalidAttribute:"Invalid attribute",InvalidCSSClassName:"Invalid CSS class name",InvalidCSSProperty:"Invalid CSS property",InvalidTag:"Invalid tag",UnknownBindingName:"Unknown or prohibited binding",InvalidBindingValue:"Invalid binding value"},n}();t.SanitizerError=e;t.anyValueAccepted=a;t.specificValueAccepted=v;t.validateUriOrBlank=u;t.validateLinkUri=y;t.validateLocalUriOnly=p;t.validateDataImage=w;t.sanitizeUri=b}(u||(u={})),u});define("MsPortalImpl/Base/Base.CssSelectorParser",["require","exports"],function(){"use strict";var n;return function(n){function f(n){return r=function(n,t){return t},l(n||"",!1)}function e(n){var t=n.map(function(n){return n.value});return t.join("")}var
a;n.parseCssSelector=f;n.subselectorToString=e;var i=jQuery.find,u=i.selectors,o=i.selectors.match,r;
/*!
         * -----------------------------------------------------------------------------
         * The portion of this file from here until "End of jQuery code snippet" is code
         * derived from the jQuery JavaScript Library v2.0.3 - http://jquery.com/
         * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
         * Released under the MIT license - http://jquery.org/license
         * Date: 2013-07-03T13:30Z
         */
var t="[\\x20\\t\\r\\n\\f]",s=new RegExp("^"+t+"+|((?:^|[^\\\\])(?:\\\\.)*)"+t+"+$","g"),h=new RegExp("^"+t+"*,"+t+"*"),c=new RegExp("^"+t+"*([>+~]|"+t+")"+t+"*"),l=function(n,t){var l,e,v,a,f,y,p,w=r[n+" "];if(w)return t?0:w.slice(0);for(f=n,y=[],p=u.preFilter;f;){(!l||(e=h.exec(f)))&&(e&&(f=f.slice(e[0].length)||f),y.push(v=[]));l=!1;(e=c.exec(f))&&(l=e.shift(),v.push({value:l,type:e[0].replace(s," ")}),f=f.slice(l.length));for(a in u.filter)(e=o[a].exec(f))&&(!p[a]||(e=p[a](e)))&&(l=e.shift(),v.push({value:l,type:a,matches:e}),f=f.slice(l.length));if(!l)break}return t?f.length:f?i.error(n):r(n,y).slice(0)};
/*!
         * End of jQuery code snippet
         * -----------------------------------------------------------------------------
         */
a=null}(n||(n={})),n});define("_generated/Less/MsPortalImpl/Themes/Themes.Reset.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'body,p{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{font-size:100%;font-weight:inherit}code,p,pre{font-size:12px}body,html{height:100%}body{margin:0;padding:0}img{overflow:hidden}:link img,:visited img,a img,img{border:0}[contentEditable=true]:not([tabindex="-1"]):focus,[tabindex="0"]:focus,a[href]:not([tabindex="-1"]):focus,area[href]:not([tabindex="-1"]):focus,button:not([disabled]):not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,input:not([disabled]):not([tabindex="-1"]):focus,select:not([disabled]):not([tabindex="-1"]):focus,textarea:not([disabled]):not([tabindex="-1"]):focus{outline:#00bcf2 solid 1px;outline-offset:-1px;box-shadow:inset 0 0 1px 1px #00bcf2}tbody tr[tabindex]:not([tabindex=\'-1\']):focus{box-shadow:none}a{text-decoration:none}p{line-height:18px}b,strong{font-weight:700}code,pre{font-family:Consolas,"Courier New",monospace}fieldset,legend{border:0;margin:0;padding:0}textarea{overflow:auto}::-moz-placeholder{opacity:1}::-moz-focus-inner{border:0}')}
);define("_generated/Less/MsPortalImpl/Themes/Themes.Blue.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-theme-blue{background-color:#2e80ab}.fxs-theme-blue .fxs-accent,.fxs-theme-blue .fxs-portal .fxs-accent{background-color:#fff;color:#2d3239;border-color:#b3b3b3}.fxs-theme-blue .fxs-accent svg,.fxs-theme-blue .fxs-portal .fxs-accent svg{fill:#2d3239}.fxs-theme-blue .fxs-accent svg.msportalfx-svg-palette-inherit,.fxs-theme-blue .fxs-portal .fxs-accent svg.msportalfx-svg-palette-inherit{fill:inherit}.fxs-theme-blue .fxs-accent .fxs-has-hover:hover,.fxs-theme-blue .fxs-portal .fxs-accent .fxs-has-hover:hover{background-color:#e6e6e6}.fxs-theme-blue .fxs-accent .fxs-is-selected,.fxs-theme-blue .fxs-accent .fxs-is-selected.fxs-has-hover:hover,.fxs-theme-blue .fxs-portal .fxs-accent .fxs-is-selected,.fxs-theme-blue .fxs-portal .fxs-accent .fxs-is-selected.fxs-has-hover:hover{background-color:#ccc}.fxs-theme-blue .fxs-accent .fxs-text-title,.fxs-theme-blue .fxs-portal .fxs-accent .fxs-text-title{color:#818488}.fxs-theme-blue .fxs-accent .fxs-fill-secondary svg,.fxs-theme-blue .fxs-portal .fxs-accent .fxs-fill-secondary svg{fill:#818488}.fxs-theme-blue .fxs-accent .fxs-has-border,.fxs-theme-blue .fxs-portal .fxs-accent .fxs-has-border{border-color:#b3b3b3}.fxs-theme-blue .fxs-trim{background-color:#282d32;color:#fff;border-color:#3d4247}.fxs-theme-blue .fxs-trim svg{fill:#fff}.fxs-theme-blue .fxs-trim svg.msportalfx-svg-palette-inherit{fill:inherit}.fxs-theme-blue .fxs-trim .fxs-has-hover:hover{background-color:#3d4247}.fxs-theme-blue .fxs-trim .fxs-is-selected,.fxs-theme-blue .fxs-trim .fxs-is-selected.fxs-has-hover:hover{background-color:#53575b}.fxs-theme-blue .fxs-trim .fxs-text-title{color:#949699}.fxs-theme-blue .fxs-trim .fxs-fill-secondary svg{fill:#949699}.fxs-theme-blue .fxs-trim .fxs-has-border{border-color:#3d4247}.fxs-theme-blue .fxs-trim a{color:#fff}.fxs-theme-blue .fxs-trim button{color:#fff;border-color:#fff}.fxs-theme-blue .fxs-search .azc-input{background-color:#4a4f53;color:#fff}.fxs-theme-blue .fxs-search .azc-input::-webkit-input-placeholder{color:#eee}.fxs-theme-blue .fxs-search .azc-input:-ms-input-placeholder{color:#eee}.fxs-theme-blue .fxs-search .azc-input::-moz-placeholder{color:#eee}.fxs-theme-blue .fxs-topbar{background-color:#202428;color:#fff;border-color:#3d4247}.fxs-theme-blue .fxs-topbar svg{fill:#fff}.fxs-theme-blue .fxs-topbar svg.msportalfx-svg-palette-inherit{fill:inherit}.fxs-theme-blue .fxs-topbar .fxs-has-hover:hover{background-color:#3d4247}.fxs-theme-blue .fxs-topbar .fxs-is-selected,.fxs-theme-blue .fxs-topbar .fxs-is-selected.fxs-has-hover:hover{background-color:#53575b}.fxs-theme-blue .fxs-topbar .fxs-has-border{border-color:#3d4247}.fxs-theme-blue .fxs-topbar a{color:#fff}.fxs-theme-blue .fxs-topbar .azc-input{border-top:solid 1px #202428}.fxs-theme-blue .fxs-topbar .fxs-topbar-dashboard,.fxs-theme-blue .fxs-topbar .fxs-topbar-exit-customize{background-color:#9b4f96}.fxs-theme-blue a.fxs-topbar-home{color:#00bcf2}.fxs-theme-blue .fxs-startboard-header{color:#fff}.fxs-theme-blue .fxs-startboard-header .fxs-startboard-button,.fxs-theme-blue .fxs-startboard-header .fxs-startboard-button-icon{color:#fff;fill:#fff}.fxs-theme-blue .fxs-startboard-header .fxs-startboard-title-edit{border-color:rgba(255,255,255,.5)}.fxs-theme-blue .fxs-blade-header,.fxs-theme-blue .fxs-commandBar-item,.fxs-theme-blue .fxs-contextpane .azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .azc-external-hovered:not(.fxs-bg-error):not(.azc-bg-edited):not(.azc-disabled):not(.azc-row-disabled):not(.azc-bg-selected):not(.fxs-selected),.fxs-theme-blue .fxs-contextpane .azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .azc-has-hover:hover:not(.fxs-bg-error):not(.azc-bg-edited):not(.azc-disabled):not(.azc-row-disabled):not(.azc-bg-selected):not(.fxs-selected){background-color:#282d32}")}
);define("_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-mode-light .fxs-text-default{color:#2d3239}.fxs-mode-light .azc-control{border-color:#b3b3b3}.fxs-mode-light .azc-control optgroup,.fxs-mode-light .azc-control option{background-color:#fff;border-color:#b3b3b3;color:#2d3239}.fxs-mode-light .azc-control optgroup[disabled],.fxs-mode-light .azc-control option[disabled]{color:#96999c}.fxs-mode-light .azc-control ::-webkit-input-placeholder{color:#575b60}.fxs-mode-light .azc-control ::-moz-placeholder{color:#575b60}.fxs-mode-light .azc-control :-ms-input-placeholder{color:#575b60}.fxs-mode-light .azc-node-fill{fill:#d9f6ff}.fxs-mode-light .azc-node-fill-focused,.fxs-mode-light .azc-node-fill-hovered{fill:#8ce5ff}.fxs-mode-light .azc-node-bg{background-color:#d9f6ff}.fxs-mode-light .azc-node-bg-focused,.fxs-mode-light .azc-node-bg-hovered{background-color:#8ce5ff}.fxs-mode-light .azc-chart{fill:#fff;stroke:#ccc}.fxs-mode-light .azc-chart text{fill:#575b60}.fxs-mode-light .azc-chart text.azc-chart-axis-slider-text{fill:#2d3239}.fxs-mode-light .azc-bg-selected svg,.fxs-mode-light .azc-fill-default,.fxs-mode-light svg.azc-fill-default{fill:#fff}.fxs-mode-light .azc-external-hovered,.fxs-mode-light .azc-has-hover:focus,.fxs-mode-light .azc-has-hover:hover{background-color:#e6f8fe}.fxs-mode-light .azc-header{background-color:#b3b3b3;color:#2d3239}.fxs-mode-light .azc-formControl,.fxs-mode-light .azc-textarea{border-color:#b3b3b3;background-color:#fff}.fxs-mode-light .azc-input{color:#2d3239}.fxs-mode-light .azc-formControl.azc-br-focused,.fxs-mode-light .azc-formControl.azc-br-focused.fxs-br-dirty,.fxs-mode-light .azc-formControl:focus{border-color:#00bcf2}.fxs-mode-light .azc-list-focused{background-color:#d9f5fd}.fxs-mode-light .azc-list-selected{background-color:#b3ebfb}.fxs-mode-light .azc-bg-default{background-color:#fff}.fxs-mode-light .azc-bg-light{background-color:#e6e6e6}.fxs-mode-light .azc-bg-muted{background-color:#b3b3b3}.fxs-mode-light .azc-bg-muted-80-10{background-color:#333}.fxs-mode-light .azc-bg-console{background-color:#191919}.fxs-mode-light .azc-bg-selected{background-color:#00bcf2;border-color:#00bcf2}.fxs-mode-light .azc-bg-selected:hover{background-color:#00bcf2}.fxs-mode-light .azc-bg-hover{background-color:#99e4fa}.fxs-mode-light .azc-bg-disabled{background-color:#e6e6e6}.fxs-mode-light .azc-outline-focusable:focus{outline-color:#4d4d4d}.fxs-mode-light .azc-outline-focusable[aria-selected=true]:focus,.fxs-mode-light .azc-outline-primary{outline-color:#00bcf2}.fxs-mode-light .azc-bg-inverted{background-color:#4d4d4d}.fxs-mode-light .azc-bg-hover-muted:hover{background-color:grey}.fxs-mode-light .azc-br-default{border-color:#b3b3b3}.fxs-mode-light .azc-br-muted{border-color:#ccc}.fxs-mode-light .azc-br-muted-80-10{border-color:#333}.fxs-mode-light .azc-br-active{border-color:#2d3239}.fxs-mode-light .azc-br-strong{border-color:grey}.fxs-mode-light .azc-br-focused,.fxs-mode-light .azc-br-focused.azc-br-edited,.fxs-mode-light .azc-br-focused.fxs-br-dirty,.fxs-mode-light .azc-br-focused.fxs-br-error,.fxs-mode-light .azc-br-hovered,.fxs-mode-light .azc-br-selected{border-color:#00bcf2}.fxs-mode-light .azc-br-top-hovered{border-top-color:#00bcf2}.fxs-mode-light .azc-br-bottom-hovered{border-bottom-color:#00bcf2}.fxs-mode-light .azc-br-inverted{border-color:#4d4d4d}.fxs-mode-light .azc-stroke-muted{stroke:grey}.fxs-mode-light .azc-stroke-heavy{stroke:#666}.fxs-mode-light .azc-stroke-default{stroke:#fff}.fxs-mode-light .azc-stroke-selected{stroke:#00bcf2}.fxs-mode-light .azc-fill-heavy,.fxs-mode-light .azc-fill-hovered-heavy:hover{fill:#666}.fxs-mode-light .azc-fill-text{fill:#2d3239}.fxs-mode-light .azc-fill-hover{fill:#d9f5fd}.fxs-mode-light .azc-fill-selected{fill:#b3ebfb}.fxs-mode-light .azc-fill-white{fill:#fff}.fxs-mode-light .azc-fill-primary svg{fill:#00bcf2}.fxs-mode-light .azc-scrollbar-default,.fxs-mode-light .azc-scrollbar-default:hover{-ms-scrollbar-track-color:#e6e6e6;-ms-scrollbar-face-color:#b3b3b3}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar{background:0 0}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar-track-piece,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar-track-piece{background:0 0}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar-thumb,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar-thumb{background:#b3b3b3}.fxs-mode-light .azc-text-muted{color:#757575}.fxs-mode-light .azc-text-label{color:#474747}.fxs-mode-light .azc-text-console{color:#e6e6e6}.fxs-mode-light .azc-text-primary,.fxs-mode-light a.azc-text-primary{color:#00bcf2}.fxs-mode-light .azc-text-white,.fxs-mode-light a.azc-text-white{color:#fff}.fxs-mode-light .azc-text-disabled,.fxs-mode-light a.azc-text-disabled{color:#96999c}.fxs-mode-light .azc-text-inverted{color:#fff}.fxs-mode-light .azc-disabled,.fxs-mode-light .azc-disabled:focus,.fxs-mode-light .azc-disabled:hover,.fxs-mode-light input.azc-disabled{color:#96999c;background-color:#e6e6e6;border-color:#8f8f8f;fill:#96999c}.fxs-mode-light .azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .azc-external-hovered:not(.fxs-bg-error):not(.azc-bg-edited):not(.azc-disabled):not(.azc-row-disabled):not(.azc-bg-selected):not(.fxs-selected),.fxs-mode-light .azc-grid-selectableRow:not(.azc-grid-activateableRow) .azc-grid-selectable .azc-has-hover:hover:not(.fxs-bg-error):not(.azc-bg-edited):not(.azc-disabled):not(.azc-row-disabled):not(.azc-bg-selected):not(.fxs-selected),.fxs-mode-light .fxs-startboard-layout .fxs-part{background-color:#fff}.fxs-mode-light .azc-fill-disabled svg{fill:#96999c!important}.fxs-mode-light .fxs-startboard-layout .fxs-tile{background-color:#fff;color:#2d3239}.fxs-mode-light .fxs-startboard-layout .fxs-tile .fxs-text-title{color:#575b60}.fxs-mode-light .fxs-startboard-layout .fxs-part .fxs-part-svg .fxs-part-svg-rect{stroke:#9cd5f4}.fxs-mode-light .fxs-startboard-layout .fxs-part.fxs-part-selected .fxs-part-svg .fxs-part-svg-rect,.fxs-mode-light .fxs-startboard-layout .fxs-part.fxs-part-selected-command .fxs-part-svg .fxs-part-svg-rect{stroke:#00bcf2}.fxs-mode-light .fxs-startboard-layout svg{fill:#2d3239}.fxs-mode-light .msportalfx-bg-muted-5{background-color:#f2f2f2}.fxs-mode-light .msportalfx-bg-muted{background-color:#e6e6e6}.fxs-mode-light .msportalfx-bg-default{background-color:#fff}.fxs-mode-light .msportalfx-bg-secondary{background-color:#00bcf2}.fxs-mode-light .msportalfx-bg-dark{background-color:#b3b3b3}.fxs-mode-light .msportalfx-text-default{color:#2d3239}.fxs-mode-light .msportalfx-text-white{color:#fff}.fxs-mode-light .msportalfx-text-muted-50{color:#575b60}.fxs-mode-light .msportalfx-fill-default{fill:#2d3239;background:#2d3239;stroke:#2d3239}.fxs-mode-light .msportalfx-fill-white{fill:#fff}.fxs-mode-light .msportalfx-bgcolor-paletteLightGray{background-color:#e6e6e6}.fxs-mode-light .msportalfx-highlight{color:#000;background-color:#fff100}.fxs-mode-light .msportalfx-brdr-color:hover,.fxs-mode-light .msportalfx-brdr-selected{border-color:#00bcf2}.fxs-mode-light .fxs-popup{background-color:#fff;color:#2d3239;border-color:#b3b3b3}.fxs-mode-light .fxs-popup svg{fill:#2d3239}.fxs-mode-light .fxs-popup svg.msportalfx-svg-palette-inherit{fill:inherit}.fxs-mode-light .fxs-popup .fxs-has-hover:hover{background-color:#e6e6e6}.fxs-mode-light .fxs-popup .fxs-is-selected,.fxs-mode-light .fxs-popup .fxs-is-selected.fxs-has-hover:hover{background-color:#ccc}.fxs-mode-light .fxs-popup .fxs-text-title{color:#575b60}.fxs-mode-light .fxs-popup .fxs-fill-secondary svg{fill:#575b60}.fxs-mode-light .fxs-popup .fxs-has-border{border-color:#b3b3b3}.fxs-mode-light .fxs-popup a{color:#2d3239}.fxs-mode-light .fxs-popup-button.fxs-is-selected{background-color:#fff;color:#2d3239}.fxs-mode-light .fxs-popup-button.fxs-is-selected a{color:#2d3239}.fxs-mode-light .fxs-popup-button.fxs-is-selected svg{fill:#2d3239}.fxs-mode-light .fxs-popup-button.fxs-is-selected .fxs-has-hover:hover,.fxs-mode-light .fxs-popup-button.fxs-is-selected.fxs-has-hover:hover,.fxs-mode-light .fxs-popup-feedback{background-color:#e6e6e6}.fxs-mode-light .fxs-sidebar-star svg{fill:#fff;stroke:#6c7074}.fxs-mode-light .fxs-sidebar-star:hover svg{fill:#ffb900}.fxs-mode-light .fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#ffb900}.fxs-mode-light .fxs-sidebar-star.fxs-is-favorite:hover svg{fill:#fff}.fxs-mode-light .fxs-input-default{background-color:#fff;border-color:#b3b3b3;color:#2d3239}.fxs-mode-light .fxs-input-default:focus{border-color:#00bcf2}.fxs-mode-light .fxs-listpopup.fxs-popup .fxs-has-hover:hover{background-color:#e6e6e6}.fxs-mode-light .fxs-listpopup.fxs-popup .fxs-is-selected,.fxs-mode-light .fxs-listpopup.fxs-popup .fxs-is-selected.fxs-has-hover:hover{background-color:#ccc}.fxs-mode-light .fxs-bg-muted-10{background-color:#e6e6e6}.fxs-mode-light .fxs-bg-muted-20{background-color:#ccc}.fxs-mode-light .fxs-tile-overlay{background-color:rgba(255,255,255,.6)}.fxs-mode-light .fxs-br-default{border-color:#b3b3b3}.fxs-mode-light .fxs-selected{background-color:#d9f5fd}.fxs-mode-light .fxs-activated{background-color:#b3ebfb}")}
);define("MsPortalImpl/Base/Themes",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css","_generated/Less/MsPortalImpl/Themes/Themes.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css"],function(n,t,i,r){"use strict";var u;return function(t){function w(n,t,i){return new h(n,t,i)}function e(n,t,i,r,u){return{colorCode:n,imageUri:c.getContentUri(p+t),name:i,title:r,mode:u}}var o=i.Base,c=o.Resources,h;t.extLightClass="ext-mode-light";t.extDarkClass="ext-mode-dark";var l="bluealttheme",a="fxs-theme-",v="fxs-mode-light "+t.extLightClass,y="fxs-mode-dark "+t.extDarkClass,f=r.Themes.Names,p="Content/Images/MsPortalImpl/Themes/",u="_generated/Less/MsPortalImpl/Themes/Themes.{0}.css",s="Blades.",b=o.Diagnostics.createLog(n);t.createManager=w;h=function(){function t(n,t,r){var u=this,s=this._themes=[e("#0078d7","Theme_Azure.png","azure",f.azure,0),e("#3284ae","Theme_Blue.png","blue",f.blue,0),e("#fff","Theme_Light.png",
"light",f.light,0),e("#333","Theme_Dark.png","dark",f.dark,1),],o,h;i.isFeatureEnabled(l)&&s.push(e("#215b7d","Theme_BlueAlt.png","blueAlt",f.bluealt,0));o=s.map(function(n){return n.name}).indexOf((r()||{}).name);~o||(o=1);this.currentTheme=r;r(s[o]);this._themeIndex=o;r.subscribe(n,function(n){n=n||u._themes[u._themeIndex=0];u._injectStyles(n).then(function(){var c=n.mode?y:v;t.removeClass(h).addClass(h=a+n.name+" "+c);var o=".MsPortalImpl\\/Themes\\/Themes\\.Reset\\.{0}\\.css",s=$("head"),i=s.find(o.format("Colors")),r=s.find(o.format("ColorsAlt")),f=u._resetColorContent,e=u._resetColorAltContent;f=u._resetColorContent=i.text()||f;e=u._resetColorAltContent=r.text()||e;i.empty();r.empty();n.name==="blueAlt"?r.append(e):i.append(f)})}).callback(r());n.registerForDispose(function(){t.removeClass(h)})}return t.prototype.getThemes=function(){return this._themes},t.prototype.rotateTheme=function(){var n=this._themes,t=this._themeIndex=((this._themeIndex||0)+1)%n.length;this.currentTheme(n[
t])},t.prototype.getDefaultTheme=function(){return this._themes[1]},t.prototype._injectStyles=function(t){var r=t.name,o=t.mode,f=r.charAt(0).toUpperCase()+r.slice(1),e=o?"DarkMode":"LightMode",h=[u.format(f),u.format(e),].concat(r==="blueAlt"?[u.format("Reset.ColorsAlt")]:[u.format("Reset.Colors")]).concat(this._injectBladeCss?[u.format(s+f),u.format(s+e)]:[]);return i.require(h,n)},t.prototype.loadBladesCSS=function(){return this._injectBladeCss=!0,this._injectStyles(this.currentTheme())},t}()}(u||(u={})),u});define("MsPortalImpl/Base/Base.CssSanitizer",["require","exports","f","./Base.Sanitization","./Base.CssSelectorParser","./Themes"],function(n,t,i,r,u,f){"use strict";var e;return function(t){function l(n){return n==="cssFloat"?"float":(n||"").replace(/([A-Z])/g,"-$1").toLowerCase()}function a(n){return"css-scope-"+n.replace(d,"")}function nt(n){var i="."+a(n.name),t=[];return n.styleSheets=(n.styleSheets||[]).map(function(n){return v(n,i,t)}),t.forEach(function(t){var i="Sanitization error found in style sheet in extension: {0}\n{1} - {2}\nCSS rule: {3}".
format(n.name,r.SanitizerError.Reasons.InvalidCSSProperty,t.errorMessage,t.rule.cssText);g?o.error(i):o.warning(i)}),t.length===0}function tt(n,t,i){t.insertRule(".ignored1 { {0} }".format(n),0);t.insertRule(".ignored2 {}",1);var r=t.cssRules[0],u=t.cssRules[1];return r.type===CSSRule.STYLE_RULE?(p(r.style,u,i),u.style.cssText):(i.push("Not a style rule: "+n),null)}function v(n,t,r){var u=document.implementation.createHTMLDocument(""),o=u.createElement("style");u.body.appendChild(o);var s=et(n,u),h=s.filter(function(n){return n.type===CSSRule.STYLE_RULE}),c=h.map(function(n){var i=it(n,o.sheet,t,r);return i?i.cssText:null}),e=c.join("\n");return[f.extLightClass,f.extDarkClass].forEach(function(n){var r=["{0} {1}","{1} {0}"].map(function(i){return i.format(t,"."+n)});e=i.replaceAll(e,r[0],r[1])}),e}function y(n,t,i){i.push.apply(i,n.map(function(n){return{rule:t,errorMessage:n}}))}function it(n,t,i,r){var e=[],o=rt(n.selectorText,i,e),u,f;return y(e,n,r),o?(t.insertRule(o+" {}",0),u=t.cssRules[
0],f=[],p(n.style,u,f),y(f,n,r),u):null}function p(n,i,r){for(var o,c,l=st(n),h=0,v=l.length;h<v;h++){var u=l[h],f=n.getPropertyValue(u),y=n.getPropertyPriority(u);if(f!=="initial"){var p=ft(y,r),a=null,s=null;t.stylePolicy.hasOwnProperty(u)?(a=u,o=t.stylePolicy[u],o===e?s=f:o instanceof Array?(c=o.indexOf(f),c>=0&&(s=o[c])):typeof o=="function"&&o(f)&&(s=f),s?i.style.setProperty(u,f,p):r.push("Disallowed style value. Property name: {0}, value: {1}".format(a,f))):r.push("Disallowed style property. Property name: "+u)}}}function rt(n,t,i){var r,f=[];try{r=u.parseCssSelector(n)}catch(e){return i.push("Malformed selector: "+n+"\nException: "+e.toString()),null}return r.forEach(function(n){ut(n,i)&&f.push(t+" "+u.subselectorToString(n))}),f.join(", ")}function ut(n,t){var i=n.some(function(n){switch(n.type){case"CLASS":if(n.value&&n.value.substring(0,5)!==".ext-")return t.push("Selectors can only refer to extension-specific class names (those starting 'ext-')"),!0;break;case"ID":return t.push(
"Selectors cannot refer to elements by ID"),!0}return!1});return!i}function ft(n,t){return n?(t.push("Disallowed CSS priority value: "+n),""):n}function et(n,t){var i=t.createElement("style");t.body.appendChild(i);i.type="text/css";i.textContent=n;var r=i.sheet,u=r&&r.cssRules;return u?Array.prototype.slice.call(u,0):[]}function ot(n){return n==="none"||n==="uppercase"||n==="lowercase"}function st(n){for(var r,u=[],f=("MozAnimation"in n),i=0;i<n.length;i++){if(r=n[i],!(r in t.stylePolicy)&&f)return ht(n);u.push(r)}return u}function ht(n){for(var i,r=[],t=s.length-1;t>=0;t--)i=s[t],n[i]&&r.push(l(i));return r}var w=i.Base.Diagnostics,e=r.anyValueAccepted,b=["align-content","align-items","border","bottom","box-shadow","box-sizing","clear","clip-path","color","cursor","display","enable-background","fill","fill-rule","fill-opacity","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font-size","font-style","font-weight","height","justify-content",
"left","line-height","margin","margin-left","margin-top","margin-right","margin-bottom","max-height","max-width","min-height","min-width","opacity","order","outline","overflow","overflow-x","overflow-y","padding","padding-top","padding-left","padding-right","padding-bottom","pointer-events","right","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-miterlimit","stroke-opacity","stroke-width","top","text-align","text-decoration","text-transform","text-overflow","transform","transform-origin","transition","vertical-align","visibility","white-space","width","word-break","word-wrap",].concat(["attachment","clip","color","image","origin","position","position-x","position-y","repeat","size",].map(function(n){return"background-"+n})).concat(["color","width","style","left","left-width","left-style","left-color","top","top-width","top-style","top-color","right","right-width","right-style","right-color","bottom","bottom-width","bottom-style","bottom-color","image-source","image-slice",
"image-width","image-outset","image-repeat","position-x","position-y","radius","spacing","top-left-radius","top-right-radius","bottom-left-radius","bottom-right-radius",].map(function(n){return"border-"+n})).concat(["increment","set","reset",].map(function(n){return"counter-"+n})).concat(["position","type",].map(function(n){return"list-style-"+n})).concat(["color","style","width",].map(function(n){return"outline-"+n})).concat(["delay","duration","property","timing-function",].map(function(n){return"transition-"+n}));t.stylePolicy={};b.forEach(function(n){t.stylePolicy[n]=e});t.stylePolicy.position=["relative","absolute","static"];t.stylePolicy["text-transform"]=ot;var k=window,o=w.createLog(n),d=/\W/g,s=["azimuth","backgroundAttachment","backgroundColor","backgroundImage","backgroundPosition","backgroundRepeat","background","bottom","captionSide","clear","clip","color","content","counterIncrement","counterReset","cueAfter","cueBefore","cue","cursor","direction","display","elevation","emptyCells",
"cssFloat","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","font","height","left","letterSpacing","lineHeight","listStyleImage","listStylePosition","listStyleType","listStyle","marginRight","marginLeft","marginTop","marginBottom","margin","maxHeight","maxWidth","minHeight","minWidth","orphans","outlineColor","outlineStyle","outlineWidth","outline","overflow","paddingTop","paddingRight","paddingBottom","paddingLeft","padding","pageBreakAfter","pageBreakBefore","pageBreakInside","pauseAfter","pauseBefore","pause","pitchRange","pitch","playDuring","position","quotes","richness","right","speakHeader","speakNumeral","speakPunctuation","speak","speechRate","stress","tableLayout","textAlign","textDecoration","textIndent","textTransform","top","unicodeBidi","verticalAlign","visibility","voiceFamily","volume","whiteSpace","widows","width","wordSpacing","zIndex"].concat(["Collapse","Color","Spacing","Style","Top","Right","Bottom","Left","TopColor","RightColor","BottomColor","LeftColor",
"TopStyle","RightStyle","BottomStyle","LeftStyle","TopWidth","RightWidth","BottomWidth","LeftWidth","Width",""].map(function(n){return"border"+n})),h=k.fx.environment,c=h.features,g=h.isDevelopmentMode||!!c.canmodifyextensions||!!c.canaddgallerypackages;t.domStylePropertyToCssProperty=l;t.getScopeName=a;t.sanitizeDefinition=nt;t.sanitizeStyleDeclarationString=tt;t.sanitizeStyleSheetText=v}(e||(e={})),e});define("MsPortalImpl/Base/Base.KnockoutBindingSanitizer",["require","exports","f","./Base.CssSanitizer","./Base.Sanitization"],function(n,t,i,r,u){"use strict";var f;return function(n){function p(n,i,r,f,e){var v=[],y=ko.expressionRewriting.parseObjectLiteral(i),s=!0,o;return y.forEach(function(i){var y=(i.key||"").trim(),p=l.hasOwnProperty(y)?l[y]:y,d=(i.value||"").trim(),b=c.hasOwnProperty(p)?c[p]:null,k,g,nt;b===null&&p.substring(0,a.length)===a&&(b=t);b?(k=b(d,f),k!==null?v.push(w(p)+": "+k):(s=!1,o=o||n(),g=new u.SanitizerError(o,h.InvalidBindingValue,r,null,y,d),e.push(g))):(s=!1,
o=o||n(),nt=new u.SanitizerError(o,h.UnknownBindingName,r,null,y,null),e.push(nt))}),s?v.join(", "):null}function tt(n,t,i,r){var f=/^\s*ko\s([\s\S]*)/.exec(t),u;return f?(u=p(n,f[1],"comment",i,r),u===null?" ko ":" ko "+u+" "):/^\s *\/ko/.test(t)?" /ko ":null}function w(n){return n&&!y.exec(n)&&(nt.exec(n)||(n="'"+n.replace("'","\\'")+"'")),n}function t(n){var r=e(n),t,i;if(r!==null)return r;for(t=0;t<v.length;t++)if(i=n.split(v[t]),i.length===2&&e(i[0].trim())&&e(i[1].trim()))return n;return null}function it(n,i,f){var c=r.domStylePropertyToCssProperty(n),e=f.style[c],o=y.exec(i),h=o?i.slice(1,-1):null,s=!1;return e===u.anyValueAccepted?s=!!o||t(i)===i:e instanceof Array?s=!!o&&e.indexOf(h)>=0:typeof e=="function"&&(s=!!o&&e(h)),s}function e(n){return/^\!?([\$_a-z0-9\.'"\[\]]|\(\))+$/i.test(n)||/^\{\s*\}$/.test(n)?n:null}function o(n){return b(n,function(n,i){return!!t(i)})}function b(n,t){return function(i,r){var e=ko.expressionRewriting.parseObjectLiteral(i),u=[],f=!0;return e.forEach(
function(i){var e=(i.key||"").trim(),o=(i.value||"").trim();n(e,r)&&t(e,o,r)?u.push(w(e)+": "+o):f=!1}),f?"{ "+u.join(", ")+" }":null}}function k(n){return o(function(t){return n.indexOf(t)>=0})}function d(n){return/^"[^"]*"$/.test(n)||/^'[^']*'$/.test(n)?n:null}function rt(n){return function(t){var i=!!n.first(function(n){return t==='"'+n+'"'||t==="'"+n+"'"});return i?t:null}}function s(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return function(n,i){for(var u,r=0;r<t.length;r++)if(u=t[r](n,i),u!==null)return u;return null}}var g=i.Base.EventTypes,h=u.SanitizerError.Reasons,f=s(t,o(function(){return!0})),c={checked:t,click:t,clickBubble:t,commands:s(t,o(function(){return!0})),disable:t,enable:t,event:k([g.click,"keypress","afterkeypress"]),foreach:s(t,k(["data","as","includeDestroyed"])),formElement:f,fxclick:t,fxParameterCollector:t,"if":t,ifnot:t,image:t,options:t,optionsText:d,optionsValue:d,sanitizedAttr:f,sanitizedCss:f,sanitizedHtml:t,selectedOptions:t,style:b(function(
n,t){return t.style.hasOwnProperty(r.domStylePropertyToCssProperty(n))},it),submit:t,text:t,uniqueName:t,visible:t,value:t,valueUpdate:rt(["afterkeyup"]),"with":t},l={attr:"sanitizedAttr",css:"sanitizedCss",html:"sanitizedHtml"},a="pc",v=["===","==","!==","!=","<=","<",">=",">","&&","||"],y=/^("([^"\\]|\\.)*"|'([^'\\]|\\.)*')$/,nt=/^[a-z_$][a-z0-9_$]*$/i;n.sanitizeBindingAttribute=p;n.sanitizeBindingComment=tt}(f||(f={})),f});define("MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",["require","exports","f","./Base.KnockoutBindingSanitizer","./Base.CssSanitizer","./Base.Sanitization"],function(n,t,i,r,u,f){"use strict";var e;return function(t){function ut(){c={}}function b(n,t,i,r){var u=i&&i.htmlTemplateInline;u&&l(n,t,u,r,function(){u.content=null})}function ft(n,t,i){(t.lenses||[]).forEach(function(r){(r.partInstances||[]).forEach(function(r){b(n,t.name+"/"+r.name,r.inline,i)})})}function et(n,t){var r=n.name,o=n.htmlTemplates||{},f=n.hash,u=c[r],e;f&&u&&u.version===f||(u=c[r]={version:
f,templateMap:{}});e=u.templateMap;i.forEachKey(o,function(n,i){var u=e[n],f;u?i.content=u:(f=l(r,n,i,t,function(){delete o[n]}),f&&(e[n]=i.content))});(n.partsCatalog||[]).forEach(function(n){var i=n.htmlTemplateInline;i&&l(r,""+n.name,i,t,function(){i.content=null})})}function l(n,i,r,u,f){var s="Extension: {0}, File: {1}, Template: '{2}'".format(n,r.file,i),e=t.sanitizeHTML(s,r.content),o=!e.errors.length,h=o||u===0;return h?r.content=e.sanitizedMarkup:f(),o}function k(n,t,i){if(!n)return n;var r=new RegExp("(\\s+)"+t+"(\\s*\\=)","g");return n.replace(r,"$1"+i+"$2")}function d(n,t){var i={};return i[h+n]=t,i}var a=i.Base,g=a.Diagnostics,nt=a.Utilities,o=f.SanitizerError,tt=window,v=g.createLog(n),s=tt.fx.environment,it=s.isDevelopmentMode||!!s.features.canmodifyextensions||!!s.features.canaddgallerypackages,rt=/^(msportalfx|ext-|lang-)[_\-a-zA-Z0-9]+$/,y=nt.getUniqueId,p,e={validateLinkUri:f.validateLinkUri,validateUriOrBlank:f.validateUriOrBlank,validateLocalUriOnly:f.validateLocalUriOnly,
validateClassNames:function(n,i,r,u,f,e,s){for(var v=/[_\-a-z0-9]+/ig,l,a=[],h,c;l=v.exec(n);)h=l[0],t.isAllowedCssClassName(h)?a.push(h):(c=c||s(),e.push(new o(c,o.Reasons.InvalidCSSClassName,i,null,null,h)));return a.join(" ")||null},validateKOBindingString:function(n,t,i,u,f,e,o){return r.sanitizeBindingAttribute(o,n,t,f,e)},mapName:function(n,t,i,r){return r.setAttribute(i,"TemplateSanitizer"+p+"_"+n),!1}},w=["src"],h="data-sanitizer-"+y().toLowerCase()+"-",c={};t.reset=ut;t.sanitizeInlineTemplate=b;t.sanitizeBladeDefinition=ft;t.sanitizeDefinition=et;t.isAllowedCssClassName=function(n){return typeof n=="string"&&rt.test(n)};t.sanitizeHTML=function(n){function c(n,t){var r=n[t].length===0?i:new s;return n[t].forEach(function(n){if(typeof n=="string")r[n]=i;else for(var t in n)r[t]=n[t]instanceof Function?n[t]:c(n,t)}),r}var i,s,t;return p=y(),i=f.anyValueAccepted,s=f.specificValueAccepted,t=n.elements,t.tags=c(t,"tags"),t.global=c(t,"global"),function(c,l,a){function ht(t,r,u,f,o,h)
{if(!a&&t===e.validateKOBindingString)return null;if(t===i)return r;if(t instanceof s)return r in t?r:null;if(t instanceof Function){var c=t(r,u,f,o,n,h,p);return typeof c=="boolean"?c===!0?r:null:typeof c=="string"?c:null}return null}function ft(n,t,i){var r,s,u;for(r in i)if(s=i[r],n.hasAttribute(r)&&!t.hasAttribute(r)){var h=n.getAttribute(r),f=[],e=ht(s,h,n.nodeName.toUpperCase(),r,t,f);e!==null&&t.setAttribute(r,e);f.length>0?f.forEach(function(n){y.push(n)}):e===null&&(u=u||p(),y.push(new o(u,o.Reasons.InvalidAttribute,n.nodeName.toUpperCase(),r,null,h)))}}function et(t,i){var h=t.nodeName.toUpperCase(),f,e,v,w,g,c,s,it,l,d;t.nodeType===Node.ELEMENT_NODE&&(rt||(rt=t!==b.body))&&(tt[h]?(e=document.createElement(h),ft(t,e,tt[h]),ft(t,e,st),v=t.getAttribute("style"),v&&(w=[],g=u.sanitizeStyleDeclarationString(v,ut,w),w.forEach(function(n){f=f||p();y.push(new o(f,o.Reasons.InvalidCSSProperty,h,"style",null,n))}),e.setAttribute("style",g)),i.appendChild(e),i=e):(f=f||p(),y.push(new o(
f,o.Reasons.InvalidTag,h,null,null,null))));for(var k=0,nt=t.childNodes,ot=nt.length;k<ot;k++){c=nt[k];switch(c.nodeType){case Node.TEXT_NODE:i.appendChild(document.createTextNode(c.textContent));break;case Node.ELEMENT_NODE:et(c,i);break;case Node.COMMENT_NODE:s=n.comments;it=!a&&s===r.sanitizeBindingComment;!it&&(s===!0||s&&s instanceof Function)&&(l=[],d=s(p,c.textContent,n,l),d!==null&&i.appendChild(document.createComment(d)),l.length>0&&l.forEach(function(n){y.push(n)}))}}return i}var d,ut,g;a===void 0&&(a=!0);var b=document.implementation.createHTMLDocument(""),ot=document.createDocumentFragment(),nt=document.createElement("div"),tt=t.tags,st=t.global,y=[],rt=!1,p;return p=typeof c=="string"?function(){return c}:c,ot.appendChild(nt),w.forEach(function(n){l=k(l,n,h+n)}),b.body.innerHTML=l||"",d=b.createElement("style"),d.setAttribute("type","text/css"),b.head.appendChild(d),ut=d.sheet,et(b.body,nt),y.forEach(function(n){var t=n.toString();it?v.error(t):v.warning(t)}),g=nt.innerHTML,
w.forEach(function(n){g=k(g,h+n,n)}),new f.SanitizerResult(g,y)}}({elements:{tags:["ABBR","ADDRESS","B","BLOCKQUOTE","BR","CAPTION","CITE","CODE","DD","DEL","DFN","DIV","DL","DT","EM","FIELDSET","H1","H2","H3","H4","H5","H6","HR","I","INS","LABEL","LEGEND","LI","OL","P","PRE","Q","S","SMALL","SPAN","STRONG","SUB","SUP","TBODY","TFOOT","THEAD","TR","U","UL",{A:["target",{href:e.validateLinkUri},]},{BUTTON:["value"]},{COL:["span"]},{COLGROUP:["span"]},{IMG:["width","height","alt","title","border",d("src",e.validateUriOrBlank)]},{TABLE:["border"]},{TD:["colspan","rowspan"]},{TH:["colspan","rowspan"]},{INPUT:[{type:["text","password","radio","checkbox","submit"]},{name:e.mapName},"checked","disabled","maxlength","value"]},{TEXTAREA:["rows","cols","disabled",{name:e.mapName}]},{SELECT:["disabled","multiple","size",{name:e.mapName}]},{OPTION:["disabled","label","selected","value"]},{TIME:["datetime"]},{SVG:["viewBox",{"xmlns:xlink":e.validateUriOrBlank},{"xmlns:svg":e.validateUriOrBlank},{xmlns:
e.validateUriOrBlank}]},{CIRCLE:["fill","stroke","cx","cy","r","stroke-dasharray","stroke-width","fill-rule","transform","opacity","stroke-miterlimit"]},{CLIPPATH:["clip-path"]},"DEFS","DESC",{ELLIPSE:["id","fill","stroke","cx","cy","rx","ry","stroke-dasharray","stroke-width","fill-rule","transform","opacity","stroke-miterlimit"]},{G:["id","fill","stroke","opacity","clip-path"]},{LINE:["id","fill","stroke","x1","x2","y1","y2","stroke-dasharray","stroke-width","fill-rule","transform","opacity","stroke-miterlimit"]},{LINEARGRADIENT:["id","x1","x2","y1","y2","gradientTransform","gradientUnits","spreadMethod",{"xlink:href":e.validateLocalUriOnly}]},"METADATA",{PATH:["id","fill","stroke","d","stroke-dasharray","stroke-width","fill-rule","transform","opacity","stroke-miterlimit"]},{POLYGON:["id","fill","stroke","points","stroke-dasharray","stroke-width","fill-rule","transform","opacity","stroke-miterlimit"]},{POLYLINE:["id","fill","stroke","points","stroke-dasharray","stroke-width","fill-rule",
"transform","opacity","stroke-miterlimit"]},{RADIALGRADIENT:["id","cx","cy","fx","fy","r","gradientTransform","gradientUnits","spreadMethod",{"xlink:href":e.validateLocalUriOnly}]},{RECT:["id","fill","stroke","width","height","x","y","rx","ry","stroke-dasharray","stroke-width","fill-rule","transform","opacity","stroke-miterlimit"]},{STOP:["offset"]},{TEXT:["id","fill","stroke","transform","font-size"]},"TITLE",{USE:["id","fill","stroke","width","height","x","y","transform",{"xlink:href":e.validateLocalUriOnly}]},{VIDEO:["height","width","controls","poster"]},{SOURCE:[d("src",e.validateUriOrBlank),"type"]},],global:[{"data-bind":e.validateKOBindingString},{"class":e.validateClassNames},"title","lang","data-click-telemetry",{"data-activatable":["true","false"]},"data-activate-info","aria-label"]},style:u.stylePolicy,comments:r.sanitizeBindingComment})}(e||(e={})),e});define("Viva.Controls/Controls/Base/Viva.KnockoutExtensions",["require","exports","f","./Viva.Image","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer"],
function(n,t,i,r,u){"use strict";var f;return function(n){function h(){return{controlsDescendantBindings:!0}}function a(n,t,i,r,o,s){var h=f(t()),c=h,a,p,y,v;h!==null&&typeof h=="object"&&(c=f(h.html),a=h.data,p=h.isolated);c&&!s&&(y=o.$ctl,s=y&&y.isTrusted,s||(c=u.sanitizeHTML("htmlBinding",c).sanitizedMarkup));v=o;p?v=a||r:a&&(v=o.createChildContext(a));l(function(){e.cleanDescendantNodes(n);e.setHtml(n,c);ko.applyBindingsToDescendants(v,n)})}var f=ko.unwrap,e=ko.utils,l=ko.ignoreDependencies,t=ko.bindingHandlers,r=ko.virtualElements,o=jQuery,c,v,s;if(n._koBindingContext=ko.bindingContext||ko.N,!n._koBindingContext)throw new Error("bindingContext");if(c=e.cloneNodes||e.ia,!c)throw new Error("cloneNodes");t.azcCommand={init:function(n,i,r,u,e){var s=f(i());if(!s||!s.text||!s.visible||!s.disabled||!s.handler||!s.execute)throw new Error("Command binding must be bound to viewmodel that implements Viva.Controls.Command.Contract");t.text.init&&t.text.init(n,function(){return s.text},r,u,e);
t.value.init&&t.value.init(n,function(){return s.text},r,u,e);t.visible.init&&t.visible.init(n,function(){return s.visible},r,u,e);t.disable.init&&t.disable.init(n,function(){var r=s.disabled(),t=s.handler(),u=t?t.canExecute():!1,i=r||!u;return n&&o(n).toggleClass("azc-command-disabled",i),i},r,u,e);t.click.init&&t.click.init(n,function(){return function(){var n=s.handler();n&&!s.disabled()&&n.canExecute()&&s.execute()}},r,u,e)},update:function(n,i,r,u,e){var s=f(i());t.text.update&&t.text.update(n,function(){return s.text},r,u,e);t.value.update&&t.value.update(n,function(){return s.text},r,u,e);t.visible.update&&t.visible.update(n,function(){return s.visible},r,u,e);t.disable.update&&t.disable.update(n,function(){var r=s.disabled(),t=s.handler(),u=t?t.canExecute():!1,i=r||!u;return n&&o(n).toggleClass("azc-command-disabled",i),i},r,u,e);t.click.update&&t.click.update(n,function(){return function(){var n=s.handler();n&&!s.disabled()&&n.canExecute()&&s.execute()}},r,u,e)}};t.stopBindings=
{init:function(n,t){var i=f(t());return{controlsDescendantBindings:i}}};t.trustedHtml={init:h,update:function(n,t,i,r,u){a(n,t,i,r,u,!0)}};t.untrustedHtml={init:h,update:function(n,t,i,r,u){a(n,t,i,r,u,!1)}};t.privateTemplate={createBindingContext:function(t){var i=new n._koBindingContext(t.$data);return i.createChildContext=function(t,i){return new n._koBindingContext(t,null,i)},i},init:function(n,i,r,u,f){return t.template.init(n,i,r,u,t.privateTemplate.createBindingContext(f))},update:function(n,i,r,u,f){return t.template.update(n,i,r,u,t.privateTemplate.createBindingContext(f))}};v=Array.prototype.slice;s={};t.vivaControl={registerCallback:function(n){var t=i.getUniqueId();return s[t]=n,t},unregisterGuid:function(n){delete s[n]},init:function(n,i,r,u,o){var h=f(i()),c=s[h];return e.domNodeDisposal.addDisposeCallback(n,function(){var n=c().disposables;t.vivaControl.unregisterGuid(h);n&&n.length>0&&(n.forEach(function(n){n.dispose()}),n.splice(0,n.length))}),t.privateTemplate.init(n,
c,r,u,o)},update:function(n,i,r,u,e){var o=f(i()),h=s[o];return t.privateTemplate.update(n,h,r,u,e)}};t.mapForEach={a:function(n){return function(){var r=undefined,t,u,f;return n()instanceof i.Base.Internal.ObservableMap?t=n():(t=n().data,r=n().afterRender,u=n().optimizeRendering),f=t.toArray(),{m:t,foreach:f,afterRender:r,o:u}}},init:function(n,i,u,f,e){var h=t.mapForEach.a(i),o,s;return h().o===!0?t.template.init(n,h,u,f,e):(o=[],s=[],s=r.childNodes(n),r.emptyNode(n),s.forEach(function(n){var t=n.nodeType;(t===1||t===8)&&o.push(n)}),n.__mapForEachTemplate=o,{controlsDescendantBindings:!0})},update:function(n,i,u,f,e){var o=t.mapForEach.a(i),h,a,s;if(o().o===!0)return t.template.update(n,o,u,f,e);h=n.__mapForEachTemplate;r.emptyNode(n);a=function(n,t){if(r.firstChild(n)){var i=r.childNodes(n);r.insertAfter(n,t,i[i.length-1])}else r.prepend(n,t)};o().m.latch();o().m.forEach(function(t){var i=c(h);i.forEach(function(i){a(n,i);ko.applyBindings(e.createChildContext(t),i)})});s=o().afterRender;
s&&l(function(){s()})}};r.allowedBindings.mapForEach=!0;t.svgImage={init:h,update:function(n,t){var s=o(n),i=f(t()),e,u,r;i&&(i.type===0?s.empty():i.type===2?(e=document.createElementNS("http://www.w3.org/2000/svg","image"),i.height&&e.setAttributeNS(null,"height",""+i.height),i.width&&e.setAttributeNS(null,"width",""+i.width),e.setAttributeNS(null,"x",""+i.x),e.setAttributeNS(null,"y",""+i.y),e.setAttributeNS("http://www.w3.org/1999/xlink","href",i.data),s.empty(),s.append(e)):i.data&&(u=o(i.data),r=document.createElementNS("http://www.w3.org/2000/svg","svg"),i.width?(r.setAttributeNS(null,"width",""+i.width),u.attr("width",i.width)):u.attr("width")&&r.setAttributeNS(null,"width",""+u.attr("width")),i.height?(r.setAttributeNS(null,"height",""+i.height),u.attr("height",i.height)):u.attr("height")&&r.setAttributeNS(null,"height",""+u.attr("height")),r.setAttribute("x",""+i.x),r.setAttribute("y",""+i.y),r.appendChild(u[0]),s.empty(),s.append(r)))}};r.allowedBindings.svgImage=!0;t.svgSpannableText=
{init:h,update:function(n,t){var h=o(n),i=f(t()),a=new DOMParser,r,u,c,e,s;if(i!==null){if(i.indexOf("<tspan")===-1){h.text(i);return}var v="<svg>"+i+"<\/svg>",y=a.parseFromString(v,"image/svg+xml"),l=y.getElementsByTagName("tspan");for(h.empty(),e=0;e<l.length;e++){for(u=l[e],r=document.createElementNS("http://www.w3.org/2000/svg","tspan"),s=0;s<u.attributes.length;s++)c=u.attributes.item(s),r.setAttribute(c.name,c.value);r.textContent=u.textContent;h.append(r)}}}};r.allowedBindings.svgSpannableText=!0}(f||(f={})),f});define("MsPortalImpl.Controls/Controls/Base/Base",["require","exports","i","../../../Viva.Controls/Util/Viva.Util","../../../_generated/Less/MsPortalImpl.Controls/Controls/Base.css","Viva.Controls/Controls/Base/Viva.KnockoutExtensions"],function(n,t,i,r){"use strict";var u;return function(n){var t="remove.fxWidget",u=function(){function n(n,t,r){if(r===void 0&&(r={}),this._destroyIds=[],!n||!n.length)throw new Error("You must specify an element to associate a control to it. Your element is either null or an empty collection.");
this.element=n;this.lifetimeManager=new i.TriggerableLifetimeManager;this.bindingContext=r.bindingContext;this._registerDispose()}return n.prototype.isDisposed=function(){return this._destroyIds.length>0},n.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(null)||(this.lifetimeManager&&this.lifetimeManager.dispose(),this._disposeCallback&&(this._unregisterDispose(),this._disposeCallback=null))},n.prototype._checkExistsOrRegisterDestroyId=function(n){return r.existsOrRegisterId(this._destroyIds,n)},n.prototype._cleanDescendants=function(){ko.utils.cleanDescendantNodes(this.element)},n.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];i=this.element;this._cleanDescendants();t.length>0&&i.removeClass(t.join(" "));i.empty()},n.prototype._registerDispose=function(){var n=this,i=this.element;if(this.bindingContext)ko.utils.domNodeDisposal.addDisposeCallback(i[0],this._disposeCallback=function(){n.dispose()});else i.on(t,this._disposeCallback=
function(t){t.target!==i[0]||n._destroyTriggered||(n._destroyTriggered=!0,n.dispose())})},n.prototype._unregisterDispose=function(){var n=this.element,i=this._disposeCallback;this.bindingContext?ko.utils.domNodeDisposal.removeDisposeCallback(n[0],i):n.off(t,i)},n}();n.Widget=u}(u||(u={})),u});define("MsPortalImpl.Controls/Controls/Base/OptionsBase",["require","exports","f","u","./Base","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","../../../_generated/Less/MsPortalImpl.Controls/Controls/Base.css"],function(n,t,i,r,u,f){"use strict";var e;return function(n){function ht(n,t){var i;return o(n)||(i=h(n)),o(i)?t:i}function ct(n,t){var u=c([n.$disabled,t.$disabled]),i=d([n.$tabIndex,t.$tabIndex],[t.$disabled]),f=r(function(){return i()===null?null:-1});return{$disabled:u,$tabIndex:i,$focusIndex:f}}function b(n){return rt(t(n)[0])}function lt(n){var i=t("<div/>")[0],r;return ut(n,i),r=rt(i),ko.cleanNode(i),r}function k(n,t,i,r){var u=r||b(n);return u=u?u.createChildContext(t):lt(t),u.extend(
i)}function kt(n){var t=b(n);return t||(t=lt(null)),o(t.$disabled)&&(t=t.extend({$disabled:r(function(){return!1})})),o(t.$tabIndex)&&(t=t.extend({$tabIndex:r(function(){return 0})})),o(t.$focusIndex)&&(t=t.extend({$focusIndex:r(function(){return-1})})),t}function c(n){return r(function(){for(var r,t=!1,i=0;i<n.length;i++)r=ht(n[i],!1),t=t||r;return t})}function d(n,t){var i=c(t);return r(function(){for(var r,f=i(),t=0,u=0;u<n.length;u++)r=ht(n[u],0),t===null||r===null?t=null:f||t<0||r<0?r<0?t=r:t<0||(t=-1):t=r;return t})}var vt=i.Base,nt=vt.Promises,yt=nt.CancelationToken,pt=nt.makeCancelable,tt=i.Errors,wt=tt.CanceledError,bt=tt.DisposedError,o=i.isUndefined,h=ko.unwrap,l=ko.ignoreDependencies,a=ko.bindingHandlers,r=ko.pureComputed,it=ko.observable,rt=ko.contextFor,ut=ko.applyBindings,ft=ko.applyBindingsToDescendants,v=ko.utils.extend,t=jQuery,et="fxc-base",ot="fxcontrol-base",y="fxc-base-fill-container-width",p="fxcontrol-base-fill-container-width",w="fxc-base-fill-container-height",
st="fxcontrol-base-fill-container-height",e,s,at,g;n.widgetTypesDataKey="fxWidgetTypes";e=[],function(n){n[n.Default=0]="Default";n[n.Width=1]="Width";n[n.Height=2]="Height";n[n.WidthAndHeight=3]="WidthAndHeight"}(n.FillBehavior||(n.FillBehavior={}));s=n.FillBehavior;n.contextFor=kt;n.chainDisabledProperties=c;n.chainTabindexProperties=d;at=function(u){function o(t,i,f){var nt=this,o,h,l,g;u.call(this,t,i,f);this._addDisposablesToCleanUp=function(n){return nt.lifetimeManager.registerForDispose(n)};this._options=i;this._widgets=[];this._waitToken=new yt;this._createOptions=v({isTrusted:!1,fillBehavior:s.Default},f);this.isTrusted=this._createOptions.isTrusted;t.addClass(et).addClass(ot);o=t.addClass.bind(this.element);switch(this._createOptions.fillBehavior){case s.Width:o(y).addClass(p);break;case s.Height:o(w);break;case s.WidthAndHeight:o(y).addClass(p);o(w).addClass(st)}t.data(n.widgetTypesDataKey)||t.data(n.widgetTypesDataKey,[]);t.data(n.widgetTypesDataKey).push(this);h=e.length;h&&
(l=e[h-1],l.push(this));var a=this.disabled=it(!1),tt=this.tabindex=it(0),k=this.bindingContext||b(t)||{};this.$disabled=c([k.$disabled,i.disabled,a]);g=this.$tabIndex=d([k.$tabIndex,tt],[i.disabled,a]);this.$focusIndex=r(function(){return g()===null?null:-1})}return __extends(o,u),o.prototype.dispose=function(){var t,r,f;this._checkExistsOrRegisterDestroyId(u.prototype.dispose)||(this._waitToken.cancel(new wt({message:"Disposed",innerErrors:new bt})),t=this.element.data(n.widgetTypesDataKey),t&&(t.splice(t.indexOf(this),1),t.length===0&&this.element.removeData(n.widgetTypesDataKey)),this._widgets&&(this._widgets.forEach(function(n){n&&n.dispose()}),this._widgets=null),this.element.removeClass(et).removeClass(ot).removeClass(y).removeClass(p).removeClass(w).removeClass(st).removeAttr("role"),r=e.length,r&&(f=e[r-1],i.remove(f,this)),u.prototype.dispose.call(this))},Object.defineProperty(o.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),o.prototype.
widget=function(){return this.element},Object.defineProperty(o.prototype,"widgets",{get:function(){return this._widgets},enumerable:!0,configurable:!0}),o.prototype.waitForReady=function(){return Q()},o.beginTracking=function(n){n===void 0&&(n=[]);e.push(n)},o.endTracking=function(){return e.pop()},o.getBindingHandler=function(n,i){return i=i||{controlsDescendantBindings:!0},{init:function(){return i},update:function(i,r,u,f,e){var s=h(r());l(function(){var r=o.getWidget(t(i),n);r!==null&&r.dispose();s&&(r=new n(t(i),s,{bindingContext:e}))})}}},o.getWidget=function(n,t){var i=o.getWidgets(n,t);return i?i[0]||null:null},o.getWidgets=function(t,i){var r=t.data(n.widgetTypesDataKey)||[];return i?r.filter(function(n){return n instanceof i}):r},o.prototype.trigger=function(n,i,r,u){var e=this.options[n],f=this.element;return r=r||{},i=i||t.Event(n),i.type=n,i.target=u||f[0],f.trigger(i,r),!(t.isFunction(e)&&e.apply(f[0],[i].concat(r))===!1||i.isDefaultPrevented())},o.prototype.waitFor=function(
n){return pt(n,this._waitToken)},o.prototype.sanitizeTemplate=function(n){return n&&!this.isTrusted?f.sanitizeHTML("Controls.Base",n).sanitizedMarkup:n},o.prototype._bindDescendants=function(n,i){var r,u,f;n===void 0&&(n={});r=this.options;u=t(i||this.element)[0];v(n,{data:r,func:this});f=k(u,n,{$ctl:this,$vm:r,$disabled:this.$disabled,$tabIndex:this.$tabIndex,$focusIndex:this.$focusIndex},this.bindingContext);ft(f,u)},o.prototype._bindElement=function(n,i){var r=t(i)[0],u=k(r,n,{$ctl:this,$vm:n,$disabled:this.$disabled,$tabIndex:this.$tabIndex,$focusIndex:this.$focusIndex},this.bindingContext);ut(u,r)},o.prototype._isRtl=function(){return t("html").attr("dir")==="rtl"},o}(u.Widget);n.Widget=at;a.context={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t,i,r,u){var f=h(t()),e=l(function(){var t=ct(u,f);return k(n,r,t,u)});ft(e,n)}};ko.virtualElements.allowedBindings.context=!0;g=a.template;a.template={init:function(n,t,i,r,u){return g.init(n,t,i,r,u)},update:function(
n,t,i,r,u){var c=t(),f=h(c),e,o,s;return f=typeof f=="string"?{name:c}:v({},f),e=f.context,e&&(u=l(function(){typeof e=="function"&&(e=e(f.data||r));var n=ct(u,e);return u.extend(n)}),delete f.context),o=u.$ctl,s=o&&o.templateEngine,s&&f.name&&!f.templateEngine&&(f.templateEngine=s),t=function(){return f},g.update(n,t,i,r,u)}}}(e||(e={})),e});define("MsPortalImpl.Controls/Controls/Base/Loadable",["require","exports","./OptionsBase"],function(n,t,i){"use strict";var r;return function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this._isInitialized=!1;this._isInitializing=!1}return __extends(t,n),Object.defineProperty(t.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t}(i.Widget);n.Widget=t}(r||(r={})),r});define("_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css",["require","exports","module"],function(
n,t,i){"use strict";window.fx.injectCss(i,".azc-control svg{overflow:hidden}.azc-control table{table-layout:fixed}.azc-control a img{border:0}.azc-control a{text-decoration:none}body>div[data-popup=true].azc-control{z-index:250}.azc-before-color-index-76::before,.azc-color-index-76,div.azc-before-color-k0t2::before,div.azc-color-k0t2,div.msportalfx-bgcolor-k0t2{background-color:#63707e!important}.azc-before-color-index-75::before,.azc-color-index-75,div.azc-before-color-j0t2::before,div.azc-color-j0t2,div.msportalfx-bgcolor-j0t2{background-color:#f0f7b2!important}.azc-before-color-index-74::before,.azc-color-index-74,div.azc-before-color-i0t2::before,div.azc-color-i0t2,div.msportalfx-bgcolor-i0t2{background-color:#ccecdb!important}.azc-before-color-index-73::before,.azc-color-index-73,div.azc-before-color-h0t2::before,div.azc-color-h0t2,div.msportalfx-bgcolor-h0t2{background-color:#ccf0ea!important}.azc-before-color-index-72::before,.azc-color-index-72,div.azc-before-color-g0t2::before,div.azc-color-g0t2,div.msportalfx-bgcolor-g0t2{background-color:#ccf2fc!important}.azc-before-color-index-71::before,.azc-color-index-71,div.azc-before-color-f0t2::before,div.azc-color-f0t2,div.msportalfx-bgcolor-f0t2{background-color:#ccd1e9!important}.azc-before-color-index-70::before,.azc-color-index-70,div.azc-before-color-e0t2::before,div.azc-color-e0t2,div.msportalfx-bgcolor-e0t2{background-color:#e1d3e4!important}.azc-before-color-index-69::before,.azc-color-index-69,div.azc-before-color-d0t2::before,div.azc-color-d0t2,div.msportalfx-bgcolor-d0t2{background-color:#fbcce8!important}.azc-before-color-index-68::before,.azc-color-index-68,div.azc-before-color-c0t2::before,div.azc-color-c0t2,div.msportalfx-bgcolor-c0t2{background-color:#facfd3!important}.azc-before-color-index-67::before,.azc-color-index-67,div.azc-before-color-b0t2::before,div.azc-color-b0t2,div.msportalfx-bgcolor-b0t2{background-color:#ffe8cc!important}.azc-before-color-index-66::before,.azc-color-index-66,div.azc-before-color-a0t2::before,div.azc-color-a0t2,div.msportalfx-bgcolor-a0t2{background-color:#fffccc!important}.azc-before-color-index-65::before,.azc-color-index-65,div.azc-before-color-k0t1::before,div.azc-color-k0t1,div.msportalfx-bgcolor-k0t1{background-color:#8f9ca8!important}.azc-before-color-index-64::before,.azc-color-index-64,div.azc-before-color-j0t1::before,div.azc-color-j0t1,div.msportalfx-bgcolor-j0t1{background-color:#d6e86c!important}.azc-before-color-index-63::before,.azc-color-index-63,div.azc-before-color-i0t1::before,div.azc-color-i0t1,div.msportalfx-bgcolor-i0t1{background-color:#66c592!important}.azc-before-color-index-62::before,.azc-color-index-62,div.azc-before-color-h0t1::before,div.azc-color-h0t1,div.msportalfx-bgcolor-h0t1{background-color:#66d1bf!important}.azc-before-color-index-61::before,.azc-color-index-61,div.azc-before-color-g0t1::before,div.azc-color-g0t1,div.msportalfx-bgcolor-g0t1{background-color:#66d7f7!important}.azc-before-color-index-60::before,.azc-color-index-60,div.azc-before-color-f0t1::before,div.azc-color-f0t1,div.msportalfx-bgcolor-f0t1{background-color:#6674bc!important}.azc-before-color-index-59::before,.azc-color-index-59,div.azc-before-color-e0t1::before,div.azc-color-e0t1,div.msportalfx-bgcolor-e0t1{background-color:#a47aaf!important}.azc-before-color-index-58::before,.azc-color-index-58,div.azc-before-color-d0t1::before,div.azc-color-d0t1,div.msportalfx-bgcolor-d0t1{background-color:#f466ba!important}.azc-before-color-index-57::before,.azc-color-index-57,div.azc-before-color-c0t1::before,div.azc-color-c0t1,div.msportalfx-bgcolor-c0t1{background-color:#f1707b!important}.azc-before-color-index-56::before,.azc-color-index-56,div.azc-before-color-b0t1::before,div.azc-color-b0t1,div.msportalfx-bgcolor-b0t1{background-color:#ffba66!important}.azc-before-color-index-55::before,.azc-color-index-55,div.azc-before-color-a0t1::before,div.azc-color-a0t1,div.msportalfx-bgcolor-a0t1{background-color:#fcf37e!important}.azc-before-color-index-54::before,.azc-color-index-54,div.azc-before-color-k0s1::before,div.azc-color-k0s1,div.msportalfx-bgcolor-k0s1{background-color:#464f59!important}.azc-before-color-index-53::before,.azc-color-index-53,div.azc-before-color-j0s1::before,div.azc-color-j0s1,div.msportalfx-bgcolor-j0s1{background-color:#8ba208!important}.azc-before-color-index-52::before,.azc-color-index-52,div.azc-before-color-i0s1::before,div.azc-color-i0s1,div.msportalfx-bgcolor-i0s1{background-color:#0f5b2f!important}.azc-before-color-index-51::before,.azc-color-index-51,div.azc-before-color-h0s1::before,div.azc-color-h0s1,div.msportalfx-bgcolor-h0s1{background-color:#00856f!important}.azc-before-color-index-50::before,.azc-color-index-50,div.azc-before-color-g0s1::before,div.azc-color-g0s1,div.msportalfx-bgcolor-g0s1{background-color:#008db5!important}.azc-before-color-index-49::before,.azc-color-index-49,div.azc-before-color-f0s1::before,div.azc-color-f0s1,div.msportalfx-bgcolor-f0s1{background-color:#00126b!important}.azc-before-color-index-48::before,.azc-color-index-48,div.azc-before-color-e0s1::before,div.azc-color-e0s1,div.msportalfx-bgcolor-e0s1{background-color:#4e195c!important}.azc-before-color-index-47::before,.azc-color-index-47,div.azc-before-color-d0s1::before,div.azc-color-d0s1,div.msportalfx-bgcolor-d0s1{background-color:#b10069!important}.azc-before-color-index-46::before,.azc-color-index-46,div.azc-before-color-c0s1::before,div.azc-color-c0s1,div.msportalfx-bgcolor-c0s1{background-color:#ae0d1a!important}.azc-before-color-index-45::before,.azc-color-index-45,div.azc-before-color-b0s1::before,div.azc-color-b0s1,div.msportalfx-bgcolor-b0s1{background-color:#bf6900!important}.azc-before-color-index-44::before,.azc-color-index-44,div.azc-before-color-a0s1::before,div.azc-color-a0s1,div.msportalfx-bgcolor-a0s1{background-color:#bfb500!important}.azc-before-color-index-43::before,.azc-color-index-43,div.azc-before-color-k0s2::before,div.azc-color-k0s2,div.msportalfx-bgcolor-k0s2{background-color:#32383f!important}.azc-before-color-index-42::before,.azc-color-index-42,div.azc-before-color-j0s2::before,div.azc-color-j0s2,div.msportalfx-bgcolor-j0s2{background-color:#3d460a!important}.azc-before-color-index-41::before,.azc-color-index-41,div.azc-before-color-i0s2::before,div.azc-color-i0s2,div.msportalfx-bgcolor-i0s2{background-color:#063d20!important}.azc-before-color-index-40::before,.azc-color-index-40,div.azc-before-color-h0s2::before,div.azc-color-h0s2,div.msportalfx-bgcolor-h0s2{background-color:#084c41!important}.azc-before-color-index-39::before,.azc-color-index-39,div.azc-before-color-g0s2::before,div.azc-color-g0s2,div.msportalfx-bgcolor-g0s2{background-color:#005e79!important}.azc-before-color-index-38::before,.azc-color-index-38,div.azc-before-color-f0s2::before,div.azc-color-f0s2,div.msportalfx-bgcolor-f0s2{background-color:#000c48!important}.azc-before-color-index-37::before,.azc-color-index-37,div.azc-before-color-e0s2::before,div.azc-color-e0s2,div.msportalfx-bgcolor-e0s2{background-color:#34113d!important}.azc-before-color-index-36::before,.azc-color-index-36,div.azc-before-color-d0s2::before,div.azc-color-d0s2,div.msportalfx-bgcolor-d0s2{background-color:#760046!important}.azc-before-color-index-35::before,.azc-color-index-35,div.azc-before-color-c0s2::before,div.azc-color-c0s2,div.msportalfx-bgcolor-c0s2{background-color:#740912!important}.azc-before-color-index-34::before,.azc-color-index-34,div.azc-before-color-b0s2::before,div.azc-color-b0s2,div.msportalfx-bgcolor-b0s2{background-color:#804600!important}.azc-before-color-index-33::before,.azc-color-index-33,div.azc-before-color-a0s2::before,div.azc-color-a0s2,div.msportalfx-bgcolor-a0s2{background-color:#807900!important}.azc-before-color-index-32::before,.azc-color-index-32,div.azc-before-color-k2::before,div.azc-color-k2,div.msportalfx-bgcolor-k2{background-color:#d6d7d8!important}.azc-before-color-index-31::before,.azc-color-index-31,div.azc-before-color-j2::before,div.azc-color-j2,div.msportalfx-bgcolor-j2{background-color:#e2e584!important}.azc-before-color-index-30::before,.azc-color-index-30,div.azc-before-color-i2::before,div.azc-color-i2,div.msportalfx-bgcolor-i2{background-color:#55d455!important}.azc-before-color-index-29::before,.azc-color-index-29,div.azc-before-color-h2::before,div.azc-color-h2,div.msportalfx-bgcolor-h2{background-color:#00d8cc!important}.azc-before-color-index-28::before,.azc-color-index-28,div.azc-before-color-g2::before,div.azc-color-g2,div.msportalfx-bgcolor-g2{background-color:#6dc2e9!important}.azc-before-color-index-27::before,.azc-color-index-27,div.azc-before-color-f2::before,div.azc-color-f2,div.msportalfx-bgcolor-f2{background-color:#4668c5!important}.azc-before-color-index-26::before,.azc-color-index-26,div.azc-before-color-e2::before,div.azc-color-e2,div.msportalfx-bgcolor-e2{background-color:#9b4f96!important}.azc-before-color-index-25::before,.azc-color-index-25,div.azc-before-color-d2::before,div.azc-color-d2,div.msportalfx-bgcolor-d2{background-color:#f472d0!important}.azc-before-color-index-24::before,.azc-color-index-24,div.azc-before-color-c2::before,div.azc-color-c2,div.msportalfx-bgcolor-c2{background-color:#dd5900!important}.azc-before-color-index-23::before,.azc-color-index-23,div.azc-before-color-b2::before,div.azc-color-b2,div.msportalfx-bgcolor-b2{background-color:#ffb900!important}.azc-before-color-index-22::before,.azc-color-index-22,div.azc-before-color-a2::before,div.azc-color-a2,div.msportalfx-bgcolor-a2{background-color:#fffc9e!important}.azc-before-color-index-21::before,.azc-color-index-21,div.azc-before-color-k0::before,div.azc-color-k0,div.msportalfx-bgcolor-k0{background-color:#bbc2ca!important}.azc-before-color-index-20::before,.azc-color-index-20,div.azc-before-color-j0::before,div.azc-color-j0,div.msportalfx-bgcolor-j0{background-color:#bad80a!important}.azc-before-color-index-19::before,.azc-color-index-19,div.azc-before-color-i0::before,div.azc-color-i0,div.msportalfx-bgcolor-i0{background-color:#009e49!important}.azc-before-color-index-18::before,.azc-color-index-18,div.azc-before-color-h0::before,div.azc-color-h0,div.msportalfx-bgcolor-h0{background-color:#00b294!important}.azc-before-color-index-17::before,.azc-color-index-17,div.azc-before-color-g0::before,div.azc-color-g0,div.msportalfx-bgcolor-g0{background-color:#00bcf2!important}.azc-before-color-index-16::before,.azc-color-index-16,div.azc-before-color-f0::before,div.azc-color-f0,div.msportalfx-bgcolor-f0{background-color:#00188f!important}.azc-before-color-index-15::before,.azc-color-index-15,div.azc-before-color-e0::before,div.azc-color-e0,div.msportalfx-bgcolor-e0{background-color:#68217a!important}.azc-before-color-index-14::before,.azc-color-index-14,div.azc-before-color-d0::before,div.azc-color-d0,div.msportalfx-bgcolor-d0{background-color:#ec008c!important}.azc-before-color-index-13::before,.azc-color-index-13,div.azc-before-color-c0::before,div.azc-color-c0,div.msportalfx-bgcolor-c0{background-color:#e81123!important}.azc-before-color-index-12::before,.azc-color-index-12,div.azc-before-color-b0::before,div.azc-color-b0,div.msportalfx-bgcolor-b0{background-color:#ff8c00!important}.azc-before-color-index-11::before,.azc-color-index-11,div.azc-before-color-a0::before,div.azc-color-a0,div.msportalfx-bgcolor-a0{background-color:#fff100!important}.azc-before-color-index-10::before,.azc-color-index-10,div.azc-before-color-k1::before,div.azc-color-k1,div.msportalfx-bgcolor-k1{background-color:#a0a5a8!important}.azc-before-color-index-9::before,.azc-color-index-9,div.azc-before-color-j1::before,div.azc-color-j1,div.msportalfx-bgcolor-j1{background-color:#7fba00!important}.azc-before-color-index-8::before,.azc-color-index-8,div.azc-before-color-i1::before,div.azc-color-i1,div.msportalfx-bgcolor-i1{background-color:#007233!important}.azc-before-color-index-7::before,.azc-color-index-7,div.azc-before-color-h1::before,div.azc-color-h1,div.msportalfx-bgcolor-h1{background-color:#008272!important}.azc-before-color-index-6::before,.azc-color-index-6,div.azc-before-color-g1::before,div.azc-color-g1,div.msportalfx-bgcolor-g1{background-color:#0072c6!important}.azc-before-color-index-5::before,.azc-color-index-5,div.azc-before-color-f1::before,div.azc-color-f1,div.msportalfx-bgcolor-f1{background-color:#002050!important}.azc-before-color-index-4::before,.azc-color-index-4,div.azc-before-color-e1::before,div.azc-color-e1,div.msportalfx-bgcolor-e1{background-color:#442359!important}.azc-before-color-index-3::before,.azc-color-index-3,div.azc-before-color-d1::before,div.azc-color-d1,div.msportalfx-bgcolor-d1{background-color:#b4009e!important}.azc-before-color-index-2::before,.azc-color-index-2,div.azc-before-color-c1::before,div.azc-color-c1,div.msportalfx-bgcolor-c1{background-color:#ba141a!important}.azc-before-color-index-1::before,.azc-color-index-1,div.azc-before-color-b1::before,div.azc-color-b1,div.msportalfx-bgcolor-b1{background-color:#eb3c00!important}.azc-before-color-index-0::before,.azc-color-index-0,div.azc-before-color-a1::before,div.azc-color-a1,div.msportalfx-bgcolor-a1{background-color:#fcd116!important}")}
);define("Viva.Controls/Controls/Base/Viva.Base",["require","exports","f","../../Util/Viva.Util","../../../MsPortalImpl.Controls/Controls/Base/OptionsBase","../../../_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css"],function(n,t,i,r,u){"use strict";var f;return function(n){function l(n){return $.extend({viewModelType:c},n)}function v(n,t){t=l(t);var i=n;return i&&i instanceof t.viewModelType||(i=new t.viewModelType,i.populateFromObject(n)),i}var e=i.initObservable,o=i.isNullOrUndefined,s="azc-control",h="azc-control-disabled",t=ko.computed,f=ko.observable,c=function(n){function t(t){t===void 0&&(t={});n.call(this,t.lifetimeManager);this.disabled=e(t.disabled,!1);this.loading=e(t.loading,!1)}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this)},t.prototype.populateFromObject=function(n){t.copyObject(n,this)},t.copyObject=function(n,i){t._copyObject(n,i,[],[])},t._copyObject=function(n,i,r,u){var s=n,o=i,h,e,f;r.push(n);u.push(i);for(e in s)s.hasOwnProperty(
e)&&(f=s[e],f!==undefined&&(Array.isArray(f)?o[e]=f:f instanceof Date?o[e]=f:typeof f=="object"&&f!==null?(h=r.indexOf(f),h>=0?o[e]=u[h]:(o[e]||(o[e]={}),t._copyObject(f,o[e],r,u))):o[e]=f))},t}(i.ViewModels.Controls.Base.ViewModel),a;n.ViewModel=c;a=function(n){function i(u,e,c){var a=this,y,w,p;if(n.call(this,u,v(e,c),l(c)),this._supportsFocus=f(!1),this._markFocusFirstElements=f(),this._dataFocusableCallback=f(),this._loading=0,this._addDisposablesToCleanUp=function(n){return a._disposablesLifetimeManager.registerForDispose(n)},y=r.Constants,!u||u.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");w=this.lifetimeManager;this._disposablesLifetimeManager=w.createChildLifetime();i.setupCleanData();p=this.element;p.addClass(s).attr(y.dataControlAttribute,"true");t(w,function(){a.widget().toggleClass(h,a.options.disabled())});t(w,function(){var n=a._dataFocusableCallback();o(n)?(p.removeAttr(y.dataCanFocusAttribute),
delete p[0][y.dataCanFocusAttribute]):(p.attr(y.dataCanFocusAttribute,"true"),p[0][y.dataCanFocusAttribute]=function(){return n.apply(a,[p,a])})});t(w,function(){var t=a._supportsFocus(),n=a._dataFocusableCallback.peek();t?n!==a._setFocus&&a._dataFocusableCallback(a._setFocus):o(n)||a._dataFocusableCallback(null)});t(w,function(){var t=a._markFocusFirstElements(),n=t?t():null;a._prevElement&&$(a._prevElement).removeAttr(y.dataFocusFirstAttribute);n&&$(n).attr(y.dataFocusFirstAttribute,"true");a._prevElement=n});this._initializeSubscriptions(this.options)}return __extends(i,n),i.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._supportsFocus(!1),this._disposeSubscriptions(),this.element.removeClass(s).removeClass(h).removeAttr(r.Constants.dataControlAttribute).removeAttr("role"),n.prototype.dispose.call(this))},Object.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(
i.prototype,"_subscriptions",{get:function(){return this._subscriptionsLifetimeManager},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_disposables",{get:function(){return this._disposablesLifetimeManager},enumerable:!0,configurable:!0}),i.prototype._canSetFocus=function(){return this.element.attr(r.Constants.dataCanFocusAttribute)&&!this.options.disabled.peek()&&this.element.is(":visible")&&!this.element.is(":disabled")?!0:!1},i.prototype._getElementToFocus=function(){return this.widget()[0]},i.prototype._setFocus=function(){if(this._canSetFocus()){var n=this._getElementToFocus();if(n)return n.focus(),!0}return!1},i.prototype._disposeSubscriptions=function(){this._subscriptionsLifetimeManager&&(this._subscriptionsLifetimeManager.dispose(),this._subscriptionsLifetimeManager=null)},i.prototype._initializeSubscriptions=function(){this._disposeSubscriptions();this._subscriptionsLifetimeManager=this.lifetimeManager.createChildLifetime()},i.prototype._afterCreate=function(
){},i.setupCleanData=function(){i._cleanData||(i._cleanData=$.cleanData,$.cleanData=function(n){for(var r,u=0,t;(t=n[u])!==null&&t!==undefined;u++)$.hasData(t)&&($(t).triggerHandler(i._widgetRemoveEvent),r=!0);r&&i._cleanData.call($,n)})},i._widgetEventNamespace=".azcWidget",i._widgetRemoveEvent="remove"+i._widgetEventNamespace,i}(u.Widget);n.Widget=a}(f||(f={})),f});define("MsPortalImpl/Base/Base.BrowserDetection",["require","exports","f"],function(){"use strict";var n;return function(n){function t(n){return n.test(o)}var e=window,o=e.navigator.userAgent,s=t(/Firefox\//i),r=t(/Chrome[ /]/i),i=t(/Edge\//i),u=t(/MSIE /i),f=t(/Trident\//i),h=t(/Safari/i);n.isFirefox=s;n.isChrome=r&&!i;n.isEdge=i;n.isIe=u||f||i;n.isIe11=!u&&f&&!i;n.isSafari=h&&!r&&!i}(n||(n={})),n});define("Viva.Controls/Util/Viva.Positioning",["require","exports","f","MsPortalImpl/Base/Base.BrowserDetection"],function(n,t,i,r){"use strict";var u;return function(n){function t(n,t){return!!(n&&t&&n&t)}function f(n){return[
[n[0],n[2],n[4]],[n[1],n[3],n[5]],[0,0,1]]}function l(n){return[n[0][0],n[1][0],n[0][1],n[1][1],n[0][2],n[1][2]]}function e(n){return n[0][0]*n[1][1]-n[0][1]*n[1][0]}function a(n){var t=f(n),i=e(t);if(i===0)return h.assert(!1,"transform cannot be inverted. returning identity matrix instead."),[1,0,0,1,0,0];var r=t[1][1]/i,u=-t[0][1]/i,o=e([[t[0][1],t[0][2]],[t[1][1],t[1][2]]])/i,s=-t[1][0]/i,c=t[0][0]/i,l=-e([[t[0][0],t[0][2]],[t[1][0],t[1][2]]])/i;return[r,s,u,c,o,l]}function v(n,t){for(var i,r,o=f(n),s=f(t),e=[[0,0,0],[0,0,0],[0,0,0]],u=0;u<3;u++)for(i=0;i<3;i++)for(r=0;r<3;r++)e[u][i]+=o[u][r]*s[r][i];return l(e)}var s=i.Base.Diagnostics,o=window,u=jQuery,h=new s.Log("Positioning"),c;(function(n){function h(n,e,o){var s,p,w,v,b,k,h,c,d,g,rt,nt,tt,ut;o||(o={});var it=r.isIe,ft=i(it?e:n),y=it?1:ft,et=it?ft:1;p=n.outerWidth();w=n.outerHeight();v=f(e.offset(),y);b=e.outerWidth()*et;k=e.outerHeight()*et;h=o.elementAlign||3;c=o.baseAlign||10;d=o.horizontalOverflowBehavior||2;g=o.verticalOverflowBehavior||
3;t(c,4)&&(v.left+=b);t(c,8)&&(v.top+=k);s=u.extend({},v);t(h,4)&&(s.left-=p);t(h,8)&&(s.top-=w);s.left=Math.round(s.left);s.top=Math.round(s.top);g!==1&&(rt=a(s,{elementAlign:h,elementSize:w,baseElementAlign:c,baseElementSize:k,scaleFactor:y},g===3))&&(s.top=rt.top);d!==1&&l(s,{elementAlign:h,elementSize:p,baseElementAlign:c,baseElementSize:b,scaleFactor:y},d===3);nt=f(n.offset(),y);tt={top:parseInt(n.css("top"),10)||0,left:parseInt(n.css("left"),10)||0};ut={top:s.top-nt.top+tt.top,left:s.left-nt.left+tt.left};n.css(ut)}function c(n){var t=i(n);return r.isChrome||r.isFirefox?1:t}function i(n){var t=(n[0].getBoundingClientRect().width||0)/(n.width()||1);return t||1}function f(n,t){return{left:n.left/t,top:n.top/t}}function e(n){return 0-n}function s(n,t){var i=u(o),r;return r=i.height()+i.scrollTop(),n-r/t}function l(n,i,r){var s=u(o),f=n.left+i.elementSize-(s.width()+s.scrollLeft())/i.scaleFactor,e;r?(e=t(i.elementAlign,2)?-i.elementSize:i.elementSize,n.left+=n.left<0?e+i.baseElementSize:
f>0?e-i.baseElementSize:0):n.left=f>0?Math.max(0,n.left-f):Math.max(0,n.left)}function a(n,i,r){var h=0,u=n.top,c=r?(t(i.elementAlign,1)?-1:1)*i.elementSize:0,o=e(u),f=0,l;return o>0?(u=r?u+c+i.baseElementSize:0,f=s(u+i.elementSize,i.scaleFactor),f>0&&(r&&f>=o?(u=n.top,h=o):h=f)):(f=s(u+i.elementSize,i.scaleFactor),f>0&&(r?(l=(t(i.baseElementAlign,1)?1:-1)*i.baseElementSize,u+=c+l):u-=f,o=e(u),o>0&&(r&&o>=f?(u=n.top,h=f):(u=0,h=o)))),{top:u,shrinkAmount:h}}n.position=h;n.getSizeScaleFactor=c})(c=n.Positioning||(n.Positioning={}));n.Invert2DTransformationMatrix=a;n.multiplyTransformArrays=v}(u||(u={})),u});define("_generated/Less/Viva.Controls/Controls/Viva.Balloon.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.azc-balloon.azc-balloon-box-left.azc-balloon-box-position-alternate .azc-balloon-pointer,.azc-balloon.azc-balloon-box-left.azc-balloon-position-alternate .azc-balloon-pointer,.azc-balloon.azc-balloon-box-right.azc-balloon-box-position-alternate .azc-balloon-pointer,.azc-balloon.azc-balloon-box-right.azc-balloon-position-alternate .azc-balloon-pointer{bottom:33px}.azc-balloon.azc-balloon-box-left .azc-balloon-pointer,.azc-balloon.azc-balloon-box-right .azc-balloon-pointer,.azc-balloon.azc-balloon-box-top .azc-balloon-pointer{width:0;border-style:solid;border-bottom-color:transparent!important;background:0 0}.azc-balloon{position:fixed;left:-99999px;top:-99999px;word-wrap:break-word;height:auto;text-align:left;z-index:250;min-width:75px}.azc-balloon.azc-balloon-hidden{visibility:hidden}.azc-balloon.azc-balloon-box-right{left:10px}.azc-balloon.azc-balloon-box-right .azc-balloon-pointer{left:2px;height:0;border-width:10px 10px 10px 0;border-top-color:transparent!important;border-left-color:transparent!important}.azc-balloon.azc-balloon-box-right .azc-balloon-content{margin:21px 0 0 12px}.azc-balloon.azc-balloon-box-right.azc-balloon-box-position-preferred,.azc-balloon.azc-balloon-box-right.azc-balloon-position-preferred{top:-48px;vertical-align:top}.azc-balloon.azc-balloon-box-right.azc-balloon-box-position-preferred .azc-balloon-pointer,.azc-balloon.azc-balloon-box-right.azc-balloon-position-preferred .azc-balloon-pointer{top:33px}.azc-balloon.azc-balloon-box-right.azc-balloon-box-position-alternate,.azc-balloon.azc-balloon-box-right.azc-balloon-position-alternate{top:68px;vertical-align:super}.azc-balloon.azc-balloon-box-left{left:-10px}.azc-balloon.azc-balloon-box-left .azc-balloon-pointer{right:2px;height:0;border-width:10px 0 10px 10px;border-top-color:transparent!important;border-right-color:transparent!important}.azc-balloon.azc-balloon-box-bottom.azc-balloon-box-position-alternate .azc-balloon-pointer,.azc-balloon.azc-balloon-box-bottom.azc-balloon-position-alternate .azc-balloon-pointer,.azc-balloon.azc-balloon-box-top.azc-balloon-box-position-alternate .azc-balloon-pointer,.azc-balloon.azc-balloon-box-top.azc-balloon-position-alternate .azc-balloon-pointer{right:48px}.azc-balloon.azc-balloon-box-left .azc-balloon-content{margin:21px 12px 0 0}.azc-balloon.azc-balloon-box-left.azc-balloon-box-position-preferred,.azc-balloon.azc-balloon-box-left.azc-balloon-position-preferred{top:-48px;vertical-align:top}.azc-balloon.azc-balloon-box-left.azc-balloon-box-position-preferred .azc-balloon-pointer,.azc-balloon.azc-balloon-box-left.azc-balloon-position-preferred .azc-balloon-pointer{top:33px}.azc-balloon.azc-balloon-box-left.azc-balloon-box-position-alternate,.azc-balloon.azc-balloon-box-left.azc-balloon-position-alternate{top:68px;vertical-align:super}.azc-balloon.azc-balloon-box-bottom{top:10px}.azc-balloon.azc-balloon-box-bottom .azc-balloon-pointer{top:2px;width:0;height:0;background:0 0;border-style:solid;border-width:0 10px 10px;border-top-color:transparent!important;border-right-color:transparent!important;border-left-color:transparent!important}.azc-balloon.azc-balloon-box-bottom .azc-balloon-content{margin-top:12px}.azc-balloon.azc-balloon-box-bottom.azc-balloon-box-position-preferred,.azc-balloon.azc-balloon-box-bottom.azc-balloon-position-preferred{left:-48px;vertical-align:top}.azc-balloon.azc-balloon-box-bottom.azc-balloon-box-position-preferred .azc-balloon-pointer,.azc-balloon.azc-balloon-box-bottom.azc-balloon-position-preferred .azc-balloon-pointer{left:48px}.azc-balloon.azc-balloon-box-bottom.azc-balloon-box-position-alternate,.azc-balloon.azc-balloon-box-bottom.azc-balloon-position-alternate{left:68px;vertical-align:super}.azc-balloon.azc-balloon-box-top{top:-10px}.azc-balloon.azc-balloon-box-top .azc-balloon-pointer{bottom:2px;height:0;border-width:10px 10px 0;border-right-color:transparent!important;border-left-color:transparent!important}.azc-balloon.azc-balloon-box-top .azc-balloon-content{margin-bottom:12px}.azc-balloon.azc-balloon-box-top.azc-balloon-box-position-preferred,.azc-balloon.azc-balloon-box-top.azc-balloon-position-preferred{left:-48px;vertical-align:top}.azc-balloon.azc-balloon-box-top.azc-balloon-box-position-preferred .azc-balloon-pointer,.azc-balloon.azc-balloon-box-top.azc-balloon-position-preferred .azc-balloon-pointer{left:48px}.azc-balloon.azc-balloon-box-top.azc-balloon-box-position-alternate,.azc-balloon.azc-balloon-box-top.azc-balloon-position-alternate{left:68px;vertical-align:super}.azc-balloon .azc-balloon-help-title{font-family:az_ea_font,wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;text-transform:uppercase;font-size:12px}.azc-balloon .azc-balloon-content{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;padding:15px;white-space:normal;text-transform:none}.azc-balloon .azc-balloon-pointer{position:absolute}')}
);define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",["require","exports","f","./Base.Sanitization"],function(n,t,i,r){"use strict";var u;return function(){function o(n,t){var i=ko.unwrap(n()),r=v(i,t);return function(){return r}}function v(n,t){if(n&&typeof n=="object"){var i={};return Object.getOwnPropertyNames(n).forEach(function(u){if(l.isSerializableProperty(u)){var f=ko.unwrap(n[u]);switch(u){case"alt":case"aria-label":case"lang":case"d":case"title":i[u]=f?f:null;break;case"href":case"poster":case"src":f?r.validateUriOrBlank(f)||u==="src"&&r.validateDataImage(f)?i[u]=f:t.push("The value '{0}' is not a valid absolute URI".format(f)):i[u]=null;break;default:t.push("The attribute '{0}' is not allowed.".format(u))}}}),i}return null}var u=i.Base,s=u.Diagnostics,f=u.Utilities,h=window,c=h.fx.environment.isDevelopmentMode||f.isDiagnosticsEnabled,e=s.createLog(n),l=f,a="Sanitization error found in 'sanitizedAttr' binding\nTag name: {0}; Binding attribute: \"{1}\"\nMessage: {2}",
t=ko.bindingHandlers;t.sanitizedAttr={init:function(n,i,r,u,f){var e=t.attr,s;return e.init?(s=o(i,[]),e.init(n,s,r,u,f)):null},update:function(n,i,r,u,f){var s=[],h=o(i,s);return s.forEach(function(t){var i=n.getAttribute("data-bind")||"None",t=a.format(String(n.tagName),i,t);c?e.error(t):e.warning(t)}),t.attr.update(n,h,r,u,f)}}}(u||(u={})),u});define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",["require","exports","./Base.KnockoutTemplateSanitizer"],function(n,t,i){"use strict";var r;return function(){function e(n){return $(n).closest(f).attr(r)}var u=1e5,n=ko.bindingHandlers,t=n.html,r="data-extensionname",f="["+r+"]["+r+"!='']";n.sanitizedHtml={init:function(n,i,r,u,f){return t.init(n,i,r,u,f)},update:function(n,r,f,o,s){var h=ko.unwrap(r());(h===null||h===undefined)&&(h="");var c=h.toString().substring(0,u),l=function(){return"Extension: {0}; sanitizedHtml binding".format(e(n)||"Unknown")},a=i.sanitizeHTML(l,c,!1),v=a.sanitizedMarkup,y=function(){return v};return t.
update(n,y,f,o,s)}};n.html=n.sanitizedHtml;n.unsanitizedHtml=t}(r||(r={})),r});define("Viva.Controls/Controls/Viva.Balloon",["require","exports","../Util/Viva.Util","./Base/Viva.Base","../Util/Viva.Positioning","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","../../_generated/Less/Viva.Controls/Controls/Viva.Balloon.css","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding"],function(n,t,i,r,u,f,e){"use strict";var o;return function(n){function yt(n){var t=o(n);return t?t[0].getBoundingClientRect():{top:0,left:0,width:0,height:0}}function k(n){for(var t;s.length>0;)t=s.splice(0,1)[0],t!==n&&t.options.visible(!1)}var c=window,o=jQuery,p="false",a="aria-hidden",t="azc-balloon",pt="__"+t,ut=t+"-content",ft=t+"-link",et=t+"-link-content",ot=t+"-pointer",st="."+t,v=t+"-hidden",nt=100,tt=t+"-position-preferred",it=t+"-box-position-preferred",rt=t+"-box-position-alternate",
w=t+"-position-alternate",ht="<div class='azc-br-muted-80-10 "+ot+"'><\/div><div class='azc-bg-muted-80-10 azc-text-white "+ut+"'><div class='azc-balloon-text'><\/div><!--ko if: data.link()--><div class='"+et+"' data-bind='if: data.link().linkUri && data.link().linkText'><a class='"+ft+"' data-bind='sanitizedAttr: { href: data.link().linkUri }, sanitizedHtml: data.link().linkText' target='_blank'><\/a><\/div><!--/ko--><\/div>",b=500,ct=0,lt=-99999,at=2e3,vt=2e3,s=[],h=["top","right","bottom","left"],l=ko.observable,y="true",d,g;n.getBox=yt;n.hideAllBalloons=k;d=function(n){function t(){n.apply(this,arguments);this.visible=l(!1);this.box=l({top:0,left:0,width:0,height:0});this.content=l("");this.position=l(0);this.horizontalOffset={preferred:0,alternate:0};this.link=l();this.verticalOffset={preferred:0,alternate:0};this.appendTo=g.getDefaultAppendTo();this.closeOtherBalloons=!1}return __extends(t,n),t}(r.ViewModel);n.ViewModel=d;g=function(n){function r(i,r,u){var f,e,s;n.call(this,i,r,
o.extend({viewModelType:d},u));f=this.options;e=this.element;f.appendTo&&(this._originalParent=e.parent(),s=o(f.appendTo),s.length||(s=o("body")),e.appendTo(s));this._balloonMeasurer=o("<div />").css({position:"absolute",left:ct,top:lt,width:at,height:vt});f.content()||f.content(e.html());e.attr({"aria-hidden":y,"aria-live":"assertive","aria-atomic":y,"data-popup":y,role:"alert"}).addClass(t).addClass(v).html(ht);this._bindDescendants();this._myInitializeSubscriptions();f.visible.valueHasMutated()}return __extends(r,n),r.prototype.dispose=function(){if(!this._checkExistsOrRegisterDestroyId(n.prototype.dispose)){var i=this.element,r=s.indexOf(this);r!==-1&&s.splice(r,1);i.removeAttr("role aria-hidden aria-live aria-atomic data-popup");this._cleanElement(t,v);i.css({top:"",left:"",opacity:""});this._removePointerClass();this._originalParent&&(i.appendTo(this._originalParent),this._originalParent=null);this._detachEvents();n.prototype.dispose.call(this)}},Object.defineProperty(r.prototype,
"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),r.getDefaultAppendTo=function(){return r._defaultAppendTo},r.setDefaultAppendTo=function(n){r._defaultAppendTo=n},r.prototype._hide=function(){var n=this;this._detachEvents();this.element.fadeOut(this._noFadeOnNextHide?0:nt,function(){n.element.attr(a,y).addClass(v)});this._noFadeOnNextHide=!1},r.prototype._show=function(){var ht=this,ct={},n,l,et,u,w,e,ot,lt,at,d,yt=o(window).scrollTop(),pt=o(window).scrollLeft(),g,tt,st,y="preferred",f,vt,r=this.element,ut=this.options,ft;if(r.appendTo(c.document.body),n=ut.box(),n){ut.closeOtherBalloons&&k(this);this._removePointerClass();this._removeTransform();do{w=r.offsetParent();e=this.options.position();lt=h[e];ot=this._getAlternatePosition(e);at=h[ot];d=h[this._getSidePositionKey(e)];g=h[this._getOtherSidePosition(e)];tt=this._getSizeKey(e);st=this._getOtherSizeKey(e);w[0].tagName==="BODY"&&(w=o(c));l=this._getBalloonBox(n,e,f);et=this._getBalloonBox(n,ot,f);u=l;switch(
e){case 1:case 2:n[d]+n[tt]+l.preferred[d]+l[tt]>w[tt]()&&(u=et);break;case 3:case 0:n[d]+l.preferred[d]<0&&(u=et)}n[g]+u.preferred[g]+u[st]>w[st]()&&n[g]+u.alternate[g]>0&&(y="alternate");ct={left:Math.max(0,n.left+u[y].left+ut.horizontalOffset[y]-pt),top:Math.max(0,n.top+u[y].top+ut.verticalOffset[y]-yt)};u===l?r.addClass(t+"-box-"+lt):r.addClass(t+"-box-"+at);y==="preferred"?r.addClass(it):r.addClass(rt);vt=f;f=parseInt(r.css("width"),10);ft=o("body").find(".fxs-portal-content").width();f>b&&ft>b?f=b:f>ft&&(f=ft)}while(f!==vt&&f!==u.width);s.splice(0,0,this);this._attachEvents();r.fadeIn(nt,function(){r.appendTo(ht._originalParent);ht._positionBalloon(ct);r.attr(a,p).removeClass(v);i.forceScreenRead(r[0])})}},r.prototype._attachEvents=function(){this._detachEvents();o(c).on("resize",this._resizeEventHandler=function(){s.length>0&&k()})},r.prototype._detachEvents=function(){this._resizeEventHandler&&(o(c).off("resize",this._resizeEventHandler),this._resizeEventHandler=null)},r.prototype.
_myInitializeSubscriptions=function(){var n=this,i=this.options,r=this._balloonContent;i.visible.subscribe(this.lifetimeManager,function(t){t?n._show():n._hide()});r=this.element.find(st+"-text");r.html(e.sanitizeHTML(t,i.content()).sanitizedMarkup);i.content.subscribe(this.lifetimeManager,function(u){r.html(e.sanitizeHTML(t,u).sanitizedMarkup);o.trim(u)===""?(n._noFadeOnNextHide=!0,i.visible(!1)):i.visible()&&n._show()});i.box.subscribe(this.lifetimeManager,function(){n.element.attr(a)===p&&n._show()});this.options.position.subscribe(this.lifetimeManager,function(){n.element.attr(a)===p&&n._show()})},r.prototype._getAlternatePosition=function(n){switch(n){case 0:return 2;case 1:return 3;case 2:return 0;case 3:return 1}},r.prototype._getSidePositionKey=function(n){switch(n){case 0:case 2:return 0;case 3:case 1:return 3}},r.prototype._getOtherSidePosition=function(n){switch(n){case 0:case 2:return 3;case 3:case 1:return 0}},r.prototype._getSizeKey=function(n){switch(n){case 3:case 1:return"width"
case 0:case 2:return"height"}},r.prototype._getOtherSizeKey=function(n){switch(n){case 3:case 1:return"height";case 0:case 2:return"width"}},r.prototype._removePointerClass=function(){this.element.removeClass(t+"-box-top "+t+"-box-right "+t+"-box-bottom "+t+"-box-left").removeClass(it).removeClass(rt)},r.prototype._removeTransform=function(){this.element.css("-webkit-transform","");this.element.css("transform","")},r.prototype._findAncestorTransformMatrix=function(){var i=this.element.parents("div[style*='transform']"),n,t,r;if(i.length>0){for(n=[1,0,0,1,0,0],t=0;t<i.length;t++)r=o(i[t]).css("transform").split(/[(),/s]+/).slice(1,-1).map(function(n){return+n}),n=u.multiplyTransformArrays(n,r);return n}return null},r.prototype._readCssAndSetBaseline=function(n,t,i){var r={left:parseInt(this.element.css("left"),10),top:parseInt(this.element.css("top"),10),alignment:this.element.css("vertical-align")},u=h[this._getOtherSidePosition(i)],o=this._getOtherSizeKey(i),f=n[o],e=t[o];switch(i){case
1:r.left+=t.width;break;case 3:r.left-=n.width;break;case 0:r.top-=n.height;break;case 2:r.top+=t.height}switch(r.alignment){case"bottom":r[u]-=f-e;break;case"super":r[u]-=f;break;case"baseline":r[u]+=e;break;case"middle":r[u]-=(f-e)/2}return r},r.prototype._getBalloonBox=function(n,i,r){var u=this.element,a=u.parent(),e=t+"-box-"+h[i],f,s,l;return this._balloonMeasurer.appendTo(c.document.body),u.css({width:""}),u.css({left:"",top:"",bottom:"",right:"",width:r||u.width()+1}).addClass(e),u.appendTo(this._balloonMeasurer),f={width:u.width(),height:u.height()},u.removeClass(w).addClass(tt),s=this._readCssAndSetBaseline(f,n,i),u.removeClass(tt).addClass(w),l=this._readCssAndSetBaseline(f,n,i),u.removeClass(w),o.extend(f,{preferred:s,alternate:l}),u.removeClass(e).appendTo(a),this._balloonMeasurer.detach(),f},r.prototype._positionBalloon=function(n){var e=this._findAncestorTransformMatrix(),i=this.element,t,r;if(e&&!f.isIe){t=u.Invert2DTransformationMatrix(e);r="matrix({0})".format(t.join(
","));i.css("transform",r);i.offset(n);var o=i[0].getBoundingClientRect(),s=n.left-o.left,h=n.top-o.top;t[4]+=s*t[0];t[5]+=h*t[3];r="matrix({0})".format(t.join(","));i.css("transform",r)}else i.offset(n)},r._defaultAppendTo=".fxs-panorama",r}(r.Widget);n.Widget=g}(o||(o={})),o});define("MsPortalImpl.Controls/Controls/Balloon",["require","exports","f","./Base/Loadable","Viva.Controls/Controls/Viva.Balloon"],function(n,t,i,r,u){"use strict";var f;return function(n){function h(n){var t=u.getBox(n);return new e(t.top,t.left,t.width,t.height)}function c(n){u.hideAllBalloons(n)}var f=i.ViewModels.Controls.Balloon,e=f.Box,o=ko.computed,s=ko.observable,t;n.getBox=h;n.hideAllBalloons=c;t=function(n){function t(t,i,r){var h=this,e,f;n.call(this,t,i,r);e=this.options;f=new u.ViewModel;f.populateFromObject(e);f.content=s(e.content());this._addDisposablesToCleanUp(o(function(){f.content(h.sanitizeTemplate(e.content()))}));this._widgets.push(new u.Widget(this.element,f))}return __extends(t,n),Object.
defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t}(r.Widget);n.Widget=t}(f||(f={})),f});define("MsPortalImpl/Base/Base.KeyboardHelper",["require","exports"],function(){"use strict";var n;return function(n){function o(n){switch(n){case 18:case 17:case 40:case 35:case 27:case 36:case 37:case 34:case 33:case 39:case 16:case 9:case 38:return!0;default:return!1}}function s(n){return(n.altKey&&1)|(n.metaKey&&2)|(n.shiftKey&&4)|(n.ctrlKey&&8)}function h(n,r){var f=n?t:i;return f[r]||u[r]}var e=window,f=/Firefox\//i.test(e.navigator.userAgent),r,u,t,i;(function(n){n[n.Equals=f?61:187]="Equals";n[n.Minus=f?173:189]="Minus"})(n.VariableKeyCode||(n.VariableKeyCode={}));r=n.VariableKeyCode,function(n){n[n.Alt=18]="Alt";n[n.Backslash=220]="Backslash";n[n.Backspace=8]="Backspace";n[n.Comma=188]="Comma";n[n.Control=17]="Control";n[n.Delete=46]="Delete";n[n.Down=40]="Down";n[n.End=35]="End";n[n.Enter=13]="Enter";n[n.Equals=r.Equals]="Equals";n[
n.Escape=27]="Escape";n[n.F1=112]="F1";n[n.F10=121]="F10";n[n.Home=36]="Home";n[n.Left=37]="Left";n[n.Menu=93]="Menu";n[n.Minus=r.Minus]="Minus";n[n.PageDown=34]="PageDown";n[n.PageUp=33]="PageUp";n[n.Period=190]="Period";n[n.Right=39]="Right";n[n.Shift=16]="Shift";n[n.Slash=191]="Slash";n[n.Space=32]="Space";n[n.Tab=9]="Tab";n[n.Up=38]="Up";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.Num0=48]="Num0";n[n.Num1=49]="Num1";n[n.Num2=50]="Num2";n[n.Num3=51]="Num3";n[n.Num4=52]="Num4";n[n.Num5=53]="Num5";n[n.Num6=54]="Num6";n[n.Num7=55]="Num7";n[n.Num8=56]="Num8";n[n.Num9=57]="Num9"}(u||(u={}));n.isNonWrittenCharacter=o;n.getModifierKeys=s;t=[];t[192]="~";t[219]="{";t[221]=
"}";t[220]="|";t[59]=":";t[188]="<";t[r.Equals]="+";t[r.Minus]="_";t[49]="!";t[50]="@";t[51]="#";t[52]="$";t[53]="%";t[54]="^";t[55]="&";t[56]="*";t[57]="(";t[48]=")";t[190]=">";t[191]="?";t[32]="SHIFT+SPACE";i=[];i[220]="\\";i[188]=",";i[r.Minus]="-";i[49]="1";i[50]="2";i[51]="3";i[52]="4";i[53]="5";i[54]="6";i[55]="7";i[56]="8";i[57]="9";i[48]="0";i[190]=".";i[32]="SPACE";i[191]="/";n.mapKeyCodeToString=h}(n||(n={})),n});define("Viva.Controls/Controls/Base/Viva.EditableControl",["require","exports","../../Util/Viva.Util","./Viva.Base"],function(n,t,i,r){"use strict";var u;return function(n){var c=window,s=jQuery,u="azc-editableControl",f="azc-is-edited",h="",t=ko.observable,e=function(n){function i(){n.call(this);this.name=null;this.value=t();this.dirty=t(!1);this.focused=t(!1)}return __extends(i,n),i}(r.ViewModel),o;n.ViewModel=e;o=function(n){function t(t,r,f){var a=this,o,c,l;n.call(this,t,r,s.extend({viewModelType:e},f));this._ready=!0;this.element.addClass(u).attr(i.Constants.dataEditableAttribute,
"true").html(h);o=this.options;c=o.dirty;c||(l=o.value()||"",o.dirty=ko.computed(this.lifetimeManager,function(n){var n=o.value()||"";return!a._isSameValue(n,l)}));this._initializeSubscriptions(o);this._supportsFocus(!0)}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this.element.removeClass(u).removeClass(f).removeAttr(i.Constants.dataEditableAttribute),n.prototype.dispose.call(this))},Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t.prototype._isSameValue=function(n,t){return n==t},t.prototype._initializeSubscriptions=function(t){var i=this,r,e,u;n.prototype._initializeSubscriptions.call(this,t);this._ready&&(r=function(n){i.element.toggleClass(f,n)},r(t.dirty()),e=this._subscriptions,u=this.lifetimeManager,t.dirty.subscribe(u,r),this.options.focused.subscribe(u,function(n){n||i.element.trigger("editableControl-blur",{widget:i,model:i.options})}))},t}(r.
Widget);n.Widget=o}(u||(u={})),u});define("Viva.Controls/Controls/Base/Viva.ValidatableControl",["require","exports","f","./Viva.EditableControl"],function(n,t,i,r){"use strict";var u;return function(t){var a=i.Base.Diagnostics,u=0,e=1,o=2,p=a.createLog(n),w=window,v=jQuery,s="azc-validatableControl",y="azc-validationMessageBelowControl",f=ko.observable,h=ko.observableArray,c=function(n){function t(){n.call(this);this.enableValidation=f(!0);this.validationState=f(u);this.validators=h();this.validationPlacements=h();var t=this.validationState(),i=this.validators().length,r=!this.enableValidation()||i===0||this.enableValidation()&&i>0&&(t===u||t===o);this.valid=f(r)}return __extends(t,n),t}(r.ViewModel),l;t.ViewModel=c;l=function(n){function t(t,i,r){n.call(this,t,i,v.extend({viewModelType:c},r));this._validationStateInternal=null;this.element.addClass(s);this.options.showValidationMessagesBelowControl&&this.element.addClass(y);this._initializeValidation();this._initializeSubscriptions(this.
options);this._initialized=!0;this.options.dirty()&&this.validate(!0);this._validationState.notifySubscribers(this._validationState())}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this.options.validators.removeAll(),this.options.validationPlacements.removeAll(),n.prototype.dispose.call(this),this.element.removeClass(s))},Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t.prototype.validate=function(n){var i,t,r=!!n;this._shouldValidate()&&(i=this.options.validators(),i&&i.length>0&&(t=this.options.value(),i.some(function(n){return t!==n.validate()?n.validate(t):(t===undefined&&t===n.validate()||r)&&n.validate.notifySubscribers(t),n.validationState()===e})))},t.prototype._initializeSubscriptions=function(t){var i=this,r,e,o,s;n.prototype._initializeSubscriptions.call(this,t);r=this.options;e=this.lifetimeManager;r.value.subscribe(e,function(n){i._onValueChanged(
n)});o=this._validationState;o||(o=this._validationState=f(u));o.subscribe(e,function(n){r.validationState(n)});this._validationStateInternal&&(s=function(n){var t=i._validationLifetimeManager;t&&(t.dispose(),i._validationLifetimeManager=null);n&&(t=i._validationLifetimeManager=e.createChildLifetime(),i._validationStateInternal.subscribe(t,function(n){o(n)}),r.dirty()&&i.validate(!0))},r.enableValidation.subscribe(e,s),s(r.enableValidation()));t.validators.subscribeArrayChanges(e,function(){i._onValidatorsChanged()},function(){i._onValidatorsChanged()})},t.prototype._afterCreate=function(){n.prototype._afterCreate.call(this);this._initializeValidationPlacements()},t.prototype._onValueChanged=function(){this._hasValidators()&&this._valueChangeValidation()},t.prototype._valueChangeValidation=function(){this.validate()},t.prototype._initializeValidationPlacements=function(){var n=this,t=this.options.validationPlacements.removeAll();this.options.validationPlacements.subscribeArrayChanges(this.
lifetimeManager,function(t){t.initialize(n.element,n.options)},function(n){n.dispose()});this.options.validationPlacements(t)},t.prototype._hasValidators=function(){var n=this.options.validators();return this.options.enableValidation()&&!this.options.disabled()&&n&&n.length>0},t.prototype._initializeValidation=function(){var t=this,n=this.options;this._addDisposablesToCleanUp(this._valid=ko.computed(function(){var t=!n.enableValidation()||n.validators().length===0||n.enableValidation()&&n.validators().length>0&&(n.validationState()===u||n.validationState()===o);return t!==n.valid.peek()&&n.valid(t),t}));this._addDisposablesToCleanUp(this._validationStateInternal=ko.computed(function(){var i=u;return t._shouldValidate()&&n.validators().some(function(n){return i=n.validationState(),i===e||i===3||i===u}),i}))},t.prototype._onValidatorsChanged=function(){this._initialized&&this.validate(!0)},t.prototype._shouldValidate=function(){var n=this.options.validators();return this.options.enableValidation(
)&&!this.options.disabled()&&n&&n.length>0?!0:!1},t}(r.Widget);t.Widget=l}(u||(u={})),u});define("MsPortalImpl/Base/Base.KnockoutExtensions.Image",["require","exports","f","./Base.BrowserDetection"],function(n,t,i,r){"use strict";var u;return function(){var u=jQuery,f=ko.unwrap,n="width",e=r.isSafari,t={"aria-hidden":!0,role:"presentation"};ko.bindingHandlers.image={init:function(){return{controlsDescendantBindings:!0}},update:function(r,o){var s=u(r),h=f(o());i.require("MsPortalImpl/Base/Base.ImageHelper").then(function(i){var f=h?i.GetImageData(h):"",r,u;s.html(f);f&&(r=s.find("svg").attr(t).attr("focusable",!1),r.find("*").attr(t),e&&(u=r.attr("style"),(!u||u.indexOf(n)<0)&&(r.css(n,"0px"),Q.nextTick(function(){r.css(n,"")}))))})}}}(u||(u={})),u});define("MsPortalImpl/Generated/SvgStartupDefinitions",["require","exports","i"],function(n,t,i){"use strict";var r;return function(n){function l(n,t){t.forEach(function(t){n[t[0]]=c(t[1],t[2])})}function t(n,t){return"<svg viewBox='"+n+"'"+
h+t+"<\/g><\/svg>"}function e(n,t){return" width='"+n+"' height='"+t+"'"}function s(n){return"<path"+a(n)}function a(n){return" opacity='"+n+"'"}function f(n,t,i){return"<circle cx='"+n+"' cy='"+t+"' r='"+i+"'"}var h=" class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title>",o="0 0 50 50",u="0 0 16 16",r=" class='msportalfx-svg-c",c=i.DefinitionBuilder.createSvgImage,v;(function(n){var i;(function(){var n=[["access",t("0 0 30 30","<path d='M26.8 23.8H26c0-4-3.3-7.3-7.3-7.3s-7.3 3.3-7.3 7.3h-.7c0-4.4 3.6-8.1 8.1-8.1s8 3.7 8 8.1z'/><path d='M18.7 16.2c-2.8 0-5-2.3-5-5s2.3-5 5-5c2.8 0 5 2.3 5 5s-2.2 5-5 5zm0-9.3c-2.4 0-4.3 1.9-4.3 4.3s1.9 4.3 4.3 4.3 4.3-1.9 4.3-4.3-1.9-4.3-4.3-4.3zM4 19.9h-.8c0-3.1 2.5-5.6 5.6-5.6 2.3 0 4.4 1.4 5.3 3.6l-.7.3c-.7-1.9-2.6-3.1-4.6-3.1-2.6-.2-4.8 2-4.8 4.8z'/><path d='M8.9 14.8c-2 0-3.6-1.6-3.6-3.6s1.6-3.6 3.6-3.6 3.6 1.6 3.6 3.6c-.1 2-1.7 3.6-3.6 3.6zm0-6.4C7.3 8.4 6 9.6 6 11.2S7.3 14 8.8 14s2.8-1.3 2.8-2.8-1.2-2.8-2.7-2.8z'/>")],
["add",t(u,"<path d='M14.969 7.969H7.938V15H7V7.969H-.031v-.938H7V0h.938v7.031h7.031v.938z'/>")],["arrowWideDown",t(u,"<path fill-rule='evenodd' clip-rule='evenodd' d='M15 7.3L13.8 6 9 11.3V1H7v10.3L2.2 6 1 7.3 8 15z'/>")],["arrowWideUp",t(u,"<path fill-rule='evenodd' clip-rule='evenodd' d='M15 8.7L13.8 10 9 4.7V15H7V4.7L2.2 10 1 8.7 8 1z'/>")],["caretDown",t("0 0 12 12","<path d='M11 3.9l-.7-.8L6 7.4 1.7 3.1l-.7.8 5 5z'/>")],["caretUp",t("0 0 12 12","<path d='M1 8.1l.7.8L6 4.6l4.3 4.3.7-.8-5-5z'/>")],["check",t(u,"<path d='M.632 8.853l-.531-.575a.38.38 0 0 1 .022-.538l1.534-1.418a.374.374 0 0 1 .531.022l4.218 4.523 7.258-9.296a.374.374 0 0 1 .298-.145.37.37 0 0 1 .233.081l1.659 1.28a.362.362 0 0 1 .064.524L6.595 15.246.632 8.853z'"+r+"14'/>")],["chevron",t("0 0 12 12","<path fill='#464F59' d='M8.2 6l-5.5 5.5.6.5 6-6-6-6-.6.5z'/>")],["clone",t(u,"<path d='M1 5v11h9V5H1zm7 9H3V7h5v7z'/><path d='M6 0v4h2V2h5v7h-2v2h4V0z'/>")],["close",t(u,"<path d='M14 3.3L12.7 2 8 6.7 3.3 2 2 3.3 6.7 8 2 12.7 3.3 14 8 9.3l4.7 4.7 1.3-1.3L9.3 8z'/>")],
["collapse",t("0 0 30 30","<path fill='none' stroke='#748392' stroke-miterlimit='10' d='M9 12l6 6 6-6'/>")],["cornerCheck",t("0 0 34 34","<path d='M34 34V0H0z'"+r+"15'/><path d='M18.302 9.992l5.022 5.022.28.235.281-.235 7.849-7.849-1.414-1.414-6.716 6.717-3.889-3.889z'"+r+"01'/>")],["customize",t("0 0 22 22",s(.9)+" d='M21.5 3.94c0 .45-.08.89-.26 1.31s-.42.8-.75 1.13l-13.5 13.5L.5 21.5l1.62-6.49 13.5-13.5c.33-.33.7-.58 1.13-.75.42-.17.86-.26 1.31-.26.47 0 .92.09 1.33.27.42.18.78.43 1.09.74s.56.68.74 1.09c.19.42.28.86.28 1.34zm-2.62 2.19c.17-.17.33-.33.49-.48s.3-.31.42-.48.22-.35.29-.54.11-.42.11-.68c0-.29-.06-.57-.17-.82s-.27-.48-.46-.68-.42-.35-.68-.46-.53-.17-.83-.17c-.26 0-.49.04-.68.11-.19.07-.38.17-.54.29s-.33.26-.48.42c-.15.16-.31.32-.48.49l3.01 3zM3.84 15.14c.72.24 1.35.62 1.87 1.14s.9 1.15 1.14 1.87L17.93 7.06l-3-3L3.84 15.14zm-1.53 4.55l3.37-.84c-.07-.31-.18-.61-.33-.89-.15-.28-.34-.53-.56-.75-.22-.22-.47-.41-.75-.56s-.58-.26-.89-.33l-.84 3.37z'/>")],["defaultBlade",t("0.5 0.5 50 50",
"<path d='M2.5 2.5v46h46v-46h-46zm43 43h-40v-40h40v40z'"+r+"15'/><path d='M8.5 8.5h34v10h-34z'"+r+"19'/><path d='M8.5 21.5h10v21h-10z'"+r+"15'/><path d='M21.5 21.5h21v21h-21z'"+r+"16'/>")],["ellipsis",t(u,f(14.4,7.6,1.6)+"/>"+f(8,7.6,1.6)+"/>"+f(1.6,7.6,1.6)+"/>")],["error",t("0 0 9 9",f(4.5,4.5,4.5)+r+"22'/>"+f(4.5,6.438,.697)+r+"01'/><path d='M4.604 2.186h-.729l.186 3.232h.878l.186-3.232z'"+r+"01'/>")],["filter",t(u,"<path d='M0 1h16v1.711l-6 6V15H6V8.711l-6-6V1zm15 1.289V2H1v.289l6 6V14h2V8.289l6-6z'/>")],["fullscreen",t("0 0 12 12","<path d='M12 0v4h-1V1.61L1.61 11H4v1H0V8h1v2.38L10.38 1H7.99V0h4z'/>")],["fullView",t(u,"<path d='M1 2v12h14V2H1zm2 10V4h10v8H3z'"+r+"01'/>")],["gear",t(o,"<path d='M50 27.7V22l-.8-.3-6.1-2-1.6-3.9 3.1-6.6-4-4-.8.4-5.7 2.9-3.9-1.6L27.7 0H22l-.3.8-2 6.1-3.9 1.6-6.5-3.1-4 4 .4.8 2.9 5.7L7 19.8l-7 2.5V28l.8.3 6.1 2 1.6 3.9-3.1 6.6 4 4 .8-.4 5.7-2.9 3.9 1.6 2.5 6.9H28l.3-.8 2-6.1 3.9-1.6 6.6 3.1 4-4-.4-.8-2.9-5.7 1.6-3.9 6.9-2.5zm-25 5.8c-4.7 0-8.5-3.8-8.5-8.5s3.8-8.5 8.5-8.5 8.5 3.8 8.5 8.5-3.8 8.5-8.5 8.5z'"+
r+"01'/>")],["gridDots",t(u,f(8,2,1.8)+r+"04'/>"+f(8,8,1.8)+r+"04'/>"+f(8,14,1.8)+r+"04'/>")],["hamburger",t("0 0 15 15","<path d='M0 2.85h15v1.01H0zM0 7h15v1.01H0zm0 4.14h15v1.01H0z'/>")],["headerDots",t("0 0 12 12",f(6,6,1.5)+"/>"+f(1.5,6,1.5)+"/>"+f(10.5,6,1.5)+"/>")],["help",t("0 0 22 22","<path d='M11 0C4.93 0 0 4.93 0 11s4.93 11 11 11 11-4.93 11-11S17.07 0 11 0zm0 20.43c-5.2 0-9.43-4.23-9.43-9.43S5.8 1.57 11 1.57 20.43 5.8 20.43 11 16.2 20.43 11 20.43zm3.14-11.79c0 1.13-.52 2.18-1.46 2.96-.58.48-.89 1.1-.89 1.75v.79h-1.57v-.79c0-1.13.52-2.18 1.46-2.96.58-.48.89-1.1.89-1.75 0-.87-.7-1.57-1.57-1.57-.95 0-1.85.46-2.54 1.29l-1.21-1C8.24 6.16 9.57 5.5 11 5.5c1.73 0 3.14 1.41 3.14 3.14zm-2.35 7.86c0 .43-.35.79-.79.79s-.79-.35-.79-.79.35-.79.79-.79.79.36.79.79z'/>")],["hyperlink",t(u,"<path d='M4.992 9.819l8.018-7.991v4.005H14V0H8.167v1h4.038L4.232 8.987l.76.833z'/><path d='M12.993 13.03H1.01V1.028h4.823V0H0v14h14V8.167h-1.007v4.863z'/>")],["info",t(o,"<path d='M25 2.753C12.713 2.753 2.753 12.713 2.753 25S12.713 47.246 25 47.246 47.247 37.287 47.247 25c0-12.286-9.961-22.247-22.247-22.247zm-1.543 7.913a3.209 3.209 0 0 1 2.369-.989c.94 0 1.737.33 2.39.989.651.659.976 1.451.976 2.378s-.329 1.717-.987 2.369a3.265 3.265 0 0 1-2.379.977 3.228 3.228 0 0 1-2.369-.977c-.652-.652-.978-1.442-.978-2.369s.326-1.719.978-2.378zm7.865 29.165H20.35v-.782c.898-.029 1.564-.29 1.999-.782.289-.333.434-1.217.434-2.651V23.754c0-1.433-.166-2.349-.498-2.748-.334-.398-.979-.627-1.935-.684v-.804h8.517v16.098c0 1.434.166 2.35.499 2.749.333.398.985.626 1.956.684v.782z'"+
r+"15'/>")],["journeys",t(u,"<path d='M13 6.5L16 8l-3 1.5 3 1.5-8 4-8-4 3-1.5L0 8l3-1.5L0 5l8-4 8 4-3 1.5zM2.23 5L8 7.88 13.77 5 8 2.12 2.23 5zM8 10.88L13.77 8l-1.88-.94L8 9 4.12 7.06 2.23 8 8 10.88zm5.77.12l-1.88-.94L8 12l-3.88-1.94-1.89.94L8 13.88 13.77 11z'"+r+"01'/>")],["journeysFilled",t(u,s(.4)+" d='M13 6.5L16 8l-3 1.5 3 1.5-8 4-8-4 3-1.5L0 8l3-1.5L0 5l8-4 8 4z'"+r+"01'/><path fill='#64E484' d='M2.23 5L8 7.88 13.77 5 8 2.12z'/><path fill='#42C94C' d='M8 10.88L13.77 8l-1.89-.94L8 9 4.12 7.06 2.23 8z'/><path fill='#14AF14' d='M13.77 11l-1.89-.94L8 12l-3.88-1.94-1.89.94L8 13.88z'/>")],["key",t("0 0 30 30","<path d='M9.1 24.4H5.5v-4.2l5.7-5.7V8.8c0-1.8 1.4-3.2 3.2-3.2h6.7c1.8 0 3.2 1.4 3.2 3.2v6.7c0 .9-.3 1.7-.9 2.3-.6.6-1.4.9-2.3.9h-6.2v2.1h-1.8v1.8h-1.8v1.8H9.1zm-2.6-.9h4v-1.8h1.8v-1.8h1.8v-1.6l.5-.5h6.6c.6 0 1.2-.2 1.6-.7.4-.4.7-1 .7-1.6V8.8c0-1.3-1-2.3-2.3-2.3h-6.7c-1.3 0-2.3 1-2.3 2.3v6.1l-5.7 5.7v2.9zm14.2-12.2c-.5 0-1-.2-1.4-.6-.8-.8-.8-2.1 0-2.9.8-.8 2.1-.8 2.9 0 .8.8.8 2.1 0 2.9-.5.4-1 .6-1.5.6zm0-3.1c-.3 0-.6.1-.8.3-.4.4-.4 1.1 0 1.6.4.4 1.2.4 1.6 0 .4-.4.4-1.1 0-1.6-.2-.2-.5-.3-.8-.3z'/>")],
["launchCurrent",t("0 0 15 15","<path d='M8.883.942v1.586h3.118L6.314 8.214a.792.792 0 1 0 1.121 1.122l5.545-5.545v2.833h1.586V.942H8.883z'/><path d='M12.01 6.064a.316.316 0 0 0-.344.068l-.946.946a.316.316 0 0 0-.092.223v3.746c0 .601-.489 1.09-1.09 1.09H3.272c-.601 0-1.09-.489-1.09-1.09V6.07c0-.601.489-1.09 1.09-1.09h4.762a.315.315 0 0 0 .223-.092l.946-.946a.316.316 0 0 0-.223-.539H3.272A2.67 2.67 0 0 0 .605 6.07v4.977a2.67 2.67 0 0 0 2.667 2.667h6.266a2.67 2.67 0 0 0 2.667-2.667V6.355a.319.319 0 0 0-.195-.291z'/>")],["maximize",t(u,"<path d='M1 2v12h14V2H1zm2 10V6h10v6H3z'/>")],["mini",t("0 0 20 20","<g class='msportalfx-contextmenu-grid'><path d='M18 0H0v13h19V0h-1zM3 12H1v-2h2v2zm0-3H1V7h2v2zm0-3H1V4h2v2zm0-3H1V1h2v2zm3 9H4v-2h2v2zm0-3H4V7h2v2zm0-3H4V4h2v2zm0-3H4V1h2v2zm3 9H7v-2h2v2zm0-3H7V7h2v2zm0-3H7V4h2v2zm0-3H7V1h2v2zm3 9h-2v-2h2v2zm0-3h-2V7h2v2zm0-3h-2V4h2v2zm0-3h-2V1h2v2zm3 9h-2v-2h2v2zm0-3h-2V7h2v2zm0-3h-2V4h2v2zm0-3h-2V1h2v2zm3 9h-2v-2h2v2zm0-3h-2V7h2v2zm0-3h-2V4h2v2zm0-3h-2V1h2v2z'/><rect"+
e(4,4)+" class='msportalfx-grid-rect-mini'/><rect"+e(7,4)+" class='msportalfx-grid-rect-small'/><rect"+e(7,7)+" class='msportalfx-grid-rect-normal'/><rect"+e(13,7)+" class='msportalfx-grid-rect-wide'/><rect"+e(7,13)+" class='msportalfx-grid-rect-tall'/><rect"+e(13,13)+" class='msportalfx-grid-rect-large'/><rect"+e(19,13)+" class='msportalfx-grid-rect-herowide'/><rect"+e(13,19)+" class='msportalfx-grid-rect-herotall'/><rect"+e(19,19)+" class='msportalfx-grid-rect-hero'/><\/g>")],["minimize",t(u,"<path d='M2 12h12v2H2z'/>")],["notifications",t("0 0 22 22",s(.9)+" d='M18.86 17.29V7.86C18.86 3.52 15.33 0 11 0S3.14 3.52 3.14 7.86v9.43H1.57v1.57h6.29C7.86 20.59 9.27 22 11 22s3.14-1.41 3.14-3.14h6.29v-1.57h-1.57zm-14.15 0V7.86c0-3.47 2.82-6.29 6.29-6.29s6.29 2.82 6.29 6.29v9.43H4.71zM11 20.43c-.87 0-1.57-.7-1.57-1.57h3.14c0 .86-.7 1.57-1.57 1.57z'/>")],["pin",t("0 0 14 14","<path d='M14 4.9c-.2.2-.3.3-.5.4-.1.1-.3.2-.5.3-.2.1-.3.2-.5.2s-.4.1-.6.1h-.5L8.8 8.5c.1.2.1.4.2.6v.6c0 .3 0 .6-.1.8s-.1.5-.3.7c-.1.2-.3.4-.4.6-.2.2-.3.4-.6.6L5 9.7l-4 4-1 .3.3-1 4-4-2.7-2.7.3-.3c.3-.3.7-.6 1.1-.7S3.9 5 4.4 5c.4 0 .8.1 1.1.2l2.7-2.7V2c0-.2 0-.4.1-.6 0-.2.1-.4.2-.5.1-.2.2-.3.3-.5s.2-.2.3-.4L14 4.9zm-2.1.1c.3 0 .5-.1.7-.2L9.2 1.3c-.1.3-.2.5-.2.8v.4c0 .1.1.2.1.4L5.7 6.2c-.1 0-.2-.1-.3-.1S5.2 6 5.1 6s-.3-.1-.4-.1h-.4c-.3 0-.5 0-.8.1s-.4.2-.6.4l4.7 4.7c.2-.2.3-.4.3-.7.1-.3.1-.5.1-.8v-.4c0-.1 0-.2-.1-.3 0-.1-.1-.2-.1-.3 0-.1-.1-.2-.1-.3l3.5-3.5c.1 0 .2.1.4.1s.2.1.3.1z'/>")],
["plus",t("0 0 18 18","<path d='M8 18h2v-8h8V8h-8V0H8v8H0v2h8z'/>")],["quickStart",t("0 0 30 30","<path d='M13.9 23.1H7.8c-3.1 0-5.6-2.5-5.6-5.6s2.5-5.6 5.6-5.6c.5 0 1 .1 1.5.2 1-2.7 3.6-4.7 6.5-5.1l.6-.1-2.3 6.1h2.1l-1.7 4.4 5.2-5.5h-2.5l2.6-4.4.3.1c2.9 1.3 4.7 4.2 4.7 7.3 0 .6-.1 1.1-.2 1.7 1.7.1 3.1 1.5 3.1 3.3 0 1.7-1.3 3.1-3 3.2H13.9zM7.8 12.6c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9h17.1c1.3-.1 2.3-1.2 2.3-2.5 0-1.4-1.1-2.5-2.5-2.5h-.3l-.5.1.1-.5c.2-.6.3-1.3.3-1.9 0-2.8-1.6-5.3-4-6.5l-1.6 2.8h2.9l-8.8 9.3 2.6-6.7H13l2.2-5.9c-2.5.5-4.6 2.4-5.4 4.8l-.1.1-.3-.1c-.5-.2-1.1-.3-1.6-.3z'/>")],["requiredField",t("0 0 6 6","<path d='M3.543 2.352l2.08-.716L6 2.687l-2.076.675L5.21 5.158l-.942.676-1.242-1.867-1.264 1.867-.97-.676 1.305-1.796L0 2.687.38 1.63l2.058.743V.233h1.105v2.119z'"+r+"22'/>")],["restore",t(u,"<path d='M11 5H2v9h9V5zm-7 7V7h5v5H4z'/><path d='M8 6V3h5v5h-3v2h5V1H6v5h2z'/>")],["save",t("0 0 14 14","<path fill='#32383F' d='M13 0c.1 0 .3 0 .4.1.1.1.2.1.3.2.1.1.2.2.2.3.1.1.1.3.1.4v13H1.8L0 12.2V1C0 .9 0 .7.1.6.2.5.2.4.3.3.4.2.5.1.6.1.7 0 .9 0 1 0h12zm0 1h-1v6H2V1H1v10.8L2.2 13H3V9h7v4h3V1zM3 6h8V1H3v5zm6 4H4v3h1v-2h1v2h3v-3z'/>")],
["search",t(o,"<path d='M21.8.6c1.5.4 2.8 1 4.1 1.7 1.2.8 2.4 1.7 3.4 2.7 1 1.1 1.9 2.2 2.7 3.5.7 1.3 1.3 2.6 1.7 4.1.4 1.5.6 3 .6 4.6 0 2-.3 4-1 5.8s-1.7 3.6-3 5.1l19.1 19.2c.3.3.5.7.5 1.1 0 .4-.2.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5l-19-19.1c-1.6 1.3-3.3 2.3-5.1 3-1.9.7-3.8 1-5.8 1-1.6 0-3.1-.2-4.6-.6-1.5-.4-2.8-1-4.1-1.7-1.3-.7-2.4-1.6-3.5-2.7-1-1.1-1.9-2.2-2.7-3.5-.7-1.3-1.3-2.6-1.7-4.1-.4-1.5-.6-3-.6-4.6 0-1.6.2-3.1.6-4.6.4-1.5 1-2.8 1.7-4.1C3.1 7.3 4 6.1 5 5c1-1 2.2-1.9 3.5-2.7C9.8 1.6 11.1 1 12.6.6c1.5-.4 3-.6 4.6-.6s3.1.2 4.6.6zm.9 29.5c1.7-.7 3.2-1.7 4.5-3s2.3-2.8 3-4.5c.7-1.7 1.1-3.5 1.1-5.5 0-1.9-.4-3.8-1.1-5.5-.7-1.7-1.7-3.2-3-4.5s-2.8-2.3-4.5-3C21 3.4 19.2 3 17.2 3s-3.8.4-5.5 1.1C10 5 8.5 6 7.3 7.3S5 10 4.2 11.7c-.7 1.7-1.1 3.5-1.1 5.5 0 1.9.4 3.8 1.1 5.5.7 1.7 1.7 3.2 3 4.5s2.8 2.3 4.5 3c1.7.7 3.5 1.1 5.5 1.1s3.7-.4 5.5-1.2z'/>")],["settings",t("0 0 22 22","<path d='M19.2 10.6v.8l2.8 1.7-1.7 4.1-3.2-.7-.5.5.7 3.2-4.2 1.8-1.7-2.8h-.8L8.9 22l-4.1-1.7.7-3.2-.5-.5-3.2.7L0 13.1l2.8-1.7v-.8L0 8.9l1.7-4.1 3.2.7.5-.5-.7-3.3L8.9 0l1.7 2.8h.8L13.1 0l4.1 1.7-.7 3.2.5.5 3.2-.7L22 8.9l-2.8 1.7zM17.9 12v-2l2.6-1.6-.9-2.2-2.9.7c-.2-.3-.5-.5-.7-.8-.2-.2-.5-.5-.8-.7l.7-2.9-2.2-.9L12 4.1h-2L8.4 1.5l-2.3.9.7 2.9c-.3.3-.5.5-.7.8-.3.2-.5.4-.7.7l-3-.7-.9 2.3L4.1 10v2l-2.6 1.6.9 2.2 2.9-.7c.2.3.5.5.7.8.2.2.5.5.8.7l-.7 2.9 2.2.9 1.6-2.6h2l1.6 2.6 2.2-.9-.7-2.9c.3-.2.5-.5.8-.7.2-.2.5-.5.7-.8l2.9.7.9-2.2-2.4-1.6zM11 6.9c.6 0 1.1.1 1.6.3s.9.5 1.3.9.7.8.9 1.3.3 1 .3 1.6-.1 1.1-.3 1.6-.5.9-.9 1.3-.8.7-1.3.9-1 .3-1.6.3-1.1-.1-1.6-.4-.9-.5-1.3-.9-.7-.8-.9-1.3-.3-1-.3-1.6.1-1 .4-1.5.5-.9.9-1.3.8-.7 1.3-.9.9-.3 1.5-.3zm0 7c.4 0 .8-.1 1.1-.2.3-.1.6-.4.9-.6.3-.3.5-.6.6-.9.1-.3.2-.7.2-1.1s-.1-.8-.2-1.1c-.1-.5-.3-.8-.6-1-.3-.3-.6-.5-.9-.6-.3-.1-.7-.2-1.1-.2s-.8.1-1.1.2c-.4.1-.7.3-.9.6-.3.2-.5.5-.6.9-.1.3-.2.7-.2 1.1s.1.8.2 1.1c.1.4.3.7.6.9.3.3.6.5.9.6.3.2.7.3 1.1.3z'/>")],
["share",t(o,"<path d='M.9 38.9c0 4.1 3.3 7.4 7.4 7.4 1.2 0 2.3-.3 3.3-.8C15.5 48.4 20.2 50 25 50s9.5-1.6 13.4-4.5c1 .5 2.1.8 3.3.8 4.1 0 7.4-3.3 7.4-7.4 0-2.2-1-4.2-2.6-5.6.5-1.8.7-3.7.7-5.5 0-9.4-6.1-17.8-14.9-20.9C32.1 3 28.9 0 25 0s-7.1 3-7.3 6.8C8.8 9.9 2.8 18.3 2.8 27.8c0 1.9.2 3.7.7 5.5C1.9 34.7.9 36.7.9 38.9zm3.7 0c0-2 1.7-3.7 3.7-3.7s3.7 1.7 3.7 3.7-1.7 3.7-3.7 3.7-3.7-1.7-3.7-3.7zm37.1 3.7c-2 0-3.7-1.7-3.7-3.7s1.7-3.7 3.7-3.7 3.7 1.7 3.7 3.7-1.7 3.7-3.7 3.7zM25 3.7c2 0 3.7 1.7 3.7 3.7S27 11.1 25 11.1s-3.7-1.7-3.7-3.7S23 3.7 25 3.7zM6.5 27.8c0-7.7 4.8-14.5 11.8-17.2 1.2 2.5 3.7 4.3 6.7 4.3s5.5-1.8 6.7-4.3c7 2.7 11.8 9.6 11.8 17.2 0 1.3-.1 2.6-.4 3.8-.5-.1-.9-.1-1.4-.1-4.1 0-7.4 3.3-7.4 7.4 0 1.5.5 2.9 1.3 4.1-3.1 2.1-6.7 3.3-10.5 3.3s-7.4-1.2-10.5-3.3c.8-1.2 1.3-2.6 1.3-4.1 0-4.1-3.3-7.4-7.4-7.4-.5 0-1 .1-1.4.1-.5-1.2-.6-2.5-.6-3.8z'/>")],["smileyHappy",t("0 0 32 32","<path d='M16 0C7.16 0 0 7.16 0 16s7.16 16 16 16 16-7.16 16-16S24.84 0 16 0zm0 30C8.28 30 2 23.72 2 16S8.28 2 16 2s14 6.28 14 14-6.28 14-14 14zm6-16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-12 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm14.93 6.47C23.29 23.74 19.91 26 16 26s-7.29-2.26-8.93-5.53l1.79-.89C10.17 22.19 12.87 24 16 24s5.83-1.81 7.15-4.43l1.78.9z'/>")],
["smileySad",t("0 0 32 32","<path d='M16 0C7.16 0 0 7.16 0 16s7.16 16 16 16 16-7.16 16-16S24.84 0 16 0zm0 30C8.28 30 2 23.72 2 16S8.28 2 16 2s14 6.28 14 14-6.28 14-14 14zm6-16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-12 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm13.46 9.37s-.01 0 0 0l-1.49 1.33a7.95 7.95 0 0 0-11.93-.01l-1.49-1.32-.01-.01C10.37 21.31 13.03 20 16 20c2.97 0 5.63 1.31 7.46 3.37z'/>")],["splitView",t(u,"<path d='M1 2v12h14V2H1zm2 10V4h10v8H3z'"+r+"01'/><path d='M7 3h2v10H7z'"+r+"01'/>")],["star",t("0 0 12 12","<path d='M6 .3l1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/>")],["statusUpsell",t("-778 992 18 18","<path d='M-764.2 993.5c.1.8.4 1.4.8 1.9.4.4 1.1.7 1.9.8 1.1-2.4 1.5-4.2 1.5-4.2s-1.8.4-4.2 1.5zm-1.2.7c-1.3.7-2.6 1.7-3.8 2.9-.8.8-1.4 1.6-1.9 2.3l-3.2.6-3.7 3.7 3.3.1 2.3-2.3c-.8 1.7-.9 2.8-.9 2.8l1 1s1.2-.1 2.9-.9l-2.4 2.4.1 3.3 3.7-3.7.6-3.2c.7-.5 1.5-1.1 2.3-1.9 1.2-1.2 2.2-2.6 2.9-3.8-.8-.2-1.5-.5-2.1-1.1-.6-.7-.9-1.4-1.1-2.2z'"+r+"01'/>")],
["tag",t("0 0 30 30","<path d='M13.3 24.8l-8.2-8.2L16.3 5.4l5.5-.2L25 8.4l-.4 5.3-.1.1-11.2 11zm-7.2-8.2l7.2 7.2 10.5-10.5.4-4.7-2.7-2.7-4.9.2L6.1 16.6zm15.2-6.4c-.4 0-.7-.1-1-.4-.6-.6-.6-1.5 0-2 .5-.5 1.5-.5 2 0 .3.3.4.6.4 1s-.1.7-.4 1c-.3.3-.6.4-1 .4zm0-2.1c-.2 0-.4.1-.5.2-.3.3-.3.7 0 1 .3.3.7.3 1 0 .3-.3.3-.7 0-1-.1-.1-.3-.2-.5-.2z'/>")],["trash",t(u,"<path fill-rule='evenodd' clip-rule='evenodd' d='M2.5 4l1 10c0 .6.5 1 1 1h7c.5 0 1-.5 1-1l1-10h-11zM7 12.1c0 .5-.3.9-.7.9s-.8-.4-.8-.9V6.9c0-.5.3-.9.8-.9s.7.4.7.9v5.2zm3.5 0c0 .5-.3.9-.8.9s-.7-.4-.7-.9V6.9c0-.5.3-.9.8-.9s.8.4.8.9v5.2zm4-9.1h-13c-.3 0-.5-.2-.5-.5s.2-.5.5-.5h13c.3 0 .5.2.5.5s-.2.5-.5.5zM9 1H7c-.3 0-.5-.2-.5-.5S6.7 0 7 0h2c.3 0 .5.2.5.5S9.3 1 9 1z'/>")],["trashOutline",t(u,"<path d='M14 3h-1v11.5a1.51 1.51 0 0 1-.437 1.063A1.493 1.493 0 0 1 11.5 16h-8a1.51 1.51 0 0 1-1.063-.437A1.482 1.482 0 0 1 2 14.5V3H1V2h4V1a.972.972 0 0 1 .293-.707A.972.972 0 0 1 6 0h3a.972.972 0 0 1 .707.293A.972.972 0 0 1 10 1v1h4v1zm-2 0H3v11.5c0 .136.05.253.148.352A.48.48 0 0 0 3.5 15h8a.48.48 0 0 0 .352-.148A.484.484 0 0 0 12 14.5V3zM6 13H5V5h1v8zM6 2h3V1H6v1zm2 11H7V5h1v8zm2 0H9V5h1v8z'/>")],
["tripleArrow",t("0 0 20 10","<path d='M2.9 1l-1 1 3 3-3 3 1 1 4-4zm5.6 0l-1 1 3 3-3 3 1 1 4-4zm5.6 0l-1 1 3 3-3 3 1 1 4-4z'"+r+"02'/>")],["warning",t("0 0 9 9","<path d='M8.267 8H.733c-.6 0-.916-.623-.62-1.129L2.014 3.53 3.896.384c.302-.507.903-.514 1.197-.008L7.001 3.65l1.882 3.229C9.183 7.383 8.881 8 8.267 8z'"+r+"10'/>"+f(4.5,6.178,.615)+r+"01'/><path d='M4.623 2.428H3.98l.164 2.85h.774l.165-2.85z'"+r+"01'/>")]];l(i,n)})(i=n.SvgStartup||(n.SvgStartup={}))})(v=n.Content||(n.Content={}))}(r||(r={})),r});define("MsPortalImpl/Widgets/Widgets.Common",["require","exports","f","i","../../MsPortalImpl.Controls/Controls/Base/OptionsBase","MsPortalImpl/Resources/ImplScriptResources","../Generated/SvgStartupDefinitions"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function nt(){if(!a){var n=o("<div style='width:50px;height:50px;overflow:auto'><div><\/div><\/div>").appendTo("body"),t=n.children();a=t.innerWidth()-t.height(99).innerWidth();n.remove()}return a}function tt(n,t,i)
{var e,o,s;t===void 0&&(t=0);i===void 0&&(i=!1);var r=n.getBoundingClientRect(),u=document.documentElement,f=!0;return i||(e=h.innerWidth||u.clientWidth,f=r.left>=0&&r.right<=e),o=h.innerHeight||u.clientHeight,s=r.top+t>=0&&r.bottom+t<=o,{elementRect:r,fullyVisible:s&&f}}function it(n,t){var i,r;if(!n){s("Cannot register a template with an undefined name.");return}if(!t){s("Cannot register a template with an undefined content.");return}if(!/^[a-z][a-z0-9]*$/ig.test(n)){s("Name '"+n+"' is invalid. Name must start with a letter and can only contain letters and numbers.");return}if(i=o("body"),i.find("#"+n).length){s("A template with name '"+n+"' was already registered.");return}r=o("<script id="+n+" type='text/html'/>").text(t);i.append(r)}function w(n){if(n){if(!c(h.document.documentElement,n))return Q.reject(new i.Errors.CanceledError("container is not in documentElement"))}else return Q.fcall(function(){throw new Error("container is "+n);});var t=l.filter(function(t){var i=t.element;return n===
i||c(n,i)}).map(function(n){return n.promise});return t.length?Q.all(t).then(function(){return w(n)}):Q()}function rt(n,t,f){return t=t||{controlsDescendantBindings:!0},{init:function(){return t},update:function(t,e,a,y,p){var w=ko.unwrap(e());ko.ignoreDependencies(function(){var e=o(t),y=i.require(n).then(function(n){var o=n.Widget,i,r;if(c(h.document.documentElement,t))return i=u.Widget.getWidget(e,o),i!==null&&i.dispose(),w&&(r=new n.Widget(e,w,{bindingContext:p,services:f}),r.waitForReady)?r.waitForReady():void 0}).catch(function(t){var f,o,u;t&&(f=r.Diagnostics.getLogFriendlyMessage(t),o=t.stack);u="Failed to load the control module '"+n+"'.";f&&(u+="\r\n Error: "+f);s(u,v.LoadingPortalControlFailed);e.html(g);setTimeout(function(){e.trigger(k.fxportalcontrolloadfailed,new i.Errors.Error({message:u,stack:o,innerErrors:t}))})}),a={element:t,promise:y};a.promise=y.finally(function(){i.remove(l,a)});l.push(a)})}}}var y=i.Base,b=y.Diagnostics,k=y.EventTypes,d=e.Content.SvgStartup,h=window,
o=jQuery,c=o.contains,g="<span class='fxs-portal-controlloadfailed'>"+d.warning.data+f.PartError.title+"<\/span>",p=b.createLog(n),s=p.error.bind(p),l=[],a,v;(function(n){n[n.LoadingPortalControlFailed=1]="LoadingPortalControlFailed"})(v||(v={}));t.getBrowserScrollbarWidth=nt;t.isElementFullyInViewport=tt;t.registerKoTemplate=it;t.waitForBindings=w;t.getAsyncBindingHandler=rt}(o||(o={})),o});define("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxc-preview,.fxs-ellipsis{white-space:nowrap;text-overflow:ellipsis}.azc-grid:focus{outline:0!important}.fxs-extension-frame,.fxs-manifest-frame{position:absolute;left:-5000px;top:-5000px;border:0;height:1px;width:1px}.fxs-portal{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;position:fixed;left:0;right:0;top:0;bottom:0;overflow:hidden;transition:background .25s ease;z-index:0}.fxc-preview,.fxs-button{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.fxs-portal .fxs-portal-main{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-align-items:stretch;align-items:stretch;height:calc(100% - 40px);position:relative;z-index:1}.fxs-portal .fxs-portal-content{-webkit-flex:1 1 auto;flex:1 1 auto;position:relative;overflow-x:auto;overflow-y:hidden;transition:margin .2s ease;z-index:1}.fxs-portal .fxs-portal-controlloadfailed>svg{vertical-align:bottom;height:18px}.fxc-preview{font-size:10px;line-height:normal;text-transform:uppercase;margin-top:3px;overflow:hidden}.fxs-portal-shield{position:fixed;width:100%;height:100%;background-color:rgba(0,0,0,.7);z-index:99999}.fxs-portal-shield .fxs-portal-shield-icon>svg{width:20px;height:20px}.fxs-portal-shield .fxs-portal-shield-icon-warning{background-color:#ff8c00}.fxs-portal-shield .fxs-portal-shield-icon-error{background-color:#e81123}.fxs-portal-shield .fxs-portal-shield-icon-on-topbar{position:absolute;height:40px;width:40px}.fxs-portal-shield .fxs-portal-shield-icon-on-topbar>svg{margin:10px}.fxs-button,.fxs-input{box-sizing:border-box;height:24px;margin:0}.fxs-portal-shield .fxs-portal-shield-modaldialog{position:fixed;width:430px}.fxs-portal-shield .fxs-portal-shield-modaldialog .fxs-messagebox{background-color:#fff;color:#1f2327}.fxs-portal-shield .fxs-portal-shield-modaldialog .fxs-messagebox .fxs-messagebox-title{padding:22px 27px}.fxs-portal-shield .fxs-portal-shield-modaldialog .fxs-messagebox .fxs-messagebox-text{max-height:calc(100vh - 295px - 160px);overflow-y:auto}.fxs-portal-shield .fxs-portal-shield-modaldialog .fxs-messagebox .msportalfx-form{background-color:inherit;border-top-width:0}.fxs-portal-shield .fxs-portal-shield-modaldialog .fxs-messagebox .msportalfx-form>div{border-top-width:0}.fxs-portal-shield .fxs-portal-shield-modaldialog .fxs-messagebox a{text-decoration:underline;color:#00bcf2}.fxs-portal-shield .fxs-portal-shield-modaldialog-on-jumpbar{left:85px;top:295px}.fxs-portal-sidebar-is-hidden .fxs-sidebar{display:none}.fxs-button:focus::after,.fxs-button:hover::after{content:"";display:block}.fxs-input{padding:0;border-width:1px;border-style:solid;outline:0;text-indent:10px}.fxs-button{position:relative;line-height:22px;cursor:pointer;border:1px solid;padding:0 20px}.fxs-button:hover::after{position:absolute;top:0;left:0;right:0;bottom:0;border-width:2px;border-style:solid}.fxs-button:focus::after{position:absolute;top:1px;left:1px;right:1px;bottom:1px;border-width:1px;border-style:dotted}.fxs-button.fxs-button-disabled{cursor:default}.fxs-button.fxs-button-disabled:focus:after,.fxs-button.fxs-button-disabled:hover:after{display:none}.fxs-hidden-important{display:none!important}.fxs-ellipsis{overflow:hidden}.fxs-full-height{height:100%}.fxs-full-width{width:100%}@-webkit-keyframes fxs-progress-animatedEllipses{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes fxs-progress-animatedEllipses{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}fxs-progress{position:absolute;width:100%;height:100%;top:0;background-color:#dcdfe2;z-index:194}.fxs-progress-dots{position:absolute;top:calc(50% - 6px/2);width:100%;line-height:0;text-align:center}.fxs-progress-dots>div{display:inline-block;height:6px;width:6px;-webkit-animation:fxs-progress-animatedEllipses 1.5s infinite;animation:fxs-progress-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-progress-dots>div:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.fxs-progress-dots>div:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.fxs-progress-dots>div:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}')}
);define("Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger",["require","exports"],function(){"use strict";var n;return function(n){n.DefaultDelayValidationTimeout=500,function(n){n[n.Default=0]="Default";n[n.AfterKeyDown=1]="AfterKeyDown";n[n.KeyPress=2]="KeyPress";n[n.Blur=3]="Blur";n[n.Input=4]="Input"}(n.ValueUpdateTrigger||(n.ValueUpdateTrigger={}));var t=n.ValueUpdateTrigger}(n||(n={})),n});define("Viva.Controls/Controls/Base/Viva.TypableControl",["require","exports","./Viva.ValueUpdateTrigger","./Viva.ValidatableControl"],function(n,t,i,r){"use strict";var u;return function(n){function u(n){f.clearTimeout(n)}var t=i.ValueUpdateTrigger,f=window,s=jQuery,h=ko.observable,e=function(n){function i(){n.apply(this,arguments);this.delayValidationTimeout=h(500);this.valueUpdateTrigger=t.Default}return __extends(i,n),i}(r.ViewModel),o;n.ViewModel=e;o=function(n){function i(t,i,r){n.call(this,t,i,s.extend({viewModelType:e},r));this._attachTypableEvents()}return __extends(i,n),i.prototype.
dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._detachTypableEvents(),this._timer=u(this._timer),n.prototype.dispose.call(this))},Object.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.prototype.validate=function(t){this._timer=u(this._timer);n.prototype.validate.call(this,t)},i.prototype._attachTypableEvents=function(){var n=this;this._onKeyUp=function(t){t.which===13&&n.element.trigger("typableControl-commit",{widget:n,model:n.options})};this.element.on("keyup",this._onKeyUp)},i.prototype._detachTypableEvents=function(){this._onKeyUp&&(this.element.off("keyup",this._onKeyUp),this._onKeyUp=null)},i.prototype._valueChangeValidation=function(){var t=this,i=this.options.delayValidationTimeout();if(i>0&&this._shouldDelayValidation()){u(this._timer);this._timer=f.setTimeout(function(){t._timer=u(t._timer);t.validate()},i);return}n.prototype._valueChangeValidation.call(this)},i.prototype._getValueUpdateTrigger=
function(){var n;switch(this.options.valueUpdateTrigger){case t.AfterKeyDown:case t.KeyPress:case t.Input:n="input";break;case t.Blur:case t.Default:n=""}return n},i.prototype._shouldDelayValidation=function(){switch(this.options.valueUpdateTrigger){case t.AfterKeyDown:case t.KeyPress:case t.Input:return!0}return!1},i}(r.Widget);n.Widget=o}(u||(u={})),u});define("_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.azc-textBox{height:23px}.azc-textBox-wrapper{font-size:12px;width:100%}.azc-textBox-wrapper input{height:23px;font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;box-sizing:border-box;width:100%;padding:2px 8px 4px;outline:0;font-size:12px;border-width:1px;border-style:solid}.azc-textBox-wrapper input::-webkit-input-placeholder{font-style:italic}.azc-textBox-wrapper input:-ms-input-placeholder{font-style:italic}.azc-textBox-wrapper input::-moz-placeholder{font-style:italic}.azc-textBox-wrapper [placeholder]{text-overflow:ellipsis}')}
);define("Viva.Controls/Controls/Forms/Viva.TextBox",["require","exports","f","../Base/Viva.Base","../Base/Viva.TypableControl","../../../_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css"],function(n,t,i,r,u){"use strict";var f;return function(t){var c=i.Base.Diagnostics,p=window,l=jQuery,w=c.createLog(n),f="azc-textBox",o="azc-has-focus",a="__azc-textBox",v='<div class=\'azc-textBox-wrapper\'><input class=\'azc-input azc-formControl\' type=\'text\' aria-multiline=\'false\' data-bind=\'value: data.value, css: { "fxs-br-error": data.validationState() === 1, "fxs-br-dirty": data.dirty(), "azc-disabled": $disabled, "azc-br-focused": data.focused() }, valueUpdate: $ctl._getValueUpdateTrigger(), attr: { name: $ctl._name, placeholder: data.placeholder, readonly: data.readonly, tabindex: $tabIndex, "aria-readonly": data.readonly, "aria-disabled": $disabled }\' /><\/div>',y=0,s=ko.observable,h=function(n){function t(){n.apply(this,arguments);this.placeholder=s(null);this.readonly=
s(!1)}return __extends(t,n),t}(u.ViewModel),e;t.ViewModel=h;e=function(n){function t(t,i,r){n.call(this,t,i,l.extend({viewModelType:h},r));var e=this.lifetimeManager,u=this.options;t.addClass(f).html(v);this._name=u.name||a+y++;this._input=t.find("input");this._attachEvents();this._initializeComputeds();this._bindDescendants();this._afterCreate();this._supportsFocus(!0);this.$disabled.subscribe(this.lifetimeManager,function(n){console.log("viva text: "+n)})}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._detachEvents(),this._cleanElement(f),n.prototype.dispose.call(this))},Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t.prototype._getElementToFocus=function(){return this._input[0]},t.prototype._initializeComputeds=function(){var n=this;ko.computed(this.lifetimeManager,function(){var t=n.options.disabled();n.element.find("input").prop("disabled",t)})}
,t.prototype._attachEvents=function(){var i=this,t=this.options,n=t.events;this._detachEvents();this._keyUpHandler=function(r){switch(r.which){case 13:r.preventDefault();t.value(i._input.val());n&&n.enterPressed&&n.enterPressed(t.value());break;case 40:n&&n.downPressed&&n.downPressed()}};this.element.on("keyup",this._keyUpHandler);this._input.on("focus."+f,function(){t.focused(!0);i.element.toggleClass(o,!0);n&&n.focus&&n.focus()}).on("blur."+f,function(){t.focused(!1);i.element.toggleClass(o,!1);n&&n.blur&&n.blur()});this._keyPressHandler=function(n){n.which===13&&t.value(i._input.val())};this._input.on("keypress."+f,this._keyPressHandler)},t.prototype._detachEvents=function(){this._keyUpHandler&&(this.element.off("keyup",this._keyUpHandler),this._keyUpHandler=null);this._keyPressHandler&&(this.element.off("keypress."+f,this._keyPressHandler),this._keyPressHandler=null)},t}(u.Widget);t.Widget=e;ko.bindingHandlers.azcTextBox=r.Widget.getBindingHandler(e)}(f||(f={})),f});define("MsPortalImpl/Base/Base.Selectable2.ClickContext",
["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(t){function e(){return i.require("../UI/Compositions/UI.Composition.Selectable2Registrar",n)}function o(n,t,i){var r=f();return{onClick:function(u){if(r())r().onClick(u);else e().then(function(f){r()||r(f.getListSelectableWithClickHandler(n,t,i));r().onClick(u)})},activationState:u(function(){return r()?r().activationState():{previous:undefined,current:undefined}})}}function s(n,t,i){function a(){s&&(s=!1,o().onClick());h&&(h=!1,o().isSelected(!0))}function c(){e().then(function(r){if(!o()){var u=r.getSelectableWithClickHandler(n,t,i);u.registerForDispose(l);o(u)}a()})}function w(){o()?o().onClick():(s=!0,c())}var l=new r.TriggerableLifetimeManager,o=f(),s,h,v=ko.computed({read:function(){return o()?o().isSelected():(c(),!1)},write:function(n){o()&&o().isSelected(n);n&&(h=!0,c())}}),y=u(function(){return o()?o().isClickable():!1}),p=u(function(){return o()?o().value():undefined});return{isSelected:v,isClickable:
y,value:p,onClick:w}}var u=ko.pureComputed,f=ko.observable;t.getListSelectableWithClickHandler=o;t.getSelectableWithClickHandler=s}(u||(u={})),u});define("MsPortalImpl.Controls/Fields/Base/FormValidation",["require","exports"],function(){"use strict";var n;return function(n){function o(n,t){t===void 0&&(t=!0);var f=r(n),e=i(n,[]);return(t&&this.gridEnableValidation(e),f.length===0)?Q(!0):u(f)}function f(n){n.forEach(function(n){var t=n.rowMetadata;t&&t.editState&&t.editState()&&n.performValidation&&!n.performValidation()&&n.performValidation(!0)})}function s(n,i,r,u){var f=t(n);f.attr("data-validatable","true");f.data("field",u);f.data("viewmodel",i);f.data("widgetviewmodel",r)}function i(n,i){var s=[],f,r,h,u,e,o;if(n.length)for(f=n.find("[data-validatable]"),r=0,h=f.length;r<h;r++)u=t(f[r]),u.is(":visible")&&(e=u.data("viewmodel"),e&&s.push(e),i&&(o=u.data("widgetviewmodel"),o&&i.push(o)));return s}function r(n){var e=[],r,i,o,u,f;if(n.length)for(r=n.find("[data-validatable]"),i=0,o=
r.length;i<o;i++)u=t(r[i]),u.is(":visible")&&(f=u.data("field"),f&&e.push(f));return e}function u(n){var t=[];return n.forEach(function(n){n.triggerValidation&&t.push(n.triggerValidation())}),Q.all(t).then(function(n){return!n.some(function(n){return!n})})}var h=window,t=jQuery,e;n.ensureFormFieldValidation=o;n.gridEnableValidation=f;n.markFormFieldElement=s;n.gatherFormFieldViewModels=i;n.gatherFormFieldWidgets=r;n.performFieldValidation=u;e=function(){function n(n,t){var i=this;this._formFieldVMs=ko.observableArray([]);this._lifetime=n;this._formTarget=t;this.valid=ko.computed(n,function(){var n=i._formFieldVMs();return n.every(function(n){return n.valid()})})}return n.prototype.setFormTarget=function(n){this._formTarget=n},n.prototype.triggerValidation=function(){if(!this._formTarget)return Q(!0);var n=i(this._formTarget),t=r(this._formTarget);return f(n),this._formFieldVMs(n),u(t)},n}();n.FormValidator=e}(n||(n={})),n});define("MsPortalImpl/Base/Telemetry",["require","exports","f"],
function(n,t,i){"use strict";var r;return function(n){function ni(n,t){i.extendArrayIntoMap(n,t)}function ki(n,t,i,r,u){var f=n.toLowerCase(),e=t+":"+(i.assetType||"").toLowerCase(),o=ri[f]=ri[f]||{};o[e]||(o[e]=!0,i.name=n,i.status=r,gi({source:u,action:i.name,name:t,data:i}))}function fr(n,t,i,r){r===void 0&&(r=!0);ki(n,t,i,r,i.obsolete?ui:ii.FeatureAdoption)}function er(n,t,i,r){r===void 0&&(r=!0);ki(n,t,i,r,ui)}var ti=i.Base,di=ti.Diagnostics.Telemetry,ii=ti.Constants.Telemetry,gi=di.trace,ri={},ui=ii.FeatureObsolete,at="Activated",t="Blade",u="Browse",fi="Button",ei="Changed",f="Clicked",lt="Command",b="Create",oi="Customize",c="Dashboard",vt="Deactivated",si="Discard",hi="DragDrop",k="Executed",it="Extension",ot="Failed",yt="Favorite",s="Feedback",pt="Full",rt="Gallery",d="Help",st="Item",v="Journey",wt="KeyboardShortcut",bt="Language",nr="Launched",ht="Loaded",ci="Manager",g="Menu",nt="Notification",h="Open",e=h+"ed",li="Pane",r="Part",kt="Ready",dt="Recommendation",ai="Related",
y="Resource",vi="RestoreDefaults",gt="Revealed",p="Search",tr="Selected",yi="Settings",l=yi+t,a=yi+li,o="SideBar",pi="StackLayout",w="Start",wi="SupportRequest",ut="Switch",bi=ut+"RegionalFormat",ft="Toggle",et="Avatar"+g,tt=g+h,ct="View",ir,rr,ur;(function(n){ni(n,["Asset",t,u+t,u+ci,u+"rRefresh",s+li,"FormControl",c,"Desktop",hi+"Composition"+ci,rt,d+t,wt+"s","Lens",nt+"Hub",r+rt,y,y+"Summary",p,"Shell",o,w+"Board"+r,l,a,"TileAction","ToastTray","TopBar",])})(ir=n.Source||(n.Source={})),function(n){ni(n,["ActionBar"+f,"Add"+r+"By"+hi,et+h+"Billing",et+h+s,et+h+"AccessDetails",et+h,et+"SignOut",et+ut+"Tenant",t+"Closed",t+ht,t+pt+e,t+e,t+pt+kt,t+pt+gt,t+kt,t+gt,t+"Rebind",t+"LoadErrored","BreadCrumb"+f,u+"AssetsCollected",u+"Canceled",u+s,u+"Saved",u+w+"ed",u+st+at,u+"Recent"+st+"Removed",u+st+vt,u+"Type"+at,u+"Type"+vt,"Clone"+r+"Across"+t+"s","Clone"+r+"InSame"+t,lt+k,b+"Abandoned"+s+e,b+"Completed",b+"Deployment"+w,b+k,b+s,b+"Flow"+k,b+"Flow"+nr,"CustomClick",oi+"ModeEntered",oi+"ModeExited",
c+si,c+"Edit"+lt+f,c+"Publish",c+"PublishNew",c+"SaveACopy",c+ct,c+ct+"Time",c+"Delete","DeepLinkVisited","Delete"+s,"Delete"+s+e,"DialogClosed","Dialog"+e,it+"SignedOut",it+"TooManyErrors",it+"VersionChanged",s+"Smiley"+f,"FormFocused","FormBlurred","Generic"+s,"HashChanged",d+t+h,d+tt,d+tt+"Legal",d+tt+wt+"s",d+tt+wi,d+tt+"Manage"+wi,"Home"+fi+f,v+tt,nt+tt,nt+g+nt+"Click",p+s,p+"Session",p+k,p+"All"+y+"s"+k,p+y+"Groups"+k,p+"Result"+e,v+at,v+vt,v+si+"ed",v+e,v+"Rehydrated",wt+k,"LensAdded","LensRemoved","LensTitleEdited","Link"+f,"NPSDismissed","NPSScore"+f,"NPSShown","NPSSubmitted","NPSOpenSurvey","OnInputsSetResolved",e,"ShellVersionChanged",o+ht,o+u+g+e,o+u+g+ct+"Initialized",o+u+g+ct+ei,o+yt,o+yt+"Moved",o+st+e,o+"New"+g+e,o+"Un"+yt,o+ct+ei,r+"Click",r+rt+"Learn"+ai+y+"s",r+rt+h+ai+y+"s",r+rt+w,r+rt+st+"s"+ht,r+ht,r+ht+"No"+it+"Derived",r+"Position",r+kt,r+gt,r+"Errored",r+"Migrated","PortalInitialize"+bt,"PortalRedirect","RelexDisconnected","RelexOnReloadSet",y+"SummaryCopyProperty",
y+"SummaryAction","Restore"+v,"Result"+e,nt+f,dt+f,dt+"Surfaced",dt+"Added","RotateTheme",tr+"Theme","SeeAll","SendScreenshot",l+h,l+ut+bt,l+bi,l+ut+"Theme",l+ft+"Animations",l+ft+nt+"Toasts",l+ft+lt+"Labels",l+vi,a+h,a+ut+bt,a+bi,a+ut+"Theme",a+ft+"Animations",a+ft+nt+"Toasts",a+ft+lt+"Labels",a+vi,pi+"MoveNext",pi+"MovePrevious",w+"Board"+r+"Loaded",w+fi+f,w+"FileDownload","TileAction"+f,"Toast"+f,"Unhandled"+it+"Error","UnknownNetworkError",])}(rr=n.Action||(n.Action={})),function(n){ni(n,["Default",ot,"Redirect","Succeeded",ot+"ToGet"+t,ot+"PreCheck",ot+"ToLoad"+it,ot+"InvalidUIDefinition",p,w+"BoardRestored",v+"Restored","PortalScrolled",])}(ur=n.ActionModifier||(n.ActionModifier={}));n.traceFeatureAdoption=fr;n.traceFeatureObsolete=er}(r||(r={})),r});define("MsPortalImpl/Base/Base.SelectableSet2",["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(n){function tt(n){var i="SelectableSet",t=h.disposableData(n,i);return t||(t=new s(n),h.disposableData(
n,i,t)),t}function it(n){return n instanceof s?n.selectedItems():n.selectableItems().filter(function(n){return n.isSelected()})}function rt(n){return n?!!n._msPortalFxSelectableSet:!1}function b(n,i){var f=new t,e=n.peek(),o=e.length,r;return o&&(i?(r=!1,i.forEach(function(t){var i=e.firstIndex(function(n){return u(n,t)});i>=0&&(r||(n.valueWillMutate(),r=!0),e.splice(i,1),f.removed.push(t))}),r&&n.valueHasMutated()):f.removed=n.removeAll()),f}function o(n,i,r,f,e,o){var s=new t,h=n.peek(),c,l;return e?h.length&&n.removeAll():i.peek().length===0?h.length>0&&(s.removed=n.removeAll()):(c=!1,l=[],s.removed=h.slice(0),i.peek().forEach(function(n){var t,i,u;r&&(t=ut(r,n));i=ft(s.removed,n);i>=0&&(u=s.removed.splice(i,1)[0],t?t.data!==u.data&&(c=!0):t=u);t&&(l.push(t),i<0&&s.added.push(t))}),(s.removed.length||s.added.length||c)&&n(l)),f&&(s.removed=s.removed.concat(f.filter(function(n){return o.some(function(t){return u(n.id,t)&&!s.removed.some(function(n){return u(t,n.id)})})}))),s}function k(
n,i,r,f){var e=new t,s,h,o;return!r&&i.length>1&&(i=i.slice(0,1)),s=n.peek(),h=s.length,i=i.filter(function(n){return!s.some(function(t){return u(t,n)})}),e.added=i,e.added.length&&(o=r?f?[0,0]:[h,0]:[0,h],o=o.concat(e.added),e.removed=n.splice.apply(n,o)),e}function ut(n,t,i){var f,o=e(t),r;return p(o)||(r=e(n),r&&(f=r.first(function(n){var t=n.id;return(!i||i(n))&&u(t,o)}))),f}function ft(n,t,i){var f=-1,o=e(t),r;return p(o)||(r=e(n),r&&(f=r.firstIndex(function(n){var t=n.id;return(!i||i(n))&&u(t,o)}))),f}function l(n){return{id:n.id,data:n.data}}var d=r.TriggerableLifetimeManager,v=i.Base,h=v.ProxiedObservables,y=h.Internal,g=i.ViewModels,nt=g.Internal.Selection2,u=nt.compareIds,p=v.Utilities.isNullOrUndefined,c=ko.observable,f=ko.observableArray,e=ko.utils.peekObservable,w,t,a,s;(function(n){n.None=1;n.Single=2;n.Multiple=3})(w=n.ActivationModeInternal||(n.ActivationModeInternal={}));n.getSelectableSet2=tt;n.getSelectedItems=it;n.isSelectableSet2=rt;t=function(){function n(n,t){n===
void 0&&(n=[]);t===void 0&&(t=[]);this.added=n;this.removed=t}return n}();a=function(){function n(n,t,i,r,u,e){this.ids=n;this.includeAll=t;this._allowMultiple=r;this._prepend=u;this._onChanged=e;this.itemsArePinnable=c(!0);this.items=f([]);this.excludedIds=i;this.excludedItems=f([])}return n.prototype.addAll=function(){var r=this._allowMultiple,u=this.includeAll.peek(),i=!1,n,t;r&&(u||(this.includeAll(!0),i=!0),n=this.ids,n.peek().length&&n.removeAll(),t=this.items,t.peek().length&&t.removeAll());this._fireChanged([],[],[],[],i,!1,[],[],[],[])},n.prototype.addId=function(n){this._add([n])},n.prototype.addIds=function(n){this._add(n)},n.prototype.addItem=function(n){this._add([n.id],[n])},n.prototype.addItems=function(n){var t=n.map(function(n){return n.id});this._add(t,n)},n.prototype.removeId=function(n){this._remove([n],null)},n.prototype.removeIds=function(n){this._remove(n,null)},n.prototype.removeItem=function(n){this._remove([n.id],[n])},n.prototype.removeItems=function(n){var t=
n.map(function(n){return n.id});this._remove(t,n)},n.prototype._add=function(n,i){var s=this.includeAll.peek(),r=new t,u=new t,f=new t,e;s?(u=b(this.excludedIds,n),f=o(this.excludedItems,this.excludedIds,i,null,!1,u.removed)):r=k(this.ids,n,this._allowMultiple,this._prepend);e=o(this.items,this.ids,i,null,s,r.removed);this._fireChanged(r.added,r.removed,e.added,e.removed,!1,!1,u.added,u.removed,f.added,f.removed)},n.prototype._remove=function(n,i){var s=this.includeAll.peek(),r=new t,u=new t,f=new t,e;s?(u=k(this.excludedIds,n,!0,!1),f=o(this.excludedItems,this.excludedIds,i,null,!1,u.removed)):r=b(this.ids,n);e=o(this.items,this.ids,null,i,s,r.removed);this._fireChanged(r.added,r.removed,e.added,e.removed,!1,!1,u.added,u.removed,f.added,f.removed)},n.prototype.removeAll=function(){var n=!1,t=[],i=[],r=[],u=[];this.includeAll.peek()&&(n=!0,this.includeAll(!1),this.excludedIds.peek().length&&(r=this.excludedIds.removeAll()),this.excludedItems.peek().length&&(u=this.excludedItems.removeAll(
)));this.ids.peek().length&&(t=this.ids.removeAll());this.items.peek().length&&(i=this.items.removeAll());this._fireChanged([],t,[],i,!1,n,[],r,[],u)},n.prototype._fireChanged=function(n,t,i,r,u,f,e,o,s,h){(n.length||t.length||i.length||r.length||u||f||e.length||o.length||s.length||h.length)&&this._onChanged(n,t,i,r,u,f,e,o,s,h)},n.prototype.fireCurrentChanges=function(){this._fireChanged(this.ids(),[],this.items(),[],this.includeAll(),!1,this.excludedIds(),[],this.excludedItems(),[])},n}();s=function(){function n(n){var t=this,u=n,i;if(!u._msPortalFxSelectableSet)throw new Error("SelectableSet is missing internal members.  Ensure the SelectableSet is constructed from FxViewModels.SelectableSet2Contract.");this._viewModel=u;this._lifetime=new d;i=this._lifetime;this._activationMode=n.activationMode||1;this._selectionMode=n.selectionMode||1;var e=n.activatedIds||f([]),o=n.selectedIds||f([]),s=n.selectedAll||c(!1),h=n.unselectedIds||f([]),r=y.disallowRemoteMutations.bind(y);r(e);r(o);r(s);
r(h);this._activationSet=new a(e,c(!1),f(),this._activationMode===w.Multiple,!0,function(n,i,r,u){t._onActivationChanged&&t._onActivationChanged(n,r,i,u)});this._selectionSet=new a(o,s,h,this._selectionMode===3,!1,function(n,i,r,u,f,e,o,s,h,c){var l=t.selectedAll.peek();t._onSelectionChanged&&t._onSelectionChanged(f,l?s:n,l?c:r,e,l?o:i,l?h:u)});this._activatedItems=this._activationSet.items.mapInto(i,function(n,t){return l(t)});this._selectedItems=this._selectionSet.items.mapInto(i,function(n,t){return l(t)});this._unselectedItems=this._selectionSet.excludedItems.mapInto(i,function(n,t){return l(t)})}return n.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null)},Object.defineProperty(n.prototype,"activationMode",{get:function(){return this._activationMode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"activatedItems",{get:function(){return this._activatedItems},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,
"activatedIds",{get:function(){return this._activationSet.ids},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionMode",{get:function(){return this._selectionMode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedItems",{get:function(){return this._selectedItems},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedIds",{get:function(){return this._selectionSet.ids},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedAll",{get:function(){return this._selectionSet.includeAll},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"itemsArePinnable",{get:function(){return this._selectionSet.itemsArePinnable},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"unselectedIds",{get:function(){return this._selectionSet.excludedIds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"unselectedItems",{get:function(){return this._unselectedItems},enumerable:!0,
configurable:!0}),Object.defineProperty(n.prototype,"commandGroupProvider",{get:function(){return this._viewModel.commandGroupProvider},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dynamicSelectionProvider",{get:function(){return this._viewModel.dynamicSelectionProvider},enumerable:!0,configurable:!0}),n.prototype.registerItemController=function(n,t,i,r){var f=this._activationSet,e=this._selectionSet,u=function(i){return{id:n(i),data:t(i),item:i}};return i&&(this._onActivationChanged=function(n,t,r,u){i(n,t.map(function(n){return n.item}),r,u.map(function(n){return n.item}))},f.fireCurrentChanges()),r&&(this._onSelectionChanged=function(n,t,i,u,f,e){r(n,t,i.map(function(n){return n.item}),u,f,e.map(function(n){return n.item}))},e.fireCurrentChanges()),{activateItem:function(n){var t=u(n);f.addItem(t)},activateItems:function(n){var t=n.map(u);f.addItems(t)},deactivateItem:function(n){var t=u(n);f.removeItem(t)},deactivateItems:function(n){var t=n.map(u);f.removeItems(
t)},selectItem:function(n){var t=u(n);e.addItem(t)},selectItems:function(n){var t=n.map(u);e.addItems(t)},unselectItem:function(n){var t=u(n);e.removeItem(t)},unselectItems:function(n){var t=n.map(u);e.removeItems(t)}}},n.prototype.activateId=function(n){this._activationSet.addId(n)},n.prototype.activateIds=function(n){this._activationSet.addIds(n)},n.prototype.activateAllSelectedItems=function(){this._activationSet.addIds(this._selectionSet.ids.peek())},n.prototype.deactivateId=function(n){this._activationSet.removeId(n)},n.prototype.deactivateIds=function(n){this._activationSet.removeIds(n)},n.prototype.deactivateAll=function(){this._activationSet.removeAll()},n.prototype.selectId=function(n){this._selectionSet.addId(n)},n.prototype.selectIds=function(n){this._selectionSet.addIds(n)},n.prototype.selectAll=function(){this._selectionSet.addAll()},n.prototype.unselectId=function(n){this._selectionSet.removeId(n)},n.prototype.unselectIds=function(n){this._selectionSet.removeIds(n)},n.prototype.
unselectAll=function(){this._selectionSet.removeAll()},n}();n.SelectableSet2=s}(u||(u={})),u});define("MsPortalImpl/Base/Base.ItemCache",["require","exports","f","u"],function(n,t,i){"use strict";var r;return function(t){function e(n){return function(t){return n(t.item)}}function y(n){var t=f();return t-n}function o(n){return{age:f(),item:n}}function s(n,t){var i;return n&&(t&&(n.age=f()),i=n.item),i}function it(n,t){var i=(k++).toString();return u.set(i,t),n.registerForDispose(function(){u.delete(i)}),i}function rt(n){return u.get(n)}var c=i.Base,d=c.Diagnostics,g=c.Utilities,l=window,ut=d.createLog(n),a=1e3,r=12e4,v=i.remove,nt=i.find,tt=i.findIndex,f=Date.now,h=function(){function n(n,t){var i=this;n===void 0&&(n=r);this._map=t;this._maxAge=n;this._timer=l.setTimeout(function(){return i._reduceCache()},a)}return n.prototype.dispose=function(){this.flush()},n.prototype.hasEntry=function(n){return n in this._map},n.prototype.getEntry=function(n){return s(this._map[n],!0)},n.prototype.
peekEntry=function(n){return s(this._map[n])},n.prototype.removeEntry=function(n){n in this._map&&this._delete(n)},n.prototype._removeEach=function(n){for(var t in this._map)n.call(this,t)&&this._delete(t)},n.prototype.removeEach=function(n){this._removeEach(n)},n.prototype.flush=function(){this._removeEach()},n.prototype._delete=function(n){delete this._map[n]},n.prototype._isExpired=function(n){return y(this._map[n].age)>this._maxAge},n.prototype._reduceCache=function(){this._removeEach(this._isExpired)},n}(),p,w,b,u,k;t.BaseItemCache=h;p=function(n){function t(t){t===void 0&&(t=r);var i={};n.call(this,t,i);this._cache=i}return __extends(t,n),t.prototype.addEntry=function(n,t){this._cache[n]=o(t)},t}(h);t.ItemCache=p;w=function(n){function t(t){t===void 0&&(t=r);var i={};n.call(this,t,i);this._cache=i}return __extends(t,n),t.prototype.addEntry=function(n,t,i){this.removeEntry(n);var r=o(t);r.mgr=i;this._cache[n]=r},t.prototype._delete=function(t){this._cache[t].mgr.dispose();n.prototype.
_delete.call(this,t)},t}(h);t.LifetimeItemCache=w;b=function(){function n(n){var t=this;n===void 0&&(n=r);this._cache=[];this._maxAge=n;this._timer=l.setTimeout(function(){return t._reduceCache()},a)}return n.prototype.dispose=function(){this.clear()},n.prototype.first=function(n,t){var i=nt(this._cache,e(n));return s(i,!t)},n.prototype.peekFirst=function(n){return this.first(n,!0)},n.prototype.pushEntry=function(n){this._cache.push(o(n))},n.prototype.removeEntry=function(n){this.removeFirst(function(t){return g.deepEquals(t,n)})},n.prototype.removeFirst=function(n){var t=tt(this._cache,e(n));t>=0&&this._cache.splice(t,1)},n.prototype.removeEach=function(n){v(this._cache,e(n))},n.prototype.clear=function(){this._cache=[]},n.prototype._isEntryExpired=function(n){return y(n.age)>this._maxAge},n.prototype._reduceCache=function(){var n=this;v(this._cache,function(t){return n._isEntryExpired(t)})},n}();t.ItemArrayCache=b;u=new i.Map;k=1;t.rotAdd=it;t.rotFind=rt}(r||(r={})),r});define("MsPortalImpl/Base/Base.Selectable2",
["require","exports","f","i","./Base.ItemCache"],function(n,t,i,r,u){"use strict";var f;return function(t){function p(n){var t=new r.TriggerableLifetimeManager;return n.setLifetimeReference(1,t),{selectable:n,dispose:function(){t.dispose()}}}function w(n){return h(n)}function h(n){var i="Selectable",t=o.disposableData(n,i),r;return t||(r=new y(n),t=p(r),o.disposableData(n,i,t)),t.selectable}function c(n,t,i,r,u){var f=n.parameters,e=n.metadata||{},o=n.options;return{cloudName:n.cloudName,detailBlade:n.bladeName,extension:n.extensionName,detailBladeInputs:f?f:{},openInContextPane:r===undefined?e.isContextBlade:r,persistentContextPane:r||e.persistentContextPane,flags:t?0:2,metadata:i,operationId:u,onClosed:o?o.onClosed:undefined}}function b(n){return n.parents("["+f+"]")}function k(n,t,i){var r=u.rotAdd(n,t);i.attr(f,r);n.registerForDispose(function(){i.removeAttr(f)})}function d(n,t){t=t.attr(f)?t:b(t);var i=t.attr(f);return u.rotFind(i)}var e=i.Base,l=e.Diagnostics,o=e.ProxiedObservables,
a=l.createLog(n),s=ko.observable,v=1,y=function(n){function t(t){function d(n,t,i,r,f){n&&u()?(o=n,k(n,r,f).then(function(u){o===n&&(u=u||c(n,t,i,r,f),e(u))})):(o=null,e(null))}function g(n){var t=n.reason;t===3&&(h=!0,u(!0),h=!1);(t===2||t===3)&&d(n.bladeReference,!!n.restorable,n.metadata,n.contextPane,n.operationId)}var w=this,l;n.call(this);this.id=v++;this.isSelected=s(!1);var e=s(),y=r.shellInterface(t),u=this.isSelected,o,i,f,p=0,b=Q.defer(),k=function(n,t,i){return b.promise.then(function(r){return r(n,t,i)})},h=!1;this.setLifetimeReference=function(n,t){n===(p&n)&&(p|=n,t.registerForDispose({dispose:function(){p^=n;p||w.dispose()}}))};this.value=ko.computed(this,{read:function(){var n=u()?e():undefined;return n!==undefined?(f&&f!==i&&(f=i),i=l.peek()):i&&(f=i,i=undefined),n},write:function(n){n===undefined&&(u(!1),e(undefined))}});this.setDefinitionPreprocesor=function(n){b.resolve(n);k=n};l=y.openBladeRequest;l.subscribe(this,g);u.subscribe(this,function(n){h||(n===!0?Q(w.fetchBladeReference(
)).then(function(n){d(n,!0,undefined)}).catch(function(n){a.error(n)}):e(undefined))});this.onClick=function(){u()||u(!0)};this.invokeClickCallback=function(n,t,i,r,u,f){t.invokeClickHandler(n,i,r,y,u,f)};this.openBlade=function(n){h=!0;try{e(n);u(!0)}finally{h=!1}};this.fetchBladeReference=function(){return Q(y.fetchBladeReference()).then(function(n){return o=n})};this.getOutputProperties=function(){var n=o.metadata,t=n&&n.outputParameters;return Array.isArray(t)?t:[]};this.getOutputsChangedHandler=function(){var n=o;return function(t){r.invokeCallback(n,"onOutputsChanged",[t])}};this.activationState=ko.computed(this,function(){var n=w.value(),t=f?{item:f.selectedItem,metadata:f.controlMetadata}:undefined,r=n&&i?{item:i.selectedItem,metadata:i.controlMetadata}:undefined;return{previous:t,current:r}});this.notifyBladeOpenCompleted=function(n,t){y.openBladeResult({operationId:n,success:t})};l()&&g(l())}return __extends(t,n),t.prototype.isClickable=function(){return!0},t}(r.TriggerableLifetimeManager),
f;t.createListSelectable=w;t.getOrCreateSelectable2=h;t.getBladeDescriptor=c;f="data-fxselectable";t.setSelectableContext=k;t.findExtensionViewModel=d}(f||(f={})),f});define("MsPortalImpl/Base/Base.Events",["require","exports"],function(){"use strict";var n;return function(n){function t(){var n=document;return n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement}function i(){var n=document,t=n.exitFullscreen||n.webkitExitFullscreen||n.mozCancelFullScreen||n.msExitFullscreen;t&&t.call(n)}n.fxpinmultipleparts="fxpinmultipleparts";n.fullscreen="fullscreenchange MSFullscreenChange mozfullscreenchange webkitfullscreenchange";n.isFullscreen=t;n.exitFullscreen=i}(n||(n={})),n});define("MsPortalImpl/Services/Services.PortalIdentity",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources"],function(n,t,i,r){"use strict";var u;return function(n){function a(n,t){return(n&t)===t}function k(n){o=u.getHubsWindowId();var t=!1;n||(n={},t=!0);s={displayName:
n.displayName,firstName:n.firstName,lastName:n.lastName,avatarUri:n.avatarUri,defaultAvatarUri:n.defaultAvatarUri,tenantId:n.tenantId,tenantDomain:n.tenantDomain,perTenantId:n.perTenantId,changePasswordUri:n.changePasswordUri,isAnonymous:t}}function d(n){var t={};n.forEach(function(n){if(n.encryptTokens){var i=n.features,r=(i&&i.allowedUserInfo||"").toLowerCase(),f=w[r]||0;t[u.getWindowId(n)]=f}});u.getUserInfoEndPoint.register(e.client,null,function(n,i){return v(t[i.srcWindowId])})}function v(n){return p().then(function(t){var i=y(),u=i.tenantId,o=i.tenantId,c=i.tenantId,s=t.first(function(n){return i.tenantId===n.id}),h,e;return s&&(u=s.displayName,o=s.domainName,c=t.filter(function(n){return n.displayName===u}).length>1?r.Services.PortalIdentity.tenantNameAndDomainFormat.format(u,o):u),h=f.isNullOrUndefined(n)?7:n,e={},a(h,3)&&f.extend(e,{email:i.displayName,givenName:i.firstName,surname:i.lastName}),a(h,4)&&f.extend(e,{directoryId:i.tenantId,directoryName:u,uniqueDirectoryName:c,domainName:
o}),e})}function y(){return s}function g(){if(!t){var n=Q.defer();l.updateSubscriptionInfoEndPoint.register(e.client,[o],function(t){n.resolve(t)});t=n.promise}return t}function p(){if(!n.Internal.tenantsPromise){var t=Q.defer();l.updateTenantInfoEndPoint.register(e.client,[o],function(n){t.resolve(n.tenantList)});n.Internal.tenantsPromise=t.promise}return n.Internal.tenantsPromise.then(function(n){var t=n.first(function(n){return n.isSignedInTenant}),i=s.tenantDomain;return t&&(t.displayName||(t.displayName=i),t.domainName||(t.domainName=i)),n})}var h=FxImpl,u=h.Extension,c=i.Base,f=c.Utilities,e=c.Rpc.Internal,l=HubsExtension.Internal.Azure,w={directory:4},o,s,t,b;h.GlobalStateManager.register({reset:function(){t=undefined;b=undefined}});n.initialize=k;n.initializeRpc=d;n.getUserInfo=v;n.getSignedInUser=y;n.getSubscriptions=g;n.getTenants=p;n.Internal={}}(u||(u={})),u});define("MsPortalImpl/Services/Services.Settings.Schema",["require","exports","f"],function(){"use strict";var n;return function(
n){n.desktopSettingsKey="sprint2";n.startBoardSettingsKey="Startboard";n.fxThemeKey="fxs-theme";n.favoritesKey="favorites";n.testExtensionsKey="TestExtensions";n.testGalleryPackagesKey="TestGalleryPackages";n.testPatchesKey="TestPatches";n.assetMruListKey="AssetMruList";n.animationEnabledKey="animationEnabledKey";n.npsTimeMs="npsTimeMs";n.rawLocaleKey="rawLocale";n.relexHostKey="relexHost";n.relexPortalUriKey="relexPortalUri";n.sideBarCollapsedKey="sideBarCollapsedKey";n.sideBarBrowseDisplayModeKey="sideBarBrowseDisplayModeKey";n.showCommandLabelsKey="showCommandLabelsKey";n.notificationToastEnabledKey="notificationToastEnabledKey";n.showLabelsKey="showLabelsKey";n.settingsVersionSettingKey="Version";n.defaultAssetTypeIdKey="MsPortalFx.Browse.DefaultAssetTypeId";n.lastHubOpenedTimeSettingKey="MsPortalFx.Notifications.LastHubOpenedTime";n.generalSettingsKeys=[n.fxThemeKey,n.testExtensionsKey,n.testGalleryPackagesKey,n.assetMruListKey,n.animationEnabledKey,n.rawLocaleKey,n.relexHostKey,n.
relexPortalUriKey,n.sideBarCollapsedKey,n.showCommandLabelsKey,n.showLabelsKey,n.notificationToastEnabledKey,n.settingsVersionSettingKey,n.defaultAssetTypeIdKey,n.npsTimeMs,n.lastHubOpenedTimeSettingKey,n.sideBarBrowseDisplayModeKey]}(n||(n={})),n});define("MsPortalImpl/Services/Services.Settings",["require","exports","f","FxHubs/HubsSettingsSchema","./Services.Settings.Schema","MsPortalImpl/Resources/ImplScriptResources"],function(n,t,i,r,u,f){"use strict";var e;return function(t){function it(n){return function(t){this[t]=n}}function vt(){var n={};return u.generalSettingsKeys.forEach(it(!0),n),n}function ct(n){return""+t.dashboardStoreNamePrefix+n}function si(){var n={manager:new w.InMemorySettingsManagerImpl,stores:[c.JourneySession,c.EditScopeSession]};return w.createUserSettingsManager(new w.UserSettingsManagerImpl,[n])}function hi(n,t){if(!t||!t.length)return Q.resolve({});var i=t.map(n.queryStore,n);return Q.all(i).then(function(n){var i={};return n.forEach(function(n,r){i[t[r]]=
n}),i})}var l=i.Base,lt=l.Constants,nt=l.Diagnostics,a=nt.Telemetry,v=i.Hubs.Notifications.NotificationStatus,tt=l.Net2,o=i.forEachKey,b=i.isEmpty,at=ko.observableArray,s=JSON.stringify,yt=window,rt=yt.fx,ci=jQuery,e=f.Services.Settings,y=rt.environment,k=i.isFeatureEnabled,pt=k("inmemorysettings"),wt=k("multidashboards"),d=y.version,ut=l.getVersionFromString(d),bt=3,p=y.settingsBaseUri+"{0}"+y.settingsUriQuery,kt=p.format("/Remove"),dt=p.format("/Select"),gt=p.format("/Clear"),ni=p.format(""),ft="Services.Settings",et=y.trace.usersettings,h=nt.createLog(n),ti=5e3,ii=3e5,ot=u.settingsVersionSettingKey,ri=vt(),st="application/json;charset=utf-8",ht=rt.early,ui=ht&&ht.preloadSettings,g="Settings operation exceeded 5 attempts. Will stop calls to the server.",fi="Get "+g,ei=5,oi=400,c,w;t.dashboardStoreQuota=100;t.dashboardStoreNamePrefix="Dashboard";t.createDashboardStoreName=ct;ut.revision=0,function(n){n[n.General=0]="General";n[n.Blade=1]="Blade";n[n.Part=2]="Part";n[n.LensState=3]="LensState";
n[n.Startboard=4]="Startboard";n[n.SharedPart=5]="SharedPart";n[n.HubsExtension=6]="HubsExtension";n[n.CrossTenant=7]="CrossTenant";n[n.JourneySession=8]="JourneySession";n[n.EditScopeSession=9]="EditScopeSession";n[n.Favorites=10]="Favorites";n[n.DashboardInventory=11]="DashboardInventory";n[n.FileUpload=12]="FileUpload"}(t.SettingStore||(t.SettingStore={}));c=t.SettingStore,function(){for(var i,r,u=c,n=0;n<t.dashboardStoreQuota;n++)i=1e3+n,r=ct(n),u[i]=r,u[r]=i}();t.createUserSettingsManager=si;t.queryStores=hi,function(n){function vi(n,t,i){return new ht(new rt(new w(nt.createWithWriteDeleteBufferTimeout(n,i),t)))}function f(n){var t=c[n];if(!t)throw new Error("Invalid settingStore:"+n);return t}function vt(n){var i={},t;return n.keys.forEach(it(null),i),t={},t[n.store]=i,t}function yi(n){var t={};return o(n,function(n,i){var r=parseInt(n);t[f(r)]=i}),t}function pi(n,t){var u=i.merge(n,t),r={settingsToSet:{},settingsToDelete:{}};return r=u.reduce(function(n,t){return y(n.settingsToSet,
n.settingsToDelete,t.settingsToSet),y(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n},r),[r]}function y(n,t,i){i&&o(i,function(r){var u=parseInt(r),e=i[u],f;n&&(n[u]||(n[u]={}),yt(e,n[u]));t&&(f=t[u],f&&(hi(e,f),b(f)&&delete t[u]))})}function yt(n,t){o(n,function(n,i){t[n]=i})}function si(n){return Q(tt.ajax(n))}function hi(n,t){o(n,function(n){delete t[n]})}function ci(n,t,i){var r={};return r[t]=i,{store:n,settings:r}}function wi(n){return!!ri[n]}function p(n){return Q.all(n)}function ct(n){return JSON.parse(s(n))}var u,t,li,w,ai,nt,rt,ht;n.createUserSettingsManager=vi;n.getSettingStoreName=f;n.convertSettingQueryToDictionary=vt;n.updateDictionary=y;n.updateSettingsDictionary=yt;n.sanitizeSettingsDictionary=hi;u=function(){function n(){this._eventsTriggered=at([])}return Object.defineProperty(n.prototype,"eventsTriggered",{get:function(){var n=this._baseManager;return n?n.eventsTriggered:this._eventsTriggered},enumerable:!0,configurable:!0}),n.prototype._fireEvent=function(
n,t,i){var r={status:i,title:n,description:t,timestamp:new Date,cloudName:lt.DefaultCloudName};this.eventsTriggered.push(r)},n.prototype._fireError=function(n){this._fireEvent(e.useInMemorySettings,n||e.settingsCallFailed,v.Error)},n}();n.SettingsManagerVeryBase=u;t=function(n){function t(t){n.call(this);this._baseManager=t}return __extends(t,n),t.prototype.flushSettings=function(){return this._baseManager?this._baseManager.flushSettings():Q()},t.prototype.dispose=function(){this._baseManager&&(this._baseManager.dispose(),this._baseManager=null)},t}(u);n.SettingsManagerBase=t;li=function(n){function t(){n.apply(this,arguments);this._maps={}}return __extends(t,n),t.prototype.setSettings=function(n){var t=n.settings,i;t&&(i=this._getMap(n.store),o(t,function(n,t){i.set(n,s(t))}))},t.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach(function(n,i){t[i]=JSON.parse(n)}),Q.resolve(t)},t.prototype.deleteSettings=function(n){if(n.keys){var t=this._getMap(n.store);n.keys.
forEach(function(n){t.delete(n)})}},t.prototype.clearSettings=function(){return this._maps={},Q()},t.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new i.Map},t}(t);n.InMemorySettingsManagerImpl=li;w=function(n){function t(t,i){n.call(this,t);this._initialize(i)}return __extends(t,n),t.prototype.queryStore=function(n){return this._getManager(n).queryStore(n)},t.prototype.deleteSettings=function(n){this._getManager(n.store).deleteSettings(n)},t.prototype.setSettings=function(n,t){this._getManager(n.store).setSettings(n,t)},t.prototype.clearSettings=function(){var n=this._managers.map(function(n){return n.clearSettings()});return p(n)},t.prototype._initialize=function(n){var t=this;this._managersDictionary={};this._managers=[this._baseManager];n&&n.forEach(function(n){t._managers.push(n.manager);n.stores.forEach(function(i){t._managersDictionary[i]=n.manager})})},t.prototype._getManager=function(n){return this._managersDictionary[n]||this._baseManager},t}(t);n.RoutingSettingsManager=
w;ai=function(n){function t(t){t===void 0&&(t=ui);n.call(this);this._didSettingsCallFail=!1;this._preloadStores=t}return __extends(t,n),t.prototype.queryStore=function(n){var i=this,t=f(n),r;return this._didSettingsCallFail?(h.error("Failed to query store '"+t+"'.",1),Q.resolve({})):(r=this._popPreloadPromise(t),r)?r.catch(function(r){return h.error(r,1,"Failed to preload store '"+t+"'."),i.queryStore(n)}):this._executeWithFallback({task:function(){return tt.postJSON({uri:dt},[t])},successCallback:function(n){return i._getRetryErrorExceeded=!1,et&&h.verbose("Retrieved the following settings from the server: {0}".format(s(n))),n&&n[t]||{}},makeMoreAttemptsCallback:function(){},failureCallback:function(n){return h.error("Get settings operation failed for store '"+t+"'.",1,n),i._fireEvent(e.useInMemorySettings,e.querySettingsCallFailed,v.Error),Q({})},attemptExceededCallback:function(){return i._getRetryErrorExceeded||(h.error(fi+" for store '"+t+"'.",1),i._getRetryErrorExceeded=!0),Q({})}
,actionName:"Get",eventName:t},1)},t.prototype._executeWithFallback=function(n,t){var r=this,i;return t<=ei?(i=a.startTrace({source:ft,action:n.actionName,name:n.eventName}),n.task().then(function(t){return a.completeTrace(i),n.successCallback(t)}).then(null,function(u){return a.cancelTrace(i),u.jqXHR&&u.jqXHR.status===0?(n.makeMoreAttemptsCallback(u,t),Q.delay(oi*(t+1)).then(function(){return r._executeWithFallback(n,t+1)})):(r._didSettingsCallFail=!0,n.failureCallback(u))})):(this._didSettingsCallFail=!0,n.attemptExceededCallback())},t.prototype.clearSettings=function(n){var i=this,t,r;return n===void 0&&(n=bt),this._clearPreloadPromises(),t=a.startTrace({source:ft,action:"Clear"}),r=k("clearallusersettings"),si({uri:gt,type:"GET",contentType:st,data:{removePersistent:r||!wt}}).then(function(){a.completeTrace(t)},function(){if(a.cancelTrace(t),n>1)return i.clearSettings(n-1);i._fireError(e.clearSettingsCallFailed)})},t.prototype.updateSettings=function(n){return this._didSettingsCallFail?
Q():p([this._makeCall(n.settingsToSet,"Set",ni,"PUT",et),this._makeCall(n.settingsToDelete,"Delete",kt,"POST",!1)])},t.prototype._makeCall=function(n,t,i,r,u){var s=this,f,e;return b(n)?Q():(f=yi(n),e=[],o(f,function(n){s._popPreloadPromise(n);e.push(n)}),this._makeAjaxCallInternal(f,i,t,r,e.join(","),u))},t.prototype._makeAjaxCallInternal=function(n,t,i,r,u,f){var e=this;return this._executeWithFallback({task:function(){return si({uri:t,type:r,data:s(n),contentType:st})},successCallback:function(){return e._setRetryErrorExceeded=!1,f&&h.verbose("Sent the following settings to the server: {0}".format(s(n))),Q()},makeMoreAttemptsCallback:function(){},failureCallback:function(n){return h.error("{0} Settings operation failed".format(i),2,n),e._fireError(),Q.reject(new Error(n.errorThrown||s(n)))},attemptExceededCallback:function(){return e._setRetryErrorExceeded||(h.error(g,2),e._setRetryErrorExceeded=!0),Q.reject(new Error(g))},actionName:i,eventName:u},1)},t.prototype._popPreloadPromise=
function(n){var t=this._preloadStores,i;return t&&(i=t[n],i)?(t[n]=null,Q(i)):null},t.prototype._clearPreloadPromises=function(){var n=this._preloadStores;return n&&o(n,function(t){n[t]=null}),null},t}(u);n.UserSettingsManagerImpl=ai;nt=function(n){function t(t,i,r,u){var f=this;n.call(this,null);this._primitiveSettingsManager=t;this._sequencer=i(pi,function(n){return f._executeMethod(n[0])},r,!0,{optionalDataInterval:u})}return __extends(t,n),t.createWithWriteDeleteBufferTimeout=function(n,i,r){var u=i!==undefined?i:ti,f=r!==undefined?r:ii;return new t(n,function(n,t,i,r,u){return new l.Debouncer(n,t,i,r,u)},u,f)},t.prototype.queryStore=function(n){return this._primitiveSettingsManager.queryStore(n)},t.prototype.setSettings=function(n,t){if(!b(n.settings)){var i={};i[n.store]=n.settings;this._sequencer.execute([{settingsToSet:i,settingsToDelete:{}}],t===r.Priority.Low)}},t.prototype.deleteSettings=function(n,t){n.keys&&n.keys.length&&this._sequencer.execute([{settingsToDelete:vt(n),settingsToSet:
{}}],t===r.Priority.Low)},Object.defineProperty(t.prototype,"eventsTriggered",{get:function(){return this._primitiveSettingsManager.eventsTriggered},enumerable:!0,configurable:!0}),t.prototype.flushSettings=function(){return this._sequencer.flush()},t.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally(function(){t._primitiveSettingsManager.clearSettings().finally(function(){n.resolve()})}),n.promise},t.prototype.dispose=function(){this.flushSettings();n.prototype.dispose.call(this)},t.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},t}(t);n.SequencingSettingsManager=nt;rt=function(n){function t(t){n.call(this,t);this._cache={};this._cachedStores={};this._activeQueryPromises={};this._activeUpdatePromises={};this._isSettingsVersionChecked=!1;this._isSettingsVersionVerified=!1;this._uniqueId=1}return __extends(t,n),t.prototype.queryStore=function(n){var i=this,t,r;return this._belongsToCache(n)?Q.resolve(
this._getSettingsFromCache(n)):(t=this._activeQueryPromises,r=t[n]||this._canCallBaseManager().then(function(r){if(!r||i._belongsToCache(n))return Q();if(t[n])return t[n];var u=Q(i._baseManager.queryStore(n)).then(function(t){return i._updateCaches(n,t),Q()});return t[n]=u,u}),r.then(function(){return i._getSettingsFromCache(n)}).finally(function(){t[n]=null}))},t.prototype.setSettings=function(n,t,i){this._execute(this._setSettingsInternal,n,t,i)},t.prototype._setSettingsInternal=function(n,t,i,r){var f=this,u=this._writeSettingsToCache(n,!0);r?(this._baseManager.setSettings(u,t),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed(function(){f._baseManager.setSettings(u,t)},i)},t.prototype._resolveSetPromise=function(n){this._activeUpdatePromises[n].resolve();delete this._activeUpdatePromises[n]},t.prototype._execute=function(n,t,i,r){var o=this,e=this._uniqueId++,u,f;this._activeUpdatePromises[e]=Q.defer();t&&(u=t.store,f=[t,i,e,r],this._belongsToCache(u)?n.apply(this,
f):this.queryStore(u).done(function(){n.apply(o,f)}))},t.prototype.deleteSettings=function(n,t){this._execute(this._deleteSettingsInternal,n,t)},t.prototype._deleteSettingsInternal=function(n,t,i){var r=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed(function(){r._baseManager.deleteSettings(n,t)},i)},t.prototype.clearSettings=function(){var t=this,i=this._baseManager?this._baseManager.clearSettings():Q(),n=Q.defer();return this.flushSettings().finally(function(){i.finally(function(){t._cache={};n.resolve()})}),n.promise},t.prototype.flushSettings=function(){var t=this,n=Object.keys(this._activeUpdatePromises).map(function(n){return t._activeUpdatePromises[parseInt(n)].promise});return n&&n.length?p(n).finally(function(){return t._baseManager.flushSettings()}):this._baseManager.flushSettings()},t.prototype._updateCaches=function(n,t){this._cachedStores[n]=!0;this._writeSettingsToCache({store:n,settings:t})},t.prototype._canCallBaseManager=function(){return this.
_isSettingsVersionChecked?Q.resolve(this._isSettingsVersionVerified):(this._settingsVerificationPromise||(this._settingsVerificationPromise=this._verifySettings()),this._settingsVerificationPromise)},t.prototype._canCallBaseManagerSync=function(){if(this._isSettingsVersionChecked)return this._isSettingsVersionVerified;throw new Error("_canCallBaseManagerSync has been called before completing async verification.");},t.prototype._verifySettings=function(){var n=this,t=c.General;return pt||!this._baseManager?(this._fireEvent(e.useInMemorySettings,this._baseManager?e.inMemorySettingsMode:e.noBaseManager,v.Warning),this._isSettingsVersionVerified=!1,this._isSettingsVersionChecked=!0,Q.resolve(!1)):Q(this._baseManager.queryStore(t)).then(function(i){var u=i[ot],f;return u?(f=l.getVersionFromString(u),f.revision=0,n._isSettingsVersionVerified=ut.compareTo(f)>=0):n._isSettingsVersionVerified=!0,n._isSettingsVersionChecked=!0,n._isSettingsVersionVerified?(n._updateCaches(t,i),n.setSettings(ci(t,
ot,d),r.Priority.Normal,!0),n._processGeneralSettings(i),Q.resolve(!0)):(n._fireEvent(e.useInMemorySettings,e.portalVersionMismatch.format(u,d),v.Warning),Q.resolve(!1))})},t.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){this._canCallBaseManagerSync()&&n();this._resolveSetPromise(t)},t.prototype._deleteSettingsFromCache=function(n){var t=this._cache[n.store];n.keys&&t&&n.keys.forEach(function(n){delete t[n]})},t.prototype._getSettingsFromCache=function(n){return this._cache[n]||(this._cache[n]={}),this._cache[n]},t.prototype._belongsToCache=function(n){return!!this._cachedStores[n]},t.prototype._writeSettingsToCache=function(n,t){var i,r;return n?(i=this._cache[n.store],i||(i=this._cache[n.store]={}),r={},o(n.settings,function(n,u){t&&(i[n]===u||s(i[n])===s(u))||(i[n]=u,r[n]=u)}),{store:n.store,settings:r}):null},t.prototype._processGeneralSettings=function(n){var t=[];o(n,function(n){wi(n)||t.push(n)});this.deleteSettings({store:c.General,keys:t})},t}(t);n.CachingSettingsManagerImpl=
rt;ht=function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.queryStore=function(n,t){return this._baseManager.queryStore(n).then(function(n){return t?n:ct(n)})},t.prototype.querySettings=function(n){return n.keys&&n.keys.length>0?this.queryStore(n.store,!0).then(function(t){var i={},r;return t&&(r=n.keys.filter(function(n){return n in t}),r.forEach(function(n){i[n]=t[n]})),ct(i)}):this.queryStore(n.store)},t.prototype.querySetting=function(n,t){return this.querySettings({store:n,keys:[t]}).then(function(n){if(n){var i=n[t];return i===undefined?null:i}return null})},t.prototype.setSettings=function(n,t){this._baseManager.setSettings(ct(n),t)},t.prototype.setSetting=function(n,t,i,r){this.setSettings(ci(n,t,i),r)},t.prototype.deleteSettings=function(n,t){this._baseManager.deleteSettings(n,t)},t.prototype.clearSettings=function(){return this._baseManager.clearSettings()},t}(t);n.ExtendedSettingsManager=ht}(w=t.Internal||(t.Internal={}))}(e||(e={})),e});define("MsPortalImpl/Interactions/Interactions.DismissHandler",
["require","exports","f"],function(n,t,i){"use strict";var r;return function(t){function k(n,t){s.error("An error occurred on dismiss. Unregister might have been forgotten on cleanup of the dismissable element. DismissHandle log name: {0}".format(t&&t.logName||"unknown"),0,n)}function d(n){var i="function",t=!!n;return n.shouldDismissOnFocusOutFn&&(t=t&&typeof n.shouldDismissOnFocusOutFn===i),n.restoreFocus&&(t=t&&typeof n.restoreFocus===i),t}function f(n){var t="function",i=n&&typeof n.dismissFn===t&&typeof n.shouldDismissOnMouseDownFn===t&&typeof n.shouldDismissOnMouseWheelFn===t&&d(n);return i||s.error("The dismiss handle object is null or malformed."),i}function o(n){var r,i,t;if(u.length)for(r=u[u.length-1],i=r.length-1;i>=0;i--){t=r[i];try{n(t)&&(t.dismissFn(),t.restoreFocus&&t.restoreFocus())}catch(f){k(f,t)}}}function a(n){o(function(t){return t.shouldDismissOnFocusOutFn?f(t)&&t.shouldDismissOnFocusOutFn(n.target):!1})}function v(n){n.keyCode===27&&o(function(n){return f(n)})}function e(
n){o(function(t){return f(t)&&t.shouldDismissOnMouseDownFn(n.target,n)})}function y(n){h||(h=!0,b.setTimeout(function(){h=!1},250),o(function(t){return f(t)&&t.shouldDismissOnMouseWheelFn(n.target)}))}function p(n){o(function(t){return f(t)&&t.shouldDismissOnMouseWheelFn(n.target)&&t.shouldDismissOnScroll})}function g(){var n=l.body;n.addEventListener(r.focus,a,!0);n.addEventListener(r.keydown,v,!0);n.addEventListener(r.mousedown,e,!0);n.addEventListener(r.touchstart,e,!0);n.addEventListener(r.pointerdown,e,!0);n.addEventListener(r.mousewheel,y,!0);n.addEventListener(r.scroll,p,!0)}function nt(){var n=l.body;n.removeEventListener(r.focus,a,!0);n.removeEventListener(r.keydown,v,!0);n.removeEventListener(r.mousedown,e,!0);n.removeEventListener(r.touchstart,e,!0);n.removeEventListener(r.pointerdown,e,!0);n.removeEventListener(r.mousewheel,y,!0);n.removeEventListener(r.scroll,p,!0);u.length=0}function tt(n,t){if(!f(n))throw new Error("The dismiss handle object is null or malformed.");u.some(
function(t){return t.indexOf(n)>=0})||((t||!u.length)&&u.push([]),u.last().push(n))}function it(n){u.forEach(function(t){t.remove(n)});u=u.filter(function(n){return n.length!==0})}function rt(n,t){var i="DismissHandle for '"+n.logName+"': previouslyFocusedElement";if(t){if(typeof t.focus!="function")return s.error(i+" focus member is not a function. _previouslyFocusedElement.focus: "+t.focus),!1}else return s.warning(i+" was not defined."),!1;return!0}var c=i.Base,w=c.Diagnostics,r=c.EventTypes,b=window,l=document,ut=jQuery,s=w.createLog(n),h=!1,u=[];t.initialize=g;t.dispose=nt;t.register=tt;t.unregister=it;t.validatePreviousFocusedElement=rt}(r||(r={})),r});define("MsPortalImpl/Services/Services.EditScopeManagement",["require","exports","f","./Services.Settings"],function(n,t,i,r){"use strict";var u;return function(n){function tt(n,t){return new e(n,t,w.client)}function y(n,t){return"{0}-{1}-{2}".format(l,n,t)}function o(n){return"{0}-{1}".format(l,n)}function s(n){var t=n.split("-"),
i=t.slice(1,t.length-1).join("-"),r=t[t.length-1];return{editScopeId:i,extension:r}}var h=FxImpl,t=h.Data,c=h.Extension,p=i.Base,w=p.Rpc.Internal,b=r.SettingStore,l="editScopes",k=t.saveSerializedEditScopeEndPoint,d=t.loadSerializedEditScopeEndPoint,g=t.onEditScopeDiscardedEndPoint,nt=t.updateEditScopeIsSavingStateEndPoint,u=b.EditScopeSession,a=ko.observable,v=ko.observableArray,f,e;(function(n){n[n.NotDirty=0]="NotDirty";n[n.Dirty=1]="Dirty";n[n.DirtyAndSaving=2]="DirtyAndSaving"})(n.EditScopeState||(n.EditScopeState={}));f=n.EditScopeState;n.createEditScopeManager=tt;e=function(){function n(n,t,i){var r=this;this._editScopes={};this._settingsManager=n;this._extensionManager=t;this._rpcClient=i;d.register(i,null,function(n,t){var i=t.srcWindowId;return r.loadEditScopeForExtension(n,i)});k.register(i,null,function(n,t){var i=t.srcWindowId;r.saveEditScopeForExtension(n.editScopeId,i,n.edits)});nt.register(i,null,function(n,t){var i=t.srcWindowId;r.updateEditScopeIsSavingStateForExtension(
n.editScopeId,i,n.isSaving)});t.onUnload(function(n){var t=c.getWindowId(n);return r._onExtensionUnloaded(t),!0})}return n.prototype.onEditScopeCreated=function(n){this._ensureEditScope(n,!0)},n.prototype.onEditScopeDisposed=function(n){var t=this,i=this._getDirtyExtensionSettings(n);i.forEach(function(i){var f=s(i.key).extension,u=c.getDescriptor(f),r=t._extensionManager.getExtension(u.name,u.cloudName);r&&r.isExtensionLoadedAsync().then(function(){g.invoke(t._rpcClient,r.getWindowId(),n)})});this._deleteEditScope(n)},n.prototype.getStateObservable=function(n){var r=this,t=this._ensureEditScope(n),i;return t.stateObservable||(i=a(),t.stateObservable=ko.computed(function(){i();var u=r._getDirtyExtensionSettings(n).length>0;return u?t.savingRefCount()>0?f.DirtyAndSaving:f.Dirty:f.NotDirty}),this._loadEditScope(n).then(function(){i(!0)})),t.stateObservable},n.prototype.logEditsToConsole=function(n){var i=this._editScopes[n]&&this._editScopes[n].settings;i&&i.extensionSettings().forEach(function(
n){var i=s(n.key);console.debug('Edits for editScopeId: {0}, extension: "{1}"'.format(i.editScopeId,i.extension));t.logEditsToConsole(n.settings)})},n.prototype.loadEditScopeForExtension=function(n,t){var i=this;return this._loadEditScope(n).then(function(){var f=i._editScopes[n],r,e,u;return f?(r=f.settings,r?(e=y(n,t),u=r.extensionSettings().first(function(n){return n.key===e}),u?u.settings:null):null):null})},n.prototype.saveEditScopeForExtension=function(n,t,i){var r=this._editScopes[n],e,f,s,h;this._canEditScopeBeUpdated(r)&&(f=y(n,t),s=r.settings.extensionSettings().firstIndex(function(n){return n.key===f}),s<0?r.settings.extensionSettings.push({key:f,settings:i}):(h=r.settings.extensionSettings()[s],h.settings=i,r.settings.extensionSettings.splice(s,1,h)),e={},e[f]=i,r.settings.keys.indexOf(f)<0&&(r.settings.keys.push(f),e[o(n)]=r.settings.keys),this._settingsManager.setSettings({store:u,settings:e}))},n.prototype.updateEditScopeIsSavingStateForExtension=function(n,t,i){var r=this.
_editScopes[n],u;r&&(u=r.savingRefCount()||0,i?r.savingRefCount(u+1):u>0&&r.savingRefCount(u-1))},n.prototype._canEditScopeBeUpdated=function(n){if(!n)return!1;var t=n.loadPromise;return!t||t.state&&t.state()!=="resolved"||t.inspect&&t.inspect().state!=="fulfilled"?!1:!0},n.prototype._deleteEditScope=function(n){var t=[o(n)],i=this._editScopes[n],r=i&&i.settings;r&&r.extensionSettings().forEach(function(n){t.push(n.key)});this._settingsManager.deleteSettings({store:u,keys:t});delete this._editScopes[n]},n.prototype._loadEditScope=function(n){var t=this._ensureEditScope(n);return t.justCreated&&(t.settings={keys:[],extensionSettings:v([])},t.loadPromise=Q(),t.justCreated=!1),t.loadPromise||(t.loadPromise=this._getAndProcessSettings(n)),t.loadPromise},n.prototype._getAndProcessSettings=function(n){var t=this,i=o(n);return this._settingsManager.querySetting(u,i).then(function(r){return r&&r.length?t._settingsManager.querySettings({store:u,keys:r}).then(function(u){return t._processSettings(
u,r,n,i),undefined}):(t._processSettings({},[],n,i),undefined)})},n.prototype._processSettings=function(n,t,i){var r,u;if(this._editScopes[i]){r=[];this._editScopes[i].settings={keys:t,extensionSettings:v(r)};for(u in n)r.push({key:u,settings:n[u]})}},n.prototype._getDirtyExtensionSettings=function(n){var t=this._editScopes[n]&&this._editScopes[n].settings,i=t&&t.extensionSettings().filter(function(n){var t=n.settings;return t&&t.edits.length>0});return i||[]},n.prototype._onExtensionUnloaded=function(n){var i,t,r,u;for(i in this._editScopes)t=this._editScopes[i],r=t.savingRefCount()>0,r&&(u=t.settings&&t.settings.extensionSettings().some(function(t){return n===s(t.key).extension&&t.settings.edits.length>0}),u&&(this._clearEditScopeEdits(i),t.savingRefCount(0)))},n.prototype._clearEditScopeEdits=function(n){var i=this._editScopes[n],t,r;this._canEditScopeBeUpdated(i)&&(t=i.settings&&i.settings.extensionSettings,r={},t().forEach(function(n){n.settings=null;r[n.key]=null}),t(t()),this._settingsManager.
setSettings({store:u,settings:r}))},n.prototype._ensureEditScope=function(n,t){t===void 0&&(t=!1);var i=this._editScopes[n];return i||(i=this._editScopes[n]={savingRefCount:a(0),justCreated:t}),i},n}();n.EditScopeManagerImpl=e}(u||(u={})),u});define("MsPortalImpl/Extension/AddCloudName",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function ut(n,t){h.multiCloudEnabled&&(n.name===r?ot(n):lt(n,t))}function ft(n,t){h.multiCloudEnabled&&(n.name===r?st(t):at(n,t))}function et(n,t){h.multiCloudEnabled&&(n.name===r?ht(t):d(n,t))}function ot(n){y(n.startBoardParts,rt);var t=n.commandGroups||[];t.forEach(function(n){w(n.commands)});w(n.commandsCatalog)}function st(n){n.effectiveInputs||(n.viewModelInputs=f(n.viewModelInputs,u));n.inputs=c(n.inputs);n.templateKeyInputs=c(n.templateKeyInputs);b(n.commandGroupReference,u);var t=n.lenses||[];t.forEach(function(n){y(n.partInstances,u)});n.actionBar&&(n.actionBar.bindings=f(n.actionBar.bindings,u))}function y(n,t){n&&
n.forEach(function(n){n.inline?p(n.inline,t):n.reference.bindings=f(n.reference.bindings,t)})}function ht(n){p(n,u)}function p(n,t){n.inputs=c(n.inputs);n.bindings=f(n.bindings,t);k(n.details||[],e.Part);b(n.commandGroupReference,t)}function w(n){(n||[]).forEach(function(n){n.bindings=f(n.bindings,u);n.commandKind===v.CommandKind.Blade&&k([n.details],e.Command)})}function b(n,t){n&&(n.commands||[]).forEach(function(n){n.bindings=f(n.bindings,t)})}function f(n,t){var i=n||[];return i.push(t),i}function c(n){var i=n||[];return i.some(function(n){return n===t})||i.push(t),i}function k(n,i){var u={property:t,valuesFrom:[{referenceType:i,property:"internal."+tt.internalCloudNamePropertyName}]};n.forEach(function(n){if(n.blade&&(!n.bladeExtension||n.bladeExtension===r)){var t=n.additionalInputArguments=n.additionalInputArguments||[];t.push(u)}})}function ct(n){return{property:t,valuesFrom:[{constantValue:n,referenceType:e.Constant,property:t}]}}function lt(n,t){t.referencesToHubsCommands={};
(n.commandGroups||[]).forEach(function(n){(n.commands||[]).forEach(function(n){n.reference&&n.reference.extension===r&&(t.referencesToHubsCommands[n.name]=!0,n.bindings=o(n.bindings,t.cloudName))})});g(t,n.startBoardParts);(n.partsCatalog||[]).forEach(function(n){d(t,n)})}function d(n,t){var i=t.reference;i?i.extension===r&&(i.bindings=o(i.bindings,n.cloudName)):l(n,t.commandGroupReference)}function at(n,t){l(n,t.commandGroupReference);var i=t.lenses||[];i.forEach(function(t){g(n,t.partInstances)})}function g(n,t){(t||[]).forEach(function(t){var i=t.reference;i?i.extension===r&&(i.bindings=o(i.bindings,n.cloudName)):l(n,t.inline.commandGroupReference)})}function l(n,t){(t&&t.commands||[]).forEach(function(t){n.referencesToHubsCommands[t.name]&&(t.bindings=o(t.bindings,n.cloudName))})}function o(n,t){var i=n||[];return i.push(ct(t)),i}var s=FxImpl,nt=s.Constants.CloudName,h=s.Extension,tt=s.ViewModels,a=i.Base.Constants,it=a.ExtensionNames.Hubs,v=i.Extension,e=v.ReferenceType,t=nt.inputBindingKey,
r=it,rt={property:t,valuesFrom:[{constantValue:a.DefaultCloudName,referenceType:e.Constant,property:t}]},u={property:t,valuesFrom:[{referenceType:e.BladeInput,property:t}]};n.addCloudName=ut;n.processBlade=ft;n.processPart=et}(r||(r={})),r});define("MsPortalImpl/ViewModels/ViewModels.BladeCaller",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function e(i,r,f){var o=r.additionalInputArguments=r.additionalInputArguments||[],e;r.outputArguments=r.outputArguments||[];e=i+u;o.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:f,property:e+n.bindingName_bladeCallId}]});o.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:f,property:e+n.bindingName_bladeCallerParams}]});r.outputArguments.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:t.BladeInput,property:n.bindingName_bladeCallerResult}]})}function o(t){t.inputs=t.inputs||[];t.inputs.push(n.bindingName_bladeCallId,n.bindingName_bladeCallerParams)}
function s(i,r,f,e){var s=r.inputs=r.inputs||[],o;if(r.outputs=r.outputs||[],r.bindings=r.bindings||[],e.inline)o=e.inline.bindings=e.inline.bindings||[];else if(e.reference)o=e.reference.bindings=e.reference.bindings||[];else throw new Error("Part is neither inline nor a reference, so cannot add blade callable bindings");s.push(n.bindingName_bladeCallId);o.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:t.BladeInput,property:n.bindingName_bladeCallId}]});s.push(n.bindingName_bladeCallerParams);o.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:t.BladeInput,property:n.bindingName_bladeCallerParams}]});r.outputs.push(n.bindingName_bladeCallerResult);r.bindings.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:t.Part,property:i+u+n.bindingName_bladeCallerResult,part:f}]})}var f=i.Extension,t=f.ReferenceType,r="internal_",u=".";n.bindingName_bladeCallId=r+"bladeCallId";n.bindingName_bladeCallerParams=r+"bladeCallerParams";
n.bindingName_bladeCallerResult=r+"bladeCallerResult";n.addBladeCallerBindings=e;n.addBladeCallablePartInputs=o;n.addBladeCallableBindings=s}(r||(r={})),r});define("MsPortalImpl/Extension/DefinitionPreprocessor",["require","exports","f","../Base/Base.KnockoutTemplateSanitizer","./AddCloudName","../ViewModels/ViewModels.BladeCaller"],function(n,t,i,r,u,f){"use strict";var e;return function(n){function ht(n,t){r.sanitizeDefinition(n,h);var i=n;return u.addCloudName(n,t),i.partTypeMap=i.partTypeMap||{},i.bladeMap=i.bladeMap||{},(i.partsCatalog||[]).forEach(function(n){return d(i,t,n)}),(i.blades||[]).forEach(function(n){return g(i,t,n)}),vt(n),i}function ct(n,t,i){if(!n.requireConfig)throw new Error("requireConfig is not provided. Extension's requireConfig must be set to fetch the custom control from the extension");return i.requireConfig=n.requireConfig,i}function d(n,i,f){return f.processed?f:(n.partTypeMap[f.name.toLowerCase()]=f,f.assetTypeDefinition=(i.assetTypes||[]).first(function(
n){return n.partName===f.name}),nt(f.name,f),e(f.details,t.Part),f.parameterProvider&&it(f),u.processPart(i,f),bt(n,f),r.sanitizeInlineTemplate(n.name,f.name,f,h),f.processed=!0,f)}function g(n,t,i){if(i.processed)return i;i.templateBlade&&wt(i);i.menuBlade&&at(n,i);n.bladeMap[i.name.toLowerCase()]=i;i.assetTypeDefinition=(t.assetTypes||[]).first(function(n){return n.bladeName===i.name});yt(i);u.processBlade(t,i);i.effectiveInputs||(i.effectiveInputs=i.viewModelInputs||[]);var f=lt(i);return n.partTypeMap[f.name.toLowerCase()]=f,(i.lenses||[]).forEach(function(n){(n.partInstances||[]).forEach(function(n){var t=n.inline;t&&nt(n.name,t)})}),r.sanitizeBladeDefinition(n.name,i,h),i.processed=!0,i}function nt(n,t){if(p["*"]||p[n.toLowerCase()]){var i=t.options=t.options||{};i.useFrame=!0}}function lt(i){var u=n.PinPrefix+i.name,r;return i.pinnedPart||(i.pinnedPart=u),r={name:u,viewModel:n.PinVMPrefix+i.name,partKind:a.Button,inputs:i.inputs,initialSize:s.Normal,details:[{blade:i.name,isMultiple:
!1,invocationInputArguments:[{valuesFrom:[{property:"container.selectable.value",referenceType:t.Part}]}],additionalInputArguments:[]}],bindings:[],viewStateProperties:["container.selectable.isSelected"],commandGroup:i.commandGroup,commandGroupReference:i.commandGroupReference,assetIdInputProperty:i.assetIdInputProperty,assetType:i.assetType},(i.inputs||[]).forEach(function(n){r.bindings.push({property:c+n,valuesFrom:[{property:n,referenceType:t.BladeInput}]})}),(i.optionalInputs||[]).forEach(function(n){n!==rt.ReferrerInfo&&r.bindings.push({property:c+n,optional:!0,valuesFrom:[{property:n,referenceType:t.BladeInput}]})}),i.viewModelInputs&&i.viewModelInputs.forEach(function(n){n.property===i.assetIdInputProperty&&r.bindings.push(n)}),r}function o(n,i,r){i&&i.forEach(function(i){n.inputs.push(i);n.bindings.push({property:i,optional:r,valuesFrom:[{referenceType:t.BladeInput,property:i}]})})}function tt(n,t,i,r,u,f,e,o){return{name:n,inline:{bindings:[],details:[],inputs:[],partKind:a.Custom,
viewModel:t.viewModelName,htmlTemplate:i,htmlTemplateInline:r,assetType:t.assetType,assetIdInputProperty:t.assetIdInputProperty,initialSize:u,viewStateProperties:[],shareVmWithParentBlade:!0,partState:f,styleSheets:o},parameterProvider:e}}function at(n,t){var u=t.name,r=tt(u,t,undefined,{content:"<div data-bind='pcControl: menu' class='ext-menublade-part'><\/div>",file:u+i.getUniqueId()},s.FitToContainer,undefined,!1,[]),f;o(r.inline,t.inputs);o(r.inline,t.optionalInputs,!0);f={name:u,partInstances:[r]};t.lenses.splice(0,0,f);t.effectiveInputs=r.inline.bindings;i.isNullOrUndefined(t.pinnable)&&(t.pinnable=!0)}function vt(n){n.startBoardParts&&n.startBoardParts.forEach(function(n){n.inline&&e(n.inline.details,t.Part)});n.commandsCatalog&&n.commandsCatalog.forEach(function(n){e([n.details],t.Command)});n.commandGroups&&n.commandGroups.forEach(function(n){n.commands&&n.commands.forEach(function(n){e([n.details],t.Command)})})}function yt(n){n.lenses&&n.lenses.forEach(function(i){i.partInstances&&
i.partInstances.forEach(function(i){i.inline&&(i.parameterProvider&&it(i.inline),e(i.inline.details,t.Part));pt(n,i.name,i)})})}function e(n,t){n&&n.filter(function(n){return n&&!!n.parameterCollector}).forEach(function(n){f.addBladeCallerBindings(n.parameterCollector+".bladeCaller",n,t)})}function it(n){n.editScopeType=n.editScopeType||"PDLEditScope";n.inputs=n.inputs||[];n.inputs.push(v);f.addBladeCallablePartInputs(n)}function pt(n,i,r){if(r.parameterProvider&&(f.addBladeCallableBindings(y+".bladeCallable",n,i,r),n.actionBar)){n.actionBar.bindings=n.actionBar.bindings||[];var u=n.actionBar.bindings.some(function(n){return n.property==="input"});u||n.actionBar.bindings.push({property:"input",valuesFrom:[{referenceType:t.Part,part:i,property:y+".defaultActionBarInput"}]});n.templateBlade||(r.inline||r.reference).bindings.push({property:v,valuesFrom:[{referenceType:t.BladeActionBar,property:"content.output"}]})}}function wt(n){var r=n.templateBlade,f=tt("TemplateBladeVirtualPart",n,r.htmlTemplate,
r.htmlTemplateInline,r.partSize?r.partSize:s.FullWidthFitHeight,r.partState,r.parameterProvider,r.styleSheets),u,e;n.lenses=n.lenses||[];n.lenses.push({name:"TemplateBladeVirtualLens",partInstances:[f]});n.locked=!0;u=f.inline;o(u,n.inputs);o(u,n.optionalInputs,!0);e=n.effectiveInputs=u.bindings;n.outputs&&n.outputs.forEach(function(i){n.bindings=n.bindings||[];n.bindings.push({property:i,valuesFrom:[{referenceType:t.Part,property:"content."+i,part:f.name}]})});n.editScopeType&&e.push({property:"editScopeId",valuesFrom:[{referenceType:t.BladeInput,property:"editScopeId"}]});n.actionBar&&(n.actionBar.source={valuesFrom:[{referenceType:t.Part,part:f.name,property:"content.actionBar"}]});n.toolbar&&(n.toolbar.source={valuesFrom:[{referenceType:t.Part,part:f.name,property:"content.commandBar"}]});u.details=r.details;(u.options=u.options||{}).useFrame=r.hasCustomControls&&i.isFeatureEnabled("customcontrols")}function bt(n,i){var r=i.reference,f,u,e;r&&(f=r.partTypeName===st&&(r.extension===
w||!r.extension&&n.name===w),f&&(u=r.bindings,e=u.first(function(n){return n.property===b}),e||(u.push({property:b,valuesFrom:[{referenceType:t.AdapterInput,property:k}],optional:!0}),i.inputDefinitions.push({name:k,type:ft.TimeRangeValueType,optional:!0}))))}var rt=i.Base.Constants.BladeParameterNames,ut=i.Extension,t=ut.ReferenceType,l=i.Parts,a=l.PartKind,s=l.PartSize,ft=i.Composition.Configuration,et=window,v="internal_parameterProviderActionBarOutput",y="content.parameterProvider",ot=i.getFeatureValue("iframecustomparts"),p=function(){var n={};return(ot||"").toLowerCase().split(",").forEach(function(t){return n[t]=!0}),n}(),h=et.fx.environment.isDevelopmentMode?1:0;n.PinPrefix="InferredBladePinPart";n.PinVMPrefix="Shell."+n.PinPrefix;var c="inferredBladePinPartInputs.",kt="content."+c,w="Microsoft_Azure_Insights",st="MetricsSummaryPart",b="timeRange",k="_msPortalFxTimeRange";n.preprocessDefinition=ht;n.processControl=ct;n.processPart=d;n.processBlade=g}(e||(e={})),e});define("MsPortalImpl/Extension/Extension.Definition.Locator",
["require","exports","f","i","../Extension/DefinitionPreprocessor"],function(n,t,i,r,u){"use strict";var f;return function(t){function c(n,t){for(var u=[],i=n,r;i;)u.unshift(i.getCacheKeyPart()),i=i.parent;return r=u.join("-"),t||(r=r.toLowerCase()),r}function ft(n,t){for(var r=[],i=n;i;)r.unshift(i.getCacheFriendlyKeyPart(t)),i=i.parent;return r.join(t)}function b(n,t){return n.definition.partTypeMap[t.toLowerCase()]}function a(n,t){var i="<InvalidJsonString>";try{i=JSON.stringify(t)}catch(r){}return p.error("{0} JSON: {1}".format(n,i)),s.forExtension("##ErrorDeserializingLocator##-{0}".format(i),h.EmptyCloudName)}function et(n,t,i,r){var u=rt.buildResourceTypeFromResourceId(t);return d(n,u,i,r)}function d(n,t,i,r){var f=t.toLowerCase(),u=n.getExtensions().some(function(n){var t=n.manifest&&o.isEqualCloudName(n.cloudName,r)&&n.manifest.assetTypes.first(function(n){return n.resourceType&&n.resourceType.resourceTypeName&&n.resourceType.resourceTypeName.toLowerCase()===f&&n.browseType!==
y.ServiceLink&&n.browseType!==y.InstanceLink});return t&&(i.extensionName=n.name,i.cloudName=n.cloudName,i.value=t),!!t});return u||(i.error="Unable to locate extension for resource type '{0}'.".format(t),i.value=null),u}var o=r.Extension,v=i.Base,h=v.Constants,tt=v.Diagnostics,it=i.Extension,y=it.BrowseType,rt=i.ViewModels.Services.ResourceTypes,e={extensionNotFound:"Unable to locate extension '{0}'.",bladeNotFound:"Unable to locate blade '{0}' in extension definition.",actionBarNotFound:"Unable to locate action bar '{0}' in extension definition.",partInstanceNotFound:"Unable to locate part instance '{0}' in extension definition.",partTypeNotFound:"Unable to locate part type '{0}' in extension definition.",commandTypeNotFound:"Unable to locate command type '{0}' in extension definition.",lensNotFound:"Unable to locate lens '{0}' in extension definition.",assetTypeNotFound:"Unable to locate asset type '{0}' in extension definition.",commandGroupNotFound:"Unable to locate command group '{0}' in extension definition.",
commandNotFound:"Unable to locate command '{0}' in extension definition.",hubNotFound:"Unable to locate hub '{0}' in extension definition."},p=tt.createLog(n),ut="{0} Search path:'{1}'.",w=u.PinPrefix,f,s,l,k,g,nt;(function(n){n[n.Extension=0]="Extension";n[n.Blade=1]="Blade";n[n.Lens=2]="Lens";n[n.AssetType=3]="AssetType";n[n.CommandGroup=4]="CommandGroup";n[n.PartInstance=5]="PartInstance";n[n.PartType=6]="PartType";n[n.StartboardPartInstance=7]="StartboardPartInstance";n[n.BladeActionBar=8]="BladeActionBar";n[n.Command=9]="Command";n[n.ExtensionManifest=10]="ExtensionManifest";n[n.Hub=11]="Hub";n[n.CustomLens=12]="CustomLens";n[n.CommandType=13]="CommandType";n[n.BladeRedirect=14]="BladeRedirect"})(t.LocatorType||(t.LocatorType={}));f=t.LocatorType;s=function(){function n(n,t,i,r,u,f,e){this.type=n;this.name=t;this.parent=u;this.enumerate=i;this.getValue=f;this.getValueAsync=e;this.errorMessageFormat=r}return n.forExtensionManifest=function(n,t){return new l(f.ExtensionManifest,n,t,
function(n){return n.getExtensions()||[]},e.extensionNotFound)},n.forExtension=function(n,t){return new l(f.Extension,n,t,function(n){return n.getInitializedExtensions()},e.extensionNotFound)},n.fromJSON=function(t){if(!t||typeof t!="object")return a("Locator object is invalid.",t);var i=t.parent?n.fromJSON(t.parent):null,r=f[t.type],u="with{0}".format(r);if(!i&&t.type!==f.Extension&&t.type!==f.ExtensionManifest)return a("Locator with name '{0}' has no parent.".format(t.name),t);switch(t.type){case f.Extension:return n.forExtension(t.name,t.cloudName);case f.ExtensionManifest:return n.forExtensionManifest(t.name,t.cloudName);default:return u in i?i[u](t.name):a("Unknown locator type: {0}.".format(r),t)}},n.prototype.getCacheKeyPart=function(){return"[{0}]{1}".format(this.type,this.name)},n.prototype.getCacheFriendlyKeyPart=function(n){return n===void 0&&(n="/"),"{0}{1}{2}".format(f[this.type],n,this.name)},n.prototype.withBlade=function(t){return new n(f.Blade,t,undefined,e.bladeNotFound,
this,function(n,t){return n.definition.bladeMap[t.toLowerCase()]},function(n){return n.getBladeDefinition(t)})},n.prototype.withPartInstance=function(t){return new n(f.PartInstance,t,function(n){return n.partInstances},e.partInstanceNotFound,this)},n.prototype.withBladeActionBar=function(t){return new n(f.BladeActionBar,t,function(n){return n.actionBar?[n.actionBar]:[]},e.actionBarNotFound,this)},n.prototype.withStartboardPartInstance=function(t){return new n(f.StartboardPartInstance,t,function(n){return n.definition.startBoardParts},e.partInstanceNotFound,this)},n.prototype.withPartType=function(t){return new n(f.PartType,t,undefined,e.partTypeNotFound,this,b,function(n){if(i.startsWith(t,w)){var r=t.substr(w.length);return n.getBladeDefinition(r).then(function(){return b(n,t)})}return n.getPartDefinition(t)})},n.prototype.withCommandType=function(t){return new n(f.CommandType,t,function(n){return n.definition.commandsCatalog},e.commandTypeNotFound,this)},n.prototype.withLens=function(
t){return new n(f.Lens,t,function(n){return n.lenses},e.lensNotFound,this)},n.prototype.withCustomLens=function(t){return new n(f.CustomLens,t,function(){return[{name:t,partInstances:[]}]},"N/A",this)},n.prototype.withAssetType=function(t){return new n(f.AssetType,t,function(n){return n.manifest.assetTypes},e.assetTypeNotFound,this)},n.prototype.withBladeRedirect=function(t){return new n(f.BladeRedirect,t,null,e.assetTypeNotFound,this,function(n){return n.getBladeRedirect(t)})},n.prototype.withCommandGroup=function(t){return new n(f.CommandGroup,t,function(n){return n.definition.commandGroups},e.commandGroupNotFound,this)},n.prototype.withCommand=function(t){return new n(f.Command,t,function(n){return n.commands},e.commandNotFound,this)},n.prototype.withHub=function(t){return new n(f.Hub,t,function(n){return n.manifest.hubs},e.hubNotFound,this)},n.prototype.getExtensionLocator=function(){for(var t=this;t.parent;)t=t.parent;return t.type===f.ExtensionManifest?n.forExtension(t.name,t.cloudName):
t},n.prototype.toString=function(){return c(this,!0)},n.prototype.toFriendlyString=function(n){return n===void 0&&(n="/"),ft(this,n)},n.prototype.equals=function(n){if(this.name&&n&&n.name&&this.name===n.name&&this.type===n.type){if(this.parent)return this.parent.equals(n.parent);if(!n.parent)return!0}return!1},n.prototype.toJSON=function(){return{name:this.name,type:this.type,parent:this.parent&&this.parent.toJSON()}},n.prototype.readFromIdentifiable=function(n){this.name=n.name},n}();t.Locator=s;l=function(n){function t(t,i,r,u,f){n.call(this,t,i,u,f);this.getValueAsync=function(n){return n.getExtensionByName(i,r)};this.cloudName=r}return __extends(t,n),t.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return t.cloudName=this.cloudName,t},t.prototype.getCacheKeyPart=function(){var n=o.getWindowId(this);return"[{0}]{1}".format(this.type,n)},t.prototype.getCacheFriendlyKeyPart=function(n){n===void 0&&(n="/");var t=o.getWindowId(this);return"{0}{1}{2}".format(f[this.type],
n,t)},t.prototype.equals=function(n){return this.name&&n&&o.isEqualDescriptor(this,n)&&this.type===n.type},t.prototype.readFromIdentifiable=function(n){this.name=n.name;this.cloudName=n.cloudName},t}(s);t.ExtensionLocator=l;k=function(){function n(n,t){this._extensionManager=n;this._cache=t||{}}return n.populateCache=function(n,t,i){return n[c(t)]=i,n},n.prototype.locateAsync=function(n){var o=this,r=i.Helpers.Deferred(),t={},s=n.getExtensionLocator(),f,e,u;return this.tryLocate(n,t)?r.resolve(t.value):(f=void 0,u=n.parent,u?(f=Q(this.locateAsync(u)),e=u.errorMessageFormat.format(u.name)):f=Q(this._extensionManager),f.then(function(i){if(e=n.errorMessageFormat.format(n.name),o.tryLocate(n,t))return t.value;if(n.getValueAsync)return n.getValueAsync(i).catch(function(n){return Q.reject(n.message)});throw t.error;}).then(function(){o.tryLocate(n,t)?r.resolve(t.value):r.reject(t.error)}).catch(function(n){typeof n=="string"?r.reject(n):r.reject(e)})),r.promise()},n.prototype.locate=function(
n){var t={},i=null;return this.tryLocate(n,t)?i=t.value:p.error(t.error),i},n.prototype.tryLocate=function(n,t){var r=c(n),u,i={},e=!1,f,o;return this._cache.hasOwnProperty(r)||(n.parent?this.tryLocate(n.parent,i):i.value=this._extensionManager,i.value&&(n.getValue?(f=n.getValue(i.value,n.name),f!==undefined&&(this._cache[r]=f)):(o=n.enumerate(i.value),this._fillCacheFromArray(o,n)))),u=this._cache[r],u?(t.value=u,e=!0):(t.error=ut.format(n.errorMessageFormat.format(n.name),n.toString()),i.error&&(t.error=i.error+"\n"+t.error)),e},n.prototype._fillCacheFromArray=function(n,t){var r=this,i=ko.toJS(t);n&&n.forEach(function(n){i.readFromIdentifiable(n);var t=c(i);r._cache[t]=n})},n}();t.DefinitionFinderImpl=k;t.tryLocateAssetDefinitionFromResourceId=et;t.tryLocateAssetDefinitionFromResourceType=d;g=o.multiCloudEnabled?h.DefaultCloudName:null;nt=h.BladeNames.Hubs.ResourceMenuBlade;t.hubsLocator=s.forExtension(h.ExtensionNames.Hubs,g);t.resourceMenu=t.hubsLocator.withBlade(nt)}(f||(f={})),f}
);define("MsPortalImpl/UI/Compositions/UI.Composition",["require","exports","f","../../Extension/Extension.Definition.Locator"],function(n,t,i,r){"use strict";var u;return function(t){function v(n,t,i){if(n)if(t){if(!i)throw new Error("Command container name is required.");}else throw new Error("Command name is required.");else throw new Error("Commands list is required.");var r=n.first(function(n){return n.commandName===t});return r||s.error("Command container '{0}' does not have a command named '{1}'.".format(i,t)),r}function y(n){var t=n.locator&&n.locator.type;return t===u.PartInstance||t===u.PartType||t===u.StartboardPartInstance}function p(n,t){return Object.keys(t).every(function(i){return n.hasOwnProperty(i)&&l.deepEquals(t[i],n[i])})}function w(n,t,i){var u,f,h,c;try{return t()}catch(r){u="Error deserializing composition.";try{f=JSON.stringify(n)}catch(l){f="<Invalid> {0}".format(l.toString())}try{h=e.fromJSON(n.locator)}catch(a){h=e.forExtension(u+"-"+a,o.EmptyCloudName)}return c=
"{0}\nJSON: {1}\nException Message: {2}\nException StackTrace: {3}".format(u,f,r.message||"<N/A>",r.stack||r.toString()),s.error(c),i(h,c)}}function b(n){var t=n&&n.assetTypeId;if(typeof t=="string")return t}function k(n){var t=n;return t&&t.beforeActivateCommandMenuItems&&typeof t.beforeActivateCommandMenuItems=="function"}var e=r.Locator,u=r.LocatorType,f=i.Base,o=f.Constants,h=o.BladeParameterNames,c=f.Diagnostics,l=f.Utilities,s=c.createLog(n),a;t.EditScopeIdPropertyName=h.EditScopeId;t.PartContainerModelIdProperty="##SnapshotContainerId##";t.CompositionInstanceDataName="MsPortalImplCompositionInstance";t.fxreplacedpartcomposing="fxreplacedpartcomposing",function(n){n[n.Unknown=0]="Unknown";n[n.Part=1]="Part";n[n.StartboardPart=2]="StartboardPart";n[n.Lens=3]="Lens";n[n.BladeActionBar=4]="BladeActionBar";n[n.Blade=5]="Blade";n[n.Journey=6]="Journey";n[n.Startboard=7]="Startboard"}(t.CompositionType||(t.CompositionType={}));a=t.CompositionType;t.findCommand=v;t.isPartComposition=y;t.
deepSubset=p;t.createCompositionFromJSON=w;t.tryGetAssetType=b;t.isContextMenuContainer=k}(u||(u={})),u});define("_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-avatarmenu-tenant,.fxs-avatarmenu-tenant-uri,.fxs-avatarmenu-username{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-avatarmenu{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-avatarmenu-header{position:relative;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding-left:20px}.fxs-avatarmenu-username{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:14px;line-height:normal;max-width:146px}.fxs-avatarmenu-dropdown-title,.fxs-avatarmenu-tenant{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;text-transform:uppercase}.fxs-avatarmenu-tenant{line-height:normal;opacity:.9;max-width:146px}.fxs-avatarmenu-tenant-container{text-align:right;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-avatarmenu-tenant-image{height:35px;width:35px;border:0;border-radius:35px;margin-left:11px;margin-right:5px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-avatarmenu-tenant-name{-webkit-flex:0 0 100%;flex:0 0 100%}.fxs-avatarmenu-dropdown{width:220px}.fxs-avatarmenu-dropdown-title{padding:5px 20px 0}.fxs-avatarmenu-tenant-uri{font-size:12px;margin-top:5px}.fxs-avatarmenu-list-tenant a{display:block}.fxs-avatarmenu-list-system a{display:-webkit-flex;display:flex}.fxs-avatarmenu-scrollviewer{max-height:505px;overflow:auto}html[lang^=ja] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=ja] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^=ko] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=ko] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^=zh] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=zh] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant{font-size:11px}')}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-breadcrumb{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;height:100%}.fxs-breadcrumb-wrapper{display:none;height:100%}.fxs-show-journey .fxs-breadcrumb-wrapper{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-breadcrumb-crumb{-webkit-flex:0 0 auto;flex:0 0 auto;height:100%;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding:0 7px}.fxs-breadcrumb-divider{-webkit-flex:0 0 auto;flex:0 0 auto;width:20px;text-align:center;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:100%;-webkit-justify-content:center;justify-content:center}.fxs-breadcrumb-divider:last-child{display:none}.fxs-breadcrumb-divider svg{-webkit-transform:rotate(90deg);transform:rotate(90deg);height:14px;width:14px;margin-top:3px}.fxs-journey-breadcrumb-overflow{-webkit-flex:0 0 auto;flex:0 0 auto;height:16px;width:16px;padding:0 10px;opacity:.4}.fxs-journey-breadcrumb-overflow svg{margin-top:3px}.fxs-breadcrumb-dropmenu{-webkit-flex:0 0 auto;flex:0 0 auto;width:30px}.fxs-breadcrumb-overflow{width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}")}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-contextMenu{display:none;position:fixed;width:225px;padding:10px 0;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:300;max-height:100vh;overflow-x:hidden;overflow-y:auto;border-style:solid;border-width:1px}.fxs-contextMenu:focus{outline:0}.fxs-contextMenu.fxs-contextMenu-active{display:block}.fxs-contextMenu-item{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:30px;padding:5px 25px;box-sizing:border-box;font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:13px;line-height:normal;cursor:default}.fxs-contextMenu-text{-webkit-flex:1 1 auto;flex:1 1 auto;height:20px}.fxs-contextMenu-icon{-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-content:flex-end;align-content:flex-end;height:21px;width:21px;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center}.fxs-contextMenu-icon>svg{height:16px;width:16px}.fxs-contextMenu-itemList{list-style-type:none;margin:0;padding:0}.fxs-contextMenu-extensioncommand .fxs-contextMenu-icon{display:none}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled{display:block;opacity:.5}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled:hover{background-color:transparent}.fxs-contextMenu-itemDisabled{display:none}.fxs-contextMenu-form{padding:8px 20px;display:none}.fxs-contextMenu-form.fxs-contextMenu-active{display:block}.fxs-dialogballoon.azc-balloon{opacity:1;width:auto;max-width:550px}.fxs-dialogballoon.azc-balloon .azc-balloon-content{padding:0}.fxs-dialogballoon.azc-balloon.azc-balloon-box-bottom .azc-balloon-pointer{border-bottom-color:#464f59}.fxs-dialogballoon.azc-balloon.azc-balloon-box-top .azc-balloon-pointer{border-top-color:#3c454f}.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-hero,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herotall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herowide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-large,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-mini,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-normal,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-small,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-tall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-wide{height:20px;width:20px}.msportalfx-contextmenu-grid rect{display:none}.msportalfx-contextmenu-grid-hero .msportalfx-grid-rect-hero,.msportalfx-contextmenu-grid-herotall .msportalfx-grid-rect-herotall,.msportalfx-contextmenu-grid-herowide .msportalfx-grid-rect-herowide,.msportalfx-contextmenu-grid-large .msportalfx-grid-rect-large,.msportalfx-contextmenu-grid-mini .msportalfx-grid-rect-mini,.msportalfx-contextmenu-grid-normal .msportalfx-grid-rect-normal,.msportalfx-contextmenu-grid-small .msportalfx-grid-rect-small,.msportalfx-contextmenu-grid-tall .msportalfx-grid-rect-tall,.msportalfx-contextmenu-grid-wide .msportalfx-grid-rect-wide{display:block}')}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-contextpane{width:0;max-width:435px;height:100%;position:relative;overflow:hidden;z-index:200}.fxs-contextpane .fxs-contextpane-content{box-sizing:border-box;max-width:435px;height:100%;overflow:auto}.fxs-contextpane .fxs-contextpane-content a{color:#00bcf2}.fxs-contextpane .fxs-progress-dots{display:none}.fxs-contextpane.fxs-contextpane-loading .fxs-progress-dots{display:block}.fxs-contextpane.fxs-contextpane-visible{width:auto}.fxs-contextpane-close,.fxs-contextpane-expand{display:none;cursor:pointer;border:0;background-color:transparent;margin:0;padding:5px 7px 9px;opacity:.8;transition:opacity 125ms ease-out;height:30px;width:30px;position:absolute;top:0}.fxs-contextpane-close:hover,.fxs-contextpane-expand:hover{opacity:1}.fxs-contextpane-close svg,.fxs-contextpane-expand svg{display:block;height:16px;width:16px}.fxs-contextpane-close{right:0}.fxs-contextpane-close:hover{background:#ba141a}.fxs-contextpane-expand{left:0;padding:10px 7px 9px 20px;width:100%}.fxs-contextpane-expand svg{height:15px;width:15px}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left{width:60px;max-width:60px}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-loading-status,.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-partscontainer,.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer>*{display:none}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer{overflow:visible}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer .fxs-partgallery-title{display:block;white-space:nowrap;-webkit-transform:rotate(90deg) translateY(5px);transform:rotate(90deg) translateY(5px);-webkit-transform-origin:0;transform-origin:0}.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand,.fxs-sidebar.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand .fxs-contextpane-button-inner{height:100%;display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap}.fxs-sidebar+.fxs-portal-contextpane-left{width:225px;max-width:225px;border-right:1px solid}.fxs-contextblade-placeholder{width:435px}")}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxc-base .fxs-tile-progress{background-color:inherit}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent{height:100%;width:100%;left:auto;top:auto}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent>div{margin:0;left:0;vertical-align:baseline}")});define("_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-dropmenu{position:relative;-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box;z-index:200}.fxs-dropmenu-button{border:none;padding:0;margin:0;background:0 0;color:inherit;cursor:pointer;display:-webkit-flex;display:flex;position:relative;height:100%;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fx-dropmenu-dropdown .fxs-dropmenu-list-system a{display:-webkit-flex;display:flex}.fx-dropmenu-dropdown .fxs-journeysmenu-journey-nodata{height:130px;width:100%}.fx-dropmenu-dropdown .fxs-journeysmenu-journey-nodata .fxs-journeysmenu-journey-nodata-content{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;line-height:18px;margin:0 40px;padding-top:50px;text-align:center}.fxs-dropmenu-content{position:absolute}.fxs-dropmenu-content ol,.fxs-dropmenu-content ul{list-style:none;padding:0;margin:0}.fxs-dropmenu-content li{white-space:nowrap}.fxs-dropmenu-content li a{-webkit-align-items:center;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:10px 20px}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton{display:-webkit-flex;display:flex;-webkit-flex:0 0 auto;flex:0 0 auto;background:0 0;cursor:pointer;border:0;margin-right:5px;-webkit-align-items:center;align-items:center}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton img,.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton svg{opacity:.2;height:15px;width:15px}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton:hover img,.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton:hover svg{opacity:1}.fxs-dropmenu-content .fxs-dropmenu-list-content{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-content .fxs-journeysmenu-journey{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;margin-right:auto}.fxs-dropmenu-content .fxs-journeysmenu-journey-content{-webkit-flex:0 0 auto;flex:0 0 auto;padding:0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-content .fxs-dropmenu-image{-webkit-flex:0 0 auto;flex:0 0 auto;height:16px;width:16px}.fxs-dropmenu-content .fxs-dropmenu-image img,.fxs-dropmenu-content .fxs-dropmenu-image svg{height:13px;width:13px}.fxs-dropmenu-content .fxs-dropmenu-line-separator{border-top:1px solid}.fxs-journeysmenu-content{min-width:450px}.fxs-dropmenu-left{right:0}.fxs-dropmenu-right{left:0}.fxs-dropmenu-hidden{display:none}.fxs-dropmenu-invisible{visibility:hidden}.fxs-journeysmenu-list{display:-webkit-flex;display:flex}.fxs-journeysmenu-journey-wrapper{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto}')}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-flowlayout{position:relative}.fxs-flowlayout>.fxs-flowlayout-childcontainer{position:relative;transition:height .25s linear,width .25s linear 0s}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-element{position:absolute}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-drop-placeholder{position:absolute;background:rgba(0,0,0,.2)}.fxs-flowlayout-resolutionguide{position:absolute;top:0;left:0;box-sizing:border-box;color:#fff;border-color:#fff;opacity:.7;border-width:1px;border-right-style:dashed;border-bottom-style:dashed;pointer-events:none;font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:13px;line-height:normal}.fxs-flowlayout-resolutionguide::after{position:absolute;right:8px;bottom:5px}.fxs-flowlayout-resolutionguide-1024x768{height:768px;width:1024px}.fxs-flowlayout-resolutionguide-1024x768::after{content:"1024 x 768"}.fxs-flowlayout-resolutionguide-1366x768{height:768px;width:1366px}.fxs-flowlayout-resolutionguide-1366x768::after{content:"1366 x 768"}.fxs-flowlayout-resolutionguide-1440x900{height:900px;width:1440px}.fxs-flowlayout-resolutionguide-1440x900::after{content:"1440 x 900"}.fxs-flowlayout-resolutionguide-1920x1080{height:1080px;width:1920px}.fxs-flowlayout-resolutionguide-1920x1080::after{content:"1920 x 1080"}.fxs-flowlayout-resolutionguide-3840x2160{height:2160px;width:3840px}.fxs-flowlayout-resolutionguide-3840x2160::after{content:"3840 x 2160"}.fxs-drag-surface{position:fixed;margin:0;padding:0;top:0;left:0;right:0;bottom:0;overflow:hidden;background-color:transparent;pointer-events:none;z-index:199}.fxs-drag-disableTouchAction{-ms-touch-action:none;touch-action:none}.fxs-flowlayout-resizehandle{display:inline-block;padding:0 4px 4px 0;bottom:0;right:0}.fxs-flowlayout-resizehandle>div{height:12px;width:12px;border:2px solid rgba(125,125,125,.5);border-left-width:0;border-top-width:0}.fxs-flowlayout-livepreview,.fxs-flowlayout-resizehandle{position:absolute;cursor:se-resize;z-index:1}.fxs-flowlayout-livepreview{min-width:85px;min-height:85px;max-width:2245px;max-height:2245px;overflow:hidden}')}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationMenu.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'@-webkit-keyframes fxs-notificationmenu-indeterminate-progress{from{left:-100%}to{left:150%}}@keyframes fxs-notificationmenu-indeterminate-progress{from{left:-100%}to{left:150%}}.fxs-notificationmenu-icon{height:20px}.fxs-notificationmenu-inprogressbar{position:absolute;overflow:hidden;height:2px;top:35px;left:1px;bottom:1px;right:1px;transition:opacity 1.5s ease-in-out 1s}.fxs-notificationmenu-inprogressbar>div{position:absolute;width:60%;height:100%;animation:fxs-notificationmenu-indeterminate-progress 1.5s linear infinite}.fxs-notificationmenu-button-unreadcount{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:13px;background-color:#fff;color:#000;position:absolute;top:5px;right:5px;border-radius:15px;text-align:center;line-height:13px}.fxs-notificationmenu-button-unreadcount-circle{height:15px;width:15px}.fxs-notificationmenu-button-unreadcount-oval{height:15px;width:28px}.fxs-notificationmenu-dropdown{width:355px}.fxs-notificationmenu-dropdown .fxs-notificationmenu-notification-nodata{height:130px;width:100%}.fxs-notificationmenu-dropdown .fxs-notificationmenu-notification-nodata .fxs-notificationmenu-notification-nodata-content{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;line-height:18px;margin:0 40px;padding-top:50px;text-align:center}.fxs-notificationmenu-list{max-height:90vh;overflow:auto}.fxs-notificationmenu-list>li:first-child .fxs-notificationmenu-notificationclick{padding-top:20px}.fxs-notificationmenu-list>li:last-child .fxs-notificationmenu-notificationclick{padding-bottom:20px}.fxs-notificationmenu-list>li .fxs-notificationmenu-notificationclick{padding:10px 25px;display:block}.fxs-notificationmenu-list>li .fxs-notificationmenu-notification .fxs-notificationmenu-notification-title{display:-webkit-flex;display:flex;-webkit-flex-flow:row wrap;flex-flow:row wrap;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-content:flex-start;align-content:flex-start;-webkit-align-items:flex-start;align-items:flex-start}.fxs-notificationmenu-list>li .fxs-notificationmenu-notification .fxs-notificationmenu-notification-title .fxs-notificationmenu-notification-title-icon{height:14px;width:14px;margin-right:5px}.fxs-notificationmenu-list>li .fxs-notificationmenu-notification .fxs-notificationmenu-notification-title .fxs-notificationmenu-notification-title-text{font-size:13px;overflow:hidden;text-overflow:ellipsis;-webkit-flex:0 0 240px;flex:0 0 240px}.fxs-notificationmenu-list>li .fxs-notificationmenu-notification .fxs-notificationmenu-notification-title .fxs-notificationmenu-notification-title-progresstext{font-size:13px;overflow:hidden;text-overflow:ellipsis;-webkit-flex:0 0 210px;flex:0 0 210px}.fxs-notificationmenu-list>li .fxs-notificationmenu-notification .fxs-notificationmenu-notification-title .fxs-notificationmenu-notification-title-subtitle{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;line-height:18px;width:20px}.fxs-notificationmenu-list>li .fxs-notificationmenu-notification .fxs-notificationmenu-notification-description{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;display:block;display:-webkit-box;max-height:60px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:4;-webkit-box-orient:vertical;position:relative;padding-top:5px;white-space:normal;line-height:15px}.fxs-notificationmenu-list>li .fxs-notificationmenu-notification .fxs-notificationmenu-notification-progressbar{margin-top:10px}')}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-panorama{position:relative;-ms-scroll-chaining:none}.fxs-panorama .fxs-journey-target,.fxs-panorama .fxs-startboard-target{position:absolute;top:0;left:0;height:100%;width:100%;z-index:0}.fxs-panorama>div[data-popup=true].azc-control{z-index:150}body.fxs-panning-cursor{cursor:ew-resize!important;cursor:-webkit-grabbing!important;cursor:-moz-grabbing!important;cursor:grabbing!important}.fxs-show-journey .fxs-startboard-target,.fxs-show-startboard .fxs-journey-target{display:none}.fxs-panorama-scrollbounce-onleft .fxs-startboard-layout,.fxs-panorama-scrollbounce-onleft>.fxs-journey-target{-webkit-transform:translateX(20px);transform:translateX(20px)}.fxs-panorama-scrollbounce-onright .fxs-startboard-layout,.fxs-panorama-scrollbounce-onright>.fxs-journey-target{-webkit-transform:translateX(-20px);transform:translateX(-20px)}.fxs-panorama-scrollbounce-reset .fxs-startboard-layout,.fxs-panorama-scrollbounce-reset>.fxs-journey-target{-webkit-transform:translateX(0);transform:translateX(0)}.fxs-panorama-scrollbounce-onleft .fxs-startboard-layout,.fxs-panorama-scrollbounce-onleft>.fxs-journey-target,.fxs-panorama-scrollbounce-onright .fxs-startboard-layout,.fxs-panorama-scrollbounce-onright>.fxs-journey-target,.fxs-panorama-scrollbounce-reset .fxs-startboard-layout,.fxs-panorama-scrollbounce-reset>.fxs-journey-target{transition:transform .333s ease!important}")}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,"@-webkit-keyframes fxs-indicator-animatedEllipses{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes fxs-indicator-animatedEllipses{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.fxs-topbar-search{height:40px}.fxs-topbar-search .fxs-box-wrapper{margin-top:6px;margin-right:6px}.fxs-topbar-search .fxs-menu{margin-right:6px;top:34px}.fxs-search{position:relative}.fxs-search.fxs-search-expanded{padding:0 0 0 10px;position:relative}.fxs-search.fxs-search-expanded .fxs-box-wrapper{display:inline-block}.fxs-search.fxs-search-expanded .fxs-search-icon{display:none}.fxs-search .fxs-box-wrapper{position:relative;padding:0;display:none}.fxs-search .fxs-box-wrapper.fxs-searching .fxs-indicator{display:inline-block}.fxs-search .fxs-box-wrapper.fxs-searching .fxs-searchbox .azc-input{padding:0 60px 0 32px}.fxs-search div.fxs-icon{position:absolute;padding:5px 7px}.fxs-search div.fxs-icon svg{height:18px;width:18px;-webkit-flex:0 0 auto;flex:0 0 auto;fill:#fff}.fxs-search .fxs-cross{height:28px;width:20px;position:absolute;font-size:20px;top:-2px;right:0;cursor:pointer;color:#fff}.fxs-search .fxs-searchbox{height:28px;width:400px}.fxs-search .fxs-searchbox .azc-input{border:0;font-size:14px;padding:0 20px 0 32px;height:28px}.fxs-search .fxs-searchbox .azc-input::-ms-clear{display:none}.fxs-search .fxs-indicator{height:28px;width:40px;position:absolute;display:none;top:0;padding-top:4px;right:20px}.fxs-search .fxs-indicator>div{display:inline-block;height:6px;width:6px;-webkit-animation:fxs-indicator-animatedEllipses 1.5s infinite;animation:fxs-indicator-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-search .fxs-indicator>div:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.fxs-search .fxs-indicator>div:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.fxs-search .fxs-indicator>div:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@media all and (min-width:1440px){.fxs-search{padding:0 0 0 10px;position:relative}.fxs-search .fxs-box-wrapper{display:inline-block}.fxs-search .fxs-search-icon{display:none}}@media all and (min-width:1200px){.fxs-search .fxs-search-no-journeys{padding:0 0 0 10px;position:relative}.fxs-search .fxs-search-no-journeys .fxs-box-wrapper{display:inline-block}.fxs-search .fxs-search-no-journeys .fxs-search-icon{display:none}}")}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-sidebar,.fxs-sidebar-bar{height:100%;box-sizing:border-box}.fxs-sidebar{z-index:200;position:relative;font-size:13px;border-right:1px solid;color:#3c454f}.fxs-sidebar ul{padding:0;margin:0;list-style:none}.fxs-sidebar button{border:none;background:0 0;font-family:inherit;margin:0;padding:0;cursor:pointer;font-size:inherit}.fxs-sidebar-flyout .fxs-sidebar-item .fxs-sidebar-matches-prefix,.fxs-sidebar-item-category .fxs-sidebar-label{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.fxs-sidebar button:focus{border:0}.fxs-sidebar-bar{width:225px;overflow:hidden}.fxs-sidebar-flyout{position:absolute;top:0;bottom:0;left:100%;width:400px}.fxs-sidebar-flyout .fxs-popup-feedback{text-align:right}.fxs-sidebar-flyout .fxs-popup-feedback .fxs-sidebar-feedback-link{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;line-height:35px;text-decoration:underline;margin:0 20px}.fxs-sidebar-flyout .fxs-popup-feedback .fxs-sidebar-feedback-link .fxs-sidebar-feedback-link-disabled{text-decoration:none}.fxs-sidebar-hint-text{text-align:right;font-size:11px;color:#63707e;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-sidebar-browse-flyout{height:100%}.fxs-sidebar-flyout-header{height:20px;margin:0 0 10px;text-align:right}.fxs-sidebar-flyout-header .fxs-sidebar-flyout-close:hover>svg{fill:#fff}.fxs-sidebar-flyout-close{height:30px;width:30px;transition:background .1s ease-out}.fxs-sidebar-flyout-close>svg{height:16px;width:16px;transition:fill .1s ease-out}.fxs-sidebar-flyout-close:hover{background:#ba141a}.fxs-sidebar-button-flex{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}button.fxs-sidebar-create{height:40px;padding:0 20px;margin-bottom:10px;width:100%;box-sizing:border-box;border-top:1px solid;border-bottom:1px solid}.fxs-sidebar-flyout-is-hidden{display:none}.fxs-sidebar-create-label{margin-left:10px}.fxs-sidebar-create-icon{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:40px}.fxs-sidebar-create-icon svg{height:18px;width:18px}button.fxs-sidebar-browse{padding:0 20px;height:40px;width:225px}.fxs-sidebar-favorites{height:calc(100% - 90px);overflow:hidden}.fxs-sidebar-favorites:hover,.fxs-sidebar-possible-favorites{overflow-y:auto;overflow-x:hidden}.fxs-sidebar-possible-favorites{height:calc(100% - 135px)}.fxs-sidebar-possible-favorites .fxs-sidebar-label{width:auto;padding-right:10px}.fxs-sidebar-possible-favorites .fxs-sidebar-item-link{padding-left:20px;width:160px}.fxs-sidebar-item-category{border-bottom:1px solid #dcdfe2;margin:25px 5px 0 20px}.fxs-sidebar-item{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;-webkit-align-items:center;align-items:center;height:40px}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-sidebar-flyout .fxs-sidebar-item:last-child{margin-bottom:35px}.fxs-sidebar-flyout .fxs-sidebar-item{-webkit-align-items:flex-start;align-items:flex-start;-webkit-flex-direction:column;flex-direction:column;min-height:35px}.fxs-sidebar-flyout .fxs-sidebar-item .fxs-sidebar-item-content{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;-webkit-align-items:center;align-items:center;width:100%}.fxs-sidebar-flyout .fxs-sidebar-item .fxs-sidebar-item-content .fxs-sidebar-star svg{opacity:.4}.fxs-sidebar-flyout .fxs-sidebar-item .fxs-sidebar-item-content .fxs-sidebar-star.fxs-is-favorite svg,.fxs-sidebar-flyout .fxs-sidebar-item .fxs-sidebar-item-content.fxs-is-selected .fxs-sidebar-star svg,.fxs-sidebar-flyout .fxs-sidebar-item .fxs-sidebar-item-content:hover .fxs-sidebar-star svg{opacity:1}.fxs-sidebar-flyout .fxs-sidebar-item .fxs-sidebar-matches{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:10px;text-align:left;display:block}.fxs-sidebar-item-link{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;-webkit-align-items:center;align-items:center;width:100%;height:40px;-webkit-user-drag:none}.fxs-sidebar-icon{-webkit-flex:0 0 18px;flex:0 0 18px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:18px}.fxs-sidebar-icon img,.fxs-sidebar-icon svg{height:18px;width:18px}.fxs-sidebar-flyout .fxs-sidebar-label,.fxs-sidebar-label{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:10px}.fxs-sidebar-item-category .fxs-sidebar-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:10px;text-align:left;text-transform:uppercase;margin:0 0 3px}.fxs-sidebar-star{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;height:100%;width:30px;cursor:pointer}.fxs-sidebar-star svg{height:14px;width:14px}button.fxs-sidebar-collapse-button{display:-webkit-flex;display:flex;height:35px;width:100%;-webkit-align-items:center;align-items:center;padding-left:20px}button.fxs-sidebar-collapse-button svg{height:15px;width:15px}.fxs-sidebar-browse-label{padding-right:5px}.fxs-sidebar-browse-icon{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:40px}.fxs-sidebar-browse-icon svg{margin-top:3px;height:15px;width:15px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-show-if-expanded{display:block}.fxs-sidebar-show-if-collapsed{display:none}.fxs-sidebar-hide{display:none!important}.fxs-sidebar-filter-input{width:100%;margin:5px 0 21px}.fxs-sidebar-filter-categories{margin:5px 0 0}.fxs-sidebar-dropdown-container{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:left;justify-content:left}.fxs-sidebar-dropdown{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-sidebar-dropdown-title{color:#00bcf2;width:auto;margin:2px 0;font-size:10pt}.fxs-sidebar-dropdown-button-container{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;margin-left:6px}.fxs-sidebar-dropdown-button{margin:4px 5px 0;padding:4px 5px;opacity:.7}.fxs-sidebar-dropdown-button .fxs-sidebar-dropdown-button-text{font-size:8px}.fxs-sidebar-dropdown-button .fxs-sidebar-dropdown-button-icon{height:8px;width:8px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fxs-sidebar-dropdown-button .fxs-sidebar-dropdown-button-icon>svg{-webkit-flex:0 0 8px;flex:0 0 8px}.fxs-sidebar-dropdown-item a{display:-webkit-flex;display:flex}.fxs-sidebar-content{height:65px;padding:0 20px 5px}.fxs-sidebar-external{-webkit-flex:0 0 12px;flex:0 0 12px;margin:0 10px;padding-top:4px;width:12px}.fxs-sidebar-external svg{height:12px;width:12px}.fxs-sidebar-handle{-webkit-flex:0 0 20px;flex:0 0 20px;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center;cursor:move}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:60px}.fxs-sidebar-is-collapsed .fxs-sidebar-show-if-collapsed{display:block}.fxs-sidebar-is-collapsed .fxs-sidebar-show-if-expanded{display:none}.fxs-sidebar-cloudFilter{padding-left:20px;padding-right:10px;padding-bottom:10px;font-size:14px;line-height:24px}')}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-stacklayout{display:-webkit-flex;display:flex}.fxs-stacklayout.fxs-stacklayout-vertical{-webkit-flex-direction:column;flex-direction:column}.fxs-stacklayout.fxs-stacklayout-horizontal{-webkit-flex-direction:row;flex-direction:row;height:100%}.fxs-stacklayout.fxs-stacklayout-horizontal>.fxs-stacklayout-child{height:100%}.fxs-stacklayout-child{-webkit-flex:0 0 auto;flex:0 0 auto}")});define("_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-startboard{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;overflow:hidden}.fxs-startboard>.fxs-startboard-header{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard>.fxs-startboard-layout{padding:25px 40px;overflow:auto;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-startboard>.fxs-startboard-layout .fxs-flowlayout-childcontainer{padding-bottom:25px;padding-right:25px}.fxs-startboard .fxs-startboard-message-container,.fxs-startboard.fxs-startboard-notfound>.fxs-startboard-layout{display:none}.fxs-startboard-header .fxs-startboard-title-next,.fxs-startboard.fxs-startboard-notfound .fxs-startboard-message-container{display:block}.fxs-startboard-header{width:100%;height:50px;padding:10px 25px 0 40px;box-sizing:border-box}.fxs-startboard-header .fxs-startboard-button .fxs-startboard-button-text{font-size:12px}.fxs-startboard-header .fxs-startboard-button .fxs-startboard-button-icon{height:12px;width:12px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fxs-startboard-header .fxs-startboard-button .fxs-startboard-button-icon>svg{-webkit-flex:0 0 12px;flex:0 0 12px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon{height:16px;width:16px;margin:4px 8px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon>svg{-webkit-flex:0 0 16px;flex:0 0 16px}.fxs-startboard-header .fxs-startboard-title{max-width:300px}.fxs-startboard-header .fxs-startboard-title-edit{padding:0 5px 2px;margin:0 -6px -2px;border-width:1px;border-style:solid;color:inherit;background-color:transparent;width:300px;transition:border .12s}.fxs-startboard-header .fxs-startboard-title-edit:active,.fxs-startboard-header .fxs-startboard-title-edit:hover{border-color:inherit}.fxs-startboard-header .fxs-startboard-button,.fxs-startboard-header .fxs-startboard-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-header .fxs-startboard-button,.fxs-startboard-header .fxs-startboard-dropdown{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:13px;line-height:20px}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-title-edit{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:24px;line-height:normal}.fxs-startboard-header .fxs-startboard-actions,.fxs-startboard-header .fxs-startboard-migration{height:40px;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard-dropdown{-webkit-flex:0 1 auto;flex:0 1 auto;max-width:560px}.fxs-startboard-button{-webkit-flex:0 0 auto;flex:0 0 auto;border:0;margin:0 5px;padding:4px 5px;height:20px;background-color:transparent;box-sizing:content-box}.fxs-startboard-button:not([aria-disabled]):hover{cursor:pointer}.fxs-startboard-button .fxs-startboard-button-text{margin-left:5px}.fxs-startboard-button .fxs-startboard-button-icon{height:16px;width:16px}.fxs-startboard-button,.fxs-startboard-button-container{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-startboard-button-browse{padding:0!important}.fxs-startboard-dropdown>.fxs-dropmenu{width:100%}.fxs-startboard-dropdown .fxs-dropmenu-button,.fxs-startboard-dropdown .fxs-dropmenu-button:hover{background-color:transparent!important;color:inherit!important}.fxs-startboard-dropdown .fxs-popup-button.fxs-is-selected svg{fill:inherit!important}.fxs-startboard-dropdown .fxs-dropmenu-content{overflow-x:hidden;overflow-y:auto;min-width:400px;max-width:560px;min-height:35px;max-height:480px}.fxs-startboard-item-container{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;min-width:0}.fxs-startboard-dropdown .fxs-dropmenu-list-system .fxs-startboard-dropdown-item{padding:7px 25px 8px}.fxs-startboard-dropdown-item+.fxs-startboard-dropdown-item::before{content:"";position:absolute;top:0;width:calc(100% - 50px);border-top-width:1px;border-top-style:solid;border-color:rgba(125,125,125,.5)}.fxs-startboard-item-title{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-item-icon{-webkit-flex:0 0 auto;flex:0 0 auto;height:14px;width:14px;padding-right:5px}.fxs-startboard-dropdown-item{position:relative;height:35px;box-sizing:border-box;cursor:pointer}.fxs-startboard-dropdown-item.fxs-startboard-dropdown-browseall{height:auto;cursor:default}.fxs-startboard-dropdown-subscriptions{white-space:normal}.fxs-startboard-actions,.fxs-startboard-dropdown,.fxs-startboard-header:not(.fxs-startboard-header-normal) .fxs-startboard-title-edit,.fxs-startboard-migration{display:none}.fxs-startboard-header-normal .fxs-startboard-actions,.fxs-startboard-header-normal .fxs-startboard-dropdown{display:-webkit-flex;display:flex}.fxs-startboard-header-migration .fxs-startboard-actions,.fxs-startboard-header-migration .fxs-startboard-dropdown,.fxs-startboard-header-normal .fxs-startboard-migration,.fxs-startboard-header-normal .fxs-startboard-title-next{display:none}.fxs-startboard-header-migration .fxs-startboard-migration{display:-webkit-flex;display:flex}.fxs-startboard-header-migration .fxs-startboard-title-next{display:block}.fxs-startboard-message-container{padding:55px 40px;color:#fff}.fxs-startboard-message-title{font-size:32px;margin-bottom:20px}.fxs-startboard-message-body{font-size:17px}.fxs-startboard-notfound .fxs-startboard-button-clone,.fxs-startboard-notfound .fxs-startboard-button-edit,.fxs-startboard-notfound .fxs-startboard-button-filter,.fxs-startboard-notfound .fxs-startboard-button-fullscreen,.fxs-startboard-notfound .fxs-startboard-button-share{display:none}.fxs-topbar-dashboard-changed+.fxs-portal-main .fxs-startboard-title-next{display:block}.fxs-topbar-dashboard-changed+.fxs-portal-main .fxs-startboard-title-next~*{display:none}.fxs-startboard-loadanimation{display:none;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;position:absolute;height:100%;width:100%}.fxs-startboard-loading .fxs-startboard-loadanimation{display:-webkit-flex;display:flex}.fxs-startboard-loading .fxs-startboard-title-next{display:block}.fxs-startboard-loading .fxs-startboard-header~*{visibility:hidden}.fxs-startboard-loading .fxs-startboard-layout .fxs-tile .fxs-part-content,.fxs-startboard-loading .fxs-startboard-title-next~*{display:none}@media all and (max-width:1000px){.fxs-startboard-button-text{display:none}}:-webkit-full-screen .fxs-sidebar,:-webkit-full-screen .fxs-topbar{display:none!important}:-webkit-full-screen .fxs-portal-main{height:100%}:-webkit-full-screen .fxs-startboard-button-clone,:-webkit-full-screen .fxs-startboard-button-delete,:-webkit-full-screen .fxs-startboard-button-edit,:-webkit-full-screen .fxs-startboard-button-filter,:-webkit-full-screen .fxs-startboard-button-new,:-webkit-full-screen .fxs-startboard-button-share{display:none}:-webkit-full-screen .fxs-tile::after{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0}:-webkit-full-screen .fxs-tile-actionbar{display:none}:-moz-full-screen .fxs-sidebar,:-moz-full-screen .fxs-topbar{display:none!important}:-moz-full-screen .fxs-portal-main{height:100%}:-moz-full-screen .fxs-startboard-button-clone,:-moz-full-screen .fxs-startboard-button-delete,:-moz-full-screen .fxs-startboard-button-edit,:-moz-full-screen .fxs-startboard-button-filter,:-moz-full-screen .fxs-startboard-button-new,:-moz-full-screen .fxs-startboard-button-share{display:none}:-moz-full-screen .fxs-tile::after{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0}:-moz-full-screen .fxs-tile-actionbar{display:none}:-ms-fullscreen .fxs-sidebar,:-ms-fullscreen .fxs-topbar{display:none!important}:-ms-fullscreen .fxs-portal-main{height:100%}:-ms-fullscreen .fxs-startboard-button-clone,:-ms-fullscreen .fxs-startboard-button-delete,:-ms-fullscreen .fxs-startboard-button-edit,:-ms-fullscreen .fxs-startboard-button-filter,:-ms-fullscreen .fxs-startboard-button-new,:-ms-fullscreen .fxs-startboard-button-share{display:none}:-ms-fullscreen .fxs-tile::after{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0}:-ms-fullscreen .fxs-tile-actionbar{display:none}:fullscreen .fxs-sidebar,:fullscreen .fxs-topbar{display:none!important}:fullscreen .fxs-portal-main{height:100%}:fullscreen .fxs-startboard-button-clone,:fullscreen .fxs-startboard-button-delete,:fullscreen .fxs-startboard-button-edit,:fullscreen .fxs-startboard-button-filter,:fullscreen .fxs-startboard-button-new,:fullscreen .fxs-startboard-button-share{display:none}:fullscreen .fxs-tile::after{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0}:fullscreen .fxs-tile-actionbar{display:none}')}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,"@-webkit-keyframes fxs-tile-progress-fade-in{0%,99%{opacity:1}100%{opacity:.4}}@keyframes fxs-tile-progress-fade-in{0%,99%{opacity:1}100%{opacity:.4}}@-webkit-keyframes fxs-tile-progress-transparent-keyframes{0%{-webkit-transform:translateX(-30px);transform:translateX(-30px);opacity:0}25%{opacity:1}50%{-webkit-transform:translateX(30px);transform:translateX(30px);opacity:0}100%{opacity:0}}@keyframes fxs-tile-progress-transparent-keyframes{0%{-webkit-transform:translateX(-30px);transform:translateX(-30px);opacity:0}25%{opacity:1}50%{-webkit-transform:translateX(30px);transform:translateX(30px);opacity:0}100%{opacity:0}}.fxs-tile-progress-transparent{position:absolute;width:85px;top:1px;height:12px;left:calc(50% - 85px/2);z-index:195}.fxs-tile-progress-transparent div{display:inline-block;margin:4px 2px;width:4px;height:4px;border-radius:100%;position:relative;background:#000;left:20px;vertical-align:top;-webkit-animation:fxs-tile-progress-transparent-keyframes 3s cubic-bezier(.030,.615,.995,.415) infinite;animation:fxs-tile-progress-transparent-keyframes 3s cubic-bezier(.030,.615,.995,.415) infinite;-webkit-animation-fill-mode:both;animation-fill-mode:both}.fxs-tile-progress-transparent div:nth-child(1){-webkit-animation-delay:.8s;animation-delay:.8s}.fxs-tile-progress-transparent div:nth-child(2){-webkit-animation-delay:.6s;animation-delay:.6s}.fxs-tile-progress-transparent div:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}.fxs-tile-progress-transparent div:nth-child(4){-webkit-animation-delay:.2s;animation-delay:.2s}.fxs-tile-progress-transparent div:nth-child(5){-webkit-animation-delay:0s;animation-delay:0s}.fxs-tile{height:175px;width:175px;transition:height 125ms linear 125ms,width 125ms linear 0s;position:relative;box-shadow:none}.fxs-tile .fxs-tile-actionbar{z-index:196}.fxs-tile .fxs-tile-container{width:100%;height:100%}.fxs-tile .fxs-tile-progress-fade{-webkit-animation:fxs-tile-progress-fade-in .3s forwards;animation:fxs-tile-progress-fade-in .3s forwards}.fxs-tile.fxs-tilesize-mini{height:85px;width:85px}.fxs-tile.fxs-tilesize-small{height:85px;width:175px}.fxs-tile.fxs-tilesize-tall{height:355px;width:175px}.fxs-tile.fxs-tilesize-wide{height:175px;width:355px}.fxs-tile.fxs-tilesize-normal{height:175px;width:175px}.fxs-tile.fxs-tilesize-large{height:355px;width:355px}.fxs-tile.fxs-tilesize-herotall{height:535px;width:355px}.fxs-tile.fxs-tilesize-herowide{height:355px;width:535px}.fxs-tile.fxs-tilesize-hero{height:535px;width:535px}.fxs-tile.fxs-tilesize-herowidefitheight{height:auto;width:535px}.fxs-tile.fxs-tilesize-fullwidthfitheight{height:auto;width:100%}.fxs-tile.fxs-tilesize-fullwidthfitheight .fxs-part,.fxs-tile.fxs-tilesize-fullwidthfitheight .fxs-part-content{height:auto}.fxs-tile.fxs-tilesize-fullwidthfitheight,.fxs-tile.fxs-tilesize-herowidefitheight{margin-bottom:5px}.fxs-tile.fxs-tilesize-fullwidthfitheight:last-child,.fxs-tile.fxs-tilesize-herowidefitheight:last-child{margin-bottom:0}.fxs-tile.fxs-tilesize-fittocontainer{height:100%;width:100%}.fxs-tile.fxs-tilesize-fittocontainer>.fxs-part{overflow:auto}.fxs-tile div.fxs-tile-overlay{display:none;position:absolute;width:100%;top:0;bottom:0;cursor:pointer}.fxs-blade-content-container .fxs-bladecontent-unlocked .fxs-tile{box-shadow:0 2px 2px rgba(0,0,0,.25)}.fxs-blade-content-container .fxs-bladestyle-context .fxs-tile,.fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile,.fxs-blade-content-container .fxs-bladestyle-create .fxs-tile,.fxs-blade-content-container .fxs-bladestyle-help .fxs-tile{box-shadow:none}")}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-tile-actionbar{height:25px}.fxs-tile-actionbar-actionlist{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-justify-content:flex-end;justify-content:flex-end}.fxs-tile-actionbar-action{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;box-sizing:border-box;height:25px;width:25px;padding:6px;background-color:transparent;cursor:pointer;border:0;transition:background .1s ease-out}.fxs-tile-actionbar-action>svg{height:13px;width:13px}.fxs-tile .fxs-tile-actionbar{position:absolute;top:-25px;width:100%;opacity:0;transition:opacity .1s;cursor:default}.fxs-tile.ui-draggable .fxs-tile-actionbar{cursor:move}.fxs-tile.fxs-tile-selected .fxs-tile-actionbar,.fxs-tile.fxs-tile-selectedfromhover .fxs-tile-actionbar{opacity:1}")}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-toast-description,.fxs-toast-time,.fxs-toast-title{overflow:hidden;text-overflow:ellipsis}.fxs-toast{position:fixed;top:55px;right:20px;width:355px;list-style-type:none;margin:0}.fxs-toast-header,.fxs-toast-item{display:-webkit-flex;margin-bottom:5px}.fxs-toast-content,.fxs-toast-link{-webkit-flex:1 1 auto;flex:1 1 auto;padding:10px}.fxs-toast-item{display:flex;position:relative}.fxs-toast-header{display:flex;-webkit-align-items:center;align-items:center;padding-top:5px}.fxs-toast-icon svg{height:14px;width:14px}.fxs-toast-title{-webkit-flex:1 1 auto;flex:1 1 auto;margin-left:10px;max-width:254px;white-space:nowrap}.fxs-toast-time{white-space:nowrap;max-width:60px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-toast-close{position:absolute;top:0;right:0;background:0 0;border:none;padding:5px;cursor:pointer}.fxs-toast-close svg{height:12px;width:12px}.fxs-toast-description{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;line-height:18px;width:335px}.fxs-toast-progressbar{margin-top:10px;max-height:5px}.fxs-nps .fxs-nps-title{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;margin-bottom:7px}.fxs-nps .fxs-nps-score{display:-webkit-flex;display:flex}.fxs-nps .fxs-nps-score span{-webkit-flex:1 1 auto;flex:1 1 auto;border:1px solid #c5cbd1;text-align:center;height:23px;line-height:23px;font-size:11px;margin-right:6px;display:inline-block;cursor:pointer}.fxs-nps .fxs-nps-score span.fxs-nps-score-selected,.fxs-nps .fxs-nps-score span:hover{background:#00bcf2;border-color:#00bcf2}.fxs-nps .fxs-nps-score span:last-child{margin-right:0}.fxs-nps .fxs-nps-help{color:#758393;display:flex;margin-bottom:10px;font-size:12px;width:335px}.fxs-nps .fxs-nps-help span:last-child{margin-left:auto}.fxs-nps .fxs-nps-survey{font-size:12px;text-decoration:underline}.fxs-nps .fxs-nps-comments{margin-top:6px;margin-bottom:18px;width:319px;border:1px solid #c5cbd1;height:100px;padding:7px}.fxs-nps .fxs-nps-button-holder{border-top:1px solid #dcdfe2;width:355px;margin-left:-10px}.fxs-nps .fxs-nps-submit{margin:15px 10px 5px;background-color:#00bcf2;border-color:#00bcf2;color:#fff}')}
);define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-portal .fxs-topbar{height:40px;position:relative;z-index:250}.fxs-portal .fxs-topbar.fxs-topbar-devmode .fxs-topbar-exitdevmode{background-color:rgba(0,0,0,.12)}.fxs-portal .fxs-topbar.fxs-topbar-devmode .fxs-has-hover:hover,.fxs-topbar-exitdevmode .fxs-has-hover:hover,.fxs-topbar-reportbug .fxs-has-hover:hover{background-color:rgba(0,0,0,.05)!important}.fxs-portal .fxs-topbar .fxs-topbar-journey-icon svg{height:16px;width:16px;margin-top:4px}.fxs-topbar-feedback,.fxs-topbar-helpmenu,.fxs-topbar-notifications,.fxs-topbar-search,.fxs-topbar-settings{border-right:1px solid rgba(128,128,128,.4)}.fxs-topbar{font-size:13px}.fxs-topbar-content{width:100%;height:100%;position:absolute;top:0;display:-webkit-flex;display:flex;-webkit-align-content:center;align-content:center;-webkit-align-items:center;align-items:center}.fxs-topbar-internal{height:40px;min-width:85px;max-width:225px;box-sizing:border-box;padding:0 12px;line-height:40px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-topbar-exitdevmode,.fxs-topbar-reportbug{display:-webkit-flex;display:flex;height:40px;width:auto;-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;padding:0 2px}.fxs-topbar-home{-webkit-flex:0 0 auto;flex:0 0 auto;font-size:20px;padding:0 7px;margin-left:13px;height:100%;line-height:40px}.fxs-topbar-button{display:-webkit-flex;display:flex;height:40px;width:40px;-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fxs-topbar-button svg{height:20px;width:20px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-desktop-organize .fxs-topbar-exit-customize{visibility:visible;top:0}.fxs-topbar-dashboard-message,.fxs-topbar-exit-customize-message{font-size:14px}.fxs-topbar-dashboard .fxs-button,.fxs-topbar-exit-customize-button{-webkit-flex:0 0 auto;flex:0 0 auto;margin-left:10px}.fxs-topbar-dashboard-view{display:none}.fxs-show-journey .fxs-topbar-dashboard-view{display:block}.fxs-show-journey .fxs-topbar-dashboard-discard,.fxs-show-journey .fxs-topbar-dashboard-save{display:none}.fxs-topbar-notifications{position:relative}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;-webkit-flex:1 1 auto;flex:1 1 auto;position:absolute;top:-40px;z-index:250;visibility:hidden;width:100%;height:100%;transition:top .3s ease .1ms}.fxs-topbar-dashboard-changed .fxs-topbar-dashboard{top:0;visibility:visible}.fxs-topbar-dashboard-changed .fxs-topbar-exit-customize{display:none}")}
);define("MsPortalImpl/Widgets/Widgets.WidgetBase",["require","exports","f","i","../../_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationMenu.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",
"../../_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","../../_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],function(n,t,i,r){"use strict";var u;return function(n){var f=i.Base,e=f.EventTypes,h=window,t=jQuery,o=ko.observable,s=function(){function n(){this.disabled=o(!1)}return n}(),u;n.ViewModel=s;u=function(){function n(i,u){var f=this;if(!i||i.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");this._lifetimeManager=new r.TriggerableLifetimeManager;this.element=t(i[0]);i.on(n.widgetRemoveEvent,this._removeHandler=function(n){n.target!==i[0]||f._disposeTriggered||(f._disposeTriggered=!0,f.dispose())});i.data(n._widgetTypesDataKey)||i.data(n._widgetTypesDataKey,[]);i.data(n._widgetTypesDataKey).push(this);this.options=u;this._initializeSubscriptions(
u)}return n.prototype.setFocus=function(){},n.prototype.dispose=function(){this._lifetimeManager&&(this._lifetimeManager.dispose(),this._lifetimeManager=null);var i=this.element,t=i.data(n._widgetTypesDataKey);i.off(n.widgetRemoveEvent,this._removeHandler);this._removeHandler=null;t&&(t.splice(t.indexOf(this),1),t.length===0&&i.removeData(n._widgetTypesDataKey))},Object.defineProperty(n.prototype,"lifetimeManager",{get:function(){return this._lifetimeManager},enumerable:!0,configurable:!0}),n.getWidget=function(t,i){var r=n.getWidgets(t,i);return r?r[0]||null:null},n.getWidgets=function(t,i){var r=t.data(n._widgetTypesDataKey)||[];return i?r.filter(function(n){return n instanceof i}):r},n.prototype.trigger=function(n,i,r){var f=this.options[n],u=this.element;return r=r||{},i=i||t.Event(n),i.type=n,i.target=u[0],u.trigger(i,r),!(t.isFunction(f)&&f.apply(u[0],[i].concat(r))===!1||i.isDefaultPrevented())},n.prototype.getTelemetrySource=function(){return null},n.prototype._bindDescendants=
function(n){var i={data:this.options,func:this},r=n?t.extend(null,i,n):i;ko.applyBindingsToDescendants(r,this.element[0])},n.prototype._cleanDescendants=function(){ko.utils.cleanDescendantNodes(this.element)},n.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];this._cleanDescendants();i=this.element;t.length>0&&i.removeClass(t.join(" "));i.empty()},n.prototype._initializeSubscriptions=function(){},n.prototype._isRtl=function(){return t("html").attr("dir")==="rtl"},n.widgetRemoveEvent=e.remove+".fxWidget",n._widgetTypesDataKey="fxWidgetTypes",n}();n.Widget=u}(u||(u={})),u});define("MsPortalImpl/Services/Services.Storage",["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(t){function y(){return f.forEach(function(n){var t=e[n.name];t.count=t.keySize=t.valueSize=0}),e}function p(n){if(n===undefined)try{var t="e9924856304645948eae54ef2dc78a17";[u.localStorage,u.sessionStorage].forEach(function(n){n.getItem(t);n.setItem(
t,t);n.removeItem(t)});n=!1}catch(i){n=!0}return new c(n)}var l=i.Base.Diagnostics,u=window,a=l.createLog(n),s=JSON.stringify,v=r.Diagnostics.getLogFriendlyMessage,o,c;(function(n){n[n.DesktopManager=2]="DesktopManager";n[n.AssetMruList=3]="AssetMruList";n[n.ExtensionManager=4]="ExtensionManager";n[n.Router=5]="Router";n[n.UserSettings_Journeys=6]="UserSettings_Journeys";n[n.UserSettings_EditScopes=7]="UserSettings_EditScopes";n[n.Relex=8]="Relex";n[n.ManifestVersions=9]="ManifestVersions";n[n.Redirect=10]="Redirect";n[n.Cdn=11]="Cdn";n[n.UserSettings_NewJourneys=12]="UserSettings_NewJourneys";n[n.Telemetry=13]="Telemetry";n[n.Dashboard=14]="Dashboard";n[n.Avatar=15]="Avatar"})(t.ComponentName||(t.ComponentName={}));var h=t.ComponentName,f=i.getEnumArray(h),e={};f.forEach(function(n){e[n.name]={count:0,keySize:0,valueSize:0}});t.create=p;o=function(){function n(n,t){this._storage=n;this._storageName=t}return n.prototype.has=function(n){return this.get(n)!==undefined},n.prototype.get=function(
n){try{return this._storage.getItem(n)}catch(t){this._logError(1,t,n)}},n.prototype.set=function(n,t){try{this._storage.setItem(n,t)}catch(i){this._logError(2,i,n)}},n.prototype.delete=function(n){try{return this._storage.removeItem(n),!0}catch(t){return this._logError(3,t,n),!1}},n.prototype.forEach=function(n,t){for(var r,u=this._storage,i=0;i<u.length;i++)r=u.key(i),n.call(t,this.get(r),r,this)},n.prototype.clear=function(){try{this._storage.clear()}catch(n){this._logError(4,n)}},n.prototype._createStorageSummary=function(){var r=y(),n=0,u="",t;this.forEach(function(t,e){var c=i.find(f,function(n){return i.startsWith(e,n.name)}),o,h;c&&(o=r[c.name],o.count++,o.keySize+=e.length,h=s(t).length,o.valueSize+=h,h>n&&(n=h,u=e))});try{t=s(r)}catch(e){t="Could not stringify the summary. Exception: "+v(e)}return"Summary: {0}. The longest value (key == {1}) took {2} bytes. The total storage length is {3}.".format(t,u,n,this._storage.length)},n.prototype._logError=function(n,t,i){var r=new Error(
"Setting Op("+n+") failed.");r.innerError=t;r.storageState=this._createStorageSummary();i&&(r.key=i);a.error(r,n)},n}();c=function(){function n(n){function r(n){return h[n]+"_"}function f(n,t){return r(n)+(t||"")}function t(n){return n===1?e:s}var e=n?new i.Map:new o(u.sessionStorage,"sessionStorage"),s=n?new i.Map:new o(u.localStorage,"localStorage");this.getValue=function(n,i,r){return t(r).get(f(n,i))};this.getAllComponentItems=function(n,i){var u=r(n),e=t(i),f={},o=u.length;return e.forEach(function(n,t){if(t.startsWith(u)){var i=t.substring(o,t.length);f[i]=n}}),f};this.setValue=function(n,i,r,u){t(u).set(f(n,i),r)};this.clearValue=function(n,i,r){var u=t(r),e=f(n,i),o=u.get(e);return u.delete(e),o};this.clearAllComponentItems=function(n,i){var e=r(n),u=t(i),f=[];u.forEach(function(n,t){t.startsWith(e)&&f.push(t)});f.forEach(function(n){u.delete(n)})};this.clearAll=function(){s.clear();e.clear()}}return n}()}(u||(u={})),u});define("MsPortalImpl/UI/UI.DesktopManager",["require","exports"],
function(){"use strict";var n;return function(n){var t=window,i;n.DesktopManagerEvents={activeJourneyChanged:"activejourneychanged",journeyActivating:"journeyActivating",journeyActivated:"journeyActivated",journeyDeactivated:"journeyDeactivated",journeyDiscarded:"journeyDiscarded",journeyCreating:"journeyCreating",journeyCreated:"journeyCreated",bladeOpening:"bladeOpening",bladeRebound:"bladeRebound",bladeClosed:"bladeClosed",settingsLoaded:"settingsLoaded"};n.isTraceEnabled=!!t.fx.environment.trace.desktop;i=function(){function n(n){this._currentDeferred=Q.defer();this._lastExecutionTime=0;this._throttleTimeout=n}return n.prototype.rejectPendingPromise=function(){this._currentDeferred.reject();t.clearTimeout(this._lastTimeoutHandler)},n.prototype.throttle=function(){var r=this,i=(new Date).getTime(),u=i-this._lastExecutionTime,f=u<this._throttleTimeout,n;return this._lastExecutionTime=i,this.rejectPendingPromise(),n=this._currentDeferred=Q.defer(),f?this._lastTimeoutHandler=t.setTimeout(
function(){n===r._currentDeferred&&n.resolve()},this._throttleTimeout):n.resolve(),n.promise},n}();n.ConsecutiveCallsThrottler=i}(n||(n={})),n});define("MsPortalImpl/Base/Base.Router",["require","exports","f","i","FxHubs/ResourceProvider","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Storage","./Telemetry","../UI/UI.DesktopManager","./Base.UriHelper"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return function(t){function ri(n,t){return function(){var r,u;try{t.apply(n,arguments)}catch(i){r=!0;i instanceof DOMException&&(u=i,(u.code===DOMException.SECURITY_ERR||u.name==="SecurityError")&&(r=!1));r&&ti.error(i,0)}}}function a(){return new nt(location.href)}function wt(n){return n.getFirstHashPart()===c[c.dashboard]}function bt(n,t){return n===void 0&&(n=a()),t===void 0&&(t=yt),n.isHashEmpty()||t&&wt(n)}function bi(n,i,r){var u,f;r===void 0&&(r=a());u=(c[c.dashboard]+"/"+n).toLowerCase();r.hash.toLowerCase()!=="#"+u&&(r.setHash(u),f=i?t.history_replaceState:pt,f(
null,null,r.href))}function ki(n){return n===void 0&&(n=a()),wt(n)?n.getRestOfHashParts():""}function ui(n,i){return i===void 0&&(i=a()),n.getValue(y,t.sessionStorageDeepLinkKey,p)===i.hashWithHashQueryString&&n.getValue(y,t.sessionStorageJourneyIdKey,p)||""}function di(n,t,i,r){var u=i;return u&&typeof u=="string"&&gt.isResourceManagerId(u)&&(u=u.substring(1)),new nt(r).setHash("#{0}/{1}/{2}/{3}".format(c[c.asset],ot(n.name,n.cloudName,!1),t,u)).toString()}function gi(n,t,i,r,u){var e=ot(n,i,!1),f="#{0}/{1}";return u&&(li(u.additionalConfig)||{}).preview&&(f+="/preview"),new nt(t).setHash(f.format(c[c.create],e)).toString()}function nr(n,t,i,r,u,f){u===void 0&&(u=!1);var e=new nt(i),s=n.cloudName,h=!0,o="";return(f&&(o="/"+f),r&&(ii(r,function(n,t){if(n!=="editScopeId"){var i=ko.unwrap(t);if(n===vi){s=i;return}if(i&&typeof i=="object")if(u)i=JSON.stringify(i);else{h=!1;return}i!==undefined&&(o+="/{0}/{1}".format(encodeURIComponent(n),encodeURIComponent(i||"")))}}),!h))?"":(e.setHash("#{0}/{1}/{2}{3}".
format(c[c.blade],ot(n.name,s,!1),t,o)),e.href.length>2082)?(v("Generated deep link failed. Uri '{0}' is greater than 2082 characters.".format(e.href)),""):e.toString()}function tr(n){return new fi.RouterImpl(n)}var kt=r,l=kt.Extension,ei=l.CloudName,ct=i.Base,k=ct.Constants,lt=k.ExtensionNames,oi=lt.Hubs,si=k.BladeNames.Hubs,hi=k.AssetNames,dt=ct.Diagnostics,ci=dt.Telemetry,d=ct.EventTypes,li=ko.unwrap,ai=i.Hubs.Notifications.NotificationStatus,gt=i.ViewModels.Services.ResourceTypes,g=s.DesktopManagerEvents,vi=kt.Constants.CloudName.inputBindingKey,it=o.Action,rt=o.Source,nt=h.Uri,pt,c,v,fi;t.sessionStorageJourneyIdKey="sessionStorageJourneyId";t.sessionStorageDeepLinkKey="sessionStorageDeepLink";t.journeyKey="journeyId";var tt=f.Shell,at=tt.deepLinkInvalid,b=window,ut=b.fx.environment,ni=f.Portal.defaultPageTitle.format(f.NavBar.home,ut.branding.title),ti=dt.createLog(n),y=e.ComponentName.Router,ft=ci.trace,p=1,yi=ut.links,pi=/^[\w-]+$/,w=b.history,et=decodeURIComponent,ii=i.forEachKey,
ir=i.keysLength,rr=i.require,ot=l.addCloudNameToId,ur=Array.prototype.slice,fr=i.isFeatureEnabled("resourcemenu"),vt=tt.deepLinkNotFound,yt=ut.features.deeplinkdashboard==="true",st="",wi={linkFormat:st,invalidLink:st,unfoundAsset:st,noResourceAsset:st},ht=r.getErrorMap(wi);pt=ri(w,w.pushState);t.history_replaceState=ri(w,w.replaceState);t.isDashboardUri=bt;t.updateDashboardUri=bi;t.getDashboardIdFromUri=ki;t.getStoredJourneyId=ui,function(n){n[n.asset=0]="asset";n[n.blade=1]="blade";n[n.create=2]="create";n[n.menu=3]="menu";n[n.resource=4]="resource";n[n.dashboard=5]="dashboard"}(c||(c={}));v=i.noop,function(n){function r(n){try{return JSON.parse(n)}catch(t){return n}}function i(n,t){v(n,t?" called with ("+t+")":null)}function e(n,t,i,r,u){return{extension:n,assetType:t,detailBladeInputs:i,cloudName:r,defaultMenuItemId:u}}n.safeJSONParse=r;var o=function(){function o(n){var t=this,i;this._linksMap={};this._map={};this._isListening=!1;this._assetTypes=n.assetTypeService;this._desktop=n.
desktop;this._extensions=n.extensionManager;this._notifications=n.notificationManager;this._storage=n.storageService;ii(yi,function(n,i){i&&(t._linksMap[i]=n)});i=function(n,i){t._map[c[n]]=i};i(c.asset,function(n){return t._handleAssetRoute(n)});i(c.blade,function(n){return t._handleBladeRoute(n)});i(c.create,function(n){return t._handleCreateRoute(n)});i(c.menu,function(n){return t._handleMenuRoute(n)});i(c.resource,function(n){return t._handleResourceRoute(n)});yt&&i(c.dashboard,function(n){return t._handleDashboardRoute(n)})}return o.prototype.route=function(n){return this._route(new nt(n))},o.prototype._route=function(n,t,r){var o,u,f,s,e;if(i("_route",n.hashWithHashQueryString),t){if(o=this._getActiveJourneyId(),t===o)return Q.resolve(null);if(u=this._handleJourneyRoute(t),u)return u}return n.isHashEmpty()||wt(n)&&r?(this._handleStartBoardRoute(),f=Q.resolve(null)):(s=n.getFirstHashPart(),e=this._map[s],f=e?e(n.getRestOfHashParts()):Q.reject(new Error("{0} is not a valid deep link".
format(n.hashWithHashQueryString)))),f},o.prototype.initialRoute=function(){var t=this,n=a(),i=ui(this._storage,n);return i&&ft({source:rt.BrowserRefresh,action:it.RestoreJourney,name:n.href}),this._route(n,i,!0).catch(function(){t._desktop.portalWidget.showStartBoard()}).finally(function(){t.startListening()})},o.prototype.startListening=function(){var n=this,r;$(b).on(d.popstate,this._popstateHandler=function(t){var r=t.originalEvent,u=r.state&&r.state.journeyId||"",f;i(d.popstate+" event ",u);f=a();n._route(f,u)});r=this._desktop;$(r.portalWidget.element).on(d.fxhomebuttonclick,this._onHomeClick=function(){var t=a();w.pushState({},"",t.setHash("#").clearHashQueryStringIfEmpty().href);n._route(t)});$(r).on(g.activeJourneyChanged,this._onJourneyChange=function(){var f=a(),u=n._getActiveJourneyId(),e=n._storage.getValue(y,t.sessionStorageJourneyIdKey,p),i,o=w.state,s=e===u||o&&o.journeyId===u,h;s?(i="activeJourneyId unchanged",n._updateNavHistory(!1)):u?bt(f)?(i="new journey",n._updateNavHistory(
!0)):e&&e!==u?(i="switched journeys",n._updateNavHistory(!0)):(i="deep link",n._updateNavHistory(!1)):r.isJourneyLoading?i="journey is loading. nothing to do":(i="no active journey. Go to startboard",n._clearStorage(),bt(f)||w.pushState({},ni,f.setHash("#").href),n._updateTitle());!s&&u&&(h=r.portalWidget.getSideBarWidget().options,h.isCollapsed(!0));v("journeyChanged: ",i)});$(r).on(g.bladeRebound,this._onRebind=function(){i(g.bladeRebound+" event ");v("_bladeReboundHandler.");n._updateNavHistory(!1)});this._isListening=!0},o.prototype._clearStorage=function(){var n=this._storage;n.clearValue(y,t.sessionStorageJourneyIdKey,p);n.clearValue(y,t.sessionStorageDeepLinkKey,p)},o.prototype.stopListening=function(){var n=this._desktop;$(b).off(d.popstate,this._popstateHandler);$(n).off(g.activeJourneyChanged,this._onJourneyChange).off(g.bladeRebound,this._onRebind);$(n.portalWidget.element).off(d.fxhomebuttonclick,this._onHomeClick);this._isListening=!1},o.prototype.dispose=function(){this.stopListening(
);this._resetTitleSubscription()},o.prototype._handleStartBoardRoute=function(){var n,t;i("_handleStartBoardRoute");var f=this._getActiveJourneyId(),r=this._desktop,u=r.portalWidget;r.tryDeactivateJourney();f||(n=u.getPanorama(),t=n&&n.getJourneyWidget(),t&&t.close());u.showStartBoard();this._updateTitle()},o.prototype._handleDashboardRoute=function(n){var t=this;return this._desktop.getDashboardManager().then(function(t){return t.switchDashboard({id:n,title:n},"Router")}).then(function(){t._handleStartBoardRoute()})},o.prototype._handleJourneyRoute=function(n){var t=this._desktop.getJourneysMetadata().first(function(t){return n===t.id});return t?this._desktop.activateJourney(n):(this._clearStorage(),null)},o.prototype._parseBladeRoute=function(t,i){var h={},a=l.getCloudNameFromId(t),r,e,c,o,u,s,f;if(t=l.removeCloudNameFromId(t),r=(t||"").split("/"),e=r.length,e<2)return null;for(o=e%2,o===1&&(c=r[2]),u=2+o;u<e;u=u+2){if(s=et(r[u]),f=et(r[u+1]),!s)return null;i&&f.match(/^\s*\{.*\}\s*$/)&&
(f=n.safeJSONParse(f));h[s]=f}return{extension:r[0],detailBlade:r[1],detailBladeInputs:h,cloudName:a,defaultMenuItemId:c}},o.prototype._handleBladeRoute=function(n){var f=this,t,r,u;return(i("_handleBladeRoute",n),t=this._parseBladeRoute(n,!0),!t)?(this._notify(at.format(n)),Q.reject(new Error("Deep link '"+n+"' does not follow format #blade/ExtensionName/BladeName/{key1}?/{value1?}/{keyN?}/{valueN?}."))):(r=this._desktop,u=r.generateLoadingJourneyGuid(),t.extension.toLowerCase()===oi.toLowerCase()&&(ei.addToModel(t.cloudName,t.detailBladeInputs),t.cloudName=k.DefaultCloudName),r.createJourneyForBlade(t,u).catch(function(t){f._notify(tt.deepLinkErrorLoading.format(n));throw t;}))},o.prototype._handleCreateRoute=function(n){var u,t,r;if(i("_handleCreateRoute",n),u=l.getCloudNameFromId(n),n=l.removeCloudNameFromId(n),t=(n||"").split("/"),!t.length)return this._notify(at.format(n)),Q.reject(new Error("Deep link "+n+" does not follow format #{routeTypes.create}/{package-id}."));ft({source:
rt.Gallery,action:it.DeepLinkVisited,name:n});r="";this._extensions.getInitializedExtensions().some(function(n){return n.name===lt.Marketplace})||(r="/useDelayedBlade/true/bladeWidth/0");var f=t.shift(),e=this._parseInputs(n,t),o=ot("{0}/{1}/package/{2}/additionalConfig/{3}/selectedMenuItemId/undefined/createLanding/undefined{4}".format(lt.Marketplace,si.CreateHubBlade,encodeURIComponent(f),encodeURIComponent(JSON.stringify(e)),r),u,!1);return this._handleBladeRoute(o)},o.prototype._handleMenuRoute=function(n){var t=this;return i("_handleMenuRoute",n),Q.fcall(function(){pi.test(n)||ht.linkFormat(n);var i=t._desktop.portalWidget.element.find(".fxs-menu-"+n.toLowerCase());i.length!==1&&ht.invalidLink(n);i.click();t._updateNavHistory(!1)})},o.prototype._handleAssetRoute=function(n){var s=this,h=l.getCloudNameFromId(n),t,o,c;if(n=l.removeCloudNameFromId(n),t=n.split("/"),t=n.match(/([^\/]+)\/([^\/]+)\/(.+)/i),i("_handleAssetRoute",n),!t||t.length<4)return this._notify(at.format(n)),Q.reject(
new Error("'"+n+"' is an invalid asset link. Correct format is #asset/{ExtensionName}/{AssetType}/{AssetId}"));var u=t[1],r=t[2],f=t[3];return typeof f=="string"&&gt.isResourceManagerId("/"+f)&&(f="/"+f),o=this._desktop,c=o.generateLoadingJourneyGuid(),this._extensions.getManifestByName(u,h).then(function(n){u=n.name;var i=r.toLowerCase(),t=n.assetTypes.first(function(n){return n.name.toLowerCase()===i});return t||(s._notify(vt.format(r)),ht.unfoundAsset(r)),r=t.name,ft({source:rt.Asset,action:it.DeepLinkVisited,name:u,data:r}),v("createJourneyForAsset: extension: '{0}' assetType: '{1}'".format(u,r)),o.createJourneyForAsset(e(u,r,{},h,null),c,f)}).catch(function(n){s._notify(vt.format(u));throw n;})},o.prototype._handleResourceRoute=function(n){var f=this,t,r,o,s;return i("_handleResourceRoute",n),n="/"+n.replace(/^\//,""),n=decodeURI(n),t=n.split("/"),r=null,t.length%2==0&&(r=t[t.length-1],n=n.substr(0,n.length-r.length-1)),o=this._desktop,s=o.generateLoadingJourneyGuid(),Q.fcall(function(
){var t=u.buildResourceTypeWithCloudName(n);return f._assetTypes.getAssetTypeByResourceTypePromiseWithFallback(t.resourceType,t.cloudName).then(function(u){var c=u.assetTypeManifest,a=c.name,v=u.extension,h=c.resourceType.resourceTypeName,y=t.cloudName;return a||(f._notify(vt.format(h)),ht.noResourceAsset(h)),ft({source:rt.Resource,action:it.DeepLinkVisited,name:v,data:h||hi.NonAssetResource}),i("_desktopManager.createJourneyForAsset",n),o.createJourneyForAsset(e(v,a,{},y,r),s,l.removeCloudNameFromId(n))}).catch(function(t){f._notify(tt.deepLinkErrorLoading.format(n));throw t;})})},o.prototype._parseInputs=function(n,t,i){var e,u,o,f;if(i===void 0&&(i=!1),e={},!t||t.length===0)return e;for(u=0;u<t.length;u=u+2)o=et(t[u]),f=et(t[u+1]),i&&f.startsWith("{")&&f.endsWith("}")&&(f=r(f)),e[o]=f;return e},o.prototype._resetTitleSubscription=function(){var n=this._titleSubscription;n&&n.dispose();this._titleSubscription=null},o.prototype._updateTitle=function(){var t=this._desktop,n=t.getActiveJourney(
),r=t.startBoard,o=r&&r.getDashboard()||{};if(document.title=yt&&o.title||ni,this._resetTitleSubscription(),n&&n.blades.length>0&&t.portalWidget.isJourneyVisible()){var i=n.blades[n.blades.length-1],s=i.isDefaultTitle(),u=f.Portal.windowTitleFormat,e=ut.branding.title;s||(b.document.title=u.format(i.title(),e));this._titleSubscription=i.title.subscribe(function(n){b.document.title=u.format(n,e)})}},o.prototype._getActiveJourneyId=function(){var t=this._desktop,n=t.getActiveJourney();return!n||!t.portalWidget.isJourneyVisible()||n.isStartedWithContextBlade()?"":n.id},o.prototype._notify=function(n){var t=new Date;this._notifications.addClientNotification({title:tt.deepLinkInvalidTitle,description:n,status:ai.Error,timestamp:t,correlationIds:[t.getTime().toString()],cloudName:k.DefaultCloudName})},o.prototype._updateNavHistory=function(n){var i=this,r=this._desktop.getActiveJourney(),u="_addDeepLinkToAddressBar: ";return r?r.getDeepLink().then(function(r){var e=i._getActiveJourneyId(),f,
o,s,h;e&&(f=a(),f.setHash(r),o=i._storage,o.setValue(y,t.sessionStorageJourneyIdKey,e,p),o.setValue(y,t.sessionStorageDeepLinkKey,f.hashWithHashQueryString,p),v(u,'complete: update address bar with: "{0}"'.format(f.href)),s={journeyId:e},h=n?pt:t.history_replaceState,h(s,document.title,f.href),i._updateTitle())},function(n){var t=n&&n.stack,u=["Failed to update address bar. Error: {0}.".format(n),"id:"+i._getActiveJourneyId(),"key:"+r.templateKey,t?"at: "+t:""];ti.warning(u.join("\n"))}):(v(u,"No active journey."),this._handleStartBoardRoute(),Q())},o}();n.RouterImpl=o}(fi=t.Internal||(t.Internal={}));t.getAssetDeepLink=di;t.getGalleryDeepLink=gi;t.getBladeDeepLink=nr;t.createRouter=tr}(c||(c={})),c});define("MsPortalImpl/UI/Hubs/UI.NotificationManager",["require","exports","f","i","../../Base/Base.Router","../../Base/Telemetry"],function(n,t,i,r,u,f){"use strict";var e;return function(t){function si(n){return ct=new it(n)}function hi(){return ct}function yt(n,t,i){return y.getWindowId(
{name:n,cloudName:t},{forceCloudName:!!i})}function ci(n,t){return yt(n.name,n.cloudName,t)}function v(n){return n&&n.trim()}function pt(n,t,i){i&&f.traceFeatureObsolete(at,n,{name:at,status:!0,properties:{version:t,count:i}})}function bt(n,t){var r=n.additionalProperties||{},u=n.correlationIds,i;b.extend(r,{status:e[n.status],correlationId:u&&u.join(",")});i=n.asset;kt.trace({source:ri,action:t,assetType:i&&i.assetType||"UnknownAsset",data:r})}function s(n,t,i){if(t&&i)return yt(t,n,!0)+"."+i}var rt=r.Constants,y=r.Extension,c=i.Base,p=c.Constants,ut=p.AssetNames,w=p.ExtensionNames,ft=c.Diagnostics,kt=ft.Telemetry,b=c.Utilities,dt=i.Extension,h=dt.NotificationMessageType,gt=i.Hubs.Notifications,e=gt.NotificationStatus,k=i.ViewModels,et=k.Dialogs,ot=et.DialogResult,ni=et.MessageBoxButtons,l=r.Hubs.Notifications,d=l.ClientNotificationUriAction,a=r.NotificationManager,g=f.Action,st=k.Services.ResourceTypes,ht=window,li=ft.createLog(n),ct,ti=600,ii=100,ai=ht.fx.environment.isDevelopmentMode,
ri=f.Source.NotificationHub,lt=w.Hubs,nt=w.AzureInsights,ui=rt.CloudName.inputBindingKey,fi=y.getHubsWindowId(),o=y.getDescriptor,at="LegacyNotifications",vt=d.OpenInNewTab,ei=ko.observable,oi=ko.observableArray,tt=Object.keys,wt,it;t.createNotificationManager=si;t.getNotificationManager=hi;wt=function(){function n(n,t){this.extensionWindowId=n;this.notificationDefinition=t}return n}();it=function(){function n(n){var t=this,r,u,f,e;this._listOfNotifications=oi();this._notificationDefinitions={};this._extensionNotifications={};this._serverEventToNotificationMap={};this._extenionsHeldByCorrelationId={};this._extensionsLoaded={};this._services=n;r=n.rpcClient;a.addNotificationsEndPoint.register(r,null,function(n,i){var u=i.srcWindowId,f,r;u&&(f=o(u).cloudName,r=n.notifications.map(function(n){return t._mapFxNotificationV1ToClientNotification(n,f)}),r=r.filter(function(n){return!!n}),r.forEach(function(n){return t._addOrUpdateNotification(n,u)}))});a.addNotification2EndPoint.register(r,null,
function(n,i){var r=i.srcWindowId,u;r&&(u=t._mapNotificationV2ToClientNotification(r,n.id,n.name,n.status,n.subStatus,n.assetId,n.properties),t._addOrUpdateNotification(u,r))});a.updateNotificationEndPoint.register(r,null,function(n){var i=t.notifications().first(function(t){return t.correlationIds&&t.correlationIds.some(function(t){return t.toLowerCase()===n.id})});if(i){var u=n.propertyName.toLowerCase(),f=n.propertyValue,r=i.correlationIds;u==="correlationid"?(r||(i.correlationIds=r=[]),r.push(f),t._addOrUpdateNotification(i)):u==="percentcomplete"&&(i.percentComplete=f,t._addOrUpdateNotification(i))}});u=function(n,r){var u=r.srcWindowId,f,e;u&&(f=o(u).cloudName,e=i.merge(n),e.forEach(function(n){n.cloudName=n.cloudName||f;t._addOrUpdateNotification(n,u)}))};f=[fi];l.addClientNotficationDefinition.register(r,null,u);l.addClientNotficationsDefinition.register(r,null,u);a.addServerEventsEndPoint.register(r,f,function(n){n.serverEvents.forEach(function(i){i&&t._addServerEvent(i,n.cloudName)}
)});l.showModalNotification.register(r,f,function(i){var r=i.notification;return t.addClientNotification(r),t._services.getService("DialogManager").then(function(n){return t.addClientNotification(r),n.showModalDialog({title:r.title,description:r.description,buttons:ni.OKCancel,defaultButtonText:i.primaryButtonText,cancelButtonText:i.secondaryButtonText,showErrorIcon:!0})}).then(function(u){var f=undefined;return u===ot.Ok?f=i.primaryButtonClickAction:u===ot.Cancel&&(f=i.secondaryButtonClickAction),f===1?t.handleNotificationClick(r):f===2&&n.redirect("/"),u})});e=this._services.extensionManager;e.onManifestLoad(function(n){var r=t._allCloudNames=t._allCloudNames||e.getExtensions().map(function(n){return n.cloudName}).unique(),i;return n.name===lt?(i=b.clone(n),r.forEach(function(n){i.cloudName=n;t._collectNotificationDefinitions(i)})):t._collectNotificationDefinitions(n),!0})}return n.prototype.listenForClientNotifications=function(){var i=this,n=[],t=this._services;t.extensionManager.getExtensions(
).forEach(function(t){t.name===nt&&n.push(t.getWindowId())});t.rpcClient.registerRpcEndPoint(rt.RpcMethods.getClientNotifications,{allowedOrigin:n,handler:function(){return i.notifications()}})},n.prototype.addClientNotification=function(n){this._addOrUpdateNotification(n)},n.prototype.handleNotificationClick=function(n){var ot=n.isRecommendation?g.RecommendationClicked:g.NotificationClicked,s,it,r,h,t,rt,e,ft,l,et;bt(n,ot);var a=this._services,o=a.router,f=n.cloudName,i=n.asset;if(i){var v=i.assetType,y=v.toLowerCase(),b=i.extensionName,tt=b.toLowerCase(),ct=!a.extensionManager.getExtension(nt,f)||tt===w.Billing.toLowerCase()&&y===ut.SubscriptionDetail.toLowerCase()||tt===lt.toLowerCase()&&y===ut.Deployments.toLowerCase();if(ct){s={};s[ui]=ei(f);it=u.getAssetDeepLink({name:b,cloudName:f},v,i.assetId,"",s);o.route(it);return}}if(r=n.uri,r){h=n.uriAction||c.Resources.isUriAbsolute(r)&&vt||d.NavigatePortal;h===vt?this._services.openWindow(r):h===d.OpenInCurrentTab?ht.window.location.href=
r:o.route(r);return}t=n.linkedBlade;t||((e=i&&i.assetId)&&typeof e=="string"&&st.isResourceManagerId(e)&&(ft=st.parseResourceManagerDescriptor(e),rt=ft.subscription),l=n.additionalProperties,t=k.getBladeSelection(nt,p.BladeNames.AzureInsights.NotificationActionBlade,{title:n.title,timestamp:n.timestamp.toString(),subscriptionId:rt||l&&l.subscriptionId||null}));t&&(et=u.getBladeDeepLink({cloudName:f,name:t.extension},t.detailBlade,"",t.detailBladeInputs,!0),o.route(et))},Object.defineProperty(n.prototype,"notifications",{get:function(){return this._listOfNotifications},enumerable:!0,configurable:!0}),n.prototype.definitionCount=function(){return tt(this._notificationDefinitions).length},n.prototype.newDefinitionCount=function(){return tt(this._extensionNotifications).length},n.prototype.serverEventsCount=function(){return tt(this._serverEventToNotificationMap).length},n.prototype._setLoadedExtension=function(n){this._extensionsLoaded[n]=!0},n.prototype.removeNotification=function(n){var
t=this.notifications().first(function(t){var i=t.correlationIds;return i&&i.some(function(t){return t===n})});t&&this.notifications.remove(t)},n.prototype._addOrUpdateNotification=function(n,t){var f,e,r,u;if(n&&(f=v(n.title),e=v(n.description),f&&e)){if(n.correlationIds&&n.correlationIds.length||(n.correlationIds=["clientNotification-"+b.getUniqueId()]),r=this.notifications(),u=r.first(function(t){var i=t.correlationIds||[],u=n.correlationIds||[],r=i.filter(function(t){return n.correlationIds.indexOf(t)!==-1});return r.length>0}),u)if(u.timestamp.getTime()<=n.timestamp.getTime())r.remove(u);else return;r.unshift(n);r=i.stableSort(r,function(n,t){return t.timestamp.getTime()-n.timestamp.getTime()});r.length>ii&&r.pop();this.notifications(r);n.isRecommendation&&bt(n,g.RecommendationAdded);t&&this._holdOntoExtension(t,n)}},n.prototype._addServerEvent=function(n,t){var i,r;n.source&&n.operationName&&(i=this._serverEventToNotificationMap[s(t,n.source,n.operationName)],i&&(r=this._mapNotificationV2ToClientNotification(
i.extensionWindowId,n.correlationId,i.notificationName,n.status,n.subStatus,n.assetId,n.properties,n.timestamp,!0),r&&this.addClientNotification(r)))},n.prototype._collectNotificationDefinitions=function(n){var t=this,r=ci(n,!0),u=n.name,f=n.cloudName,e=n.notifications,i;e&&(pt(u,1,e.length),e.forEach(function(n){var i=s(f,n.eventSource,n.eventType);t._notificationDefinitions[i]||(t._notificationDefinitions[i]=new wt(r,n))}));i=n.notifications2;i&&(pt(u,2,i.length),i.forEach(function(n){var e=n.name,h=s(f,u,e),i,o;t._extensionNotifications[h]=n;i=n.serverEvent;i&&i.operation&&i.source&&(o=s(f,i.source,i.operation),t._serverEventToNotificationMap[o]={extensionWindowId:r,notificationName:e})}));this._extensionsLoaded[r]=!0},n.prototype._holdOntoExtension=function(n,t){var i=this,r=t.correlationIds,f,u;if(r)if(t.status===e.InProgress){if(f=r.some(function(n){return!!i._extenionsHeldByCorrelationId[n]}),!f){var s=o(n),h=this._services,c=h.extensionManager.getExtension(s.name,s.cloudName);c&&
(u=h.rpcClient.acquireWindow(c.getWindowId(),ti),r.forEach(function(n){i._extenionsHeldByCorrelationId[n]=u;u.onDispose(function(){i._extenionsHeldByCorrelationId[n]&&delete i._extenionsHeldByCorrelationId[n]})}))}}else r.forEach(function(n){var t=i._extenionsHeldByCorrelationId[n];t&&t.dispose()})},n.prototype._mapNotificationV2ToClientNotification=function(n,t,i,r,u,f,e,h,c){var v,a,l,y,b,p,w,k;return(c===void 0&&(c=!1),v=o(n),a=this._extensionNotifications[s(v.cloudName,v.name,i)],a&&(y=a.messages.filter(function(n){return n.status.toLowerCase()===r.toLowerCase()}),u?l=y.first(function(n){return n.subStatus&&n.subStatus.toLowerCase()===u.toLowerCase()}):y.length===1&&(l=y[0]),l))?(b=v.cloudName,p=l.message,e&&(p=p.format(e)),w={title:l.title,description:p,timestamp:h||new Date,isRecommendation:!1,status:this._getNotificationStatusFromMessageType(l.type),cloudName:b,correlationIds:[t],additionalProperties:[],isServerEvent:c},!!(l.assetType||a.assetType)&&f&&(k=l.assetType||a.assetType,
w.asset={extensionName:o(n).name,assetType:k,assetId:f}),w):null},n.prototype._getNotificationStatusFromMessageType=function(n){switch(n){case h.Error:return e.Error;case h.Warning:return e.Warning;case h.Success:return e.Success;case h.Progress:return e.InProgress;case h.Info:return e.Information}},n.prototype._mapFxNotificationV1ToClientNotification=function(n,t){var i=this._formatNotificationV1FromExtensionManifest(n,t),r,u;return i?(r={title:i.label,description:i.description,timestamp:i.timestamp,isRecommendation:!1,cloudName:t,percentComplete:i.percentOperationComplete,status:i.state,correlationIds:[],additionalProperties:{}},u=i.clientDetails,i.assetId&&u&&(r.asset={extensionName:o(u.assetOwner).name,assetType:u.assetType,assetId:i.assetId}),i.correlationId&&r.correlationIds.push(i.correlationId),i.operationId&&r.correlationIds.push(i.operationId),i.subscriptionId&&(r.additionalProperties.subscriptionId=i.subscriptionId),r):null},n.prototype._formatNotificationV1FromExtensionManifest=
function(n,t){var r=n.eventType,f=n.source,u,i,e,o;return(f&&r&&(u=this._notificationDefinitions[s(t,f,r)],u?(i=u.notificationDefinition,n.label=i.label,n.description=i.message.format(n.descriptionArgs),n.clientDetails=i.assetType?{assetOwner:u.extensionWindowId,assetType:i.assetType}:null):(n.label=n.label||r,n.description=n.description||r,n.assetId||(n.clientDetails=null))),e=v(n.label),o=v(n.description),!e||!o)?null:n},n}();t.NotificationManager=it}(e||(e={})),e});define("MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed",["require","exports"],function(){"use strict";var n;return function(){ko.extenders.allowOverride||(ko.extenders.allowOverride=function(n,t){if(t!==!0)throw new Error("'allowOverride' extender only accepts 'true' as a parameter.");var r=!1,u,i=ko.computed({read:n,write:function(t){u=t;r||n(t)}});return i.override=function(t){r=!0;n(t)},i.restoreLastWrittenValue=function(){r=!1;n(u)},i(n()),i})}(n||(n={})),n});define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",
["require","exports","f","i","u"],function(n,t,i,r,u){"use strict";var f;return function(t){function ot(n,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return et(ut,this,[n,t].concat(r.map(ko.toJS)))}function a(n){try{var t=ko.toJSON(n)}catch(i){return i.message}return t}function nt(n,t){var i=a(t);return i?"{0}\nModel: '{1}'".format(n,i):n}function ht(n,t,i,r){var f=v(r,k),u={};return Array.isArray(t)&&t.forEach(function(t){var r=t.source,s=t&&r&&r.scope===g.CurrentContainer&&r.modelType===i,o=s&&e.getModelValue(n,r.property);o&&o.exists&&(y(f,t.targetProperty,o.value),e.setModelValue(u,t.targetProperty,ko.toJS(o.value)))}),u}function v(n,t){if(t){var e=n.toLowerCase(),i=function(n){return w.isPlainObject(n)&&!w.isEmptyObject(n)?Object.keys(n).every(function(n){return e.indexOf(n.toLowerCase())>=0}):!1},r=i(t.debug),o=i(t.log),u=i(t.verbose),f;return(o||r||u)&&(f={debugId:n,breakOnInputsSet:r,verbose:u}),f}}function y(n,t,r){n&&n.verbose&&!i.Util.canSendThroughPostMessage(
r)&&b.verbose("Inputs should be simple data objects without functions/observables: {0} | {1} | {2}".format(n.debugId,t,ko.toJSON(r)))}var it=r.TriggerableLifetimeManager,h=i.Base,p=h.Utilities,w=p.Internal.JQuery,b=h.Diagnostics.createLog(n),s=ko.unwrap,rt=window,c=rt.fx.environment,k=c.trace.inputsset,d=ko.utils.peekObservable,ut=Array.prototype.splice,ft=h.KnockoutExtensions.Internal.quickApplyArrayEdits,et=i.applyCall,g,st,o,f,l,e,tt;(function(n){n[n.CurrentContainer=0]="CurrentContainer";n[n.MasterContainer=1]="MasterContainer";n[n.DetailsContainer=2]="DetailsContainer"})(t.ReferenceScope||(t.ReferenceScope={}));g=t.ReferenceScope,function(n){n[n.OneToOne=0]="OneToOne";n[n.OneToMany=1]="OneToMany";n[n.ManyToOne=2]="ManyToOne"}(t.ReferenceCardinality||(t.ReferenceCardinality={}));st=t.ReferenceCardinality,function(n){n[n.Object=0]="Object";n[n.Array=1]="Array"}(t.ObservableKind||(t.ObservableKind={}));o=t.ObservableKind;f=function(){function n(n,t){this.kind=n;this.propertyName=t}return n.
forObject=function(t,i,r){var u=new n(o.Object,t);return u.propertyValue=i,u.propertyOldValue=r,u},n.forArray=function(t,i){var r=new n(o.Array,t);return r.propertyArrayEdits=i||[],r},n.forNewArray=function(t,i){var r=new n(o.Array,t);return r.propertyValue=i,r},n}();t.ObservableChangeArgs=f;l=function(){function n(n,t,i,r,u){this.cancel=!1;this.propertyChanges=[];this.sourceModelId=n;this.sourceModel=t;this.sourceProperty=i;this.targetModel=r;this.targetProperty=u}return n}();t.PropertyTransformerArgs=l;e=function(){function n(n,t,r,u,f,e){this.transformers=[];this.compositionBindingDefinition=null;this._callbacks=$.Callbacks();this._errCallbacks=$.Callbacks();this._tgtHasValue=!1;this._srcProp=n;this._tgtProp=t;this._tgtModel=r;this._tgtModelName=u;this.transformers=f;this._awaitBound=i.Helpers.Deferred();this._tgtPropExists=e;this._traceOptions=v(this._tgtModelName,k)}return Object.defineProperty(n.prototype,"sourceProperty",{get:function(){return this._srcProp},enumerable:!0,configurable:
!0}),Object.defineProperty(n.prototype,"sourceModelName",{get:function(){return this._srcModelName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"targetModel",{get:function(){return this._tgtModel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sourceModel",{get:function(){return this._srcModel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"targetProperty",{get:function(){return this._tgtProp},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBound",{get:function(){return!!this._srcModel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"awaitBound",{get:function(){return this._awaitBound.promise()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"targetHasValue",{get:function(){return this._tgtHasValue},enumerable:!0,configurable:!0}),n.prototype.addValueChangedHandler=function(n){n&&this._callbacks.add(n)},n.prototype.removeValueChangedHandler=function(n){this._callbacks.
remove(n)},n.prototype.addErrorHandler=function(n){n&&this._errCallbacks.add(n)},n.prototype.bind=function(n,t,i,r,e){var o=this,h,c,s;if(i===void 0&&(i=!0),this.isBound){this._err("Property binding is already bound.");return}return this.addValueChangedHandler(r),this.addErrorHandler(e),this._validateBinding(n,t)?(this._srcModelName=n,this._srcModel=t,h=this._getSrcValue(),c=d(h),i&&c!==u&&this._changeTgtModel(f.forObject(this._tgtProp,c)),ko.isObservable(h)?(s=h,this._bindingLifetime=new it,s.subscribe(this._bindingLifetime,function(n){var t,u,i,r;Array.isArray(n)?(u=n,t=n.slice(0)):t=n;(s.splice||s.map)&&(i="arrayChange");r=o._bindingLifetime.createChildLifetime();s.subscribe(r,function(n){var e,h;r.dispose();i==="arrayChange"&&(e=n,n=s());Array.isArray(t)&&Array.isArray(n)?u===n?(e=e||ko.utils.compareArrays(t,n,{sparse:!0}),h=f.forArray(o._tgtProp),h.propertyArrayEdits=ko.utils.adjustArrayEdits(e),o._changeTgtModel(h)):o._changeTgtModel(f.forNewArray(o._tgtProp,n)):o._changeTgtModel(
f.forObject(o._tgtProp,s(),t))},null,i)},null,"beforeChange")):i||this._err("Error when binding. The value is not an observable and importInitialValue is false."),this._awaitBound.resolve()):this._awaitBound.reject(),this},n.prototype.unbind=function(){this._bindingLifetime&&(this._bindingLifetime.dispose(),this._bindingLifetime=null);this._srcModel=null;this._srcModelName=null;this._callbacks.empty();this._errCallbacks.empty()},n.prototype.toString=function(){return"\n\nDetails:\nSource model id: '{0}'.\nSource property: '{1}'.\nTarget model id: '{2}'.\nTarget property: '{3}'.\nSource model: '{4}'.\nTarget model: '{5}'.".format(this._srcModelName||"<UNBOUND>",this._srcProp,this._tgtModelName,this._tgtProp||"<DYNAMIC>",this._srcModel?a(this._srcModel):"<UNBOUND>",a(this._tgtModel))},n.getModelValue=function(n,t,i){for(var e=t?t.split("."):[],f={exists:n&&e.length>0,value:u},r=n,o=0,h=i?d:s;f.exists&&o<e.length;)r=h(r),r&&r.hasOwnProperty(e[o])?r=r[e[o]]:f.exists=!1,o++;return f.exists&&
(f.value=r),f},n.setModelValue=function(n,t,i){for(var o=function(i){if(!i||typeof i!="object")throw new Error(nt("A property in model hierarchy is not an object. Path: '{0}'.".format(t),n));return i},f=t.split("."),u=o(n),r,e=0;e<f.length-1;e++)r=f[e],(!u.hasOwnProperty(r)||p.isNullOrUndefined(u[r]))&&(u[r]={}),u=o(s(u[r]));r=f.last();u[r]&&ko.isObservable(u[r])?u[r](i):u[r]=i},n.prototype._changeTgtModel=function(t){var r=this,f=new l(this._srcModelName,this._srcModel,this._srcProp,this._tgtModel,this._tgtProp),i,e;t&&f.propertyChanges.push(t);this._processTransformers(f)&&((f.propertyChanges||[]).forEach(function(t){var f,h,c;t.propertyName&&(f=r._traceOptions,t.kind===o.Object?(r._tgtHasValue=t.propertyValue!==u,y(f,t.propertyName,t.propertyValue),n.setModelValue(r._tgtModel,t.propertyName,ko.toJS(t.propertyValue))):(i=n.getModelValue(r._tgtModel,t.propertyName).value,e=s(i),h=t.propertyArrayEdits,Array.isArray(e)?h?(f&&f.verbose&&h.forEach(function(n){n.status==="added"&&y(f,t.propertyName,
n.value)}),ko.isObservable(i)&&i.valueWillMutate(),r._tgtHasValue=!0,ft(e,h,{inplaceFixup:!1,spliceFunc:ot}),ko.isObservable(i)&&i.valueHasMutated()):t.propertyValue&&(r._tgtHasValue=!0,c=t.propertyValue,i.splice?i.splice.apply(i,[0,e.length].concat(c)):i(c)):r._err("[Property Binding] Array change detected on source property, but target property is not an array.")))}),this._callbacks.fire(f.propertyChanges))},n.prototype._processTransformers=function(n){return this.transformers.some(function(t){return t(n),n.cancel}),!n.cancel},n.prototype._getSrcValue=function(){return n.getModelValue(this._srcModel,this._srcProp).value},n.prototype._validateBinding=function(n,t){var i,r=this.compositionBindingDefinition,u=!(r&&r.optional);return this._validateModel(n,t,this._srcProp,u,function(n){i=n})?this._srcProp?this._validateModel(this._tgtModelName,this._tgtModel,this._tgtProp,this._tgtPropExists,function(n){i=n})||(i="[Property Binding] Invalid target model - {0}".format(i)):i="[Property Binding] Invalid source model - Source property must be defined.":
i="[Property Binding] Invalid source model - {0}".format(i),i&&this._err(i),!i},n.prototype._validateModel=function(t,i,r,u,f){var e;return t?i?r&&u&&!n.getModelValue(i,r).exists&&(e="Model is missing property '{0}'.".format(r)):e="Model is undefined.":e="Model is missing an identifier.",e&&f&&f(nt(e+"\nModel id: '{0}'.".format(t||"N/A"),i)),!e},n.prototype._err=function(n){this.isBound&&(n+=this.toString());var t=c.trace;(c.isDevelopmentMode||t&&t.diagnostics)&&b.error(n);this._errCallbacks.fire(n)},n}();t.PropertyBinding=e;tt=function(){function n(n,t,i){var r=this;this._properties=[];this._propertyChangedCallbacks=$.Callbacks();this._aggregatePropertyChangedHandler=function(n){r._propertyChangedCallbacks.fire(n)};this._targetModel=t;this._targetModelName=n;this._validateTargetPropertiesExist=i!==!1}return Object.defineProperty(n.prototype,"properties",{get:function(){return this._properties.slice(0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"targetModelName",
{get:function(){return this._targetModelName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"targetModel",{get:function(){return this._targetModel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"awaitAllBound",{get:function(){var n=this._properties.map(function(n){return n.awaitBound});return $.when.apply($,n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allBound",{get:function(){return this.properties.every(function(n){return n.isBound})},enumerable:!0,configurable:!0}),n.prototype.addPropertyChangedHandler=function(n){this._propertyChangedCallbacks.add(n)},n.prototype.addProperty=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return i=new e(n,n,this._targetModel,this._targetModelName,r,this._validateTargetPropertiesExist),i.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(i),i},n.prototype.mapProperty=function(n,t){for(var r,u=[],i=2;i<arguments.length;i++)u[i-
2]=arguments[i];return r=new e(n,t,this._targetModel,this._targetModelName,u,this._validateTargetPropertiesExist),r.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(r),r},n.prototype.removeProperty=function(n){var t=this._properties.indexOf(n);t>=0&&(this._properties[t].unbind(),this._properties[t].removeValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.splice(t,1))},n.prototype.getProperty=function(n){return this._properties.first(function(t){return t.targetProperty===n})},n.prototype.unbind=function(){this._properties.forEach(function(n){n.unbind()});this._propertyChangedCallbacks.empty()},n.prototype.toString=function(){for(var t="",i=this.properties,r=this.properties.length,n=0;n<r;++n)t+="properties[{0}]: {1}".format(n,i[n].toString());return t},n}();t.PropertyBindings=tt;t.mapSourceModelToTargetModel=ht;t.extractTraceOptions=v}(f||(f={})),f});define("MsPortalImpl/Base/Languages",["require","exports","f","MsPortalFx/Globalization",
"../Services/Services.Storage"],function(n,t,i,r,u){"use strict";var f;return function(n){function v(){function t(t){var r=this,i=t[0];n[i]={locale:i,name:t[1],localizedName:t[2],neutralCulture:r}}var n={};return[["de","German","Deutsch"],["en","English","English"],["es","Spanish","Espaol"],["fr","French","Franais"],["it","Italian","Italiano"],["hu","Hungarian","Magyar"],["nl","Dutch","Nederlands"],["pl","Polish","Polski"],["pt","Portuguese","Portugus"],["sv","Swedish","Svenska"],["tr","Turkish","Trke"],["cs","Czech","etina"],["ru","Russian",""],["zh","Chinese",""],["zh-hans","Chinese (Simplified)","()"],["zh-chs","Chinese (Simplified) Legacy","() "],["zh-hant","Chinese (Traditional)","()"],["zh-cht","Chinese (Traditional) Legacy","() "],["ja","Japanese",""],["ko","Korean",""],].forEach(t,!0),[["de-be","German (Belgium)","Deutsch (Belgien)"],["de-de","German (Germany)","Deutsch (Deutschland)"],["de-li","German (Liechtenstein)",
"Deutsch (Liechtenstein)"],["de-lu","German (Luxembourg)","Deutsch (Luxemburg)"],["de-ch","German (Switzerland)","Deutsch (Schweiz)"],["de-at","German (Austria)","Deutsch (sterreich)"],["en-as","English (American Samoa)","English (American Samoa)"],["en-ai","English (Anguilla)","English (Anguilla)"],["en-ag","English (Antigua and Barbuda)","English (Antigua and Barbuda)"],["en-au","English (Australia)","English (Australia)"],["en-bs","English (Bahamas)","English (Bahamas)"],["en-bb","English (Barbados)","English (Barbados)"],["en-be","English (Belgium)","English (Belgium)"],["en-bz","English (Belize)","English (Belize)"],["en-bm","English (Bermuda)","English (Bermuda)"],["en-bw","English (Botswana)","English (Botswana)"],["en-io","English (British Indian Ocean Territory)","English (British Indian Ocean Territory)"],["en-vg","English (British Virgin Islands)","English (British Virgin Islands)"],["en-cm","English (Cameroon)","English (Cameroon)"],["en-ca","English (Canada)",
"English (Canada)"],["en-029","English (Caribbean)","English (Caribbean)"],["en-ky","English (Cayman Islands)","English (Cayman Islands)"],["en-cx","English (Christmas Island)","English (Christmas Island)"],["en-cc","English (Cocos (Keeling) Islands)","English (Cocos (Keeling) Islands)"],["en-ck","English (Cook Islands)","English (Cook Islands)"],["en-dm","English (Dominica)","English (Dominica)"],["en-er","English (Eritrea)","English (Eritrea)"],["en-150","English (Europe)","English (Europe)"],["en-fk","English (Falkland Islands)","English (Falkland Islands)"],["en-fj","English (Fiji)","English (Fiji)"],["en-gm","English (Gambia)","English (Gambia)"],["en-gh","English (Ghana)","English (Ghana)"],["en-gi","English (Gibraltar)","English (Gibraltar)"],["en-gd","English (Grenada)","English (Grenada)"],["en-gu","English (Guam)","English (Guam)"],["en-gg","English (Guernsey)","English (Guernsey)"],["en-gy","English (Guyana)","English (Guyana)"],["en-hk","English (Hong Kong SAR)",
"English (Hong Kong SAR)"],["en-in","English (India)","English (India)"],["en-id","English (Indonesia)","English (Indonesia)"],["en-ie","English (Ireland)","English (Ireland)"],["en-im","English (Isle of Man)","English (Isle of Man)"],["en-jm","English (Jamaica)","English (Jamaica)"],["en-je","English (Jersey)","English (Jersey)"],["en-ke","English (Kenya)","English (Kenya)"],["en-ki","English (Kiribati)","English (Kiribati)"],["en-ls","English (Lesotho)","English (Lesotho)"],["en-lr","English (Liberia)","English (Liberia)"],["en-mo","English (Macao SAR)","English (Macao SAR)"],["en-mg","English (Madagascar)","English (Madagascar)"],["en-mw","English (Malawi)","English (Malawi)"],["en-my","English (Malaysia)","English (Malaysia)"],["en-mt","English (Malta)","English (Malta)"],["en-mh","English (Marshall Islands)","English (Marshall Islands)"],["en-mu","English (Mauritius)","English (Mauritius)"],["en-fm","English (Micronesia)","English (Micronesia)"],["en-ms","English (Montserrat)",
"English (Montserrat)"],["en-na","English (Namibia)","English (Namibia)"],["en-nr","English (Nauru)","English (Nauru)"],["en-nz","English (New Zealand)","English (New Zealand)"],["en-ng","English (Nigeria)","English (Nigeria)"],["en-nu","English (Niue)","English (Niue)"],["en-nf","English (Norfolk Island)","English (Norfolk Island)"],["en-mp","English (Northern Mariana Islands)","English (Northern Mariana Islands)"],["en-pk","English (Pakistan)","English (Pakistan)"],["en-pw","English (Palau)","English (Palau)"],["en-pg","English (Papua New Guinea)","English (Papua New Guinea)"],["en-ph","English (Philippines)","English (Philippines)"],["en-pn","English (Pitcairn Islands)","English (Pitcairn Islands)"],["en-pr","English (Puerto Rico)","English (Puerto Rico)"],["en-rw","English (Rwanda)","English (Rwanda)"],["en-kn","English (Saint Kitts and Nevis)","English (Saint Kitts and Nevis)"],["en-lc","English (Saint Lucia)","English (Saint Lucia)"],["en-vc","English (Saint Vincent and the Grenadines)",
"English (Saint Vincent and the Grenadines)"],["en-ws","English (Samoa)","English (Samoa)"],["en-sc","English (Seychelles)","English (Seychelles)"],["en-sl","English (Sierra Leone)","English (Sierra Leone)"],["en-sg","English (Singapore)","English (Singapore)"],["en-sx","English (Sint Maarten)","English (Sint Maarten)"],["en-sb","English (Solomon Islands)","English (Solomon Islands)"],["en-za","English (South Africa)","English (South Africa)"],["en-ss","English (South Sudan)","English (South Sudan)"],["en-sh","English (St Helena, Ascension, Tristan da Cunha)","English (St Helena, Ascension, Tristan da Cunha)"],["en-sd","English (Sudan)","English (Sudan)"],["en-sz","English (Swaziland)","English (Swaziland)"],["en-tz","English (Tanzania)","English (Tanzania)"],["en-tk","English (Tokelau)","English (Tokelau)"],["en-to","English (Tonga)","English (Tonga)"],["en-tt","English (Trinidad and Tobago)","English (Trinidad and Tobago)"],["en-tc","English (Turks and Caicos Islands)",
"English (Turks and Caicos Islands)"],["en-tv","English (Tuvalu)","English (Tuvalu)"],["en-um","English (U.S. Outlying Islands)","English (U.S. Outlying Islands)"],["en-vi","English (U.S. Virgin Islands)","English (U.S. Virgin Islands)"],["en-ug","English (Uganda)","English (Uganda)"],["en-gb","English (United Kingdom)","English (United Kingdom)"],["en-us","English (United States)","English (United States)"],["en-vu","English (Vanuatu)","English (Vanuatu)"],["en-001","English (World)","English (World)"],["en-zm","English (Zambia)","English (Zambia)"],["en-zw","English (Zimbabwe)","English (Zimbabwe)"],["es-ar","Spanish (Argentina)","Espaol (Argentina)"],["es-bo","Spanish (Bolivia)","Espaol (Bolivia)"],["es-cl","Spanish (Chile)","Espaol (Chile)"],["es-co","Spanish (Colombia)","Espaol (Colombia)"],["es-cr","Spanish (Costa Rica)","Espaol (Costa Rica)"],["es-cu","Spanish (Cuba)","Espaol (Cuba)"],["es-ec","Spanish (Ecuador)","Espaol (Ecuador)"],["es-sv","Spanish (El Salvador)",
"Espaol (El Salvador)"],["es-es","Spanish (Spain, International Sort)","Espaol (Espaa, alfabetizacin internacional)"],["es-us","Spanish (United States)","Espaol (Estados Unidos)"],["es-ph","Spanish (Philippines)","Espaol (Filipinas)"],["es-gt","Spanish (Guatemala)","Espaol (Guatemala)"],["es-gq","Spanish (Equatorial Guinea)","Espaol (Guinea Ecuatorial)"],["es-hn","Spanish (Honduras)","Espaol (Honduras)"],["es-419","Spanish (Latin America)","Espaol (Latinoamrica)"],["es-mx","Spanish (Mexico)","Espaol (Mxico)"],["es-ni","Spanish (Nicaragua)","Espaol (Nicaragua)"],["es-pa","Spanish (Panama)","Espaol (Panam)"],["es-py","Spanish (Paraguay)","Espaol (Paraguay)"],["es-pe","Spanish (Peru)","Espaol (Per)"],["es-pr","Spanish (Puerto Rico)","Espaol (Puerto Rico)"],["es-do","Spanish (Dominican Republic)","Espaol (Repblica Dominicana)"],["es-uy","Spanish (Uruguay)","Espaol (Uruguay)"],["es-ve","Spanish (Venezuela)","Espaol (Venezuela)"],["fr-dz","French (Algeria)",
"Franais (Algrie)"],["fr-be","French (Belgium)","Franais (Belgique)"],["fr-bf","French (Burkina Faso)","Franais (Burkina Faso)"],["fr-bi","French (Burundi)","Franais (Burundi)"],["fr-bj","French (Benin)","Franais (Bnin)"],["fr-cm","French (Cameroon)","Franais (Cameroun)"],["fr-ca","French (Canada)","Franais (Canada)"],["fr-029","French (Caribbean)","Franais (carabes)"],["fr-km","French (Comoros)","Franais (Comores)"],["fr-cg","French (Congo)","Franais (Congo)"],["fr-cd","French (Congo DRC)","Franais (Congo, Rpublique dmocratique du)"],["fr-ci","French (Cte dIvoire)","Franais (Cte dIvoire)"],["fr-dj","French (Djibouti)","Franais (Djibouti)"],["fr-fr","French (France)","Franais (France)"],["fr-ga","French (Gabon)","Franais (Gabon)"],["fr-gp","French (Guadeloupe)","Franais (Guadeloupe)"],["fr-gq","French (Equatorial Guinea)","Franais (Guine quatoriale)"],["fr-gn","French (Guinea)","Franais (Guine)"],["fr-gf","French (French Guiana)","Franais (Guyane franaise)"],
["fr-ht","French (Haiti)","Franais (Hati)"],["fr-re","French (Runion)","Franais (La Runion)"],["fr-lu","French (Luxembourg)","Franais (Luxembourg)"],["fr-mg","French (Madagascar)","Franais (Madagascar)"],["fr-ml","French (Mali)","Franais (Mali)"],["fr-ma","French (Morocco)","Franais (Maroc)"],["fr-mq","French (Martinique)","Franais (Martinique)"],["fr-mu","French (Mauritius)","Franais (Maurice)"],["fr-mr","French (Mauritania)","Franais (Mauritanie)"],["fr-yt","French (Mayotte)","Franais (Mayotte)"],["fr-mc","French (Monaco)","Franais (Monaco)"],["fr-ne","French (Niger)","Franais (Niger)"],["fr-nc","French (New Caledonia)","Franais (Nouvelle-Caldonie)"],["fr-pf","French (French Polynesia)","Franais (Polynsie franaise)"],["fr-rw","French (Rwanda)","Franais (Rwanda)"],["fr-cf","French (Central African Republic)","Franais (Rpublique centrafricaine)"],["fr-bl","French (Saint Barthlemy)","Franais (Saint-Barthlemy)"],["fr-mf","French (Saint Martin)",
"Franais (Saint-Martin)"],["fr-pm","French (Saint Pierre and Miquelon)","Franais (Saint-Pierre-et-Miquelon)"],["fr-sc","French (Seychelles)","Franais (Seychelles)"],["fr-ch","French (Switzerland)","Franais (Suisse)"],["fr-sy","French (Syria)","Franais (Syrie)"],["fr-sn","French (Senegal)","Franais (Sngal)"],["fr-td","French (Chad)","Franais (Tchad)"],["fr-tg","French (Togo)","Franais (Togo)"],["fr-tn","French (Tunisia)","Franais (Tunisie)"],["fr-vu","French (Vanuatu)","Franais (Vanuatu)"],["fr-wf","French (Wallis and Futuna)","Franais (Wallis-et-Futuna)"],["it-it","Italian (Italy)","Italiano (Italia)"],["it-sm","Italian (San Marino)","Italiano (San Marino)"],["it-ch","Italian (Switzerland)","Italiano (Svizzera)"],["hu-hu","Hungarian (Hungary)","Magyar (Magyarorszg)"],["nl-aw","Dutch (Aruba)","Nederlands (Aruba)"],["nl-be","Dutch (Belgium)","Nederlands (Belgi)"],["nl-bq","Dutch (Bonaire, Sint Eustatius and Saba)","Nederlands (Bonaire, Sint Eustatius en Saba)"],
["nl-cw","Dutch (Curaao)","Nederlands (Curaao)"],["nl-nl","Dutch (Netherlands)","Nederlands (Nederland)"],["nl-sx","Dutch (Sint Maarten)","Nederlands (Sint-Maarten)"],["nl-sr","Dutch (Suriname)","Nederlands (Suriname)"],["pl-pl","Polish (Poland)","Polski (Polska)"],["pt-ao","Portuguese (Angola)","Portugus (Angola)"],["pt-br","Portuguese (Brazil)","Portugus (Brasil)"],["pt-cv","Portuguese (Cabo Verde)","Portugus (Cabo Verde)"],["pt-gw","Portuguese (Guinea-Bissau)","Portugus (Guin-Bissau)"],["pt-mz","Portuguese (Mozambique)","Portugus (Moambique)"],["pt-pt","Portuguese (Portugal)","Portugus (Portugal)"],["pt-mo","Portuguese (Macao SAR)","Portugus (RAE de Macau)"],["pt-st","Portuguese (So Tom and Prncipe)","Portugus (So Tom e Prncipe)"],["pt-tl","Portuguese (Timor-Leste)","Portugus (Timor-Leste)"],["sv-fi","Swedish (Finland)","Svenska (Finland)"],["sv-se","Swedish (Sweden)","Svenska (Sverige)"],["sv-ax","Swedish (land Islands)","Svenska (land)"],["tr-cy",
"Turkish (Cyprus)","Trke (Gney Kbrs Rum Kesimi)"],["tr-tr","Turkish (Turkey)","Trke (Trkiye)"],["qps-ploc","Pseudo (Pseudo)","[ () !!! !!]"],["cs-cz","Czech (Czech Republic)","etina (esk republika)"],["ru-by","Russian (Belarus)"," ()"],["ru-kz","Russian (Kazakhstan)"," ()"],["ru-kg","Russian (Kyrgyzstan)"," ()"],["ru-md","Russian (Moldova)"," ()"],["ru-ru","Russian (Russia)"," ()"],["ru-ua","Russian (Ukraine)"," ()"],["zh-cn","Chinese (Simplified, China)","()"],["zh-tw","Chinese (Traditional, Taiwan)","()"],["zh-sg","Chinese (Simplified, Singapore)","()"],["zh-mo","Chinese (Traditional, Macao SAR)","()"],["zh-hk","Chinese (Traditional, Hong Kong SAR)","()"],["ja-jp","Japanese (Japan)"," ()"],["ko-kr","Korean (Korea)","()"],].forEach(t,!1),n}function y(n){var t=f[n];return t?t.localizedName:null}function s(n,t){var
u="-",f=0,i,r;return n===t?!0:(i=n.split(u),r=t.split(u),i.length<2||r.length<2)?i[f]===r[f]:!1}function p(i,r){var o=0,h=1,f;if(i&&r){var l=i.toLowerCase().split(n.localeDelimiter),a=r.toLowerCase().split(n.localeDelimiter),v=l[o],y=t.indexOf(v)>=0,p=y&&!s(v,a[o]),u=l[h],w=t.indexOf(u)>=0,b=u&&w&&!s(u,a[h]);if(p||b)return f=new c.UriBuilder(e.location.href),f.query.setParameter(n.localeQueryStringName,i),f.toString()}}function w(i,u,f,e){e===void 0&&(e=l);ko.reactor(i,function(){var t=f();t?u.setValue(n.lastLocaleSettingComponent,n.lastLocaleSettingKey,t,n.lastLocaleSettingLifetime):u.clearValue(n.lastLocaleSettingComponent,n.lastLocaleSettingKey,n.lastLocaleSettingLifetime)});var o=f(),s=p(o,e);if(s)return s;n.currentLocaleContext=new h.LocaleContextImpl({supportedLocales:t,displayLanguage:r.displayLanguage,formatCulture:r.formatCulture,rawLocaleSetting:o})}var c=i.Base,e=window,o=e.fx.environment,l=o.effectiveLocale,t=o.supportedLocales,f=v(),a=i.forEachKey,h;n.lastLocaleSettingComponent=
u.ComponentName.Redirect;n.lastLocaleSettingKey="LastLocaleSetting";n.lastLocaleSettingLifetime=0;n.getLocalizedName=y;n.localeQueryStringName="l";n.localeDelimiter=".",function(t){function i(n,t){var i=[];return n.forEach(function(n){n in t&&i.push(t[n])}),i}function r(n){var t={},i=[];return n.map(function(n){return n.locale.split("-")[0]}).forEach(function(n){t[n]=n}),a(f,function(n,r){var u=n.split("-"),f=u[0];u.length>1&&!r.neutralCulture&&t[f]&&i.push(r)}),i}function u(t,i,r){if(t){if(t&&t.indexOf(n.localeDelimiter)>=0)return t.split(".")[1]}else return r;return null}var e=function(){function n(n){this.selectableDisplayLanguages=[];var t=n.displayLanguage;this.selectableDisplayLanguages=i(n.supportedLocales,f);this.selectedDisplayLanguage=t;this.selectedFormatCulture=u(n.rawLocaleSetting,t,n.formatCulture);this.selectableFormatCultures=r(this.selectableDisplayLanguages)}return n}();t.LocaleContextImpl=e}(h=n.Internal||(n.Internal={}));n.initialize=w}(f||(f={})),f});define("MsPortalImpl/Services/Services.AssetTypes.Utils",
["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(n){function v(n,i){return e(n)&&e(i)?t.compareResourceManagerId(n,i):f.deepEquals(n,i)}function y(n,i,r){var u=function(n){return typeof n!="string"?f.toSortedString(n):n},e=t.tryBuildResourceManagerKey(r)||u(r);return(h.getWindowId(n,{forceCloudName:!0})+":"+i+":"+e).toLowerCase()}function p(n,t){var r=new c,i="failed";return t().then(function(n){return i="success",n}).finally(function(){s(n,i,r.millisecondsElapsed)})}function s(){}function w(){return o}var h=r.Extension,u=i.Base,c=u.Stopwatch.TelemetryStopwatch,f=u.Utilities,t=i.ViewModels.Services.ResourceTypes,l=window,a=l.fx.environment,b=a.isDevelopmentMode,e=t.isResourceManagerId,o;n.compareAssetId=v;n.getMruItemKey=y;o={};n.timePromise=p;n.recordTelemetryTimeElapsed=s;n.prepareTelemetryResults=w}(u||(u={})),u});define("MsPortalImpl/Services/Services.AssetTypes",["require","exports","f","i","FxHubs/RpcEndPoints","../Base/Base.ItemCache","../Extension/Extension.Definition.Locator",
"MsPortalImpl/Resources/ImplScriptResources","./Services.AssetTypes.Utils","./Services.PortalIdentity","../Base/Base.Router"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return function(t){function hu(n){fi.push(n)}function ft(n){return wt(n)||bt(n)}function ht(n){return ft(n)||pi(n)}function wf(n,t){return wt(n)&&wt(t)&&fu(n,t)}function bf(n,t){return bt(n)&&bt(t)&&yf(n,t)}function kf(n,t){return pi(n)&&pi(t)&&pf(n,t)}function ki(n,t){return wf(n,t)||bf(n,t)||kf(n,t)}function df(n,t){return n===du&&t===ni.SubscriptionDetail}function di(n,t){var i=t;return(n&1)==1&&(i.startsWith(vi)||(i=vi+i)),i}function cu(n){return wt(n)?lt.Subscriptions:bt(n)?lt.ResourceGroups:st(n)}function au(n){return n.replace(lu,function(n,t,i){return i.toLowerCase()})}function ne(n,t,i){return au(n+" "+t+(i?" "+i:""))}function vu(n){var t=b(n.message,n.stack);return t.status=n.status,t}function te(n){var t=n.text||n.name,i=n.pluralDisplayName||t;return{plural:i,singular:n.singularDisplayName||t,lowerPlural:
n.lowerPluralDisplayName||t,lowerSingular:n.lowerSingularDisplayName||t,service:n.serviceDisplayName||i}}function yu(n,t,i){var r;return fi.some(function(u){return r=u.provideAssetTypeKeywords(n,t,i),!!r}),r}function ie(n){var t;return fi.some(function(i){return t=i.provideCategoryName(n),!!t}),t||n}function pu(n,t){return n||!!t.isPreview}function re(){return bi}function ue(n){bi=n}function fe(n){return n&&n.icon?n.icon:it.Images.Polychromatic.ResourceDefault()}function ee(n,t,i,r,u){var h=function(n,t){n.reject(t)},s;r=r||h;s=function(n){n.reject(new Error("Promise timed out"))};u=u||s;var f=Q.defer(),e=f.promise,o=e.isPending.bind(e);return n.then(function(n){o()&&i(f,n)},function(n){o()&&r(f,n)}),Q.delay(t).then(function(){o()&&u(f)}),e}function oe(n,t,i,r,u){var h=function(n,t){n.reject(t)},l,c,s;r=r||h;l=function(n,t){n.notify(t)};r=r||h;var f=Q.defer(),e=f.promise,o=e.isPending.bind(e);return n.then(function(n){o()&&i(f,n)},function(n){o()&&r(f,n)}),c=0,s=function(){Q.delay(t).then(
function(){o()&&(u(f,++c),s())})},s(),e}function l(n){return n.assetTypeManifest}function ei(n,t,i,u,f){i===void 0&&(i=null);u===void 0&&(u=null);f===void 0&&(f=null);var e=l(n);return{icon:f||n.icon,selection:r.ViewModels.getBladeSelection(n.cloudName,u||e.bladeExtensionName||n.extension,i||e.bladeName,{id:t}),isPreview:n.isPreview}}function gi(n,t){var i;if(!t)return!0;var u=l(n),f=u.resourceType,e=f&&f.resourceTypeName,r=function(n){return(t&n)===n};return r(1)&&((i=u.browseType,i===undefined)||r(5)&&(i!==iu||!e)||r(9)&&(i!==pt&&i!==yt||!u.browseLinkUri||r(25)&&i!==pt||r(41)&&i!==yt))?!1:r(2)&&!e?!1:!0}function dt(n,t,i){return n.extensionName===t&&n.assetType===i}function gt(n,t,i,r){return dt(n,t,i)&&s.compareAssetId(n.assetId,r)}function wu(n,t,i){return"Extension <"+n+"> : AssetType <"+t+"> : ID <"+i+">"}function nr(n,t,i){return b("Asset type does not specify a resource type. Extension <"+t+"> : AssetType <"+i+"> : "+n)}function tr(n,t){return b("Resource ID <"+n+"> is not a subscription ID, resource group ID or resource ID."+
(t||""))}function ir(n,t,i,r){return tr(n," "+wu(t,i,r))}function rr(n,t,i){return new Error("The "+n+" view model was already disposed. Extension <"+t+"> : ViewModel <"+i+">")}function se(n,t){var r=t.name,i=yu(n,r,""),u;i&&i.length&&(t.keywords=pr((t.keywords||"").split(",").filter(function(n){return!!n}).concat(i)).join(","));u=t.resourceType||{};(u.kinds||[]).forEach(function(t){var u=(t.name||"").toLowerCase(),i=yu(n,r,u);i&&(t.keywords=pr((t.keywords||"").split(",").filter(function(n){return!!n}).concat(i)).join(","))})}function bu(n,t,i,r){return{assetTypeManifest:t,id:wi(n.name,i,t.name),extension:n.name,cloudName:i,compositeDisplayName:te(t),icon:fe(t),isPreview:pu(r,t)}}function ur(n){return p.getDescriptor(n.srcWindowId).cloudName}function he(n,t){p.getAssetTypeInformationEndPoint.register(n,null,function(n,i){return t.getAssetTypeInformation(n.extensionName,n.assetType,ur(i))});p.getResourceTypeAssetTypeInformationEndPoint.register(n,null,function(n,i){return t.getResourceTypeAssetTypeInformation(
n,ur(i))});p.mapAssetIdToDynamicSelectionAndIconEndPoint.register(n,null,function(n,i){var r={reason:"mapAssetIdToDynamicSelectionAndIcon",extension:i.srcWindowId};return t.mapAssetIdToDynamicSelectionAndIcon(n.assetId,ur(i),r)})}function ce(n,t){var i=p.getHubsWindowId();at.getRegisteredAssetTypesInformationEndPoint.registerObjectFactory(n,{allowedOrigin:[i],allowRemoteChanges:!0,handler:function(){var n=t.getRegisteredAssetTypesInformation();return Q(ru(n))}});at.getAssetTypeInformationEndPoint.register(n,[i],function(n){return t.getAssetTypeInformation(n.extensionName,n.assetType,n.cloudName)});at.getResourceTypeAssetTypeInformationEndPoint.register(n,[i],function(n){return t.getResourceTypeAssetTypeInformation(n.resourceTypes,n.cloudName)});at.mapAssetIdToDynamicSelectionEndPoint.register(n,[i],function(n){return t.mapAssetIdToDynamicSelectionAndIcon(n.assetTriplet,n.cloudName,{reason:"mapAssetIdToDynamicSelection",extension:"HubsExtension"}).then(function(n){return n.selection})})}
function fr(n,t){ii.disposeViewModelProperties(t);n.releaseViewModel(t)}function le(n){return Q({icon:n.icon,kind:null,isPreview:n.isPreview})}function d(n,t,i){n.push(t);n.length>i&&n.splice(0,n.length-i)}function ae(n,t,i){return new ku(i,n,t||h.getSignedInUser())}function ve(n){var t=n.rpcClient,i=n.assetTypeService;he(t,i);ce(t,i)}var p=r.Extension,g=p.CloudMap,er=p.CloudName,oi=r.TriggerableLifetimeManager,it=i.Base,ct=it.Constants,ni=ct.AssetNames,si=ct.BladeNames.Hubs,or=ct.ExtensionNames,w=or.Hubs,du=or.Billing,lt=ct.ResourceTypes,sr=it.Diagnostics,hr=it.Rpc.Internal,gu=i.Extension,et=gu.BrowseType,cr=i.ViewModels,rt=cr.Services.ResourceTypes,ti=i.Assets,lr=r.Assets,nf=cr.Services.DynamicBlade,at=u.AssetTypes,ar=ti.AssetContracts,nt=f.ItemArrayCache,hi=f.ItemCache,vr=f.LifetimeItemCache,ii=it.Utilities,tf=e.Locator,ri=window,ci=ri.fx.environment,ui=sr.createLog(n),vt=ui.warning.bind(ui),rf=ui.error.bind(ui),yr=3e4,li=3e5,tt=216e5,uf=2e4,ut="Timeout trying to load extension manifest",
k=200,ff=3e5,ef=o.BrowseCategories,of=o.AssetTypeKeywords,y=i.find,v=i.remove,pr=i.unique,ai=i.require,wr=i.isFeatureEnabled("browsegrid2"),br=i.getFeatureValue("assettypeapiversion"),kr=wr?"Resources":si.BrowseResourceBlade,dr=function(){return i.isFeatureEnabled("resourcemenu")},gr="ResourceMap$ResourceProviderViewModel",nu="MsPortalImpl/Services/Services.AssetTypes",tu=nu+"Delayed",sf=nu+".Logger",hf="(none)",vi="/subscriptions/",ot=si.ResourceMenuBlade,cf=et.AssetTypeBlade,yt=et.InstanceLink,yi=et.NoBrowse,iu=et.ResourceType,pt=et.ServiceLink,lf=et.ServiceViewModel,ru=ko.observable,af=ko.observableArray,uu=ti.supportsContract,b=sr.createIgnoreUnhandledRejectionError,vf=ci.isDevelopmentMode,wt=rt.isSubscriptionId,fu=rt.compareSubscriptionId,bt=rt.isResourceGroupId,yf=rt.compareResourceGroupId,pi=rt.isResourceId,pf=rt.compareResourceId,st=rt.buildResourceTypeFromResourceId,wi=lr.getAssetTypeOrResourceTypeId,a=p.isEqualCloudName,eu=ni.NonAssetResource,kt=s.timePromise,ou=c.getBladeDeepLink,
bi,su,fi,gf,lu,ku;t.allAssetTypesRetrievalNotifyPeriodInMilliseconds=vf?1e4:5e3;t.allAssetTypesRetrievalTimeoutInMilliseconds=t.allAssetTypesRetrievalNotifyPeriodInMilliseconds*5;su=function(){function n(){}return n}();t.AssetType=su;fi=[];t.registerStringProvider=hu;gf={};lu=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;hu({provideCategoryName:function(n){return ef[au(n)]||n},provideAssetTypeKeywords:function(n,t,i){var r=of[ne(n,t,i)];return r&&r.split(",")||[]}});t.provideCategoryName=ie;t.isAssetTypeInPreview=pu;t.getCloudNames=re;t.setCloudNames=ue;t.createAssetTypeService=ae;t.setupAssetTypeServiceRpc=ve;t.Internal={};ku=function(){function n(n,t,i){var u=this,r;this._assetTypes=af([]);this._resourceMappingCache=new g;this._resourceAssetIdCache=new g;this._assetIdToResourceIdPromises=[];this._resourceIdToAssetIdPromises=[];this._assetIdSelectionCache=new g;this._resourceIdSelectionCache=new g;this._assetIdIconAndKindCache=new g;this._resourceGroupReferenceCache=new g;this._resourceReferenceCache=
new g;this._assetTypePromises=[];this._assetTypeByIdPromises=[];this._assetTypeByIdBrowseLink={};this._assetTypeByResourceTypePromises=[];this._resourceTypeMappingPromises=[];this._selectionFromAssetIdPromises=[];this._selectionFromResourceIdPromises=[];this._iconAndKindFromResourceIdPromises=[];this._resourceGroupReferencePromises=[];this._resourceReferencePromises=[];this._duplicateResourceTypes=new g;this._apiVersionOverrides={};this._extensionManager=t;this._client=n;this._cachedUser=i;this._initialLoad=t.initialManifestsLoadPromise();br&&(r=br.split(","),r&&r.forEach(function(n){var t=n.split(":");t.length===2&&(u._apiVersionOverrides[t[0].toLowerCase()]=t[1])}));this._listenForExtensions()}return n.prototype._getDynamicBladePromiseForAssetType=function(n,t){var u=l(n),i=n.extension,r=u.dynamicBladeServiceViewModel;if(!r)throw b("The asset type does not have a dynamic blade service view model. Extension <"+i+"> : AssetType <"+u.name+">");return Q(this._extensionManager.getExtensionByName(
i,n.cloudName)).then(function(n){return Q(n.getViewModel(r)).then(function(u){var f=!1;if(t.registerForDispose(function(){f=!0;fr(n,u)}),!f)return u.content;throw rr("dynamic blade service",i,r);})})},n.prototype._mapAssetTypeToInternalResourceTypeAssetTypeInformation=function(n){var t=this.mapAssetTypeToResourceTypeAssetTypeInformation(n);return t.cloudName=n.cloudName,t},n.prototype._getAssetTypePromise=function(n,t){var a=this,i=n(),h,e;if(i)return Q(i);var o=this._extensionManager,u=Q.defer(),s=u.promise,r=s.isPending.bind(s),c=[],l=function(t){var f=t.getManifest();Q.isPending(f)&&c.push(f);f.then(function(){r()&&(i=n(),i&&u.resolve(i))})},f="Could not find the asset type";if(t){if(h=function(){var n=o.getExtension(t.extensionName,t.cloudName);return n?(l(n),!0):(a.allManifestsLoaded()&&r()&&u.reject(b(f+", extension was not available.")),!1)},!h()&&r())o.onManifestLoad(function(){return!h()&&r()})}else if(e=o.getExtensions(),e&&e.length)e.forEach(function(n){l(n)});else return Q.
reject(b(f+", no extensions available."));return r()&&ee(Q.allSettled(c),uf,function(){r()&&(i=n(),i?u.resolve(i):u.reject(b(f+" after all extension manifests loaded.")))},function(){r()&&u.reject(b(f+", an error occurred loading the manifests."))},function(){r()&&u.reject(b(ut))}),s},n.prototype._getAssetTypeByResourceType=function(n,t,i){var f=this,e=n.toLowerCase(),o=y(this._assetTypeByResourceTypePromises,function(n){return a(n.cloudName,t)&&n.resourceType===e&&n.requirements===i}),r,u;return o?o.promise:(r=this._getAssetTypePromise(function(){return f.getAssetTypeByResourceType(n,t,i)}),u={resourceType:e,promise:r,requirements:i,cloudName:t},d(this._assetTypeByResourceTypePromises,u,k),r.catch(function(n){n===ut&&(vt(ut),v(f._assetTypeByResourceTypePromises,u))}),r)},n.prototype._getResourceTypeMappingPromiseForAssetType=function(n,t){var u=l(n).resourceType,i=u&&u.mappingViewModel,r;if(!i)throw b("The resource type does not have a resource type mapping view model. AssetType <"+n+
">");return r=n.extension,Q(this._extensionManager.getExtensionByName(r,n.cloudName)).then(function(n){return Q(n.getViewModel(i)).then(function(u){var f=!1;if(t.registerForDispose(function(){f=!0;fr(n,u)}),!f)return u.content;throw rr("resource type mapping",r,i);})})},n.prototype._getMappingViewModel=function(n){var o=l(n),i=this._resourceTypeMappingPromises,u=this._resourceMappingCache,r,t;if(u.getOrSet(n.cloudName,new vr(yr)).hasEntry(n.id))return Q(u.get(n.cloudName).getEntry(n.id));if(r=o.resourceType.resourceTypeName.toLowerCase(),t=y(i,function(t){return a(t.cloudName,n.cloudName)&&t.resourceType===r}),t)return t.promise;var f=new oi,e=this._getResourceTypeMappingPromiseForAssetType(n,f).then(function(e){return u.get(n.cloudName).addEntry(n.id,e,f),t=y(i,function(t){return a(t.cloudName,n.cloudName)&&t.resourceType===r}),t&&v(i,t),e}),s={resourceType:r,cloudName:n.cloudName,promise:e};return d(i,s,k),e},n.prototype._getDynamicBladeReference=function(n,t){var i=new oi;return this.
_getDynamicBladePromiseForAssetType(n,i).then(function(n){if(typeof n.onInputsSet!="function")return null;var i=n.onInputsSet({assetId:t.assetId,usage:nf.Usage.DynamicAssetSelection});return(i||Q(!0)).then(function(){return n},function(){return null})}).then(function(n){return n&&n.bladeName()?{blade:n.bladeName(),extension:n.extensionName()}:null}).finally(function(){i.dispose();i=null})},n.prototype._getResourceProvider=function(){var n=this;return this._resourceProviderPromise?this._resourceProviderPromise:(this._resourceProviderPromise=Q(this._extensionManager.getHubsExtension()).then(function(t){return Q(t.getViewModel(gr)).then(function(i){n._resourceProviderLifetime||(n._resourceProviderLifetime=new oi);if(n._resourceProviderLifetime.registerForDispose(function(){fr(t,i)}),!0)return i.content;throw rr("resource map provider",w,gr);})}).catch(function(t){if(!n._resourceProviderLifetime)return n._resourceProviderPromise=null,Q.reject(t)}),this._resourceProviderPromise)},n.prototype.
_getDynamicSelectionAndIconFromAssetId=function(n,t){var r=ei(n,t.assetId),u=this._selectionFromAssetIdPromises,f=y(u,function(i){return a(i.cloudName,n.cloudName)&&gt(i.assetId,t.extensionName,t.assetType,t.assetId)}),i;return f?f.promise:(i=function(i){return d(u,{assetId:t,cloudName:n.cloudName,promise:i},k),i},l(n).dynamicBladeServiceViewModel)?i(this._getDynamicBladeReference(n,t).then(function(i){return i?ei(n,t.assetId,i.blade,i.extension):r})):i(Q(r))},n.prototype._getResourceTypeCachePromise=function(n){return this._resourceTypeCachePromise?this._resourceTypeCachePromise:(this._resourceTypeCachePromise=this._getResourceProvider().then(function(t){return t.getResourceTypeCache(n)}),this._resourceTypeCachePromise)},n.prototype._getResourceReference=function(n,t,i){var e=this,r=this._resourceReferenceCache,u,f;return r.getOrSet(t,new hi(li)).hasEntry(n)?Q(r.get(t).getEntry(n)):(u=y(this._resourceReferencePromises,function(i){return a(i.cloudName,t)&&i.resourceId===n}),u)?u.promise:
(f=this._getResourceProvider().then(function(u){return u.getResource(n,t,i).then(function(i){return r.get(t).addEntry(n,i),v(e._resourceReferencePromises,function(i){return a(i.cloudName,t)&&i.resourceId===n}),i})}),d(this._resourceReferencePromises,{resourceId:n,cloudName:t,promise:f},k),f)},n.prototype._getResourceGroupReference=function(n,t,i){var o=this,r=this._resourceGroupReferenceCache,u,f,e;return r.getOrSet(t,new hi(li)).hasEntry(n)?Q(r.get(t).getEntry(n)):(u=function(){return y(o._resourceGroupReferencePromises,function(i){return a(i.cloudName,t)&&i.resourceGroupId===n})},f=u(),f)?f.promise:(e=this._getResourceProvider().then(function(f){return f.getResourceGroup(n,t,i).then(function(i){r.get(t).addEntry(n,i);var f=u();return f&&v(o._resourceGroupReferencePromises,f),i})}),d(this._resourceGroupReferencePromises,{resourceGroupId:n,cloudName:t,promise:e},k),e)},n.prototype._getDynamicSelectionAndIconFromResourceId=function(n,t,i,u,f){var p=this,o=ei(n,i.assetId),e=o.selection,s=
l(n),h=dr(),c,v;return wt(t)?r.Azure.getAllSubscriptions(this._client||hr.client,u).then(function(n){if(!n.first(function(n){return fu(vi+n.subscriptionId,t)})){var i=b("Could not find susbscription");i.status=it.Net2.HttpStatusCode.NotFound;throw i;}return h&&(e.extension=w,e.detailBlade=ot),Q(o)}):bt(t)?this._getResourceGroupReference(t,u,f).then(function(n){if(n.error)throw n.error;return h&&(e.extension=w,e.detailBlade=ot),o}).catch(function(n){if(n&&n.message)throw vu(n);throw n;}):(c=y(this._selectionFromResourceIdPromises,function(i){return a(i.cloudName,n.cloudName)&&i.resourceId===t}),c)?c.promise:(v=this._getResourceReference(t,n.cloudName,f).then(function(t){var r,u;if(t.error)throw t.error;return s.name===eu?(h&&(e.extension=w,e.detailBlade=ot),o):(r=!1,h&&s.viewModel&&uu(s.contracts,ar.ResourceMenuConfig)&&(e.extension=w,e.detailBlade=ot,r=!0),u=function(){return s.dynamicBladeServiceViewModel?p._getDynamicBladeReference(n,i).then(function(t){return t?ei(n,i.assetId,t.blade,
t.extension,o.icon):o}):Q(o)},ai(tu).then(function(i){if(s.resourceType&&s.resourceType.kinds){var c=!1,l=!1,f=!1;return(i.getIconAndBladeFromAssetTypeInformation(t,s.resourceType.kinds,null,function(n){n?h&&s.viewModel&&uu(s.contracts,ar.KindResourceMenuConfig)&&(e.extension=w,e.detailBlade=ot,r=!0):r=!1},function(n){l||(l=!0,o.isPreview=n)},function(n){c||(c=!0,o.icon=n)},function(t,i){f||r||(f=!0,e.extension=t||n.extension,e.detailBlade=i)}),f||r)?o:u()}return p._getResourceTypeCachePromise(n.cloudName).then(function(n){var f=!1,s=!1;return(i.getIconAndBladeFromResourceTypeAndKind(t,n,null,function(n){s||(s=!0,o.icon=n)},function(n,t){f||r||(f=!0,e.extension=n,e.detailBlade=t)}),f||r)?o:u()})}))}).catch(function(n){if(n&&n.message)throw vu(n);throw n;}),d(this._selectionFromResourceIdPromises,{resourceId:t,cloudName:n.cloudName,promise:v},k),v)},n.prototype._getIconAndKindFromResourceId=function(n,t,i,r,u){var h=this,f={icon:n.icon,kind:null,isPreview:n.isPreview},e=l(n),o,s;return ft(
t)?Q(f):(o=y(this._iconAndKindFromResourceIdPromises,function(n){return n.resourceId===t}),o)?o.promise:(s=this._getResourceReference(t,n.cloudName,u).then(function(n){if(n.error)throw n.error;return ai(tu).then(function(t){if(e.resourceType&&e.resourceType.kinds){var i=!1,u=!1,o=!1;return t.getIconAndBladeFromAssetTypeInformation(n,e.resourceType.kinds,function(n){i||(i=!0,f.kind=n)},null,function(n){o||(o=!0,f.isPreview=n)},function(n){u||(u=!0,f.icon=n)}),Q(f)}return h._getResourceTypeCachePromise(r).then(function(i){var r=!1,u=!1;return t.getIconAndBladeFromResourceTypeAndKind(n,i,function(n){r||(r=!0,f.kind=n)},function(n){u||(u=!0,f.icon=n)}),f})})}),d(this._iconAndKindFromResourceIdPromises,{resourceId:t,promise:s},k),s)},n.prototype._getAssetTypeInformation=function(){var t=this,n=[];return this.assetTypes().forEach(function(i){n.push(t._mapAssetTypeToInternalResourceTypeAssetTypeInformation(i))}),n},n.prototype._getResourceTypeAssetTypeInformation=function(n,i){var f=this,e=t.
Internal.getResourceTypeAssetTypeInformationOverride,r,u;return e?e(n,i):(r=n,r.sort(),u=[],r.forEach(function(n){u.push(f.getAssetTypeByResourceTypePromise(n,i).then(function(n){return f.mapAssetTypeToResourceTypeAssetTypeInformation(n)}).catch(function(){return{resourceType:n,extensionName:null,assetType:null,browseType:yi,compositeDisplayName:null,icon:null,viewModel:null,contracts:0}}))}),Q.all(u))},n.prototype._flushCachesForAssetType=function(n){var r=l(n).name,u=n.extension,t=n.cloudName,f,e,i;this._resourceMappingCache.getOrSet(t,new vr(yr)).removeEntry(n.id);this._resourceAssetIdCache.getOrSet(t,new nt(tt)).removeEach(function(n){return dt(n.assetId,u,r)});v(this._assetIdToResourceIdPromises,function(n){return a(n.cloudName,t)&&dt(n.assetId,u,r)});this._assetIdSelectionCache.getOrSet(t,new nt(tt)).removeEach(function(n){return dt(n.assetId,u,r)});v(this._assetTypePromises,function(n){return a(n.cloudName,t)&&n.extension===u&&n.assetType===r});f=wi(u,t,r);v(this._assetTypeByIdPromises,
function(n){return n.assetTypeId===f});this._assetTypeByIdBrowseLink[f]&&delete this._assetTypeByIdBrowseLink[f];v(this._selectionFromAssetIdPromises,function(n){return a(n.cloudName,t)&&dt(n.assetId,u,r)});u===w&&r===ni.ResourceGroups&&(this._resourceGroupReferenceCache.all().forEach(function(n){n.flush()}),v(this._resourceGroupReferencePromises,function(n){return a(n.cloudName,t)}));e=l(n).resourceType;e&&(i=e.resourceTypeName.toLowerCase(),v(this._resourceIdToAssetIdPromises,function(n){if(ft(n.resourceId)||!a(n.cloudName,t))return!1;var r=st(n.resourceId);return r.toLowerCase()===i}),this._resourceIdSelectionCache.getOrSet(t,new nt(tt)).removeEach(function(n){if(ft(n.resourceId))return!1;var t=st(n.resourceId);return t.toLowerCase()===i}),this._resourceReferenceCache.getOrSet(t,new hi(li)).removeEach(function(n){if(ft(n))return!1;var t=st(n);return t.toLowerCase()===i}),v(this._assetTypeByResourceTypePromises,function(n){return a(n.cloudName,t)&&n.resourceType===i}),v(this._resourceTypeMappingPromises,
function(n){return a(n.cloudName,t)&&n.resourceType===i}),v(this._selectionFromResourceIdPromises,function(n){if(ft(n.resourceId)||!a(n.cloudName,t))return!1;var r=st(n.resourceId);return r.toLowerCase()===i}),v(this._resourceReferencePromises,function(n){if(ft(n.resourceId)||!a(n.cloudName,t))return!1;var r=st(n.resourceId);return r.toLowerCase()===i}))},n.prototype._preventDuplicateResourceTypes=function(n,t){var r=t.resourceType.resourceTypeName.toLowerCase(),u=this._duplicateResourceTypes.getOrSet(n.cloudName,{}),o=function(){var t="The extension <"+n.name+"> has a duplicate resource type <"+r+"> originally found in the <"+u[r]+"> extension.";vt(t)},i,f,e;if(u[r])return o(),!1;if(i=y(this._assetTypes(),function(t){var i=l(t).resourceType;return a(t.cloudName,n.cloudName)&&i&&i.resourceTypeName&&i.resourceTypeName.toLowerCase()===r}),i)if(f=t.browseType,e=l(i).browseType,e===pt||e===yt)this._assetTypes.remove(i);else return f===pt||f===yt?!1:(this._assetTypes.remove(i),u[r]=i.extension,
o(),!1);return!0},n.prototype._listenForExtensions=function(){var i=this,t,n=this._assetTypes,f=function(){t&&(ri.clearTimeout(t),t=undefined);t=ri.setTimeout(function(){ai(sf).then(function(i){i.logAssetTypes(n);ri.clearTimeout(t);t=undefined})},ff)},u=this._extensionManager,r=this._mappedBrowseBlades={};u.onManifestLoad(function(t,e){var c=dr(),o=n().filter(function(n){return p.isEqualDescriptor(t,{name:n.extension,cloudName:n.cloudName})}),s,h;return o.forEach(function(n){i._flushCachesForAssetType(n)}),s=p.getWindowId(t).toLowerCase(),r[s]=r[s]||{},t.assetTypes&&t.assetTypes.forEach(function(u){var h=y(o,function(n){return l(n).name===u.name}),f,s,w,b,g,p;if(h&&(v(o,h),n.remove(h)),f=u.resourceType,s=f&&f.resourceTypeName,s){if(w=s.split("/"),w.length<2){b="Asset type <"+u.name+"> with invalid resource type <"+s+"> in extension <"+t.name+">.  Asset type skipped.";vt(b);return}if(!i._preventDuplicateResourceTypes(t,u))return}var k=function(n,i,u){if(n&&c&&u){var f=(i||t.name).toLowerCase(
),e=r[f]||(r[f]={});e[n.toLowerCase()]=!0}},a=f&&f.kinds,d=ti.supportsContract(u.contracts,ti.AssetContracts.ResourceMenuConfig);a&&a.length?a.forEach(function(n){k(n.bladeName||u.bladeName,n.bladeExtensionName||u.bladeExtensionName,n.useResourceMenu!==undefined?n.useResourceMenu:d)}):k(u.bladeName,u.bladeExtensionName,d);se(t.name,u);g=wi(t.name,t.cloudName,u.name);f&&(p=i._apiVersionOverrides[g.toLowerCase()],p&&(u.resourceType.apiVersion=p));t.name===it.Constants.ExtensionNames.Hubs?bi.forEach(function(i){n.push(bu(t,u,i,e))}):n.push(bu(t,u,t.cloudName,e))}),h=n(),v(h,function(n){return o.indexOf(n)>=0}),n(h),f(),i.allManifestsLoaded()&&u.getHubsExtension().then(function(){at.registeredAssetTypesInformationUpdatedEndPoint.invoke(hr.client,w,undefined)}),!0})},n.prototype._getAssetTypeById=function(n,t){var u=this,f=y(this._assetTypeByIdPromises,function(i){return i.assetTypeId===n&&i.requirements===t}),i,r;return f?f.promise:(i=this._getAssetTypePromise(function(){return u.getAssetTypeById(
n,t)}),r={assetTypeId:n,promise:i,requirements:t},d(this._assetTypeByIdPromises,r,k),i.catch(function(n){n===ut&&(vt(ut),v(u._assetTypeByIdPromises,r))}),i)},n.prototype._getAssetType=function(n,t,i,r,u){var o=this,l={name:n,cloudName:i},s=y(this._assetTypePromises,function(n){var i={name:n.extension,cloudName:n.cloudName};return p.isEqualDescriptor(i,l)&&n.assetType===t&&n.requirements===u}),h,f,e,c;return s?(r&&r(s.options()),s.promise):(h=function(){return o._getAssetTypePromise(function(){return o.getAssetType(n,t,i,u)},{extensionName:n,cloudName:i})},e=ru(0),f=df(n,t)?this._getAssetTypeByResourceType(lt.Subscriptions,i,u).then(function(n){return e(1),r&&r(e()),n}).catch(function(){return h()}):h(),c={extension:n,assetType:t,promise:f,requirements:u,cloudName:i,options:e},d(this._assetTypePromises,c,k),f.catch(function(n){n===ut&&(vt(ut),v(o._assetTypePromises,c))}),f)},n.prototype.dispose=function(){var n=this._resourceProviderLifetime;n&&n.dispose();this._resourceProviderLifetime=
null;this._resourceProviderPromise=null;this._resourceReferenceCache.disposeAll();this._resourceGroupReferenceCache.disposeAll();this._assetIdIconAndKindCache.disposeAll();this._resourceIdSelectionCache.disposeAll();this._assetIdSelectionCache.disposeAll();this._resourceAssetIdCache.disposeAll();this._resourceMappingCache.disposeAll()},Object.defineProperty(n.prototype,"assetTypes",{get:function(){return this._assetTypes},enumerable:!0,configurable:!0}),n.prototype.getMappedBladeLocator=function(n){if(n.type===e.LocatorType.Blade){var i=n.name.toLowerCase(),r=p.getWindowId(n.getExtensionLocator()).toLowerCase(),t=this._mappedBrowseBlades[r];if(t&&t[i])return tf.forExtension(w,ct.DefaultCloudName).withBlade(ot)}return n},n.prototype.getAssetType=function(n,t,i,r){var u={name:n,cloudName:i};return y(this._assetTypes(),function(n){var i={name:n.extension,cloudName:n.cloudName};return p.isEqualDescriptor(i,u)&&l(n).name===t&&gi(n,r)})},n.prototype.hasAssetType=function(){return!!this.getAssetType.
apply(this,arguments)},n.prototype.getAssetTypePromise=function(n,t,i,r){return this._getAssetType(n,t,i,null,r)},n.prototype.getAssetTypeById=function(n,t){return y(this._assetTypes(),function(i){return i.id===n&&gi(i,t)})},n.prototype.hasAssetTypeById=function(){return!!this.getAssetTypeById.apply(this,arguments)},n.prototype.getAssetTypeByIdPromise=function(){return this._getAssetTypeById.apply(this,arguments)},n.prototype.getAssetTypeByResourceType=function(n,t,i){var r=n.toLowerCase();return y(this._assetTypes(),function(n){var u=l(n).resourceType;return(n.extension===w||a(n.cloudName,t))&&u&&u.resourceTypeName.toLowerCase()===r&&gi(n,i)})},n.prototype.hasAssetTypeByResourceType=function(){return!!this.getAssetTypeByResourceType.apply(this,arguments)},n.prototype.getAssetTypeByResourceTypePromise=function(){return this._getAssetTypeByResourceType.apply(this,arguments)},n.prototype.getAssetTypeByResourceTypePromiseWithFallback=function(n,t,i){var r=this;return this._getAssetTypeByResourceType.
apply(this,arguments).catch(function(){return r._getAssetType(w,eu,t,null,i).then(function(t){return t=ii.clone(t),l(t).resourceType={resourceTypeName:n},t})})},n.prototype.allManifestsLoaded=function(){return Q.isFulfilled(this._initialLoad)},n.prototype.getAssetTypeDeepLink=function(n,t){var r=l(n),s=r.name,h=r.bladeName,y=n.cloudName,c=n.extension,b={name:w,cloudName:p.getHubsCloudName()},e=r.bladeExtensionName||c,u=r.resourceType,a=u&&u.resourceTypeName,k=(t&&u&&u.kinds||[]).some(function(n){return n.name.toLowerCase()===(t||"").toLowerCase()}),f,i,v,o;t=k||t===hf?t:undefined;f=function(n,t){return ou(b,n,"",er.addToModel(y,t),!1)};i="";switch(r.browseType){case lf:i=f(si.BrowseServiceBlade,{assetTypeId:lr.getAssetTypeOrResourceTypeIdByWindowId(c,s)});break;case yt:case iu:i=f(kr,{resourceType:a,kind:t});break;case cf:wr&&e===w&&(v={BrowseAllResourcesBlade:lt.AllResources,BrowseRecentResourcesBlade:lt.RecentResources},o=v[h],o&&(i=f(kr,{resourceType:o})));i||(i=ou({name:e,cloudName:
n.cloudName},h,"",e===w?er.addToModel(n.cloudName,{}):{},!1),s===ni.Gallery&&(i=i+"/selectedMenuItemId/undefined"));break;case pt:i=this.getBrowseLinkUri(n)}return i||rf("<"+a+"> asset type does not have a deep link. This means that the side bar and the search results will not be able to open any blades."),i},n.prototype.getBrowseLinkUri=function(n){var i=this._cachedUser,r=this._assetTypeByIdBrowseLink[n.id],t,u;return r?r:(t=l(n).browseLinkUri,t&&(u=ci.links.classicPortal.format({domain:i.tenantDomain}),t=t.format({accountPortal:ci.links.accountPortal,classicPortal:u,domain:i.tenantDomain,tenantId:i.tenantId})),this._assetTypeByIdBrowseLink[n.id]=t,t)},n.prototype.getAssetTypeInformation=function(n,i,r){var f=this,u=t.Internal.getAssetTypeInformationOverride;return u?u(n,i,r):this.getAssetTypePromise(n,i,r).then(function(n){return f.mapAssetTypeToAssetTypeInformation(n)})},n.prototype.getResourceTypeAssetTypeInformation=function(){return this._getResourceTypeAssetTypeInformation.apply(
this,arguments)},n.prototype.mapAssetIdToResourceId=function(n,t){var i=this,r=this._assetIdToResourceIdPromises;return kt("mapAssetToResource",function(){var f=n.extensionName,e=n.assetType,u=n.assetId,h=i._resourceAssetIdCache,c=h.getOrSet(t,new nt(tt)).first(function(n){return gt(n.assetId,f,e,u)}),o;if(c)return Q(c.resourceId);if(o=y(r,function(n){return a(n.cloudName,t)&&gt(n.assetId,f,e,u)}),o)return o.promise;var w=function(n){u=di(n,u)},s=i._getAssetType(f,e,t,w).then(function(r){var s=l(r).resourceType,o;if(!s)throw nr("ID <"+u+">",f,e);if(o=function(i){return h.get(t).pushEntry({assetId:n,resourceId:i}),i},ht(u))return o(u);if(!s.mappingViewModel)throw b("Asset ID was not a resource ID but asset type does not provided mapping view model. "+wu(f,e,u));return i._getMappingViewModel(r).then(function(n){return n.mapAssetIdToResourceId(u).then(function(n){if(!ht(n))throw ir(n,f,e,u);return o(n)})})}),p={assetId:n,cloudName:t,promise:s};return d(r,p,k),s.catch(function(){v(r,p)}),s}
)},n.prototype.mapResourceIdToAssetId=function(n,t){var i=this,r=this._resourceIdToAssetIdPromises;return kt("mapResourceToAsset",function(){var f,e,o,u,s;if(!ht(n))throw tr(n);return(f=i._resourceAssetIdCache,e=f.getOrSet(t,new nt(tt)).first(function(t){return ki(t.resourceId,n)}),e)?Q(e.assetId):(o=y(r,function(i){return a(i.cloudName,t)?ki(i.resourceId,n):!1}),o)?o.promise:(u=i._getAssetTypeByResourceType(cu(n),t).then(function(r){var e=l(r),o=e.name,s=e.resourceType,u;if(!s)throw nr("ResourceId <"+n+">",r.extension,o);return(u=function(i){var u={extensionName:r.extension,assetType:o,assetId:i};return f.get(t).pushEntry({assetId:u,resourceId:n}),u},!s.mappingViewModel)?u(n):i._getMappingViewModel(r).then(function(t){return t.mapResourceIdToAssetId(n).then(function(n){return u(n)})})}),s={resourceId:n,cloudName:t,promise:u},d(r,s,k),u.catch(function(){v(r,s)}),u)})},n.prototype.mapAssetIdToDynamicSelectionAndIcon=function(n,t,i){var r=this,u=this._assetIdSelectionCache;return kt("mapAssetToSelection",
function(){var e=n.extensionName,o=n.assetType,f=n.assetId,s=u.getOrSet(t,new nt(tt)).first(function(n){return gt(n.assetId,e,o,f)}),h;return s?Q(s.value):(h=function(n){f=di(n,f)},r._getAssetType(e,o,t,h).then(function(u){var s=ii.clone(n);return(s.assetId=f,l(u).resourceType)?r.mapAssetIdToResourceId(s,t).then(function(n){if(!ht(n))throw ir(n,e,o,f);return r._getDynamicSelectionAndIconFromResourceId(u,n,s,t,i)}):r._getDynamicSelectionAndIconFromAssetId(u,s)}).then(function(i){return u.get(t).pushEntry({assetId:n,cloudName:t,value:i}),i}))})},n.prototype.mapAssetIdToIconAndKind=function(n,t,i){var r=this,u=this._assetIdIconAndKindCache;return kt("mapAssetToKind",function(){var e=n.extensionName,o=n.assetType,f=n.assetId,s=u.getOrSet(t,new nt(tt)).first(function(n){return gt(n.assetId,e,o,f)}),h;return s?Q(s.value):(h=function(n){f=di(n,f)},r._getAssetType(e,o,t,h).then(function(u){var s=ii.clone(n);return(s.assetId=f,l(u).resourceType)?r.mapAssetIdToResourceId(s,t).then(function(n){if(
!ht(n))throw ir(n,e,o,f);return r._getIconAndKindFromResourceId(u,n,s,t,i)}):le(u,s)}).then(function(i){return u.get(t).pushEntry({assetId:n,cloudName:t,value:i}),i}))})},n.prototype.mapResourceIdToDynamicSelectionAndIcon=function(n,t,i){var r=this,u=this._resourceIdSelectionCache;return kt("mapResourceToSelection",function(){if(!ht(n))throw tr(n);var f=u.getOrSet(t,new nt(tt)).first(function(t){return ki(t.resourceId,n)});return f?Q(f.value):r._getAssetTypeByResourceType(cu(n),t).then(function(u){var f=l(u),e=f.name;if(!f.resourceType)throw nr("ResourceId <"+n+">",u.extension,e);return r.mapResourceIdToAssetId(n,t).then(function(f){return r._getDynamicSelectionAndIconFromResourceId(u,n,f,t,i)})}).then(function(i){return u.get(t).pushEntry({resourceId:n,cloudName:t,value:i}),i})})},n.prototype.getRegisteredAssetTypesInformation=function(){var n=this,i=0,r=function(n,t,i){i===void 0&&(i=!1);var r={assetTypesInformation:t,isPartialSet:i};n.resolve(r)},f=function(n,t){var i={assetTypesInformation:
t,isPartialSet:!0};n.notify(i)},e=function(t){r(t,n._getAssetTypeInformation())},u=function(t,i){var u=n._getAssetTypeInformation();u&&u.length?r(t,u,!0):t.reject(b("Failed to get registered asset types information with an error...{0}".format(i)))},o=function(t){var r=n._getAssetTypeInformation();r&&r.length!==i&&(i=r.length,f(t,r))};return oe(this._initialLoad,t.allAssetTypesRetrievalNotifyPeriodInMilliseconds,function(n){e(n)},function(n,t){u(n,t)},function(n,i){i*t.allAssetTypesRetrievalNotifyPeriodInMilliseconds>=t.allAssetTypesRetrievalTimeoutInMilliseconds?u(n,"Timed out waiting for manifests to load"):o(n)})},n.prototype.mapAssetTypeToAssetTypeInformation=function(n){var t=l(n),i=t.keywords;return{extensionName:n.extension,assetType:t.name,browseType:t.browseType!==undefined?t.browseType:yi,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModel:t.viewModel,dynamicBladeServiceViewModel:t.dynamicBladeServiceViewModel,contracts:t.contracts,
isPreview:n.isPreview,privateBrowse:t.privateBrowse,keywords:!i?undefined:i.split(",")}},n.prototype.mapAssetTypeToResourceTypeAssetTypeInformation=function(n){var t=l(n),i=t.resourceType,r=i||{},u=t.browseType,f=t.keywords;return{resourceType:r.resourceTypeName,apiVersion:r.apiVersion,routingType:r.routingType,bladeName:i&&t.bladeName,bladeExtensionName:i&&t.bladeExtensionName,kinds:r.kinds,extensionName:n.extension,assetType:t.name,browseType:u!==undefined?u:yi,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModel:t.viewModel,dynamicBladeServiceViewModel:t.dynamicBladeServiceViewModel,contracts:t.contracts,isPreview:n.isPreview,marketplaceItemId:t.marketplaceItemId,marketplaceMenuItemId:t.marketplaceMenuItemId,staticOverview:i&&t.staticOverview,privateBrowse:t.privateBrowse,keywords:!f?undefined:f.split(",")}},n}()}(l||(l={})),l});define("MsPortalImpl/UI/Compositions/UI.Composition.CloudName",["require","exports","f","./UI.Composition"],
function(n,t,i,r){"use strict";var u;return function(t){function p(n,t){if(!e.multiCloudEnabled)return n;var i=k(t),r=t.locator.getExtensionLocator();if(i.name===f)r.name===f&&v.assert(n[u],"Hubs extension should provide cloud name.");else if(n[u])throw new Error("Use of {0} by extensions is not supported".format(u));else r.name===f&&(n[u]=y(i.cloudName),t.masterInputKeys&&t.masterInputKeys.push(u));return n}function w(n,t){return e.multiCloudEnabled?(t&&t.hasOwnProperty(u)&&!n[u]&&(n[u]=t[u]()),n):n}function b(n,t){var o,i,r;if(!e.multiCloudEnabled)return!1;if(o=!1,n===f&&t)for(r=0;r<t.length;r++)if(i=t[r],i&&i.additionalInputArguments&&i.additionalInputArguments.some(function(n){return n.property===u})){o=!0;break}return o}function k(n){var t,r=n.masterContainer,i=n.masterContainer.getCompositionType();if(n.masterCommandExtension)t=n.masterCommandExtension;else if(i===o.Startboard)t=c(n.masterPartId,r.children);else if(i===o.Blade)t=c(n.masterPartId,r.getParts());else throw"Can not handle composition type {0}".
format(o[i]);return t}function c(n,t){var i=t.first(function(t){return t.id===n});return i.extension}var s=FxImpl,e=s.Extension,h=i.Base,f=h.Constants.ExtensionNames.Hubs,l=h.Diagnostics,o=r.CompositionType,a=s.Constants,u=a.CloudName.inputBindingKey,v=l.createLog(n),y=ko.observable,d=ko.observableArray;t.ensureInputToHubsBlade=p;t.ensureRebindToHubsBlade=w;t.needInternalProperty=b}(u||(u={})),u});define("MsPortalImpl/Interactions/Interactions.Command",["require","exports","i"],function(n,t,i){"use strict";var r;return function(n){var f=i.TriggerableLifetimeManager,t=ko.observable,e=function(){function n(n,t){this.target=n;this.formTarget=t}return n}(),r,u;n.CommandContext=e;r=function(){function n(n,i){this.accept=n;this.maxFiles=i;this.files=t(null)}return n}();n.FileInputOptions=r;u=function(n){function i(i,r){n.call(this);this._text=t();this._pressed=t();this._visible=t(!0);this._tooltip=t();this._fileInputOptions=t(null);this._enabled=t(!0);this._icon=t();this.fxEnabled=t(!0);this.
hasPopup=t(!1);typeof i=="string"?this._text(i):ko.isObservable(i)&&(this._text=i);r!==undefined&&this._enabled(r)}return __extends(i,n),Object.defineProperty(i.prototype,"canRebind",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pressed",{get:function(){return this._pressed},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fileInputOptions",{get:function(){return this._fileInputOptions},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tooltip",{get:function(){return this.
_tooltip},enumerable:!0,configurable:!0}),i.prototype.activate=function(){},i.prototype.execute=function(){},i.prototype.bind=function(n){this._currentContext=n},i}(f);n.CommandImpl=u}(r||(r={})),r});define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers",["require","exports","f","./UI.Composition.PropertyBinding"],function(n,t,i,r){"use strict";var u;return function(t){var f=i.Base,o=f.Diagnostics,s=f.Utilities,e=r.PropertyBinding,u=o.createLog(n),h;(function(n){function o(){var n=function(n){var t=n.propertyChanges||[],r=t.length===1&&t[0].propertyValue,f=(r||{}).hasOwnProperty("detailBladeInputs");return r&&!f&&u.error(i.invalidNewValue.format(n.sourceModelId,JSON.stringify(n))),f};return function(t){if(n(t)){var i=t.propertyChanges[0],r=i.propertyValue;i.propertyValue=r.detailBladeInputs}}}function h(){return function(n){var t,i;if(n.propertyChanges&&n.propertyChanges.length===1&&$.isPlainObject(n.propertyChanges[0].propertyValue)){t=n.propertyChanges[0].propertyValue;
n.propertyChanges=[];for(i in t)t.hasOwnProperty(i)&&n.propertyChanges.push(r.ObservableChangeArgs.forObject(i,t[i]))}}}function c(){var n=function(n,t){var i=!0;return Array.isArray(t)?t.length!==1&&(i=!1):(u.error(f.invalidNewValue.format(n.sourceModelId,JSON.stringify(t))),i=!1),i};return function(t){var u=ko.unwrap(e.getModelValue(t.sourceModel,t.sourceProperty).value)||[],i;n(t,u)?(i=t.propertyChanges[0],i.kind=r.ObservableKind.Object,i.propertyValue=u[0],i.propertyArrayEdits=null):t.cancel=!0}}function l(){var n=null,i=function(n,i){var r=!0;return!i||!i.propertyChanges||i.propertyChanges.length<1?(u.error(t.invalidPropertyChange.format(i.sourceModelId,JSON.stringify(i))),r=!1):Array.isArray(i.propertyChanges[0].propertyValue)||i.propertyChanges[0].propertyArrayEdits&&i.propertyChanges[0].propertyArrayEdits.length>0?(u.error(t.invalidNewValue.format(i.sourceModelId,JSON.stringify(i))),r=!1):Array.isArray(n)||(u.error(t.invalidCurrentValue.format(i.sourceModelId,n)),r=!1),r};return function(
t){var o=ko.unwrap(e.getModelValue(t.targetModel,t.targetProperty).value),u,h,f,c=function(n,t){return n.firstIndex(function(n){return s.deepEquals(n,t)})};i(o,t)&&(h=n===undefined?-1:c(o,n),u=t.propertyChanges[0],f=ko.unwrap(u.propertyValue),u.propertyArrayEdits=[],u.kind=r.ObservableKind.Array,h>=0&&n!==f&&u.propertyArrayEdits.push({status:"deleted",index:h,moved:null,value:n}),f!==undefined&&c(o,f)===-1&&u.propertyArrayEdits.push({status:"added",index:0,moved:null,value:f}),n=f);t.cancel=!u||!u.propertyArrayEdits||!u.propertyArrayEdits.length}}var i={invalidNewValue:"[DynamicSelectionTransformer] [{0}] Source value does not implement MsPortalFx.ViewModels.DynamicSelection. Transformer Args: '{1}'"},f={invalidNewValue:"[ManyToOneTransformer] [{0}]: Source value '{1}' must be an array."},t={invalidPropertyChange:"[OneToManyMergeTransformer] [{0}]: No property change detected on source. Transformer Args: '{1}'.",invalidNewValue:"[OneToManyMergeTransformer] [{0}]: Source cannot be an array. Transformer args: '{1}'",
invalidCurrentValue:"[OneToManyMergeTransformer] [{0}]: Target value '{1}' must be an array."};n.getDynamicSelectionMapper=o;n.getModelToPropertyMapper=h;n.getManyToOne=c;n.getOneToManyMerge=l})(h=t.PropertyTransformers||(t.PropertyTransformers={}))}(u||(u={})),u});define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder",["require","exports","f","u","./UI.Composition.PropertyBinding","./UI.Composition","../../Extension/Extension.Definition.Locator","./UI.Composition.PropertyTransformers","../../Base/Telemetry"],function(n,t,i,r,u,f,e,o,s){"use strict";var h;return function(t){var ot=e.Locator,st=e.LocatorType,ht=FxImpl,ct=ht.TelemetryContext,g=i.Base,it=g.Diagnostics,lt=it.Telemetry,w=g.Rpc.Internal,nt=w.Measurement,at=g.Utilities,vt=i.Extension,h=vt.ReferenceType,yt=i.Util,pt=f.CompositionType,v=u.PropertyBinding,c=u.ReferenceScope,a=i.Helpers,b=o.PropertyTransformers,ni;t.onInputsSetTimeoutInMilliseconds=5e3;var tt=window,wt=tt.fx.environment,rt=wt.trace,bt=rt.inputsset,
kt=rt.shellinputsset,l=it.createLog(n),ut=lt,dt=i.isFeatureEnabled("pov2"),ft=u.extractTraceOptions,k=ko.observable,gt=ko.observableArray,d=ko.toJS,y=ko.toJSON,p=u.ReferenceCardinality,et=function(){function n(n){this._currentPromise=Q();this._getStateAsync=n}return n.prototype.getStateAsyncSequenced=function(){return this._currentPromise=this._currentPromise.then(this._getStateAsync,this._getStateAsync),this._currentPromise},n}();t.StateReader=et,function(n){function wt(n,t,i,u){var f=function(i,r){var u=t.mapProperty(i.source.property,i.targetProperty);u.transformers=nr(i);u.compositionBindingDefinition=i;r?u.bind(r.sourceModelName,r.sourceModel):oi(n,u)};i&&i.forEach(function(n){var i=u&&u(n),e=n.source.constantValue,h,o,s;i&&i.overridesConstantBindings?f(n,i):e!==r?(h="[Constant: {0}]".format(y(e)),o={},v.setModelValue(o,n.source.property,e),s=t.mapProperty(n.source.property,n.targetProperty),s.compositionBindingDefinition=n,s.bind(h,o)):f(n,i)})}function hi(n,t,i){var r=(t||[]).every(
function(n){return i&&v.getModelValue(i,n).exists});return r||l.error("Model '{0}' is missing properties. Expected properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(d(i))||"<null>")),r}function ci(n,t,i){var u=(t||[]).every(function(n){var t=i&&v.getModelValue(i,n);return t&&t.exists&&ko.unwrap(t.value)!==r});return u||l.error("Model '{0}' is missing required properties or has them set to undefined. Required properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(d(i))||"<null>")),u}function li(n){var r={},t,i;for(t in n)n.hasOwnProperty(t)&&(i=d(n[t]),r[t]=Array.isArray(i)?gt(i):k(i));return r}function ni(n,t,r){return i.mapMany(n||[],function(n){return(n.valuesFrom||[]).map(function(i){var u={property:i.property,modelType:i.referenceType,constantValue:i.constantValue,scope:c.CurrentContainer,cardinality:n.valuesFrom.length>1?p.OneToMany:p.OneToOne},o={targetProperty:n.property,source:u,optional:!!n.optional,isIdentityInput:!!n.
isIdentityInput},e=i.part,s=t.locator.name;return(i.referenceType===h.Part||i.partCommand)&&(u.partLocator=t.locator.getExtensionLocator().withPartInstance(e||s),f.isPartComposition(t)&&(!e||e===s)&&(u.id=t.id)),i.referenceType===h.Command&&(u.modelId=i.bladeCommand||i.partCommand),r&&r(o,i),o})})}function ai(n){return(n||[]).forEach(function(n){var t=n.source,i=t&&t.partLocator;i&&(t.partLocator=ot.fromJSON(i))}),n}function vi(n){return(n||[]).map(function(n){var t={targetProperty:n.targetProperty};return n.source&&(t.sourceProperty=n.source.property,t.sourcePartLocator=n.source.partLocator&&n.source.partLocator.toString(),t.sourceType=h[n.source.modelType],t.sourceScope=c[n.source.scope],t.sourceCardinality=p[n.source.cardinality]),t})}function ti(n,t){var i=!1;return f.isPartComposition(n)&&!n.isDisposed()&&(i=t.id?n.id===t.id:n.eligibleForBinding&&n.locator.getExtensionLocator().withPartInstance(n.locator.name).equals(t.partLocator)),i}function yi(n){var t=ii(n);return t.inputsWatcherConfig&&
rt(t.inputsWatcherConfig),t}function ii(n){var i=[],t={allInputsSet:k(!1),calledOnInputsSet:k(!1),failedOnInputsSet:k(!1),definitionBindings:[],propertyBindings:new u.PropertyBindings(n.bindableTarget.viewModelName,{},!1)};return ri(n.referenceComposition,n.inputs,i,n.customInputBindingValidator)?(t.definitionBindings=ni(n.inputs,n.referenceComposition),wt(n.referenceComposition,t.propertyBindings,t.definitionBindings,n.customBindHandler),t.inputsWatcherConfig=it({bindableTarget:n.bindableTarget,allInputsSet:t.allInputsSet,calledOnInputsSet:t.calledOnInputsSet,failedOnInputsSet:t.failedOnInputsSet,propertyBindings:t.propertyBindings,referenceComposition:n.referenceComposition,referenceCompositionIsContainer:n.referenceCompositionIsContainer,notifyWhenInputsChangeWithSameValues:!1,beforeViewModelPropertyUpdate:n.beforeViewModelPropertyUpdate,inputsSetCalled:n.inputsSetCalled})):l.error("{0} Reference: {1}.".format(JSON.stringify(i),n.bindableTarget.viewModelName)),t}function pi(n){rt(it(
n))}function it(n){return $.extend({},n,{propertyBindingsState:r,inputsSetTrace:bt,shellInputsSetTrace:kt,stateReader:!!n.getStateAsync&&new et(n.getStateAsync)})}function rt(n){var t;if(g(n,null,n.calledOnInputsSet()),!n.allInputsSet()){t=gi(n.propertyBindings);n.referenceComposition.onDispose(function(){lt(t)})}n.propertyBindings.addPropertyChangedHandler(function(){var i=n.onInputsSetCoordinatorState&&n.onInputsSetCoordinatorState();i!==0&&g(n,t)});n.onInputsSetCoordinatorState&&n.onInputsSetCoordinatorState.subscribe(function(i){if(i!==0){var r=i===1,u=i===2;g(n,t,r,u)}})}function ri(n,t,i,u){var e,o=f.isPartComposition(n);return(t&&t.some(function(n){return n.property?n.valuesFrom&&n.valuesFrom.length===1?o||n.valuesFrom[0].referenceType!==h.Part||n.valuesFrom[0].part?n.valuesFrom[0].referenceType===h.Constant&&n.valuesFrom[0].constantValue===r?e="'constantValue' must be defined if using 'Constant' reference type.":n.valuesFrom[0].constantValue!==r&&n.valuesFrom[0].referenceType!==
h.Constant?e="'constantValue' can only be be defined when using 'Constant' reference type.":u&&(e=u(n)):e="Input binding that reference a Part must specify the source part name.":e="Input binding must define one and only one source valueFrom property.":e="Input binding must define a target property.",e||n.valuesFrom[0].referenceType!==h.Command||(n.valuesFrom[0].bladeCommand||n.valuesFrom[0].partCommand?n.valuesFrom[0].bladeCommand&&n.valuesFrom[0].partCommand?e="Only one, 'bladeCommand' or 'partCommand' is allowed when using 'Command' reference type.":n.valuesFrom[0].part&&(e="'part' is not allowed when using 'Command' reference type."):e="'bladeCommand' or 'partCommand' is required if using 'Command' reference type."),!!e}),e)?(i.push(e),!1):!0}function e(n,t){var u=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return"| "+t.map(function(n){return(n.toString()+"                    ").slice(0,15)}).join("")},i=["-----------",u("Optional","isBound","hasValue","Input: Value")],
f=t.properties.map(function(n){return"{0}{1}: {2}".format(u(ht(n),n.isBound,n.targetHasValue),n.targetProperty,y(n.targetHasValue?v.getModelValue(t.targetModel,n.targetProperty).value:r))});i=i.concat(f);i.push("-----------");l.verbose("{0} Target Model: {1}\n{2}".format(n,t.targetModelName,i.join("\n")))}function g(n,t,i,r){return ui(n,t,i,!0,r).then(function(t){t&&ct.usingState(function(){wi(n,t)},n.referenceComposition.getCreationState())})}function ui(n,t,i,u,f){var l=!n.propertyBindings.properties.some(di),s=ft(n.bindableTarget.viewModelName,n.inputsSetTrace),h=s&&s.verbose,o,c;return l?(o=d(n.propertyBindings.targetModel),!u&&!yt.canSendThroughPostMessage(o))?(n.propertyBindingsState=r,a.Deferred().resolve(null).promise()):(lt(t),!i&&n.notifyWhenInputsChangeWithSameValues||f||!at.deepEquals(o,n.propertyBindingsState)?(n.allInputsSet(!0),n.propertyBindingsState=o,c=n.beforeViewModelPropertyUpdate?n.beforeViewModelPropertyUpdate(o).then(function(t){if(t)return fi(n,s);h&&e("onInputsSet not called, RBAC check failed.",
n.propertyBindings)}):fi(n,s),c.then(function(t){var r=n.getInputsMetadata&&n.getInputsMetadata(),i={inputs:o,settings:t,traceOptions:s,viewModelName:n.bindableTarget.viewModelName,inputsMetadata:r};return ki(n,i)?i:null})):(h&&e("onInputsSet not called, new values are the same as current values.",n.propertyBindings),a.Deferred().resolve(null).promise())):(h&&e("onInputsSet not called, missing required properties.",n.propertyBindings),n.propertyBindingsState=r,a.Deferred().resolve(null).promise())}function fi(n,t){var f=n.referenceComposition,r,u,i;return(!f||!f.isDisposed())&&(r=n.bindableTarget,!r.viewModel||r.viewModel.updatePartInputValues)?(u=n.stateReader,u?(i=a.Deferred(),u.getStateAsyncSequenced().then(i.resolve.bind(i),i.reject.bind(i)),i.promise().then(function(n){return n||{}},function(){t&&t.verbose&&e("onInputsSet not called, failed to retrieve part settings.",n.propertyBindings);n.failedOnInputsSet(!0)})):a.Deferred().resolve({}).promise()):a.Deferred().resolve(null).promise(
)}function wi(n,t){var i=n.bindableTarget.viewModel,r=t.inputs,u=t.settings,f=t.traceOptions,e=t.viewModelName,o=t.inputsMetadata,s=i.updatePartInputValues(r,u,f,e,o);ei(n,t,s)}function bi(n,t){var c=w.messageContext;if(w.messageContext){var f=n.referenceComposition.locator.toFriendlyString(),h=nt.getTimestamp(),i=c.initiatingTimestamps,u=c.timestamps,l=n.bindableTarget.viewModelName,a=l.substring(l.lastIndexOf("}")+1),r=nt.ON_INPUTS_SET_CALLED,s=n.referenceCompositionIsContainer?"Command":pt[n.referenceComposition.getCompositionType()],e={viewModel:a,earlyOnInputsSet:!!i.operations[nt.VIEW_MODEL_CTOR],requestQueueTime:i.sendTime-i.enqueueTime,requestPostTime:i.receiveTime-i.sendTime,requestProcessMsgTime:i.operations[r].begin-i.receiveTime,onInputsSetCallTime:i.operations[r].end-i.operations[r].begin,resolveWaitTime:u.enqueueTime-i.operations[r].end,responseQueueTime:u.sendTime-u.enqueueTime,responsePostTime:u.receiveTime-u.sendTime,processResolveTime:h-u.receiveTime,initialOnInputsSet:
t};o("OnInputsSetRoundtrip",f,i.enqueueTime,h,e);o("Ext"+s+"OnInputsSetDelay",f,i.enqueueTime,i.sendTime,e);o("Ext"+s+"OnInputsSet",f,i.operations[r].begin,i.operations[r].end,e);o("Ext"+s+"FullDataLoaded",f,i.operations[r].begin,u.enqueueTime,e);o("Ext"+s+"FullDataReceived",f,i.operations[r].begin,h,e)}}function o(n,t,i,r,u){ut.trace({timestamp:r,extension:w.messageContext.srcWindowId,source:s.Source.Shell,action:n,name:t,data:u,actionModifier:ut.ActionModifier.Complete,duration:r-i})}function ki(n,t){var o=t.inputs,u=t.settings,f=t.traceOptions,i,r;return u&&(!n.referenceComposition||!n.referenceComposition.isDisposed())?(i=n.bindableTarget.viewModelName,r=ft(i,n.shellInputsSetTrace),f&&f.verbose&&e("onInputsSet will be called, all required properties are set.",n.propertyBindings),r&&(l.verbose("Invoking onInputsSet of view model '{0}'.\nInputs: {1}.\nSettings: {2}".format(i,y(o),y(u))),!!r.breakOnInputsSet),!0):!1}function ei(n,t,i){var r=n.calledOnInputsSet();n.calledOnInputsSet(!0);
n.inputsSetCalled&&n.inputsSetCalled(t.inputs,i||Q({}));i&&i.then(function(){dt||bi(n,!r)})}function di(n){return n.targetHasValue?!1:!ht(n)}function ht(n){var t=n.compositionBindingDefinition,r=t&&t.optional,i=t&&t.source,u=i&&i.scope===c.DetailsContainer,f=r||u;return!!f}function gi(n){var i={handle:tt.setTimeout(function(){var t,u,f;lt(i);t=[];u=[];n.properties.forEach(function(i){var f=ht(i),o=i.targetHasValue?v.getModelValue(n.targetModel,i.targetProperty).value:r,e="Target Input Name: {0} \nSource Model Name: {1} \nSource Property Name: {2} \nCurrent Value: {3} \nOptional: {4}".format(i.targetProperty,i.isBound?i.sourceModelName:"<UNBOUND>",i.isBound?i.sourceProperty:"<UNBOUND>",i.isBound?y(o):"<UNBOUND>",f);i.targetHasValue||f?u.push(e):t.push(e)});f="onInputsSet is taking more time than expected for target model: {0}\n=== Missing Required Properties === \n{1}\n\n=== All Other Properties === \n{2}";l.warning(f.format(n.targetModelName,t.join("\n\n"),u.join("\n\n")))},t.onInputsSetTimeoutInMilliseconds)};
return i}function lt(n){n&&n.handle&&(tt.clearTimeout(n.handle),n.handle=null)}function nr(n){var t=[];return n.source.cardinality===p.OneToMany?t.push(b.getOneToManyMerge()):n.source.cardinality===p.ManyToOne&&t.push(b.getManyToOne()),n.opensDynamicBlades&&t.push(b.getDynamicSelectionMapper()),n.targetProperty||t.push(b.getModelToPropertyMapper()),t}function oi(n,t){if(!n.isDisposed()){var i=tr(n,t.compositionBindingDefinition.source),r=si(n,i,t,t.compositionBindingDefinition.source);r(n,i,t,t.compositionBindingDefinition.source)}}function tr(n,t){var u=n.getPartsContainer(),i,r;switch(t.scope){case c.MasterContainer:i=u.masterContainer;break;case c.DetailsContainer:r=u.detailContainers.filter(function(n){return n&&!(n.openInContextPane&&n.persistentContextPane)});r.length>1?l.error("Unable to bind composition to detail blade, multiple detail blades found. Reference Composition: '{0}', Detail Blades: '{1}'.".format(n.toString(),r.map(function(n){return n.toString()}).join(","))):i=r.first(
);break;default:i=u}return i}function si(n,t,i,r){return t?r.partLocator?r.modelType===h.Command&&i.compositionBindingDefinition.source.scope!==c.MasterContainer?ur:rr:fr:ir}function ir(n,t,i){n.getPartsContainer().awaitContainer(n,function(t){return er(n.getPartsContainer(),t,i.compositionBindingDefinition.source)}).done(function(t){var r=si(n,t,i,i.compositionBindingDefinition.source);r(n,t,i,i.compositionBindingDefinition.source)})}function rr(n,t,i,r){t.awaitComposedPart(n,function(n){return ti(n,r)}).done(function(t){vt(n,t,i)})}function ur(n,t,i){vt(n,n,i)}function fr(n,t,i){vt(n,t.getBindableContainer(),i)}function er(n,t,i){var r=t.masterContainer;return t.isDisposed()?!1:t.locator.type!==st.Blade?!1:i.scope===c.MasterContainer?n.masterContainer&&n.masterContainer.id===t.id:i.scope===c.DetailsContainer?r&&r.id===n.id&&n.detailContainers.length===1:r&&r.id===n.id}function vt(n,t,i){var o=i.compositionBindingDefinition.source,r=o.modelType,u=o.modelId,s="[Composition: {0}, ModelType:{1}, ModelId:{2}]".
format(t.toString(),r,u||"<null>"),c,f,e;r===h.BladeInput||r===h.Dashboard?(c=t.getViewModel(r,u),i.bind(s,c)):t.getViewModelAsync(r,u).done(function(n){t.isDisposed()||i.bind(s,n)}).fail(function(){l.error("Failed to retrieve view model type '{0}' with id '{1}' from composition '{2}' to bind source property '{3}'.".format(h[r]||r,u||"<none>",t.toString(),i.sourceProperty))});f=function(){i.unbind();t.offDispose(e)};e=function(){i.unbind();i.compositionBindingDefinition.autoRebindWhenSourceDisposes&&oi(n,i);n.offDispose(f)};t.onDispose(e);n.onDispose(f)}n.setupPropertyBindings=wt;n.modelHasProperties=hi;n.modelHasPropertiesWithValue=ci;n.createObservableModel=li;n.mapInputBindingDefinitions=ni;n.bindingsFromJSON=ai;n.mapBindingsToFriendlyObjects=vi;n.isSourcePart=ti;n.bindViewModelInputs=yi;n.createBindViewModelResult=ii;n.setupAllInputsSetWatcher=pi;n.createAllInputsSetWatcherConfigExtended=it;n.setupAllInputsSetWatcherFromExtendedConfig=rt;n.validateInputBindings=ri;n.callOnInputsSetIfNeeded=
g;n.loadOnInputsSetParameters=ui;n.notifyOnInputsSetCalled=ei}(ni=t.CompositionBinder||(t.CompositionBinder={}))}(h||(h={})),h});define("MsPortalImpl/UI/Compositions/UI.Composition.Security",["require","exports","f","../../Services/Services.AssetTypes"],function(n,t,i){"use strict";var r;return function(n){function s(n,i,r,f,e,c,l,a){if(n&&n.length){if(o[i]===undefined)return Q.reject(new Error("checkPermission: unexpect requirement: "+i));var v=i===o.All;return n.reduce(function(n,i){return n.then(function(o){var y,w,p;if(k(v,o))return n;if(i.permissionType===t.PermissionType.Permission)w=i,y=h(w,r,f,e,c,l,a);else if(i.permissionType===t.PermissionType.PermissionSet)p=i,y=s(p.permissions,p.requirement,r,f,e,c,l,a);else throw new Error("unexpected permission.permissionType: "+i.permissionType);return y.catch(function(n){var t=u.warning;return t.call(u,n,1,["Failed check permissions:","compositionInfo:"+a,"reason: "+n].join("\n")),Q(!0)})})},Q(v))}return Q(!0)}function h(n,i,r,f,e,o,s){
var l,h;if(!n)return Q(!1);l=function(t,i){return e.permissionsManager.hasPermission(t,[n.action],i)};f===y&&(o=a.readFromInputs(i));switch(n.assetId.sourceType){case t.AssetIdSourceType.FromInput:h=Q(i[n.assetId.property]);break;case t.AssetIdSourceType.FromProvider:h=c(n,i,r,f,e,o);break;case t.AssetIdSourceType.FromSourceProvider:h=c(n,i,n.assetType||r,n.extensionName||f,e,o)}return h.then(function(t){var i,h,a,v,c;return t=ko.unwrap(t),i=n.extensionName||f,h=n.assetType||r,d(t)?l(t,o):e.assetTypeService.hasAssetType(i,h,o,2)?(a=u.warning,v="",a.call(u,["Performance Warning: assetId is not in the form of resourceID. This result in slow code path to perform the conversion. Please contact the extension below to improve performance","assetTypeExtension: "+i+", assetType: "+h,"composition: "+(s||""),v].join("\n")),c=e.assetTypeService.getAssetType(i,h,o,2),e.getService("ResourceMapManager").then(function(n){return n.mapAssetIdToResourceId({extensionName:c.extension,assetType:c.assetTypeManifest.
name,assetId:t},o)}).then(function(n){return l(n,o)})):Q(!1)})}function c(n,t,i,r,u,f){var e="[getAssetIdFromPropertyProvider]:";return u.extensionManager.getExtensionByName(r,f).then(function(r){var u=r.manifest.assetTypes.first(function(n){return n.name===i});if(!u)throw new Error(e+"Unknown extension Asset Type : "+i);return Q(r.getViewModel(u.propertyProviderServiceViewModel)).then(function(i){var u=new v;return u.registerForDispose(function(){w.disposeViewModelProperties(i);r.releaseViewModel(i)}),Q.fcall(function(){var r=i.content,u=r&&r.onInputsSet,f,o;if(typeof u=="function")return f=$.extend({providerKey:n.assetId.providerKey},t),o=u.call(r,f)||Q(),o.then(function(){var u=r.properties(),t=n.assetId.property,i=u.first(function(n){return n.property===t});if(i)return i.value;throw new Error(e+"Can not find propertyDefinition for assetIdProperty: "+t);});throw new Error(e+"ViewModel.content.onInputsSet is not a function.");}).finally(function(){u.dispose();u=null})})})}function d(
n){return n&&l.some(function(t){return t(n)})}var e=FxImpl,a=e.Extension.CloudName,v=e.TriggerableLifetimeManager,f=i.Base,y=f.Constants.ExtensionNames.Hubs,p=f.Diagnostics,w=f.Utilities,t=i.Extension,o=t.SetRequirement,b=i.ViewModels,r=b.Services.ResourceTypes,u=new p.Log("UI/Composition/Security"),k=i.xor,l;n.checkPermissions=s;n.checkPermission=h;l=[r.isResourceGroupId,r.isResourceId,r.isTenantResource,r.isSubscriptionId]}(r||(r={})),r});define("MsPortalImpl/UI/Compositions/UI.Composition.Pipeline",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function u(n){function f(n){u.push(n)}function e(n,t,r,u){function e(f,e){return r(f,e)?i.require(n,u).then(function(n){return t(n,f,e)}):undefined}f(e)}function o(n,t){return u.map(function(i){return i(n,t)})}var u=[],r={events:n,registerFactory:f,registerAsyncFactory:e,getHandlers:o,createPipeline:undefined};return r.createPipeline=function(n,i,u){return t(n,r,i,u)},r}function t(n,t,i,r){function h(s){function a(
t){t=t.filter(function(n){return!!n});var i=f(u,o,t),r=t.filter(function(n){return typeof n.dispose=="function"});return l.registerForDispose(r),e(i,s,n,l).finally(function(){l.dispose()})}var l=n.createChildLifetime(),c=t.getHandlers(i,r),h;return(c.forEach(function(n,t){Q.isPromise(n)&&(h||(h=[]),h[t]=n.then(function(n){c[t]=n}))}),h)?Q.all(h.filter(function(n){return!!n})).then(function(){return a(c)}):a(c)}var u=t.events,o=s(u);return{startTask:h}}function f(n,t,r){var u=t.map(function(t){var i=n[t];return r.filter(function(n){return typeof n[i]=="function"})});return i.mapMany(t,function(t){var i=n[t];return u[t].map(function(n){return{e:i,f:n[i].bind(n)}})})}function e(n,t,i,u){function a(i){var r;try{r=n[f].f(l,t)}catch(u){return Q.reject(u)}return o?undefined:r&&f<n.length?r.then(i):r}function h(){var t=undefined;for(f++;f<n.length&&!o;f++)if(t=a(h),t)break;return t}var f=-1,e,o=!1,c=r++,s=function(){o=!0},l={indicateTaskComplete:s,taskId:c,lifetime:u};return i.registerForDispose(
s),e=h(),e||(e=Q.resolve(undefined)),e}function o(n){return Object.keys(n).filter(function(t){return typeof n[t]=="number"})}function s(n){return o(n).map(function(t){return n[t]}).sort(function(n,t){return n===t?0:n<t?-1:1})}var h=i.uncurryThis(String.prototype.toLowerCase),r=1;n.createDescriptor=u;n.createPipelineInstance=t}(r||(r={})),r});define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase",["require","exports","f","../../Base/Base.Selectable2","../../Extension/Extension.Definition.Locator","./UI.Composition.PropertyBinding","./UI.Composition.Pipeline","./UI.Composition.PropertyTransformers","../UI.DesktopManager"],function(n,t,i,r,u,f,e,o,s){"use strict";var h;return function(t){function ft(){var n=[],t={},i=tt.Callbacks();return{bladeOpenedCallbacks:i,getBlades:function(){return n.slice(0)},track:function(t){(t||[]).forEach(function(t){t&&!n.some(function(n){return n===t})&&(n.push(t),i.fire(t))})},wasClosedByMaster:function(n){return t.hasOwnProperty(n&&n.id)},isTracked:
function(t){return n.some(function(n){return n===t})},untrack:function(i){i&&(n.remove(i),t[i.id]=!0)},closed:function(i){i&&(n.remove(i),delete t[i.id])},dispose:function(){n=[];t={};i.empty()}}}function et(n,t){var i=arguments.length===2?h(n,t).value:n;return i?r(i.selectedValue)&&r(i.value)&&r(i.isSelected)&&r(i.isActivated)&&r(i.isCommandSelected)&&r(i.hasChildEdits):!1}function ot(n,t){var i=arguments.length===2?h(n,t).value:n;return i?r(i.selectableItems)&&r(i.selectedItems)&&r(i.activatedItems)&&r(i.itemsWithChildEdits):!1}function st(n){var t=n;return t.isLocked()}function ht(n){var t={master:{part:n.masterPartId,property:n.masterInvocationProperty,command:n.masterCommandName}};return v.toSortedString(t)}function ct(n){return n.blade?n.selectablePath||"container.selectable":lt(n)}function lt(n){var u,i=n.invocationInputArguments,t,r,f;return!i||i.length<=0||i[0].valuesFrom.length<=0||!i[0].valuesFrom[0].property?null:(u=i[0].valuesFrom[0].property,t=u.split("."),r=t.length,r>1)?
(f=t[r-1],["value","activatedItems","selectedItems","selectedItem"].some(function(n){return n===f})&&(t=t.slice(0,r-1)),t.join(".")):null}function at(n){var t,i,r;return n?(t=n.filter(function(n){return n?!n.selectablePath&&!n.invocationInputArguments:!1}),i=n.filter(function(n){return n?n.selectablePath==="container.selectable":!1}),r=n.filter(function(n){var t=n&&n.invocationInputArguments,i,r;return t&&t.length&&(i=t[0]&&t[0].valuesFrom,i&&i.length)?(r=i[0].property,r==="container.selectable.value"||!n.blade&&r==="container.selectable"):!1}),!!(t.length||i.length||r.length)):!1}function vt(n,t,i){var r,f=n.invocationInputArguments,o=f&&f.length!==1,e=f&&!o&&f[0].valuesFrom,u=n.outputArguments;return(o?r="Invocation arguments must exist and have only one element.":e&&e.length>1?r="Multiple 'valuesFrom' not supported for invocation arguments.":!n.blade&&f[0].property?r="Static invocation property is not supported when omitting the details blade name.":e&&e[0].constantValue!==undefined?
r="Constants are not allowed on invocation argument.":u&&u.length>0&&(u.some(function(n){return!n.property})?r="Output arguments must specify a target property.":u.some(function(n){return n.valuesFrom.length!==1})?r="Output arguments support only one valueFrom property.":u.some(function(n){return n.valuesFrom[0].constantValue!==undefined})?r="Constants are not allowed on output arguments.":u.some(function(n){return n.valuesFrom[0].referenceType!==y.BladeInput})&&(r="Output arguments only support source ReferenceType.BladeInput.")),!r&&i&&(r=i(n)),r)?(t.push(r),!1):!0}function yt(n,t,i){var u={},r=new f.PropertyTransformerArgs(n,t,null,u,null);return r.propertyChanges.push(f.ObservableChangeArgs.forObject(i.targetProperty,t)),i.opensDynamicBlades&&ut(r),i.targetProperty||rt(r),r.propertyChanges.forEach(function(n){var t=n.propertyName;t&&(u[t]=n.propertyValue)}),u}function pt(n,t,i,r){var s=t,h=t,l=t,a,f,o,e={};return dt(r,t)&&(o=t.cloudName||i.cloudName,t.extension&&(i=c.forExtension(t.
extension,o)),a=c.forExtensionManifest(i.name,i.cloudName),s.detailBlade?f=i.withBlade(s.detailBlade):h.assetType&&n.finder.tryLocate(a.withAssetType(h.assetType),e)?f=k(i.name,i.cloudName,e.value):l.resourceId&&u.tryLocateAssetDefinitionFromResourceId(n.extensionManager,l.resourceId,e,o)?f=k(e.extensionName,o,e.value):p.logDynamicSelectionError("Unable to locate asset. Error: '{0}'. ".format(e.error),r,t)),f||(f=i.withBlade("##NOT_SPECIFIED##")),f}function wt(n,t,i){var r=t&&t.container,u=i.details;return r&&r.selectable===n?u.first(function(n){return b(n)}):n?(u||[]).first(function(i){var r=i.invocationInputArguments,u=i.selectablePath;return r?r.some(function(i){return i.valuesFrom.some(function(i){var r=[];return i.property.split(".").some(function(i){return r.push(i),h(t,r.join(".")).value===n})})}):u?h(t,u).value===n:!1}):null}function b(n){var i=n.invocationInputArguments,u=i&&i[0]&&i[0].valuesFrom&&i[0].valuesFrom[0]&&i[0].valuesFrom[0].property,f=n.selectablePath,r=!0;return u?
r=u===t.PartContainerSelectableValue_ViewModelPath:f&&(r=f===t.PartContainerSelectable_ViewModelPath),r}function bt(n,t,i,r,u){var e,o;if(t.setLifetimeReference(8,i),o=function(){var t={},h,o,s;e=new f.PropertyBindings(i.id+"-"+n,t,!1);h=i.getViewModel(y.BladeInput);s=e.addPropertyChangedHandler.bind(e);s(function(){o=l(t,!0)});r.forEach(function(n){e.mapProperty(n,n).bind(i.id,h,!0)});o&&u(o);s(function(){var n=l(t,!0);u(n)})},r.length>0){i.isComposed?o():i.awaitComposed().then(o);i.onDispose(function(){e&&(e.unbind(),e=null)})}}function kt(n,t,i,r,u){function f(){return i.referenceComposition.getPartsContainer().detailContainers.map(function(n){return"\n    "+n.toString()+". Model: "+ko.toJSON(n.getInputsOnlyViewModel())}).join("")||"<None>"}s.isTraceEnabled&&n.verbose("[BladeOpener] "+t+("\n Master Identifier: "+i.masterModelId+".")+("\n  Master Property: '"+r.source.property)+("\n  Master Value: "+(u!==undefined?ko.toJSON(u):"<undefined>")+".")+("\n  Current Detail Blades from Container: "+
f()))}function dt(n,t){var i,r=t,u=t,f=t;return t?r.detailBlade||u.assetType||f.resourceId?r.detailBlade&&u.assetType?i="'detailBlade' and 'assetType' cannot be specified at the same time.":r.detailBlade&&f.resourceId?i="'detailBlade' and 'resourceId' cannot be specified at the same time.":u.assetType&&f.resourceId?i="'assetType' and 'resourceId' cannot be specified at the same time.":t.detailBladeInputs||(i="Model must define a 'detailBladeInputs' property."):i="Either 'detailBlade', 'assetType' or 'resourceId' must be specified on the model. ":i="Dynamic selection must be specified. ",i&&p.logDynamicSelectionError(i,n,t),!i}function k(n,t,i){return i?c.forExtension(i.bladeExtensionName||n,t).withBlade(i.bladeName):null}var c=u.Locator,a=i.Base,d=a.Diagnostics,v=a.Utilities,g=i.Extension,y=g.ReferenceType,nt=f.PropertyBinding,r=ko.isObservable,gt=window,tt=jQuery,it=d.createLog(n),rt=o.PropertyTransformers.getModelToPropertyMapper(),ut=o.PropertyTransformers.getDynamicSelectionMapper(
),p={logDynamicSelectionError:function(n,t,i){it.error("Error invoking detail blade for master '{0}'. ".format(t)+n+"Selection model: '{0}'".format(JSON.stringify(i)))}},l,h,w;t.PartContainerSelectable_ViewModelPath="container.selectable";t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath+".value";l=v.clone;h=nt.getModelValue;t.DefaultConfiguration={services:null,masterModelId:null,masterModel:null,referenceComposition:null,referenceExtension:null,isBladeOpenedByMaster:null,invocationThrottleDuration:25,configureBladeDescriptor:function(){},onBladesOpening:function(){},onBladeOpened:function(){},addOutputBindings:function(){},removeOutputBindings:function(){},getCloseOwnedDetailBladesHandler:function(){return null},getCloseOtherDetailBladesHandler:function(){return null}};t.createDetailBladesTracer=ft,function(n){n[n.waitForPreviousInvocationCompletion=0]="waitForPreviousInvocationCompletion";n[n.beforeInvocation=1]="beforeInvocation";n[n.throttleInvocation=
2]="throttleInvocation";n[n.processExtensionMessages=3]="processExtensionMessages";n[n.onInvocation=4]="onInvocation";n[n.afterInvocation=5]="afterInvocation"}(t.BladeInvocationEvents||(t.BladeInvocationEvents={}));w=t.BladeInvocationEvents;t.InvocationPipeline=e.createDescriptor(w);t.isSelectable=et;t.isSelectableSet=ot;t.isSelectableLocked=st;t.getBladeOpenerJourneyPathSegment=ht;t.getSelectablePath=ct;t.needContainerSelectable=at;t.validateDetailsDefinition=vt;t.mapMasterModelToBladeModel=yt;t.mapDynamicSelectionToBladeLocator=pt;t.getAssociatedDetailDefinition=wt;t.detailsIsPartContainer=b;t.bindOutputsToSelectable2=bt;t.traceInvocationChange=kt}(h||(h={})),h});define("MsPortalImpl/UI/Commands/UI.ExtensionCommands",["require","exports","f","MsPortalImpl.Controls/Controls/Balloon","../../Base/Base.Sanitization","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Resources/ImplScriptResources","../../Interactions/Interactions.Command","../Hubs/UI.NotificationManager","../../Base/Telemetry",
"../Compositions/UI.Composition","../Compositions/UI.Composition.BladeOpenerBase","../Compositions/UI.Composition.CompositionBinder","../Compositions/UI.Composition.PropertyBinding","../UI.DesktopManager"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return function(t){function ni(n,t,i){var r;return n.viewModel?r=new ki(t,i):n.execute?r=new vi(t,i):n.navigateUriCallback?r=new pi(t,i):n.navigateUri?r=new yi(t,i):n.listItems?r=new wi(t,i):n.targetUri&&n.httpMethod?r=new bi(t,i):(i.commandItem.commandDefinition.details||n.bladeName)&&(r=new di(t,i)),r}function st(n){var t=n,i=null;if(!(n instanceof ht))throw new Error("Command context was not an instance of CompositionInstanceCommandContext. All context objects are expected to be of that type.");return t.compositionInstance&&t.compositionInstance.locator&&(i=t.compositionInstance.locator.toFriendlyString()),i}function gi(n){tt=n}var g=i.Base,ct=g.Constants,lt=g.Diagnostics,nt=lt.Telemetry,ii=g.Resources,d=g.Utilities,ri=i.Extension,
it=ri.ReferenceType,at=i.Hubs.Notifications.NotificationStatus,w=i.ViewModels,rt=w.Dialogs,vt=rt.DialogResult,yt=rt.MessageBoxButtons,ui=c.CompositionType,fi=a.CompositionBinder,ei=v.PropertyBinding,oi=v.ReferenceScope,si=g.Net2,pt=w.CommandStatus,b=window,ut=jQuery,p=lt.createLog(n),wt=b.fx.environment.branding.title,bt=function(){return i.require("MsPortalImpl/UI/UI.DialogManager")},ot=d.isNullOrUndefined,ft=i.uncurryThis(Array.prototype.forEach),tt=null,hi={invocationInputArguments:[{valuesFrom:[{referenceType:it.Command,property:"container.selectable"}]}]},y=e.FileDownloadCommand,ci="Content-Disposition",li="Authorization",kt="error",dt=412,ai="data:",gt="text/plain",et=pt.Executing,ht,ti;t.createExtensionCommand=ni;t.getCommandSourceTelemetryName=st;ht=function(n){function t(t,i,r){n.call(this,t,i);this.compositionInstance=r}return __extends(t,n),t}(o.CommandContext);t.CompositionInstanceCommandContext=ht;ti=function(){function n(){}return n}();t.ExtensionCommandImplOptions=ti;var
k=function(){function n(n,t){this._extension=t.extension;this._viewModelName=t.viewModelName;this._composedViewModel=n;this._commandItem=t.commandItem;this._commandContainer=t.container;this._lifetimeManager=t.lifetimeManager;this._propertyBindings=t.propertyBindings;this._services=t.services}return n.prototype.init=function(){},Object.defineProperty(n.prototype,"viewModel",{get:function(){return this._composedViewModel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"commandItem",{get:function(){return this._commandItem},enumerable:!0,configurable:!0}),n.prototype.execute=function(n){nt.trace({extension:this._extension.name,source:st(this._context()),action:h.Action.CommandExecuted,name:this._viewModelName,data:n})},n.prototype.dispose=function(){this._disposeViewModel();this._propertyBindings&&(this._propertyBindings.unbind(),this._propertyBindings=null)},n.prototype._context=function(){return this._commandItem.getCommandContext()},n.prototype._formTarget=function(
){var n=this._context();return n&&n.formTarget},n.prototype._target=function(){var n=this._context();return n&&n.target},n.prototype._disposeViewModel=function(){this._composedViewModel&&(d.disposeViewModelProperties(this._composedViewModel),this._extension.releaseViewModel(this._composedViewModel),this._composedViewModel=null)},n}(),vi=function(n){function t(t,i){n.call(this,t,i);this._viewModel=t.content;this._handleDesktopModeChange()}return __extends(t,n),t.prototype.execute=function(t,i){var u=this,r;n.prototype.execute.call(this,t,i);r=this._viewModel;r.status()===et?this._services.getService("DialogManager").then(function(n){u._loadDialog(n,ko.unwrap(r.dialog))}):r.status(et);r.execute(i)},t.prototype.init=function(){var t=this,n=this._viewModel,i=this._lifetimeManager;this._services.getService("DialogManager").then(function(r){n.status.subscribe(i,function(n){t._statusChanged(r,n)});ko.isObservable(n.dialog)&&n.dialog.subscribe(i,function(n){t._dialogChanged(r,n)})})},t.prototype.
_handleDesktopModeChange=function(){var n=this;this._services.desktop.mode.subscribe(this._lifetimeManager,function(t){var i=n._formTarget();t===1&&i&&i.hideForm()})},t.prototype._statusChanged=function(n,t){t===pt.None?this._hideCommandForm():t===et&&this._loadDialog(n,ko.unwrap(this._viewModel.dialog))},t.prototype._dialogChanged=function(n,t){this._viewModel.status()===et&&this._loadDialog(n,t)},t.prototype._loadDialog=function(n,t){var i=this;if(this._formTarget()&&(!d.deepEquals(this._currentDialogOptions,t)||!n.hasOpenDialog))if(this._currentDialogOptions=t,ot(t))this._hideCommandForm();else{if(!this._target())return;var f=ut(this._formTarget().getForm()),u=this._commandContainer.locator,e=u&&u.withCommand(this._commandItem.commandName);this.commandItem.pressed(!0);n.showDialog(f,t,e).then(function(n){i.commandItem.pressed(!1);var t=i._viewModel,r=t&&t.dialogClick;typeof r=="function"&&r.call(t,n)});this._formTarget().showForm(r.getBox(this._target()))}},t.prototype._hideCommandForm=
function(){var n=this._formTarget();n&&n.hideForm()},t}(k),yi=function(n){function t(t,i){n.call(this,t,i);this._viewModel=t.content;this.canSkipBladeValidation=!0}return __extends(t,n),t.prototype.execute=function(t){var i=this._viewModel,r=i.navigateTarget?i.navigateTarget():"_blank";n.prototype.execute.call(this,t);b.open(i.navigateUri(),r)},t}(k),pi=function(n){function t(t,i){n.call(this,t,i);this._resourceStrings=e.UriCallbackCommand;this._viewModel=t.content;this._getDialogResources();this.canSkipBladeValidation=!0}return __extends(t,n),t.prototype.execute=function(t){var i=this,l;n.prototype.execute.call(this,t);var c=this._viewModel.navigateTarget?this._viewModel.navigateTarget():"_blank",s=this._viewModel.navigateUriCallback,r,h=!0,f=this._viewModel,o=this.commandItem,a=f.showUriCallbackConfirmationDialog&&f.showUriCallbackConfirmationDialog();s&&s()&&a?(o.fxEnabled(!1),this._services.getService("DialogManager").then(function(n){return i._dialogManager=n,i._showUriCallbackProgressDialog(
n,t),Q(f.navigateUriCallback()()).then(function(r){return h=!1,bt().then(function(u){var f=new u.MessageBox(i._downloadTitle,i._downloadText,yt.OKCancel);f.defaultButtonText=i._defaultButtonText;f.cancelButtonText=i._cancelButtonText;n.showDialogWithCallback(i._getDialogElement(),f,function(n){n===vt.Ok&&i._openUri(r,c);i._hideForm(t);o.fxEnabled(!0)},i._getLocator())})},function(n){i._notifyError(n)}).finally(function(){h&&(p.error(i._resourceStrings.callbackError.format("navigateUriCallback failed.")),r&&r.close(),i._dialogManager&&i._dialogManager.dismissOpenDialog(),i._hideForm(t),o.fxEnabled(!0))})}).catch(function(n){p.error(n)})):s&&s()?(l=this._resourceStrings,o.fxEnabled(!1),r=b.open("about:blank",c),r.document.title=e.Portal.windowTitleFormat.format(this._resourceStrings.loading,wt),Q(f.navigateUriCallback()()).then(function(n){h=!1;u.sanitizeUri(n)?(r.document.title=wt,r.location.href=n):(p.error(l.invalidUri.format(n)),i._notifyError(),r.close())},function(n){i._notifyError(
n)}).finally(function(){h&&(p.error(l.callbackError.format("navigateUriCallback failed.")),r.close());o.fxEnabled(!0)})):this._openUri(f.navigateUri(),c)},t.prototype._openUri=function(n,t){u.sanitizeUri(n)?b.open(n,t):(p.error(this._resourceStrings.invalidUri.format(n)),this._notifyError())},t.prototype._notifyError=function(n){var i=n&&n.title,r=n&&n.description,t=this._resourceStrings;s&&s.getNotificationManager()&&s.getNotificationManager().addClientNotification({title:i||t.uriCallbackCommandError,description:r||t.error,status:at.Error,timestamp:new Date,cloudName:ct.DefaultCloudName})},t.prototype._getDialogElement=function(){var n=this._formTarget(),t=n&&n.getForm();return ut(t)},t.prototype._getLocator=function(){var n=this._commandContainer.locator;return n&&n.withCommand(this._commandItem.commandName)},t.prototype._showUriCallbackProgressDialog=function(n,t){var i=new rt.ProgressBox(this._uriCallbackProgressTitle,this._uriCallbackProgressText);n.showDialog(this._getDialogElement(
),i,this._getLocator());this._showForm(t)},t.prototype._showForm=function(n){var t=this._formTarget();n&&t&&t.showForm(r.getBox(this._target()))},t.prototype._hideForm=function(n){var t=this._formTarget();n&&t&&t.hideForm()},t.prototype._getDialogResources=function(){var t=this._viewModel,n=t.uriCallbackConfirmationDialogOptions;if(n)var i=n.uriCallbackProgressTitle,r=n.uriCallbackProgressText,u=n.downloadTitle,f=n.downloadText,e=n.defaultButtonText,o=n.cancelButtonText;this._uriCallbackProgressTitle=i||y.uriCallbackProgressTitle;this._uriCallbackProgressText=r||y.uriCallbackProgressText;this._downloadTitle=u||y.downloadTitle;this._downloadText=f||y.downloadText;this._defaultButtonText=e||y.defaultButtonText;this._cancelButtonText=o||y.cancelButtonText},t}(k),wi=function(n){function t(t,i){n.call(this,t,i);var f=this._lifetimeManager,e=this._commandItem,r=t.content,o=e.widgetViewModel,u=o.dialogOptions;ko.reactor(f,function(){u.listItems(r.listItems())});r.selectedItem.subscribe(f,function(
n){u.selectedItem(n)});u.selectedItem(r.selectedItem());e.hasPopup(!0);u.selectedItem.subscribe(f,function(n){r.selectedItem(n)});this.canSkipBladeValidation=!0}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t}(k),bi=function(n){function t(t,i){n.call(this,t,i);this._disposed=!1;this._viewModel=t.content;this._getDialogResources();f.isSafari&&(this.commandItem.fxEnabled(!1),this.commandItem.tooltip(y.downloadNotSupported));this.canSkipBladeValidation=!0}return __extends(t,n),t.prototype.execute=function(t){var i=this,r,u,f;n.prototype.execute.call(this,t);r=this._viewModel;u=this.commandItem;u.fxEnabled(!1);r.targetUriCallback&&r.targetUriCallback()?this._services.getService("DialogManager").then(function(n){r.showUriCallbackConfirmationDialog&&r.showUriCallbackConfirmationDialog()&&i._showUriCallbackProgressDialog(n,t);var f=!0;return r.targetUriCallback()().then(function(e){if(f=!1,r.showUriCallbackConfirmationDialog&&r.showUriCallbackConfirmationDialog(
)){var o=!0;return bt().then(function(t){var r=new t.MessageBox(i._downloadTitle,i._downloadText,yt.OKCancel);return r.defaultButtonText=i._defaultButtonText,r.cancelButtonText=i._cancelButtonText,n.showDialog(i._getDialogElement(),r,i._getLocator())}).then(function(n){n===vt.Ok&&(o=!1,i._initiateFileDownload(e,t))}).finally(function(){o&&(i._hideForm(t),u.fxEnabled(!0))})}i._initiateFileDownload(e,t)}).finally(function(){if(f){var e=r.errorMessage();i._notifyDownloadError(e||y.downloadTargetUriCallbackFailed);r.showUriCallbackConfirmationDialog&&r.showUriCallbackConfirmationDialog()&&n.dismissOpenDialog();i._hideForm(t);u.fxEnabled(!0)}})}).catch(function(n){p.error(n)}):(f=this._viewModel.targetUri?this._viewModel.targetUri():null,this._initiateFileDownload(f,t))},t.prototype.dispose=function(){this._disposed=!0;n.prototype.dispose.call(this)},t.prototype._initiateFileDownload=function(n,t){var i=this,f=null,s=this._getHttpMethodName(),r=this._viewModel,u=function(){i._hideForm(t);i.
commandItem.fxEnabled(!0)},e,o;if(!n||!s){e=n?y.typeError:y.uriError;this._notifyDownloadError(e);r.downloadStatus(new w.FileDownloadStatus(kt,dt,e));u();return}if(o=this._isDataUri(n),!ii.isUriAbsolute(n)&&!o){this._notifyDownloadError(y.absoluteUriError);r.downloadStatus(new w.FileDownloadStatus(kt,dt,y.absoluteUriError));u();return}r.downloadStatus(null);this._services.getService("DialogManager").then(function(e){r.showDownloadProgressDialog&&r.showDownloadProgressDialog()&&i._showDownloadProgressDialog(e,t);f=nt.startTrace({extension:i._extension.name,source:st(i._context()),action:h.Action.StartFileDownload,name:i._viewModelName,data:t});o?(i._dataUriHandler(e,n),u(),nt.cancelTrace(f)):si.ajaxExtended(i._getAjaxOptions(n,s)).then(function(n){var t=n.content,r=t&&t.length?t.length:0;i._disposed||i._fileDownloadSuccessHandler(e,t,n.textStatus,n.jqXHR);u();nt.completeTrace(f,r)},function(n){i._fileDownloadErrorHandler(e,n.textStatus,n.jqXHR.status,n.errorThrown);u();nt.cancelTrace(f)}
)}).catch(function(n){p.error(n)})},t.prototype._getHeaders=function(){var n=this._viewModel,t=n.headers&&n.headers();return t?d.clone(t):null},t.prototype._getHeadersWithAuthorizationToken=function(){var t=this._viewModel.authorizationToken&&this._viewModel.authorizationToken(),n=this._getHeaders();return t?n?(n[li]=t,n):{authorizationHeader:t}:n},t.prototype._getHttpMethodName=function(){var t=this._viewModel,i=t.httpMethod&&t.httpMethod(),n;return i?(n=i.toUpperCase(),n==="GET"||n==="POST")?n:null:"GET"},t.prototype._getFileNameFromResponseHeaders=function(n){var t,r=0,u=n.getResponseHeader(ci),f=this._viewModel,e=f.targetFileName&&f.targetFileName(),i;return e?t=e:u&&(i=u.split(";").filter(function(n){return n.indexOf("filename")>=0}),i&&i.length>0&&(r=i[0].indexOf("="))>=0&&(t=i[0].substring(r+1),t&&(t=t.replaceAll('"',"").trim()))),t?t:y.defaultFileName},t.prototype._getDatatype=function(){var n=this._viewModel,t=n.downloadType&&n.downloadType();return t===w.FileDownloadType.Binary?
"binary":"text"},t.prototype._getAjaxOptions=function(n,t){var u=this._getDatatype(),r={uri:n,type:t,dataType:u,headers:this._getHeadersWithAuthorizationToken(),checkVersion:!1},i;return u==="binary"&&(r.processData=!1,r.responseType="arraybuffer"),t==="POST"&&(i=this._viewModel,i.httpRequestContent&&i.httpRequestContent()&&(r.data=i.httpRequestContent(),r.contentType=i.httpRequestContentType&&i.httpRequestContentType()||"application/json")),r},t.prototype._isDataUri=function(n){return n&&n.startsWith(ai)},t.prototype._getMimeTypeForDataUri=function(n){var r=gt,t,i;return n.length>0&&n[0]&&(t=n[0].split(":"),t.length>1&&t[1]&&(i=t[1].split(";"),i.length>0&&i[0]&&(r=i[0]))),r},t.prototype._dataUriToBlob=function(n,t){var r=t.split(","),e=gt,i,f,o,u;if(r.length>1&&r[1])if(e=this._getMimeTypeForDataUri(r),this._getDatatype()==="binary")try{for(i=atob(r[1]),o=new Uint8Array(new ArrayBuffer(i.length)),u=0;u<i.length;u++)o[u]=i.charCodeAt(u);return new Blob([o],{type:e})}catch(s){f=y.dataUriBinaryEncodingError}
else try{return i=decodeURIComponent(r[1]),new Blob([i],{type:e})}catch(s){f=y.dataUriTextEncodingError}else f=y.dataUriParseError;return this._fileDownloadErrorHandler(n,y.dataUriErrorStatusText,400,f),null},t.prototype._dataUriHandler=function(n,t){var u=this._viewModel.targetFileName()||y.defaultFileName,r=this._dataUriToBlob(n,t),i=this._viewModel;i.showDownloadProgressDialog&&i.showDownloadProgressDialog()&&n.dismissOpenDialog();r!=null&&(this._launchSavaAsDialog(r,u),i.downloadStatus(new w.FileDownloadStatus(y.fileDownloadSuccessStatus,200)))},t.prototype._launchSavaAsDialog=function(n,t){var i=b.navigator,r;i.msSaveOrOpenBlob?i.msSaveOrOpenBlob(n,t):(r=(b.webkitURL||b.URL).createObjectURL(n),this._launchDownloadFileDialog(r,t))},t.prototype._fileDownloadSuccessHandler=function(n,t,i,r){var f=this._getFileNameFromResponseHeaders(r),e=new Blob([t],{type:"application/octet-stream"}),u=this._viewModel;u.showDownloadProgressDialog&&u.showDownloadProgressDialog()&&n.dismissOpenDialog(
);this._launchSavaAsDialog(e,f);u.downloadStatus(new w.FileDownloadStatus(i,r.status))},t.prototype._fileDownloadErrorHandler=function(n,t,i,r){var u=this._viewModel,f;u.showDownloadProgressDialog&&u.showDownloadProgressDialog()&&n.dismissOpenDialog();f=u.errorMessage&&u.errorMessage()||y.downloadError;this._notifyDownloadError(y.downloadErrorDetails.format(f,t,i,r));u.downloadStatus(new w.FileDownloadStatus(t,i,r))},t.prototype._launchDownloadFileDialog=function(n,t){var i=b.document.createElement("a");i.style.display="none";i.href=n;i.download=t;document.body.appendChild(i);i.click();ut(i).remove()},t.prototype._notifyDownloadError=function(n){s.getNotificationManager().addClientNotification({title:y.downloadCommandError,description:n,status:at.Error,timestamp:new Date,cloudName:ct.DefaultCloudName})},t.prototype._getDialogElement=function(){var n=this._formTarget(),t=n&&n.getForm();return t&&ut(t)},t.prototype._getLocator=function(){var n=this._commandContainer.locator;return n&&n.withCommand(
this._commandItem.commandName)},t.prototype._showUriCallbackProgressDialog=function(n,t){this._showProgressDialog(n,this._uriCallbackProgressTitle,this._uriCallbackProgressText,t)},t.prototype._showDownloadProgressDialog=function(n,t){this._showProgressDialog(n,this._downloadProgressTitle,this._downloadProgressText,t)},t.prototype._showProgressDialog=function(n,t,i,r){var u=new rt.ProgressBox(t,i);n.showDialog(this._getDialogElement(),u,this._getLocator());this._showForm(r)},t.prototype._showForm=function(n){var t=this._formTarget();n&&t&&t.showForm(r.getBox(this._target()))},t.prototype._hideForm=function(n){var t=this._formTarget();n&&t&&t.hideForm()},t.prototype._getDialogResources=function(){var i=this._viewModel,n=i.uriCallbackConfirmationDialogOptions,t=i.downloadProgressDialogOptions,r,u;if(n)var f=n.uriCallbackProgressTitle,e=n.uriCallbackProgressText,o=n.downloadTitle,s=n.downloadText,h=n.defaultButtonText,c=n.cancelButtonText;t&&(r=t.downloadProgressTitle,u=t.downloadProgressText);
this._uriCallbackProgressTitle=f||y.uriCallbackProgressTitle;this._uriCallbackProgressText=e||y.uriCallbackProgressText;this._downloadTitle=o||y.downloadTitle;this._downloadText=s||y.downloadText;this._defaultButtonText=h||y.defaultButtonText;this._cancelButtonText=c||y.cancelButtonText;this._downloadProgressTitle=r||y.downloadProgressTitle;this._downloadProgressText=u||y.downloadProgressText},t}(k),ki=function(n){function t(t,i){n.call(this,t,i);this._container=i.container;this._viewModel=t.content;this._selectionInList=i.selectionInList}return __extends(t,n),t.prototype.execute=function(t){var u,f,i;n.prototype.execute.call(this,t);var r=this._viewModel.viewModel(),e=this._composedViewModel,o={container:this._container,extension:this._extension,viewModelName:this._viewModelName,commandItem:this._commandItem,lifetimeManager:this._lifetimeManager,propertyBindings:null,services:this._services,selectionInList:this._selectionInList};this._commandItem.commandDefinition.details=hi;r?(this._validate(
r),u=d.clone(e),u.content=r,f=r,f.bladeName&&u.container.selectable.selectedValue({detailBlade:f.bladeName,detailBladeInputs:f.bladeInputs}),i=this._nestedCommand,i&&i.dispose(),i=this._nestedCommand=ni(r,u,o),i.init(),i.execute(t)):p.error("The nested command is missed for the {0} dynamic command.".format(this._viewModelName))},t.prototype.dispose=function(){this._nestedCommand&&this._nestedCommand.dispose()},t.prototype._validate=function(n){var i=this,t=n;ft(["text","icon","enabled"],function(n){i._checkPropertyNotNullOrUndefined(t[n],n)});this._checkPropertyNotNullOrUndefined(t.onInputsSet,"onInputSet",!0)},t.prototype._checkPropertyNotNullOrUndefined=function(n,t,i){ot(n)||typeof n!="function"||!i&&ot(n())||this._logIgnoredPropertyWarning(t)},t.prototype._logIgnoredPropertyWarning=function(n){p.warning("The '"+n+"' property of a command viewModel contains a value. This value will be ignored when passing to '"+this._viewModelName+"' dynamic command viewModel.")},t}(k),di=function(n)
{function t(t,r){var u=this,f,e;n.call(this,t,r);this._addedOutputPropertyBindings=[];this._outputBindingDefinitions=[];this._viewModel=t;this._containerViewModel=t.container;f=this._commandItem;e=f.commandDefinition;this._commandInstanceId=r.selectionInList?d.newGuid():undefined;var h=this._validateCommandDefinition(e),o=e.details,c=this._validateDetailsDefinition(o),s=function(n){u._bladeOpener=new n.BladeOpener(u._getBladeOpenerConfig(r.container,r.extension));u._bladeOpener.registerInvocationProperty(f.commandDefinition.details)};h&&c?(this._outputBindingDefinitions=fi.mapInputBindingDefinitions(o.outputArguments||[],r.container,function(n){n.source.scope=oi.DetailsContainer}),tt?s(tt):i.require("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener").then(function(n){tt=n;s(tt)})):r.commandItem.setEnabled(!1);this.canSkipBladeValidation=!0}return __extends(t,n),t.prototype.dispose=function(){this._bladeOpener&&(this._bladeOpener.dispose(),this._bladeOpener=null);n.prototype.dispose.
call(this)},t.prototype.execute=function(t){n.prototype.execute.call(this,t);var i=this._containerViewModel,r=i&&i.selectable;r?r.isSelected(!0):p.error("OpenBladeCommand '{0}' from extension '{1}' was not initialized with a Selectable.".format(this._commandItem.commandDefinition.name,this._extension.name))},t.prototype._getBladeOpenerConfig=function(n,t){var i=this,u=this._commandItem.commandDefinition.details,f=u?!!u.parameterCollector:!1,r=this._services;return{services:r,masterModelId:"{0}-[{1}-{2}]".format(n.toString(),"OpenBladeCommand",this._commandItem.commandDefinition.name),masterModel:this._viewModel,referenceComposition:n,referenceExtension:t,isBladeOpenedByMaster:function(t){return t.masterCommandName===i._commandItem.commandDefinition.name&&t.masterPartId===n.id&&t.masterCommandId===i._commandInstanceId},configureBindings:function(t){ft(t,function(t){var r=t.source,u=r&&r.modelType;u===it.Command&&(r.modelId=i._commandItem.commandDefinition.name,c.isPartComposition(n)&&(r.
partLocator=n.locator,r.id=n.id))})},configureBladeDescriptor:function(t){var r,u,o;if(t.masterCommandName=i._commandItem.commandDefinition.name,t.masterCommandId=i._commandInstanceId,t.masterCommandExtension=i._extension,t.masterPartId=n.id,r=t.bindings,Array.isArray(r))for(u=r.length-1;u>=0;u--){var s=r[u],e=s.source,h=e&&e.modelType;h===it.Command&&(t.model[s.targetProperty]=ko.toJS(ei.getModelValue(i._viewModel,e.property).value),o=i._commandItem.sourceBindableContainer,!f&&o&&o.isPartListItem&&r.splice(u,1))}},onBladeOpened:function(n){i._setCommandActivated(!0);n.onDispose(function(){i._bladeOpener&&i._bladeOpener.notifyDetailBladeClosed(n);i._disposeOutputBindings();i._setCommandActivated(!1)});n.awaitComposed().then(function(){i._createOutputBindings(n)});i.bladeOpenedCallback&&i.bladeOpenedCallback(n)},getCloseOtherDetailBladesHandler:function(t,i){if(i.openInContextPane){if(n.getCompositionType()===ui.StartboardPart){var u=r.desktop.getActiveJourney();return!u||u.isStartedWithContextBlade(
)?null:function(){return r.desktop.tryDeactivateJourney()}}if(!r.contextPane.opened.peek())return function(){return!0}}return null}}},t.prototype._createOutputBindings=function(n){var t=this;ft(this._outputBindingDefinitions,function(i){var u=t._propertyBindings,r;u&&(r=u.mapProperty(i.source.property,i.targetProperty).bind(n.toString()+"LaunchCommandOutputBinding",n.getViewModel()),r.compositionBindingDefinition=i,t._addedOutputPropertyBindings.push(r))})},t.prototype._disposeOutputBindings=function(){var n=this;this._propertyBindings&&ft(this._addedOutputPropertyBindings,function(t){n._propertyBindings.removeProperty(t)});this._addedOutputPropertyBindings.length=0},t.prototype._validateCommandDefinition=function(n){var t;return n.name?n.details||(t="OpenBladeCommand must provide a details blade definition."):t="OpenBladeCommand must provide a command name.",t&&p.error("{0} Command: '{1}'. CommandDefinition: '{2}'.".format(t,n.name,JSON.stringify(n))),!t},t.prototype._validateDetailsDefinition=
function(n){var t=[],i=function(n){var t,i=n.invocationInputArguments;return n.isMultiple?t="Command cannot open multiple blades. isMultiple value must be false.":i&&i[0].valuesFrom[0].referenceType!==it.Command&&(t="Command invocation argument reference type can only be of type Command."),t},r=l.validateDetailsDefinition(n,t,i);return t.length&&p.error("{0} Command: '{1}'. Details: '{2}'.".format(t[0],this._commandItem.commandDefinition.name,JSON.stringify(n))),r},t.prototype._setCommandActivated=function(n){var t=this._commandContainer.getViewModel(),i=t&&t.container,r=i&&i.selectable;r&&r.isCommandSelected(n);this._commandItem.pressed(n)},t}(k);t.setBladeOpenerModule=gi}(y||(y={})),y});define("MsPortalImpl/Widgets/Widgets.CommandBarBase",["require","exports","f","../Interactions/Interactions.Command","../Base/Telemetry"],function(n,t,i,r,u){"use strict";var f;return function(n){var e=i.Base.Diagnostics.Telemetry,o=i.ViewModels,s=o.Dialogs,h=ko.observable,t=function(n){function t(t,r,
u){var f=this;n.call(this,t.label);this._model=t;this._locator=r;this._icon=this._model.icon;this.commandName=u||i.getUniqueId();this._enabled=ko.computed(this,function(){var n=t,i=!t.disabled(),r=!n.command||n.command.canExecute();return i&&r});ko.computed(this,function(){var n=!t.unauthorizedMessage||!t.unauthorizedMessage();f.visible(n)})}return __extends(t,n),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._model&&this._model.type},enumerable:!0,configurable:!0}),t.prototype.execute=function(t){e.trace({source:u.Source.Shell,action:u.Action.CommandExecuted,name:this._locator&&this._locator.toFriendlyString(),extension:this._locator&&this._locator.getExtensionLocator().name});n.prototype.execute.call(this,t)},t}(r.CommandImpl),f;n.ItemViewModel=t;f=function(n){function t(t,i,r,u){n.call(this,t,i,u);this.hasOpenDialog=h(!1);this._services=r;var f=t.dialogOptions;
this.hasPopup(!!f&&f.type===s.DialogType.List)}return __extends(t,n),Object.defineProperty(t.prototype,"dialogOptions",{get:function(){return this._model.dialogOptions},enumerable:!0,configurable:!0}),t.prototype.execute=function(t){var r=this;this._services.getService("DialogManager").then(function(u){if(r.hasOpenDialog())u.dismissOpenDialog(),r.hasOpenDialog(!1);else{var e=r._currentContext,o=e&&e.target,f=e.formTarget,h=f&&f.getForm(),s=r._model;r.hasOpenDialog(!0);u.showDialog($(h),r.dialogOptions,r._locator).then(function(n){r.hasOpenDialog(!1);s.command&&s.command.execute(n)},function(){r.hasOpenDialog(!1)});f&&o&&i.require("MsPortalImpl.Controls/Controls/Balloon").then(function(n){f.showForm(n.getBox(o))})}n.prototype.execute.call(r,t)})},t}(t);n.DialogButton=f}(f||(f={})),f});define("MsPortalImpl/UI/Commands/UI.Commands",["require","exports","f","../../Base/Base.SelectableSet2","../../Extension/Extension.Definition.Locator","MsPortalImpl.Controls/Fields/Base/FormValidation","../Compositions/UI.Composition.CloudName",
"MsPortalImpl/Resources/ImplScriptResources","../../Interactions/Interactions.Command","../Compositions/UI.Composition.CompositionBinder","../Compositions/UI.Composition.Security","../UI.DesktopManager","./UI.ExtensionCommands","../../Widgets/Widgets.WidgetBase","../../Widgets/Widgets.CommandBarBase","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var p;return function(t){function ti(n){return a.getCommandSourceTelemetryName(n)}function ii(n){var t=v.Widget.getWidget(n,null);if(n.hasClass("fxs-blade"))return t}function ri(n,t,i,r){var u=null,f=i.commandGroupReference,e=f?f.name:i.commandGroup;return e&&(u=n.locate(rt.forExtension(t,r).withCommandGroup(e))),u}function ui(n,t,i,r,u,f,e){var v={name:f,details:{invocationInputArguments:[{valuesFrom:[{property:"container.selectable",referenceType:ot.Command}]}]}},o=new dt({});o.selectable=l.OpenBladeCommand.createSelectableViewModel();var y={enabled:it(!0)},c=new yt(o,y,undefined),
p="__{0}ViewModel__".format(f),s=new b(u,i,v,r,t),w={container:i,extension:u,viewModelName:p,commandItem:s,lifetimeManager:new ft,propertyBindings:null,services:t,selectionInList:!1},h=a.createExtensionCommand(c.content,c,w);return h.bladeOpenedCallback=e,s.bind(new lt(null,null,i)),n.registerForDispose([o,s,h]),h}var rt=u.Locator,ut=FxImpl,ft=ut.TriggerableLifetimeManager,yt=ut.ViewModels.CompositionViewModel,p=i.Base,pt=p.Diagnostics,et=p.Images,wt=p.Utilities,k=i.Extension,ot=k.ReferenceType,bt=k.SetRequirement,l=i.ViewModels,d=l.Dialogs,st=l.Toolbars,kt=h.CompositionBinder,dt=l.Internal.SelectableContainerViewModel,gt=l.CommandStatus,g=i.Helpers,fi=window,ht=jQuery,nt=pt.createLog(n),ct=o.Commands,ni=wt.isNullOrUndefined,tt=i.uncurryThis(Array.prototype.forEach),it=ko.observable,lt=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(a.CompositionInstanceCommandContext),w,at,b,vt;t.CompositionInstanceCommandContext=lt;t.getCommandSourceTelemetryName=ti;t.getBladeWidget=
ii;t.getCommandGroupForDefinitionItem=ri;w=function(n){function t(t,i,r,u){n.call(this,i,!1);this.commandName=t;this._services=u;this._compositionContainer=r;this._enabled=this._enabled.extend({allowOverride:!0});this._init(u.desktop)}return __extends(t,n),Object.defineProperty(t.prototype,"services",{get:function(){return this._services},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"container",{get:function(){return this._compositionContainer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceBindableContainer",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype._init=function(n){var t=this;ko.reactor(this,function(){var i=t.enabled,r=n.mode(),u=n.commandsEnabled();u&&r!==1?i.restoreLastWrittenValue():i.override(!1)})},t}(s.CommandImpl);t.ExtensionCommandMenuItemBase=w;at=function(n){function t(t,i,u,f,e,o){var s=this,h=u.name,c,l;n.call(this,h,u.text,i,e);c=h?h:u.text;l=r.getSelectedItems(o);this._subcommands=l.map(function(
n){var o={viewModel:n.data,viewModelName:i.toString()+"[Command: "+c+"]",isPartListItem:!0},r=new b(t,i,u,f,e,o);return s.registerForDispose(r),r});ko.reactor(this,function(){var n=s._subcommands.reduce(function(n,t){return t.enabled()&&n},!0);s.enabled(n)})}return __extends(t,n),t.prototype.bind=function(n){tt(this._subcommands,function(t){return t.bind(n)})},t.prototype.activate=function(){tt(this._subcommands,function(n){return n.activate()})},t.prototype.execute=function(n){tt(this._subcommands,function(t){return t.execute(n)})},t}(w);t.ExtensionMultiselectCommandMenuItemImpl=at;b=function(n){function t(t,i,r,u,f,e,o){n.call(this,r.name,r.text,i,f);this._extension=t;this._commandDefinition=r;this._commandContainerDefinition=u;this._sourceBindableContainer=e;this._selectionInList=o;this._setupWidgetViewModel(r,f)}return __extends(t,n),t.prototype.extensionName=function(){return this._extension&&this._extension.name},Object.defineProperty(t.prototype,"commandDefinition",{get:function(
){var n=this._commandDefinition;return nt.assert(!n.reference,"External CommandDefinition has not been resolved."),n},enumerable:!0,configurable:!0}),t.prototype.getInputBindingsFromDefinition=function(n){var i,t=this._getCommandReference(n);return t&&Array.isArray(t.bindings)&&t.bindings.length>0?i=t.bindings:n&&(i=n.bindings),i||[]},Object.defineProperty(t.prototype,"widgetViewModel",{get:function(){return this._widgetViewModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceBindableContainer",{get:function(){return this._sourceBindableContainer},enumerable:!0,configurable:!0}),t.prototype.activate=function(){this._loadViewModel()},t.prototype.execute=function(n){var f=this,t=this.widgetViewModel,i=t&&t.dialogOptions;if(i&&i.type&&t.type===st.ToolbarItemType.DialogButton){var r=this._formTarget(),e=r&&r.getForm(),u=this.container.locator,o=u&&u.withCommand(this.commandName);this._services.getService("DialogManager").then(function(n){return n.showDialog(ht(e),
i,o)}).then(function(){f._execute(n)})}else this._execute(n)},t.prototype.getCommandContext=function(){return this._currentContext},t.prototype._formTarget=function(){var n=this._currentContext;return n&&n.formTarget},t.prototype._target=function(){var n=this._currentContext;return n&&n.target},t.prototype._getCommandReference=function(n){var t=this._commandContainerDefinition&&this._commandContainerDefinition.commandGroupReference,i=null;return t&&t.commands&&n.name&&(i=t.commands.first(function(t){return t.name===n.name})),i},t.prototype._execute=function(t){var i=this,u=this._currentContext.compositionInstance,r;if(!this._extensionCommand){this._loadViewModel();return}r=u&&u.widget;r&&!this._extensionCommand.canSkipBladeValidation?(this._overrideEnabledPropertyWith(!1),f.ensureFormFieldValidation(r.element).then(function(r){n.prototype.execute.call(i,t);i._extensionCommand.execute(t,r)}).finally(function(){i._clearEnabledPropertyOverride()})):(n.prototype.execute.call(this,t),this._extensionCommand.
execute(t))},t.prototype.dispose=function(){var r=this,t=this._viewModelLoadedPromise,i=this._lifetimeManager;t&&(t.done(function(){i&&(i.dispose(),r._lifetimeManager=null)}),this._viewModelLoadedPromise=null);n.prototype.dispose.call(this)},t.prototype.setEnabled=function(n){this._extensionEnabledProperty=n;this._overrideEnabledProperty||this.enabled(n)},t.prototype.getViewModel=function(){var n=this._extensionCommand;return n&&n.viewModel},t.prototype.getViewModelAsync=function(){return this._loadViewModel(),this._viewModelLoadedPromise},Object.defineProperty(t.prototype,"canRebind",{get:function(){var n=this._getContentViewModel(),t=n&&n.status&&n.status();return t!==gt.Executing},enumerable:!0,configurable:!0}),t.prototype._setupWidgetViewModel=function(n,t){var r=n.commandKind===k.CommandKind.List,i,u;(!n.commandKind||r)&&(i=new st.DialogButton,u=this.container.locator.withCommand(n.name),i.dialogOptions=new d.ListPopup,i.dialogOptions.type=r?d.DialogType.List:d.DialogType.Invalid,
this._widgetViewModel=new y.DialogButton(i,u,t,n.name))},t.prototype._getContentViewModel=function(){var n=this.getViewModel();return n&&n.content},t.prototype._overrideEnabledPropertyWith=function(n){this._overrideEnabledProperty=!0;this.enabled(n)},t.prototype._clearEnabledPropertyOverride=function(){this._overrideEnabledProperty&&(this._overrideEnabledProperty=!1,this.enabled(this._extensionEnabledProperty))},t.prototype._resolveCommandDefinition=function(){var n=this,i,t=this._commandDefinition,r,u;return t.reference?(r=rt.forExtension(t.reference.extension||this._extension.name,this._extension.cloudName),u=r.withCommandType(t.reference.commandType),this.icon(et.Loading.EllipsisSquare()),this.text(ct.loading),i=this.services.finder.locateAsync(u).then(function(i){n._extension=n.services.finder.locate(r);var u=n.getInputBindingsFromDefinition(t);n._commandDefinition=ht.extend({},i,{name:t.name});u.length>0&&(n._commandDefinition.bindings=u);n.text(i.text)})):i=g.Deferred().resolve().
promise(),i},t.prototype._logError=function(n){var t=this._commandDefinition;nt.error("{0} \nCommand name: {1} \nView model name: {2} \nExtension name {3}".format(n,t.name,t.viewModel,this._extension.name))},t.prototype._createExtensionCommandHandler=function(n){var o=this,s=n.content,i=this._lifetimeManager=new ft,r={container:this.container,extension:this._extension,viewModelName:this._commandDefinition.viewModel,commandItem:this,lifetimeManager:i,propertyBindings:null,services:this._services,selectionInList:this._selectionInList},u=new vt(n,r),t,f,e;u.init();r.propertyBindings=u.propertyBindings;t=this._extensionCommand=a.createExtensionCommand(s,n,r);t?(i.registerForDispose([t]),t.init()):this._logError("Error loading command view model. Unknown view model type.");f=function(n){return o.visible(ni(n))};e=this._unauthorizedReactor=n.container.unauthorizedMessage.subscribe(this,f);f(n.container.unauthorizedMessage());i.registerForDispose([u,e])},t.prototype._loadViewModel=function(){
var n=this;this._viewModelLoadedPromise||(this._viewModelLoadedPromise=this._resolveCommandDefinition().then(function(){var t=n._extension,i=n._commandDefinition,r=e.needInternalProperty(t.name,[i.details]);return t.getViewModel(i.viewModel,{createSelectable:!0,createHubsInternalCloudNameProperty:r})}),this._viewModelLoadedPromise.done(function(t){n._createExtensionCommandHandler(t)}).fail(function(t){n.icon(et.Blank());n.text(ct.failedToLoad);n._logError("Error loading command view model. \nReason: {0}".format(t))}))},t}(w);t.ExtensionCommandMenuItemImpl=b;vt=function(){function n(n,t){this._onInputsSetPending=it(!1);this._hasPermissions=it(!0);this._extension=t.extension;this._viewModelName=t.viewModelName;this._composedViewModel=n;this._commandViewModel=n.content;this._commandItem=t.commandItem;this._services=t.services;this._lifetimeManager=t.lifetimeManager;this._initializeInputBindings(t.container,t.commandItem)}return n.prototype.init=function(){var n=this;ko.reactor(this._lifetimeManager,
function(){var t=n._commandViewModel,i=n._commandItem;i.setEnabled(t.enabled()&&n._hasPermissions()&&!n._onInputsSetPending());ko.isObservable(t.icon)&&i.icon(t.icon());ko.isObservable(t.text)&&t.text()!==undefined&&i.text(t.text())})},Object.defineProperty(n.prototype,"propertyBindings",{get:function(){return this._propertyBindings},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this._propertyBindings&&(this._propertyBindings.unbind(),this._propertyBindings=null);this._commandViewModel=null},n.prototype._initializeInputBindings=function(n,t){var i=this,f=t.getInputBindingsFromDefinition(t.commandDefinition),e=p.getVersionFromString(this._extension.manifest.schemaVersion),r={bindableTarget:{viewModelName:n.toString()+"-["+this._viewModelName+"]",viewModel:this._composedViewModel},inputs:f,referenceComposition:n,referenceCompositionIsContainer:!0,customBindHandler:function(n){var i=t.sourceBindableContainer;if(i&&i.viewModel&&n.source.modelType!==ot.Part)return{sourceModelName:
i.viewModelName,sourceModel:i.viewModel}},beforeViewModelPropertyUpdate:function(r){var u=t.commandDefinition,o=i._extension,f,e;return u&&u.permissions?(i._hasPermissions(!1),f=n&&n.locator&&n.locator.toString()+"-",f=(f||"")+u.name,e=g.Deferred(),c.checkPermissions(u.permissions,bt.All,r,u.assetType,o.name,i._services,o.cloudName,f).then(function(n){i._updateForHasPermissions(n);e.resolve(n)}).catch(function(n){e.reject(n)}),e.promise()):(i._updateForHasPermissions(!0),g.Deferred().resolve(!0).promise())}},u;r.inputs&&Array.isArray(r.inputs)&&r.inputs.length>0&&(this._onInputsSetPending(!0),r.inputsSetCalled=function(r,u){i._onInputsSetPending(!0);i._currentOnInputsSetPromise=u;u.then(function(){i._currentOnInputsSetPromise===u&&i._onInputsSetPending(!1)},function(u){nt.error("Command '{0}' on composition '{1}' rejected its onInputsSet promise. \nView Model Name: {2} \nInputs Provided: {3} \nReason: {4}".format(t.commandName,n.toString(),i._viewModelName,ko.toJSON(r),u||"N/A"))})});u=
kt.bindViewModelInputs(r);this._propertyBindings=u.propertyBindings},n.prototype._updateForHasPermissions=function(n){var i=this._composedViewModel,t=i&&i.container;t&&(n?t.unauthorizedMessage(undefined):t.unauthorized());this._hasPermissions(n)},n}();t.createOpenBladeCommand=ui}(p||(p={})),p});define("MsPortalImpl/Interactions/Interactions.KeyboardNavigation",["require","exports","f","../Base/Base.KeyboardHelper"],function(n,t,i,r){"use strict";var u;return function(n){var u=i.Base.EventTypes,e=window,o=jQuery,t,f;(function(n){n[n.TabKeys=2]="TabKeys";n[n.UpDownKeys=4]="UpDownKeys";n[n.LeftRightKeys=8]="LeftRightKeys"})(n.TabTrigger||(n.TabTrigger={}));t=n.TabTrigger;f=function(){function n(n,i){this._element=n;this._tabTriggers=i||t.TabKeys|t.UpDownKeys;this._attachHandlers()}return n.prototype.dispose=function(){this._removeHandlers()},n.prototype._attachHandlers=function(){var n=this;this._element.on(u.keydown,this._keyDownHandler=function(t){n._handleMenuKeyDown(t)})},n.prototype.
_removeHandlers=function(){this._keyDownHandler&&(this._element.off(u.keydown,this._keyDownHandler),this._keyDownHandler=null)},n.prototype._handleMenuKeyDown=function(n){var f=r.getModifierKeys(n),u=!1,e=this._tabTriggers&t.TabKeys,o=this._tabTriggers&t.UpDownKeys,s=this._tabTriggers&t.LeftRightKeys,i=f===0;e&&n.keyCode===9&&i||o&&n.keyCode===40&&i||s&&n.keyCode===39&&i?u=this._moveFocusToItem(1,n.target):(e&&n.keyCode===9&&f===4||o&&n.keyCode===38&&i||s&&n.keyCode===37&&i)&&(u=this._moveFocusToItem(-1,n.target));u&&n.preventDefault()},n.prototype._moveFocusToItem=function(n,t){var i=this._element.find(":tabbable"),r=!1,u;return i.length>0&&(u=i.index(t),u!==-1?(i[(u+n+i.length)%i.length].focus(),r=!0):n===-1?(i.last().focus(),r=!0):n===1&&(i.first().focus(),r=!0)),r},n}();n.KeyboardNavigation=f}(u||(u={})),u});define("MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function e(n){var t=n.currentTarget,
i;t.offsetWidth<t.scrollWidth&&!t.title&&(i=f(t),i.attr("title",i.text()).addClass(u))}function o(n){var t=f(n.currentTarget);t.hasClass(u)&&t.removeAttr("title").removeClass(u)}function s(n){n.on(t.mouseover,r,e).on(t.mouseleave,r,o)}function h(n){n.off(t.mouseover,r,e).off(t.mouseleave,r,o)}var t=i.Base.EventTypes,c=window,f=jQuery,r=".msportalfx-tooltip-overflow,.msportalfx-text-ellipsis",u="fxs-autotooltip";n.register=s;n.unregister=h}(r||(r={})),r});define("_generated/Templates/WidgetsContextMenu",["require","exports"],function(){"use strict";return function(){return'<ul class="fxs-contextMenu-itemList" data-bind="foreach: { data: data.orderedMenuItems().concat(data.orderedMenuItemsCommands()), afterRender: afterRender }"> <li role="menuitem" class="fxs-contextMenu-item fxs-has-hover" data-bind="css: { \'fxs-contextMenu-itemDisabled\': !enabled(), \'fxs-contextMenu-extensioncommand\': !!$data._extension }, attr: { \'aria-disabled\': !enabled()}" tabindex="0"> <div class="fxs-contextMenu-text fxs-text-default msportalfx-text-ellipsis" data-bind="text: text"><\/div> <div class="fxs-contextMenu-icon" data-bind="image: icon"><\/div> <\/li> <\/ul>'}
});define("MsPortalImpl/Widgets/Widgets.ContextMenu",["require","exports","f","../Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.KeyboardNavigation","../Interactions/Interactions.OverflowAutoTooltip","./Widgets.WidgetBase","../../_generated/Templates/WidgetsContextMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return function(t){function y(n,t){return t||ot.error("ContextMenuViewModel."+n+" is not accessible. Please call registerForCleanup first."),t}function ft(n){return!n._extension}function ct(){var n=s.Widget.getWidget(a("."+c),w);n.updateRenderedPositionFromLastShow()}var b=i.Base,et=b.Diagnostics,l=b.EventTypes,k=window,a=jQuery,ot=et.createLog(n),c="fxs-contextMenu",d=c+"-active",v=c+"-item",st=v+"Disabled",g="fxs-popup",nt="role",tt="aria-label",it="tabindex",rt=ko.computed,ut=ko.observable,ht=ko.observableArray,
p=function(n){function t(){n.call(this);this._menuItems=ht();this.visible=ut(!1)}return __extends(t,n),Object.defineProperty(t.prototype,"menuItems",{get:function(){return this._menuItems},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orderedMenuItemsCommands",{get:function(){return y("orderedMenuItemsCommands",this._orderedMenuItemsCommands)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orderedMenuItems",{get:function(){return y("orderedMenuItems",this._orderedMenuItems)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleCommands",{get:function(){return y("hasVisibleCommands",this._hasVisibleCommands)},enumerable:!0,configurable:!0}),t.prototype.registerForCleanup=function(n){var t=this,r=this._menuItems,i=this._lifetimeManager=n.createChildLifetime();this._orderedMenuItemsCommands=r.filter(i,function(n){return n.visible()&&!ft(n)&&!n.hasPopup()});this._orderedMenuItems=r.filter(i,function(n){return n.visible()&&ft(
n)&&n.enabled()});this._hasVisibleCommands=rt(i,function(){return t.orderedMenuItemsCommands().length+t.orderedMenuItems().length>0});i.registerForDispose(function(){t._lifetimeManager=t._orderedMenuItemsCommands=t._orderedMenuItems=t._hasVisibleCommands=null})},t}(s.ViewModel),w;t.ViewModel=p;w=function(n){function t(t,i){var r=this;n.call(this,t,i&&i instanceof p?i:new p);this._validateForDismiss=function(n){var t=r.element[0];return!(t===n)&&!a.contains(t,n)};this._dismissHandle={dismissFn:function(){r.hide()},shouldDismissOnMouseDownFn:this._validateForDismiss,shouldDismissOnMouseWheelFn:this._validateForDismiss,logName:"contextmenu"};this._lastShowArgs=ut(null);this.options.registerForCleanup(this.lifetimeManager);t.html(h()).addClass(c).addClass(g).attr(it,0).attr(nt,"menu").attr(tt,u.ContextMenu.ariaLabel);this._bindDescendants({afterRender:ct});this._initializeHandlers()}return __extends(t,n),t.prototype.dispose=function(){this._dismissHandle&&(f.unregister(this._dismissHandle),
this._dismissHandle=null);this.element.removeAttr(it).removeAttr(nt).removeAttr(tt);this._cleanElement(c,g);n.prototype.dispose.call(this)},t.prototype.hide=function(){this._lastShowArgs(null);this.element.removeClass(d);this.options.visible(!1);f.unregister(this._dismissHandle)},t.prototype.show=function(n,t,i){var o=this,u,e;if(n===void 0&&(n=0),t===void 0&&(t=0),i===void 0&&(i=!1),r.isFullscreen()){this.hide();return}u=document.activeElement;this._dismissHandle.restoreFocus=function(){f.validatePreviousFocusedElement(o._dismissHandle,u)&&u.focus()};this._lastShowArgs({xCoord:n,yCoord:t,forceLeft:i});e=this.element;e.css(this._ensureInViewPort(n,t,i)).addClass(d);this.options.visible(!0);e.focus();f.register(this._dismissHandle,!0)},t.prototype.updateRenderedPositionFromLastShow=function(){var n=this._lastShowArgs();if(n){var t=n.xCoord||0,i=n.yCoord||0,r=n.forceLeft||!1;this.element.css(this._ensureInViewPort(t,i,r))}},t.prototype._initializeHandlers=function(){var t=this,n=this.element,
i=this.lifetimeManager,r=function(n){if(n.stopPropagation(),!a(n.currentTarget).hasClass(st)){t.hide();var i=ko.dataFor(n.target);i.enabled()&&i.execute(!0)}},u,f;n.find("ul").on(l.click,"."+v,r).on(l.keydown,"."+v,function(n){n.which===13&&r(n)});n.on(l.contextmenu,u=function(){return!1});f=new e.KeyboardNavigation(n);o.register(n);rt(i,function(){t._lastShowArgs()&&(t.options.menuItems().forEach(function(n){n.enabled()}),t.updateRenderedPositionFromLastShow())});i.registerForDispose(function(){n.off(l.contextmenu,u);o.unregister(n);f.dispose()})},t.prototype._ensureInViewPort=function(n,t,r){var f=t,u="auto",h=this.element,e=h.outerHeight(),o=h.outerWidth(),s;return this._isRtl()?(u=n-o,(r||u-o<0)&&(u+=o)):(u=n,(r||u+o>k.innerWidth)&&(u-=o)),s=k.innerHeight,f+e>s&&(f-e>=0?f-=e:f=e<s?i.truncate((s-e)/2):0),{top:f,left:u}},t}(s.Widget);t.Widget=w}(c||(c={})),c});define("MsPortalImpl/Widgets/Widgets.UIElementBase",["require","exports","./Widgets.WidgetBase"],function(n,t,i){"use strict";
var r;return function(n){var f=ko.observable,o=ko.observableArray,t="Not implemented in base class.",e,r,u;n.displayStateChangingEventName="displayStateChange";n.displayStateChangedEventName="displayStateChanged",function(n){n[n.Previous=-4]="Previous";n[n.Next=-3]="Next";n[n.First=-2]="First";n[n.Last=-1]="Last"}(n.BladeToFocus||(n.BladeToFocus={}));e=n.BladeToFocus;r=function(n){function i(t){n.call(this);this.locked=f(!0);this.id=t}return __extends(i,n),i.prototype.getViewSettings=function(){throw new Error(t);},i.prototype.applyViewSettings=function(){throw new Error(t);},i}(i.ViewModel);n.ViewModel=r;u=function(n){function i(t,r){if(n.call(this,t,r),!r.id||typeof r.id!="string")throw new Error("An unique identifier is required and it must be a string.");i.attachId(t,r.id)}return __extends(i,n),i.prototype.dispose=function(){i.detachId(this.element);n.prototype.dispose.call(this)},i.attachId=function(n,t){n.data(i._fxsIdKey,t)},i.detachId=function(n){n.removeData(i._fxsIdKey)},i.getId=
function(n){return n.data(i._fxsIdKey)},i.prototype.addChild=function(){throw new Error(t);},i.prototype.insertChild=function(){throw new Error(t);},i.prototype.removeChild=function(){throw new Error(t);},i.prototype.moveChild=function(){throw new Error(t);},i.prototype.saveViewSettings=function(){throw new Error(t);},i.prototype.setSize=function(){throw new Error(t);},i.prototype.discardStateOfUnusedChildren=function(){return{stateDiscarded:!1}},i.viewSettingsChanged="viewSettingsChanged",i.errorEvent="widgetError",i._fxsIdKey="fxsId",i}(i.Widget);n.Widget=u}(r||(r={})),r});define("MsPortalImpl/UI/Compositions/UI.Composition.Base",["require","exports","f","./UI.Composition","../../Widgets/Widgets.UIElementBase","../../Services/Services.Settings","../../Services/Services.Settings.Schema"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function nt(n,t,i){var u=t||[],r=[];return u.forEach(function(t){var u=i[t];u?r.push(u):s.error("Unable to find child element '{0}' for parent composition '{1}' in user settings. It will be removed from the composition tree.".
format(t,n))}),r}function l(n,t,i){return i=i||w.getUniqueId(),"{0}{1}{2}".format(k[n],!t?"":"-"+t.name,"-"+i)}function tt(n,t,r,u){return i.require(t,u).then(function(t){return n.isDisposed()||r(t),t})}var v=FxImpl,y=v.TriggerableLifetimeManager,h=i.Base,p=h.Diagnostics,w=h.Utilities,b=f.SettingStore,k=r.CompositionType,o=jQuery,s=p.createLog(n),d=ko.observable,g=ko.observableArray,c,a;(function(n){n[n.Normal=0]="Normal";n[n.Immediately=1]="Immediately"})(t.SaveKind||(t.SaveKind={}));c=t.SaveKind;t.getChildrenSettings=nt;t.createIdentifier=l;t.compositionRequire=tt;a=function(n){function t(t,r,u,f,e){if(n.call(this),this._childObjects=g(),this._disposeCallbacks=o.Callbacks("memory once"),this._composedDeferred=i.Helpers.Deferred(),!t)throw new Error("CompositionServices are required.");this.services=t;this.locator=r;this.id=e||this.createIdentifier();this.widgetState=d(f||{});this._addChildrenInternal(u)}return __extends(t,n),Object.defineProperty(t.prototype,"children",{get:function(
){return this._childObjects()},enumerable:!0,configurable:!0}),t.prototype.subscribeChildren=function(n){return this._childObjects.subscribe(this,n)},Object.defineProperty(t.prototype,"templateKey",{get:function(){return this.locator?this.locator.toString():this.id},enumerable:!0,configurable:!0}),t.prototype.getPerfData=function(){return{}},t.prototype.getCompositionType=function(){throw new Error("The getCompositionType method is not implemented.");},t.prototype.getCreationState=function(){return this._creationState},t.prototype.toString=function(){return"{ Name: {0}, Type: {1}, Id: {2} }".format(this._name||"<NOT SPECIFIED>",this.locator?this.locator.toString():"<null>",this.id)},t.prototype.compose=function(n){for(var r,i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];r=[n,this._composedDeferred].concat(i);this._compose.apply(this,r)},t.prototype._compose=function(){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];throw new Error("Not implemented.");},t.prototype.resetLayout=
function(){var n=this.children;n&&n.forEach(function(n){n.resetLayout()})},t.prototype._attachWidgetErrorEvent=function(){var r=this,n=this.widget,i,t;if(!n)throw new Error("Cannot attach to error event of undefined widget.");t=u.Widget.errorEvent;o(n).on(t,i=function(n,t){s.error("[Widget Error] {0}\nCurent State: {1}".format(t,ko.toJSON(r.getDiagnosticsData(),null,2)))});this.registerForDispose(function(){o(n).off(t,i)})},t.prototype.isOrganizable=function(){return!0},t.prototype.dispose=function(t){this.isDisposed()||(n.prototype.dispose.call(this),this._disposeCallbacks.fire(),t||this._deleteSetting(),this.children.slice(0).forEach(function(n){n.dispose(t)}))},t.prototype._deleteSetting=function(){var i=this,n,t;this._store!==undefined?this.services.sharedSettings.deleteSettings({store:this._store,keys:[this.id]}):this.parent&&(n=this.parent.children,t=n.first(function(n){return n.id===i.id}),t&&n.remove(t),this.parent.save())},t.prototype.save=function(n){var t=this.services.settings,
i;if(this._store!==undefined){if(t&&(i=this.toJSON(),t.setSetting(this._store,this.id,JSON.parse(JSON.stringify(i))),n===c.Immediately))return t.flushSettings()}else if(this.parent)return this.parent.save(n);return Q()},Object.defineProperty(t.prototype,"isComposed",{get:function(){return this.awaitComposed().state()==="resolved"},enumerable:!0,configurable:!0}),t.prototype.getLoadDelayed=function(){return this._loadDelayed},t.prototype.awaitComposed=function(){return this._composedDeferred.promise()},t.prototype.awaitOnInputsSetComplete=function(){return Q.resolve(null)},t.prototype.awaitContentRevealed=function(){return Q.resolve(!1)},t.prototype.onDispose=function(n){this._disposeCallbacks.add(n)},t.prototype.offDispose=function(n){this._disposeCallbacks.remove(n)},t.prototype.addChild=function(n,t,i){i===void 0&&(i=!0);n&&this.addChildren([n],t,i)},t.prototype.addChildren=function(n,t,i){i===void 0&&(i=!0);this._addChildrenInternal(n,t);i&&this.save()},t.prototype._addChildrenInternal=
function(n,t){var r=this,i;t===void 0&&(t=this.children.length);n&&n.length>0&&(i=this._childObjects(),n.forEach(function(n){i.splice(t,0,n);n.parent=r;t++;r.addChildWidget(n.widget)}),this._childObjects(i))},t.prototype.sortChildren=function(n){this._childObjects(this._childObjects().stableSort(n))},t.prototype.removeChildren=function(n){for(var t=this.children.length-1;t>=0;t--)this.removeChildAt(t,n,!1);this.save()},t.prototype.removeChildAt=function(n,t,i){if(i===void 0&&(i=!0),n>=0){var r=this._childObjects.splice(n,1)[0];this.removeChildWidget(r.id,t);t||r.dispose();i&&this.save()}},t.prototype.replaceChild=function(n,t){var i=this._childObjects,r;n&&t&&i&&(r=i.indexOf(n),r>=0&&(i.splice(r,1,t),t.parent=this,this.save()))},t.prototype.removeChild=function(n,t,i){if(i===void 0&&(i=!0),n&&this._childObjects){var r=this._childObjects.indexOf(n);this.removeChildAt(r,t,i)}},t.prototype.addChildWidget=function(n){this.widget&&n&&this.widget.addChild(n)},t.prototype.removeChildWidget=function(
n,t){this.widget&&this.widget.removeChild(n,t)},t.prototype.getChildById=function(n){return this._childObjects?this._childObjects().first(function(t){return t.id===n}):null},t.prototype.toJSON=function(n){var t={},i=this.children,r=n?i.filter(n):i;return this.id!==e.startBoardSettingsKey&&r.forEach(function(n){t[n.id]=n.toJSON()}),{id:this.id,locator:this.locator,widgetState:this.widgetState(),errorMessage:this.unrecoverableErrorMessage,children:r.map(function(n){return n.id}),childSettings:t}},t.prototype.loadFromJson=function(n){this.unrecoverableErrorMessage=n.errorMessage},t.prototype.getPartsContainer=function(){return this._partsContainer||(this._partsContainer=this._getTopMostContainer("masterContainer")),this._partsContainer},t.prototype.getBindableContainer=function(){return this._bindableContainer||(this._bindableContainer=this._getTopMostContainer("getViewModel")),this._bindableContainer},t.prototype.getTemplate=function(){return{key:this.templateKey,locator:this.locator.toJSON(
),widgetId:this.id,widgetState:ko.toJS(this.widgetState),children:this.children.map(function(n){return n.getTemplate()})}},t.prototype.saveTemplate=function(){var n=this.getTemplate(),t=this.services.sharedSettings;return n.timeStamp=Date.now(),t.setSetting(b.Blade,n.key,n),t.flushSettings(),n},t.prototype.getDiagnosticsData=function(){return o.extend(this.toJSON(),{id:this.id,name:this._name,locator:this.locator&&this.locator.toString(),errorMessage:this.unrecoverableErrorMessage,children:(this.children||[]).map(function(n){return n.getDiagnosticsData()})})},t.prototype.definitionExists=function(n){var t=this.services.finder,i=this.locator;return t.tryLocate(i,{})?0:t.tryLocate(i.getExtensionLocator(),{})&&n?1:2},t.prototype.discardWidgetStateOfUnusedChildren=function(){var n,t;this.widget&&(n=this.widget.discardStateOfUnusedChildren(),n&&n.stateDiscarded&&(t=this.children||[],s.warning("Unused widget state was discarded for composition '{0}'. \n{1} \nCurrent Children: {2}\nCurrent Widget State: {3}".
format(this.toString(),n.message,JSON.stringify(t.map(function(n){return n.toString()})),JSON.stringify(this.widgetState())))))},t.prototype._markAsComposed=function(){this._composedDeferred.resolve()},t.prototype.createIdentifier=function(){return l(this.getCompositionType(),this.locator)},t.prototype._getTopMostContainer=function(n){for(var t=this,i;t;)(t.hasOwnProperty(n)||typeof t[n]=="function")&&(i=t),t=t.parent;return i||s.error("Could not locate container with property or function '{0}' for composition '{1}'.".format(n,this.toString())),i},t}(y);t.Instance=a}(o||(o={})),o});define("MsPortalImpl/Interactions/Interactions.FocusHandler",["require","exports","f"],function(n,t,i){"use strict";var r;return function(t){var e=i.Base,r=e.EventTypes,h=window,f=jQuery,o=e.Diagnostics.createLog(n),u,s=function(){function n(){if(this._focusableTargets=[],u)throw new Error("FocusHandler operates as a singleton.");u=this;this._bodyElement=f("body")[0];this._attachEventHandlers()}return n.prototype.
dispose=function(){this._removeEventHandlers();this._removeAllAutofocusTargets();this._bodyElement=null;u=null},Object.defineProperty(n,"Instance",{get:function(){return u||(u=new n),u},enumerable:!0,configurable:!0}),n.prototype.registerContainerForFocus=function(n){n&&(this._removeAllAutofocusTargets(),this._containerTarget=n)},n.prototype.registerTargetForFocus=function(n){this._containerTarget&&n&&f.contains(this._containerTarget,n)&&this._focusableTargets.push(n)},n.prototype.notifyTargetReadyForFocus=function(t){var r,i;try{r=u._focusableTargets.indexOf(t);r>-1&&(this._focusableTargets.splice(r,1),this._focusableTargets.length===0&&(i=this._containerTarget,setTimeout(function(){var t=f(i).findFirstTabbable(function(n){return n.isInScrollView("fxs-blade-content")}),r;o.debug("Container to focus:"+i.innerHTML);t.hasClass("fxs-part")&&(r=t.findFirstTabbable(),r.length===1&&(t=r));t.focus();n.Instance.raiseReadyForFocusEvent(i)},125),n.Instance._removeAllAutofocusTargets()))}catch(e)
{}},n.prototype.raiseReadyForFocusEvent=function(n){var t=document.createEvent("CustomEvent");t.initCustomEvent(r.fxreadyforfocus,!1,!1,null);n.dispatchEvent(t)},n.prototype._attachEventHandlers=function(){var n=this._bodyElement,t=this._cancelAutofocusListener;n.addEventListener(r.mousedown,t,!0);n.addEventListener(r.keydown,t,!0);n.addEventListener(r.touchstart,t,!0);n.addEventListener(r.pointerdown,t,!0);n.addEventListener(r.mousewheel,t,!0)},n.prototype._removeEventHandlers=function(){var n=this._bodyElement,t=this._cancelAutofocusListener;n.removeEventListener(r.mousedown,t,!0);n.removeEventListener(r.keydown,t,!0);n.removeEventListener(r.touchstart,t,!0);n.removeEventListener(r.pointerdown,t,!0);n.removeEventListener(r.mousewheel,t,!0)},n.prototype._removeAllAutofocusTargets=function(){this._containerTarget=null;this._focusableTargets=[]},n.prototype._cancelAutofocusListener=function(){n.Instance._removeAllAutofocusTargets()},n}();t.FocusHandler=s}(r||(r={})),r});define("_generated/Templates/PartError",
["require","exports"],function(){"use strict";return function(){return"<div class='fxs-part-error-content'> <div class='fxs-part-error-text'> <div class='fxs-part-error-title' data-bind='visible: data.title, text: data.title'><\/div> <div class='fxs-part-error-subtitle fxs-text-title' data-bind='visible: data.subtitle, text: data.subtitle'><\/div> <\/div> <img class='fxs-part-error-icon' data-bind='attr: { src: data.uri.icon, title: data.title, alt: data.title}'/> <div class='fxs-part-error-reason' data-bind=\"text: data.reason\"><\/div> <\/div> "}});define("_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-part-error-content .fxs-part-error-reason,.fxs-part-error-content .fxs-part-error-title{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;line-height:normal}.fxs-portal .fxs-tile .fxs-part-error-devmode{background-color:#b00000!important;color:#fff}.fxs-part-error{background-color:#f4f5f6}.fxs-part .fxs-part-content.fxs-errorpart-clickable{cursor:pointer}.fxs-part-error-content{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;height:100%;box-sizing:border-box}.fxs-part-error-content .fxs-part-error-title{font-size:14px}.fxs-part-error-content .fxs-part-error-reason{font-size:12px}.fxs-part-error-icon{-webkit-flex:0 0 auto;flex:0 0 auto;margin:auto;display:block;height:50px;width:50px}.fxs-part-error-subtitle{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;line-height:normal;text-transform:uppercase}.fxs-tilesize-fullwidthfitheight .fxs-part .fxs-part-content.fxs-errorpart,.fxs-tilesize-herowidefitheight .fxs-part .fxs-part-content.fxs-errorpart{position:relative}.fxs-tilesize-fullwidthfitheight .fxs-part-error-content,.fxs-tilesize-herowidefitheight .fxs-part-error-content{position:static}.fxs-tilesize-mini .fxs-part-error-icon,.fxs-tilesize-small .fxs-part-error-icon{display:none}.fxs-tilesize-mini .fxs-part-error-text{order:1}.fxs-tilesize-mini .fxs-part-error-reason,.fxs-tilesize-mini .fxs-part-error-text{text-align:center}.fxs-tilesize-small .fxs-part-error-reason{margin-top:auto}html[lang^=ja] .fxs-part-error-subtitle,html[lang^=ko] .fxs-part-error-subtitle,html[lang^=zh] .fxs-part-error-subtitle{font-size:11px}')}
);define("MsPortalImpl/Widgets/Widgets.PartError",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","./Widgets.WidgetBase","../../_generated/Templates/PartError","../../_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css"],function(n,t,i,r,u,f){"use strict";var e;return function(t){var h=i.Base,a=h.Diagnostics,e=h.EventTypes,v=MsPortalImpl.Resources.Images,y=window,b=jQuery,c="fxs-errorpart",p="fxs-errorpart-clickable",k=a.createLog(n),o=r.PartError,s=ko.observable,w=function(n){function t(){n.apply(this,arguments);this.uri=v.getPartError();this.title=s(y.fx.environment.isDevelopmentMode?o.titleDevMode:o.title);this.subtitle=s(o.subtitle);this.reason=s("");this.clickable=!0}return __extends(t,n),t}(u.ViewModel),l;t.ViewModel=w;l=function(n){function t(t,i){if(n.call(this,t,i),t.html(f()).addClass(c),i.clickable){var r=function(){t.trigger(e.fxerrorpartclicked)};t.addClass(p).on(e.click,r);this.lifetimeManager.registerForDispose(function(){t.off(e.click,r)})}this.
_bindDescendants()}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(c);n.prototype.dispose.call(this)},t}(u.Widget);t.Widget=l}(e||(e={})),e});define("_generated/Templates/Part",["require","exports"],function(){"use strict";return function(){return'<header class="fxs-part-title"> <h4 data-bind="text: container.partTitle" class="msportalfx-tooltip-overflow"><\/h4> <h5 data-bind="visible: !context.inContainerOfSameAsset(), text: container.assetName" class="msportalfx-tooltip-overflow"><\/h5> <\/header> <section class="fxs-part-content"><\/section> <!-- ko if: context.isUiBlocked --> <div class="fxs-part-blockui-shield" data-bind="visible: !context.spinnerBehaviorNone()"><\/div> <!-- ko if: !context.notFoundMessage() --> <div class="fxs-part-nodatamessage" data-bind="visible: container.noDataMessage"> <!--The extra nested div is to enable vertical centering--> <div data-bind="text: container.noDataMessage" class="fxs-part-nodatamessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <\/div> <div class="fxs-part fxs-part-noaccessmessage" data-bind="visible: container.unauthorizedMessage, css: { \'fxs-part-noaccessmessage-withtitle\': container.partTitle }"> <!--The extra nested div is to enable vertical centering--> <header class="fxs-part-title" data-bind="visible: container.partTitle"> <h4 data-bind="text: container.partTitle" class="msportalfx-tooltip-overflow"><\/h4> <h5 data-bind="visible: !context.inContainerOfSameAsset(), text: container.assetName" class="msportalfx-tooltip-overflow"><\/h5> <\/header> <div data-bind="text: container.unauthorizedMessage" class="fxs-part-noaccessmessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <div data-bind="text: container.unauthorizedMessage" class="fxs-part-noaccessmessage-textsmall msportalfx-tooltip-overflow"><\/div> <\/div> <!-- /ko --> <!-- ko if: context.notFoundMessage --> <div class="fxs-part-notfoundmessage"> <!--The extra nested div is to enable vertical centering--> <div data-bind="text: context.notFoundMessage" class="fxs-part-notfoundmessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <\/div> <!-- /ko --> <!-- /ko --> <svg class="fxs-part-svg" focusable="false"> <rect class="fxs-part-svg-rect" x="0" y="0" width="100%" height="100%"/> <\/svg> '}
});define("_generated/Less/MsPortalImpl/Parts/Parts.Part.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-part,.fxs-part .fxs-part-svg{height:100%;overflow:hidden;width:100%}.fxs-part{position:relative;box-sizing:border-box;padding:15px}.fxs-part.fxs-part-clickable:hover{cursor:pointer}.fxs-part.fxs-part-clickable:focus .fxs-part-svg .fxs-part-svg-rect,.fxs-part.fxs-part-clickable:hover .fxs-part-svg .fxs-part-svg-rect{stroke-opacity:1}.fxs-part .fxs-part-svg{position:absolute;left:0;top:0;pointer-events:none;fill-opacity:0}.fxs-part .fxs-part-svg .fxs-part-svg-rect{stroke-width:4px;stroke-opacity:0;transition-property:stroke-opacity;transition-duration:.15s;transition-timing-function:ease-in-out}.fxs-part .fxs-part-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.fxs-part .fxs-part-title{display:none;height:49px;position:relative;top:-4px}.fxs-part .fxs-part-title h4,.fxs-part .fxs-part-title h5{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part .fxs-part-title h4{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:14px;line-height:17px;padding-bottom:1px}.fxs-part .fxs-part-title h5{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase;margin-top:3px}.fxs-part .fxs-part-content,.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px}.fxs-part .fxs-part-content{line-height:18px;line-height:normal;position:relative;width:100%;height:100%;box-sizing:border-box}.fxs-part.fxs-part-part-title-visible .fxs-part-title{display:block}.fxs-part.fxs-part-part-title-visible .fxs-part-content{height:calc(100% - 45px);top:-4px}.fxs-part .fxs-part-color-white{color:#fff}.fxs-part.fxs-part-selected .fxs-part-svg .fxs-part-svg-rect,.fxs-part.fxs-part-selected-command .fxs-part-svg .fxs-part-svg-rect{stroke-width:6px;stroke-opacity:1}.fxs-tile-selected .fxs-part .fxs-part-svg .fxs-part-svg-rect,.fxs-tile-selectedfromhover .fxs-part .fxs-part-svg .fxs-part-svg-rect{stroke-width:4px;stroke-opacity:1}.fxs-part.fxs-part-nodata,.fxs-part.fxs-part-notfound{-webkit-filter:grayscale(100%);filter:grayscale(100%);min-height:85px}.fxs-part .fxs-part-noaccessmessage,.fxs-part .fxs-part-nodatamessage,.fxs-part .fxs-part-notfoundmessage{position:absolute;left:0;top:0;height:100%;width:100%;text-align:left;padding:15px;box-sizing:border-box;z-index:1}.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text,.fxs-part .fxs-part-nodatamessage>.fxs-part-nodatamessage-text,.fxs-part .fxs-part-notfoundmessage>.fxs-part-notfoundmessage-text{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);margin-top:20px;padding:15px 10px;width:calc(100% - 30px);box-sizing:border-box;font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;line-height:18px;text-align:center;border-width:1px;border-style:solid}.fxs-tile.fxs-tilesize-mini .fxs-part,.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage{padding-left:3px;padding-right:3px}.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{display:none;position:absolute;bottom:0;margin-bottom:13px;line-height:18px;text-align:left}.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text,.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text{display:none}.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall,.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{display:block;bottom:0}.fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-text{display:none}.fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{display:block}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall,.fxs-tile.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{margin-bottom:7px}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{top:0;bottom:auto;width:calc(94%);text-align:center}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-title{display:none!important}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-content{height:100%!important;top:0!important}.fxs-blade .fxs-blade-locked .fxs-part{padding:0 0 15px}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title{height:29px;top:0}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-svg,.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title h5{display:none}.fxs-blade .fxs-blade-locked .fxs-tilesize-fittocontainer .fxs-part{padding:0}.fxs-part-content{background-color:inherit}html[lang^=ja] .fxs-part .fxs-part-title,html[lang^=ko] .fxs-part .fxs-part-title,html[lang^=zh] .fxs-part .fxs-part-title{top:-5px}html[lang^=ja] .fxs-part .fxs-part-title h3,html[lang^=ko] .fxs-part .fxs-part-title h3,html[lang^=zh] .fxs-part .fxs-part-title h3{font-size:11px;line-height:11px}')}
);define("_generated/Less/MsPortalImpl/CustomPart.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.msportalfx-font-regular,.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child,.msportalfx-text-header{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-layoutChildren-horizontal-inlineblock{white-space:nowrap;line-height:0;font-size:0}.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child{display:inline-block;box-sizing:border-box;white-space:normal;font-size:12px;line-height:18px;line-height:normal}.msportalfx-clearfix::after,.msportalfx-layoutChildren-horizontal-float::after{content:"\\0000a0";clear:both;visibility:hidden;font-size:0;line-height:0}.msportalfx-layoutChildren-horizontal-float>.msportalfx-layoutChildren-child{float:left;box-sizing:border-box}.msportalfx-layoutChildren-horizontal-float::after{display:block;height:0}.msportalfx-bgcolor-themeMain{background-color:#00bcf2}.msportalfx-bgcolor-themeWarning{background-color:#ff8c00}.msportalfx-bgcolor-themeError{background-color:#e81123}.msportalfx-bgcolor-themeSuccess{background-color:#7fba00}.msportalfx-bgcolor-paletteDiffAdd{background-color:#c7f1c7}.msportalfx-bgcolor-paletteDiffDel{background-color:#fcd6f1}.msportalfx-bgcolor-white{background-color:#fff}.msportalfx-vertical-center{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-align-items:center;align-items:center}.msportalfx-removeTableBorders{border-spacing:0;border-collapse:collapse}.msportalfx-boxsizing-borderbox{box-sizing:border-box}.msportalfx-removeDefaultListStyle{list-style-type:none;padding:0;margin:0}.msportalfx-removeDefaultListStyle>li{margin:0;padding:0}.msportalfx-fill{height:100%;width:100%}.msportalfx-clearfix::after{display:block;height:0}.azc-graph-node-container .msportalfx-overflowY,.fxs-tilesize-fittocontainer .msportalfx-overflowY{overflow-x:hidden;overflow-y:auto}.msportalfx-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-removepartpadding{height:calc(100% + 15px + 15px);width:calc(100% + 15px + 15px);margin:-15px}.msportalfx-removepartpaddingside{width:calc(100% + 15px + 15px);margin:0 -15px}.fxs-blade-locked .msportalfx-removepartpadding{height:calc(100% + 15px);width:100%;margin:0 0 15px}.fxs-blade-locked .msportalfx-removepartpaddingside{width:100%;margin:0}.fxs-blade-locked .fxs-tilesize-fittocontainer .msportalfx-removepartpadding{height:100%;width:100%;margin:0}.msportalfx-partdivider:after{content:"";display:block;width:calc(100% + 15px + 15px);margin:0 -15px;border-bottom-width:1px;border-bottom-style:solid}.msportalfx-text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-font-bold{font-family:az_ea_font,wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-font-semibold{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-font-light{font-family:az_ea_font,wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-font-semilight{font-family:az_ea_font,wf_segoe-ui_semilight,"Segoe UI Light","Segoe WP Light","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-code,.msportalfx-font-monospace{font-family:Consolas,"Courier New",monospace}.msportalfx-font-monospace{font-size:12px}.msportalfx-text-header{font-size:14px;line-height:17px}.msportalfx-text-header-small,.msportalfx-text-label,.msportalfx-text-small{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;line-height:normal}a.msportalfx-text-header{cursor:pointer}.msportalfx-text-header-small,.msportalfx-text-label{text-transform:uppercase}.msportalfx-text-subheader{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase}.msportalfx-text-header-regular,.msportalfx-text-regular{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}html[lang^=ja] .msportalfx-text-subheader,html[lang^=ko] .msportalfx-text-subheader,html[lang^=zh] .msportalfx-text-subheader{font-size:11px;line-height:11px}.msportalfx-text-header-regular{font-size:14px;line-height:17px}.msportalfx-text-regular{font-size:12px;line-height:18px}.msportalfx-text-preview{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:11px;line-height:11px;text-transform:uppercase;color:#fff}.msportalfx-text-createsectionheader{font-family:az_ea_font,wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:20px;line-height:normal}.msportalfx-number-jumbo,.msportalfx-number-large,.msportalfx-number-medium,.msportalfx-number-small{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-number-jumbo{font-size:60px;line-height:60px;letter-spacing:-.02em}.msportalfx-number-large{font-size:43px;line-height:43px;letter-spacing:-.02em}.msportalfx-number-medium{font-size:30px;line-height:30px;letter-spacing:-.025em}.msportalfx-number-small{font-size:17px;line-height:17px;letter-spacing:-.02em}.msportalfx-number-jumbo-adorn,.msportalfx-number-large-adorn,.msportalfx-number-medium-adorn,.msportalfx-number-small-adorn{font-family:az_ea_font,wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-number-jumbo-adorn{font-size:20px;line-height:20px;letter-spacing:-.02em}.msportalfx-number-large-adorn,.msportalfx-number-medium-adorn{font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-small-adorn{font-size:10px;line-height:10px;letter-spacing:-.05em}.msportalfx-code{font-size:12px;background-color:#f1f1f8;color:#32383f;border:1px solid #dcdfe2;border-left:5px solid #dcdfe2;padding:10px 10px 10px 15px;margin:5px 0;overflow-x:auto}.msportalfx-customtopo-text-description-donotuse,.msportalfx-customtopo-text-name-donotuse{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;line-height:normal}.msportalfx-lineheight-reset{line-height:normal}.msportalfx-gettingstarted-part{color:#fff}.msportalfx-gridcolumn-asseticon img,.msportalfx-gridcolumn-asseticon svg{margin-top:4px;height:21px;width:21px}.msportalfx-gridcolumn-assetsvg-icon .fx-grid-formatters-svgicon{width:21px!important;height:21px!important}.msportalfx-gridcolumn-assetsvg-badge,.msportalfx-gridcolumn-assetsvg-icon img,.msportalfx-gridcolumn-assetsvg-icon svg{height:21px;width:21px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-badge{margin-left:-21px;display:inline-block}.msportalfx-gridcolumn-assetsvg-badge img,.msportalfx-gridcolumn-assetsvg-badge svg{height:10px;width:10px;margin-top:11px}.msportalfx-gridcolumn-assetsvg-text{margin-left:10px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-textbox{vertical-align:middle;display:inline-block;margin-left:20px}.msportalfx-gridcolumn-assetsvg-strongtext{vertical-align:middle;margin-left:0}.msportalfx-gridcolumn-assetsvg-linkicon{margin-left:10px;display:inline-block;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon{display:inline-block}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon img,.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon svg{opacity:.4;height:10px;width:10px;vertical-align:middle}.msportalfx-gridcolumn-statusicon{text-align:center}.msportalfx-gridcolumn-statusicon img,.msportalfx-gridcolumn-statusicon svg{text-align:center;height:15px;width:15px}.msportalfx-gridcolumn-statusicon svg{margin-top:4px}.msportalfx-grid-borderless .azc-grid table tbody tr td,.msportalfx-grid-borderless .azc-grid table tbody tr[role=row]:first-of-type td,.msportalfx-grid-borderless .azc-grid table tbody:last-child tr:last-child td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-br-muted{border-top-width:0;border-bottom-width:0;border-color:transparent!important}.msportalfx-customtopo-text-name-donotuse{font-size:12px}.msportalfx-customtopo-text-description-donotuse{font-size:10px;color:#8f9ca8}.msportalfx-inherit-color{color:inherit!important}.msportalfx-statuspart{position:relative;height:100%;width:100%}.msportalfx-statuspart>*{box-sizing:border-box}.msportalfx-statuspart .msportalfx-statuspart-statussection{height:calc(100% - 55px);padding-top:10px}.msportalfx-statuspart .msportalfx-statuspart-statussection>*{vertical-align:middle}.msportalfx-statuspart .msportalfx-statuspart-statussection>img{height:30px;width:30px}.msportalfx-statuspart .msportalfx-statuspart-statussection>span{font-family:az_ea_font,wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:11px;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-messagesection{position:absolute;bottom:55px;margin-bottom:25px;height:40px;line-height:0;white-space:normal}.msportalfx-statuspart .msportalfx-statuspart-messagesection>span,.msportalfx-statuspart .msportalfx-statuspart-propertysection{line-height:18px;font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px}.msportalfx-statuspart .msportalfx-statuspart-metricsection,.msportalfx-statuspart .msportalfx-statuspart-propertysection{position:absolute;bottom:0;width:100%;height:55px}.msportalfx-statuspart .msportalfx-statuspart-propertysection{padding-top:5px}.msportalfx-statuspart .msportalfx-statuspart-propertysection>div,.msportalfx-statuspart .msportalfx-statuspart-propertysection>span{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div{float:left;width:calc(100% / 3 - 3px);box-sizing:border-box;border-right:1px solid #8f9ca8;padding-left:7px}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:first-child{padding-left:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:last-child{border-right:none}.msportalfx-statuspart .msportalfx-statuspart-metricsection .msportalfx-statuspart-metrictitle{white-space:normal;height:30px;font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;line-height:normal;text-transform:uppercase}.msportalfx-bgcolor-a1{background-color:#fcd116;color:#000}.msportalfx-bgcolor-b1{background-color:#eb3c00;color:#fff}.msportalfx-bgcolor-c1{background-color:#ba141a;color:#fff}.msportalfx-bgcolor-d1{background-color:#b4009e;color:#fff}.msportalfx-bgcolor-e1{background-color:#442359;color:#fff}.msportalfx-bgcolor-f1{background-color:#002050;color:#fff}.msportalfx-bgcolor-g1{background-color:#0072c6;color:#fff}.msportalfx-bgcolor-h1{background-color:#008272;color:#fff}.msportalfx-bgcolor-i1{background-color:#007233;color:#fff}.msportalfx-bgcolor-j1{background-color:#7fba00;color:#fff}.msportalfx-bgcolor-k1{background-color:#a0a5a8;color:#fff}.msportalfx-bgcolor-a0{background-color:#fff100;color:#000}.msportalfx-bgcolor-b0{background-color:#ff8c00;color:#fff}.msportalfx-bgcolor-c0{background-color:#e81123;color:#fff}.msportalfx-bgcolor-d0{background-color:#ec008c;color:#fff}.msportalfx-bgcolor-e0{background-color:#68217a;color:#fff}.msportalfx-bgcolor-f0{background-color:#00188f;color:#fff}.msportalfx-bgcolor-g0{background-color:#00bcf2;color:#fff}.msportalfx-bgcolor-h0{background-color:#00b294;color:#fff}.msportalfx-bgcolor-i0{background-color:#009e49;color:#fff}.msportalfx-bgcolor-j0{background-color:#bad80a;color:#000}.msportalfx-bgcolor-k0{background-color:#bbc2ca;color:#000}.msportalfx-bgcolor-a2{background-color:#fffc9e;color:#000}.msportalfx-bgcolor-b2{background-color:#ffb900;color:#000}.msportalfx-bgcolor-c2{background-color:#dd5900;color:#fff}.msportalfx-bgcolor-d2{background-color:#f472d0;color:#fff}.msportalfx-bgcolor-e2{background-color:#9b4f96;color:#fff}.msportalfx-bgcolor-f2{background-color:#4668c5;color:#fff}.msportalfx-bgcolor-g2{background-color:#6dc2e9;color:#000}.msportalfx-bgcolor-h2{background-color:#00d8cc;color:#000}.msportalfx-bgcolor-i2{background-color:#55d455;color:#000}.msportalfx-bgcolor-j2{background-color:#e2e584;color:#000}.msportalfx-bgcolor-k2{background-color:#d6d7d8;color:#000}.msportalfx-bgcolor-a0s2{background-color:#807900;color:#fff}.msportalfx-bgcolor-b0s2{background-color:#804600;color:#fff}.msportalfx-bgcolor-c0s2{background-color:#740912;color:#fff}.msportalfx-bgcolor-d0s2{background-color:#760046;color:#fff}.msportalfx-bgcolor-e0s2{background-color:#34113d;color:#fff}.msportalfx-bgcolor-f0s2{background-color:#000c48;color:#fff}.msportalfx-bgcolor-g0s2{background-color:#005e79;color:#fff}.msportalfx-bgcolor-h0s2{background-color:#084c41;color:#fff}.msportalfx-bgcolor-i0s2{background-color:#063d20;color:#fff}.msportalfx-bgcolor-j0s2{background-color:#3d460a;color:#fff}.msportalfx-bgcolor-k0s2{background-color:#32383f;color:#fff}.msportalfx-bgcolor-a0s1{background-color:#bfb500;color:#000}.msportalfx-bgcolor-b0s1{background-color:#bf6900;color:#fff}.msportalfx-bgcolor-c0s1{background-color:#ae0d1a;color:#fff}.msportalfx-bgcolor-d0s1{background-color:#b10069;color:#fff}.msportalfx-bgcolor-e0s1{background-color:#4e195c;color:#fff}.msportalfx-bgcolor-f0s1{background-color:#00126b;color:#fff}.msportalfx-bgcolor-g0s1{background-color:#008db5;color:#fff}.msportalfx-bgcolor-h0s1{background-color:#00856f;color:#fff}.msportalfx-bgcolor-i0s1{background-color:#0f5b2f;color:#fff}.msportalfx-bgcolor-j0s1{background-color:#8ba208;color:#fff}.msportalfx-bgcolor-k0s1{background-color:#464f59;color:#fff}.msportalfx-bgcolor-a0t1{background-color:#fcf37e;color:#000}.msportalfx-bgcolor-b0t1{background-color:#ffba66;color:#000}.msportalfx-bgcolor-c0t1{background-color:#f1707b;color:#fff}.msportalfx-bgcolor-d0t1{background-color:#f466ba;color:#fff}.msportalfx-bgcolor-e0t1{background-color:#a47aaf;color:#fff}.msportalfx-bgcolor-f0t1{background-color:#6674bc;color:#fff}.msportalfx-bgcolor-g0t1{background-color:#66d7f7;color:#000}.msportalfx-bgcolor-h0t1{background-color:#66d1bf;color:#000}.msportalfx-bgcolor-i0t1{background-color:#66c592;color:#000}.msportalfx-bgcolor-j0t1{background-color:#d6e86c;color:#000}.msportalfx-bgcolor-k0t1{background-color:#8f9ca8;color:#fff}.msportalfx-bgcolor-a0t2{background-color:#fffccc;color:#000}.msportalfx-bgcolor-b0t2{background-color:#ffe8cc;color:#000}.msportalfx-bgcolor-c0t2{background-color:#facfd3;color:#000}.msportalfx-bgcolor-d0t2{background-color:#fbcce8;color:#000}.msportalfx-bgcolor-e0t2{background-color:#e1d3e4;color:#000}.msportalfx-bgcolor-f0t2{background-color:#ccd1e9;color:#000}.msportalfx-bgcolor-g0t2{background-color:#ccf2fc;color:#000}.msportalfx-bgcolor-h0t2{background-color:#ccf0ea;color:#000}.msportalfx-bgcolor-i0t2{background-color:#ccecdb;color:#000}.msportalfx-bgcolor-j0t2{background-color:#f0f7b2;color:#000}.msportalfx-bgcolor-k0t2{background-color:#63707e;color:#fff}')}
);define("_generated/Less/MsPortalImpl/CustomForm.css",["require","exports","module"],function(n,t,i){"use strict";window.fx.injectCss(i,'.msportalfx-form .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .msportalfx-form-labelcontainer label{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:12px;line-height:normal}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-elementContainer{display:inline-block;vertical-align:middle;width:66%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:80px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-labelcontainer{width:32%;display:inline-block}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular .msportalfx-form-extralabel{display:block;width:66%;margin-top:-20px;margin-left:33%;margin-right:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:nth-child(odd),.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:nth-child(odd){margin-right:1%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement{min-height:43px;width:48.75%!important;display:inline-block;vertical-align:top;margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:last-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:last-child{margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-optionsGroupField{height:auto;margin-right:1px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:100px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-labelcontainer{display:block;margin-bottom:0;width:auto;min-height:20px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-elementContainer{display:block;width:100%;margin-left:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-extralabel>.msportalfx-form-extralabel{display:inline-block;width:47.75%;margin:43px 1% 0 -49.75%!important}.msportalfx-form.msportalfx-form-custom .msportalfx-form-extralabel{margin-top:0}.fxs-bladestyle-create .msportalfx-form{margin-top:14px}.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement{padding-bottom:15px;width:100%;min-height:23px}.msportalfx-form:not(.msportalfx-form-custom) .fxc-has-sublabel:not(.fxc-right-sublabel),.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement .msportalfx-form-formelement{padding-bottom:0}.msportalfx-form.msportalfx-vertical-compact .fxc-section>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>div>.msportalfx-form-formelement{padding-bottom:7px}.msportalfx-form .azc-checkBoxField-inlineLabelContainer,.msportalfx-form .azc-form-labelcontainer,.msportalfx-form .msportalfx-form-labelcontainer{box-sizing:border-box;min-height:20px}.msportalfx-form .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .msportalfx-form-labelcontainer label{max-width:calc(100% - 25px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px)}.msportalfx-form .azc-validatableControl-invalid+.azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px - 6px)}.msportalfx-form .msportalfx-form-extralabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;margin-top:-15px;padding-bottom:3px}.msportalfx-form.msportalfx-form-row{padding:0 25px;width:calc(100% - 50px)}.msportalfx-form .azc-multiLineTextField .azc-multiLineTextBox{height:100%}.msportalfx-form .azc-creatorAndSelectorField{height:90px!important;padding:0!important;margin-bottom:0!important}.msportalfx-form .azc-selectorField{height:61px!important;padding:0!important}.msportalfx-form .azc-creatorAndSelectorField .fxc-selector,.msportalfx-form .azc-selectorField .fxc-selector{box-sizing:border-box}.msportalfx-form .azc-creatorAndSelectorField+.msportalfx-form-formelement,.msportalfx-form .azc-selectorField+.msportalfx-form-formelement{margin-top:15px}.msportalfx-form .azc-creatorAndSelectorField+.azc-creatorAndSelectorField,.msportalfx-form .azc-creatorAndSelectorField+.azc-selectorField,.msportalfx-form .azc-selectorField+.azc-creatorAndSelectorField,.msportalfx-form .azc-selectorField+.azc-selectorField{margin-top:0}.msportalfx-form .azc-creatorAndSelectorField+.azc-creatorAndSelectorField .fxc-selector,.msportalfx-form .azc-creatorAndSelectorField+.azc-selectorField .fxc-selector,.msportalfx-form .azc-selectorField+.azc-creatorAndSelectorField .fxc-selector,.msportalfx-form .azc-selectorField+.azc-selectorField .fxc-selector{border-top-width:0}.msportalfx-form .msportalfx-form-fileUploadField{height:80px}.msportalfx-form .msportalfx-form-fileUploadField .azc-fileUpload{padding-right:0}.msportalfx-form .msportalfx-form-fileUploadField .azc-fileUpload .azc-fileUpload-wrapper .azc-fileUpload-selectedFile{width:calc(100% - 35px)}.msportalfx-form .msportalfx-form-fileUploadField .fxc-fileUpload-uploadTasks .fxc-fileUpload-uploadTask{width:100%}.msportalfx-form .msportalfx-form-formelement.azc-checkBoxField-inlineLabel .azc-checkBox{vertical-align:top;margin-top:2px}.azc-text-sublabel{float:right;margin-bottom:-1px}.azc-formElementSubLabelContainer::after{content:"";display:table;clear:both}.fxc-left-label .azc-text-sublabel-neighbor{padding-bottom:16px}.fxc-left-label .azc-text-sublabel-neighbor.azc-form-labelcontainer{padding-bottom:calc(19px)}.fxc-left-label .azc-text-sublabel-neighbor.azc-checkBoxField-inlineLabelContainer{padding-bottom:0}.azc-required-balloon{display:inline-block}')}
);define("MsPortalImpl/Parts/Parts",["require","exports","f","i","../Base/Base.CssSanitizer","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.FocusHandler","../Base/Base.Selectable2","../Base/Telemetry","../UI/Compositions/UI.Composition.PropertyBinding","../Widgets/Widgets.Common","../Widgets/Widgets.PartError","../../_generated/Templates/Part","../Base/Base.Selectable2.ClickContext","../UI/UI.DesktopManager","../../_generated/Less/MsPortalImpl/Parts/Parts.Part.css","../../_generated/Less/MsPortalImpl/CustomPart.css","../../_generated/Less/MsPortalImpl/CustomForm.css"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return function(t){function hi(n,t){if(ft[n])throw new Error("The part kind '{0}' has already been registered and cannot be registered again.".format(n));ft[n]=t}function bt(n){return ft[n]}function kt(n){var t=n&&n.initialSize;return lt[t]!==undefined?t:lt.Normal}function dt(n,t,i){t.addClass(u.getScopeName(i.extensionName)).addClass(u.getScopeName(
i.uniqueName));gt(n,i)}function gt(n,t,i){var r=t.uniqueName,o=t.styleSheets||[],f,e;ht[r]||(ht[r]=!0,f=o.map(function(n){var f="."+u.getScopeName(r),t=[],e=i?n.content:u.sanitizeStyleSheetText(n.content,f,t);return t.forEach(function(t){var i="Sanitization error found in style sheet in extension: {0}\n{1} - {2}\nCSS rule: {3}".format(r,n.file,t.errorMessage,t.rule.cssText);g.warning(i,1)}),e}),e=f.map(function(i){var r=n.createElement("style");return r.type="text/css",r.textContent=i,r.setAttribute("data-extensionname",t.extensionName),r}),y(e).appendTo(n.head))}function ci(n,i,r){var f=i.partKind,u,e;if(f===ut.Custom){var l=i.htmlTemplateInline,a=i.htmlTemplate,o=l||r[a],s={supportedSizes:i.supportedSizes},h=o&&o.content,c=i.options;c&&c.useFrame&&(u=t.createAmdPartFactory("MsPortalImpl/Parts/Parts.CustomControlsPart",function(n,t,i,r,u){var f=new n.CustomPart(t,i,r,u);return f.template=h,f},s));u||(u=t.createPartFactory(h,s))}else u=f===ut.Frame?t.createAmdPartFactory("MsPortalImpl/Parts/Parts.Frame",
function(n,t,i,r,u){return new n.Part(t,i,r,u)},{supportedSizes:i.supportedSizes}):bt(ut[f]);return e=u.supportedSizes,e&&e.length||(u.supportedSizes=[kt(i)]),u}function li(n,t,r){return{createPart:function(r,u,f,e){return i.require(n).then(function(n){return t(n,r,u,f,e)})},defaultSize:r.defaultSize,supportedSizes:r.supportedSizes,viewStateProperties:r.viewStateProperties,moduleId:n}}function ai(n,t){return t=y.extend({defaultSize:undefined,supportedSizes:undefined,viewStateProperties:undefined,partClass:undefined},t),{createPart:function(r,u,f,e){var s=t.partClass||st,o=new s(r,u,f,e);return o.template=n,i.Helpers.Deferred().resolve(o).promise()},defaultSize:t.defaultSize,supportedSizes:t.supportedSizes,viewStateProperties:t.viewStateProperties}}var ni=r.TriggerableLifetimeManager,it=i.Base,ct=it.Diagnostics,ti=ct.Telemetry,p=it.EventTypes,ii=it.Utilities,rt=i.Parts,lt=rt.PartSize,at=i.ViewModels,ri=h.PropertyBinding,w=at.ContentState,ut=rt.PartKind,k=rt.PartState,d=window,ui=d.fx.environment,
fi="To enable tracing, load portal with query string: '?trace=inputsset.log.<VIEWMODELNAME>' or '?trace=inputsset.debug.<VIEWMODELNAME>'.",g=ct.createLog(n),ei=f.Parts.partSettingNotReceivedErrorDescription,vi=f.Parts.unknownErrorDescription,y=jQuery,ft={},oi="attr: { 'role': context._computedRole },css: context._computedClasses,click: function (data, evt) { return context._onClick(data, evt); },event: {'keydown': function (data, evt) { return context._onKeyDown(data, evt); } }",vt=ko.applyBindings,nt=ko.cleanNode,tt=ko.computed,si=ko.dataFor,yt=ko.ignoreDependencies,b=ko.observable,yi=ko.observableArray,pt=ko.pureComputed,et=ko.reactor,wt=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(at.ClickableLink),ot,st,ht;t.InternalClickableLink=wt;ot=function(){function n(){this.inContainerOfSameAsset=b(!0);this.partSettingFailed=b(!1);this.notFoundMessage=b();this.lockedUiContext=b(!0)}return n.prototype.getSelectable=function(){return this._selectable},n.prototype.configure=
function(n){this._onStartboard=n.onStartboard;this._selectable=n.selectable||this._selectable},n}();t.PartBase=ot;st=function(n){function t(t,i,u,f){var s=this,h,l,g;n.call(this);this.spinnerBehaviorNone=b(ui.features.spinnerbehavior==="none");var c=this._lifetime=new ni,e=i.container,d=r.tryGetSelectableViewModelContract(e);if(!e)throw new Error("Cannot create a part without a container viewmodel.");this._selectable=d&&d._msPortalFxSelectable2?o.getOrCreateSelectable2(d._msPortalFxSelectable2):undefined;h=this._selectable=this._selectable||e.selectable;h||(l=i.content,l&&typeof l.onClick=="function"&&(h=this._selectable=v.getSelectableWithClickHandler(l,y(t),l.onClick)));this._viewModel=i;this._partContainer=y(t).attr("data-bind",oi).html(a());this._partContent=this._partContainer.find(".fxs-part-content")[0];this._options=u;this._services=f;g=function(n){return!!s.notFoundMessage()||!!n.noDataMessage()||!!n.unauthorizedMessage()};this.isUiBlocked=pt(function(){return s._viewModel.internal.
allowUiBlocking()&&(e.operations.blockingUi()||g(e))});this._isUiBlockedMessageDisplayed=pt(function(){return s._viewModel.internal.allowUiBlocking()&&g(e)});this._isPartClickable=tt(c,function(){return e.operations.blockingUi()?!1:e.partState&&e.partState()===k.Failed?!1:s.notFoundMessage()?!1:e.unauthorizedMessage()!==null&&e.unauthorizedMessage()!==undefined?!1:e.clickableLink||e.isSelectable()&&!!h});tt(c,function(){e.partTitle();setTimeout(function(){s._partContainer.trigger(p.fxwidthchanged)},50)});this._computedClasses=tt(c,function(){var n=[];e.partTitle()&&e.partState()!==k.Failed&&n.push("fxs-part-part-title-visible");s._isPartClickable()&&n.push("fxs-part-clickable");s.notFoundMessage()?n.push("fxs-part-notfound"):e.noDataMessage()&&n.push("fxs-part-nodata");h&&e.isSelectable()&&(h.isSelected()&&n.push("fxs-part-selected"),h.isSelected()&&n.push("fxs-part-selected"),h.isCommandSelected&&h.isCommandSelected()&&n.push("fxs-part-selected-command"));switch(e.contentState()){case
w.Success:n.push("fxs-part-success");break;case w.Warning:n.push("fxs-part-warning");break;case w.Error:n.push("fxs-part-error");break;case w.Dirty:n.push("fxs-part-dirty");break;case w.Info:n.push("fxs-part-info")}return n.join(" ")});this._computedRole=tt(c,function(){var n=undefined;return s._isPartClickable()&&(n=s._viewModel.container.clickableLink?"link":"button"),n});si(this._partContainer[0])&&nt(this._partContainer[0]);vt({container:e,context:this},this._partContainer[0]);et(c,function(){var n=s._isUiBlockedMessageDisplayed();n?(s._initializeBlockedUiHandlers(),s._partContainer.find(document.activeElement).length>0&&s._partContainer[0].focus()):(s._removeBlockedUiHandlers(),s._toggleDisableTabbableElements(n))});et(c,function(){s.lockedUiContext()?s._partContainer.removeAttr("tabindex"):s._partContainer.attr("tabindex",0)})}return __extends(t,n),t.prototype.setupContent=function(n){var t=this;et(this._lifetime,function(){if(t.partSettingFailed())g.error(ei),yt(function(){t._bindErrorTemplate(
)});else{var i=t._viewModel.container.partState();yt(function(){t._bindContentTemplate(i,t.template,n)})}})},t.prototype.selectOnReady=function(n,t){var i=this,h=function(){i._selectable.isSelected(!0)},u,f;t=t||{};t.selectablePath=t.selectablePath||"container.selectable";t.timeoutInMilliseconds=t.timeoutInMilliseconds===undefined?5e3:t.timeoutInMilliseconds;t.execute=t.execute||h;var e=this._viewModel.container.operations.inProgress,r=Q.defer(),o=ri.getModelValue(this._viewModel,t.selectablePath),c=typeof this._viewModel.content.onInputsSet=="function"&&e(),s=function(){var u=n();u&&t.execute(i._viewModel);r.resolve(u)};return o.exists&&o.value?c?this._inProgressLifetime||(u=t.timeoutInMilliseconds,f=d.setTimeout(function(){i._inProgressLifetime.dispose();i._inProgressLifetime=null;r.reject("Unable to select part because its onInputsSet promise did not resolve after {0} milliseconds.".format(u))},u),this._inProgressLifetime=this._lifetime.createChildLifetime(),e.subscribe(this._inProgressLifetime,
function(n){n||(i._inProgressLifetime.dispose(),i._inProgressLifetime=null,d.clearTimeout(f),f=null,s())})):s():r.reject("Unable to select part because it is missing selectable property '{0}' from its view model.".format(t.selectablePath)),r.promise},t.prototype._setupAutofocusReadyListener=function(){var n=this._partContainer[0];e.FocusHandler.Instance.registerTargetForFocus(n);c.waitForBindings(n).then(function(){e.FocusHandler.Instance.notifyTargetReadyForFocus(n)}).catch(function(){})},t.prototype._logClick=function(n){ti.trace({extension:this._options.locator.getExtensionLocator().name,source:this._onStartboard?s.Source.StartBoardPart:s.Source.Blade,action:s.Action.PartClick,name:this._options.locator.toFriendlyString(),data:n})},t.prototype._onClick=function(n,t){return this._activatePart(n,t)},t.prototype._onKeyDown=function(n,t){return t.target===this._partContainer[0]&&t.keyCode===13?this._activatePart(n,t):!0},t.prototype._activatePart=function(n,t){if(this._services.desktop.
mode.peek()===1)return!0;var h=this._viewModel.container,e=y(t.target),c=!0,o=d.getSelection(),s=o.rangeCount>0&&o.getRangeAt(0),r=h.clickableLink;if(this._isPartClickable()&&!(e.closest("a").length>0)&&(o.isCollapsed||!s||s.commonAncestorContainer.ownerSVGElement||s.commonAncestorContainer.nodeName==="svg"))if(r)if(r instanceof wt&&y.isFunction(r.onClick))r.onClick();else{var u=r.target(),f=r.uri(),l=i.startsWith(f,"#"),a=!1;u==="auto"&&(u=l?"_self":"_blank");u==="_self"&&(t.ctrlKey||t.shiftKey?u="_blank":l&&(this._services.router.route(f),a=!0));a||window.open(f,u);this._logClick({effectiveTarget:u,target:r.target(),scrubbedUri:f.split("?")[0]})}else t.shiftKey||t.ctrlKey||t.which===2?e.trigger(p.fxopeninnewtab,{selectable:h.selectable}):(this._selectable&&(this._selectable.isSelected()?e.trigger(p.fxensurebladevisible,{}):(this._selectable.onClick(),this._logClick())),c=!1);return c},t.prototype._bindContent=function(n,t,i){i&&dt(document,y(this._partContent),i);y(n).html(t);vt(this.
_getContentForBinding(this._lifetime,this._viewModel),n);this._nodeToCleanup=n},t.prototype.dispose=function(){var t=this._nodeToCleanup,n;t&&nt(t);this._removeBlockedUiHandlers();n=this._partContainer[0];n&&(nt(n),this._partContainer[0]=this._partContent=null);ii.disposeViewModelProperties(this._viewModel);this._lifetime.dispose()},t.prototype._dispose=function(n){n&&n.dispose()},t.prototype._getContentForBinding=function(n,t){return t.content},t.prototype._getCloudName=function(){return this._options.locator.getExtensionLocator().cloudName},t.prototype._getExtensionName=function(){return this._options.locator.getExtensionLocator().name},t.prototype._bindContentTemplate=function(n,t,i){var e=n===k.Ready,u=this._viewModel.container,r,f;if(e)try{u.contentState(w.None);this._resetContentTemplateContainer();this._bindContent(this._partContent,t,i)}catch(o){g.error(o,null,"Part {0} failed to bind.".format(this._options.getDebugId()));this._bindErrorTemplate()}else n===k.Failed&&(r=u.failureMessage(
),this._options.traceErrorTelemetry(r),f="Part {0} manually transitioned into failure state with message: {1}.\n{2}".format(this._options.getDebugId(),r,fi),g.error(f),this._bindErrorTemplate());this._setupAutofocusReadyListener()},t.prototype._bindErrorTemplate=function(){this.notFoundMessage(null);this._viewModel.container.contentState(w.Error);this._resetContentTemplateContainer();var n=new l.ViewModel;new l.Widget(y(this._partContent),n);n.title(this._options.locator.name);n.subtitle(this._getExtensionName());e.FocusHandler.Instance.notifyTargetReadyForFocus(this._partContainer[0])},t.prototype._resetContentTemplateContainer=function(){nt(this._partContent);y(this._partContent).html("")},t.prototype._removeBlockedUiHandlers=function(){var t=this._partContainer,i=this._onFocus,n;i&&(t.off(p.focus,i),this._onFocus=null);n=this._onFocusIn;n&&(t.off(p.focusin,n),this._onFocusIn=null)},t.prototype._initializeBlockedUiHandlers=function(){var n=this,t=this._partContainer;t.on(p.focus,this.
_onFocus=function(){n._toggleDisableTabbableElements(n._isUiBlockedMessageDisplayed())});t.on(p.focusin,this._onFocusIn=function(){n._isUiBlockedMessageDisplayed()&&t[0].focus()})},t.prototype._toggleDisableTabbableElements=function(n){var r,t,u,i,f="tabindex",e="data-initialtabindex";if(n)for(r=this._partContainer.find(":tabbable"),i=0;i<r.length;++i)t=y(r[i]),u=t.attr(f),t.attr(f,"-1"),t.attr(e,u||"unset");else for(r=this._partContainer.find("["+e+"]"),i=0;i<r.length;++i)t=y(r[i]),u=t.attr(e),u!=="unset"?t.attr(f,u):t.removeAttr(f),t.removeAttr(e)},t}(ot);t.PartImpl=st;t.registerFactory=hi;t.getFactory=bt;t.getPartSizeOrDefault=kt;ht={};t.enableCustomCss=dt;t.injectStyles=gt;t.getPartFactory=ci;t.createAmdPartFactory=li;t.createPartFactory=ai}(y||(y={})),y});define("MsPortalImpl/Interactions/Interactions.RightClick",["require","exports","f","../Base/Base.KeyboardHelper"],function(n,t,i,r){"use strict";var u;return function(n){function e(n,i,e){function l(){n.removeClass(u);var r=i();
r&&r.forEach(function(n){n.dispose()});o&&(n.off(t.fxcontextmenurequest,o),o=null);s&&(n.off(t.keydown,s),s=null);h&&(n.off(t.remove,h),h=null)}function a(n){var t=i();t&&t.length>0&&(n.preventDefault(),n.stopPropagation(),v(n.clientX,n.clientY))}function v(r,u){var e=f.Event(t.fxcontextmenu);e.clientX=r;e.clientY=u;c||(c=n.hasClass("fxs-blade")?n:null);n.trigger(e,{commands:i(),formTarget:c})}var c=e&&e.formTarget,o,s,h;n.addClass(u);n.on(t.fxcontextmenurequest,o=function(n){a(n)});n.on(t.keydown,s=function(n){if(n.which===121&&r.getModifierKeys(n)===4){var t=n.target.getClientRects()[0];n.clientX=t&&t.left;n.clientY=t&&t.top;a(n)}});n.on(t.remove,h=l);return{dispose:l}}var t=i.Base.EventTypes,o=window,f=jQuery,u="fx-rightClick";n.setup=e}(u||(u={})),u});define("_generated/Templates/WidgetsTileActionBar",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-tile-actionbar-actionlist" role="menubar" data-bind="foreach: _actionsForUi"> <!-- ko if: command.enabled() --> <button type="button" class="fxs-tile-actionbar-action" role="menuitem" data-bind="css: className, image: command.icon, attr: { title: command.text, \'aria-label\': command.text }"><\/button> <!-- /ko --> <\/div>'}
});define("MsPortalImpl/Widgets/Widgets.TileActionBar",["require","exports","f","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.ContextMenu","../../_generated/Templates/WidgetsTileActionBar","../../_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css"],function(n,t,i,r,u,f,e){"use strict";var o;return function(n){var s=i.Base,h=s.EventTypes,y=s.Diagnostics.Telemetry,d=window,p=jQuery,w=y.trace,t="fxs-tile-actionbar",b=t+"-action",k=ko.observable,c=ko.observableArray,l,a,o,v;n.widgetClassName=t;n.actionClassName=b;l=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(u.ViewModel);n.TileActionViewModel=l;a=function(n){function t(){n.apply(this,arguments);this._actionsForUi=c([]);this.actions=c([]);this.visible=k(!1)}return __extends(t,n),t.prototype.update=function(){var n=this.visible();n?(this.actions().forEach(function(n){n.command.activate();n.bindCommand()}),this._actionsForUi(this.actions())):this._actionsForUi([])},t}(u.ViewModel);n.ViewModel=
a;o=function(n){function i(i,r,u){n.call(this,i,u);i.addClass(t).html(e());this._attachEventHandlers();ko.applyBindings(u,i[0]);this._initContextMenu(r)}return __extends(i,n),i.prototype.dispose=function(){this._cleanElement(t);this.contextMenuWidget&&this.contextMenuWidget.dispose();n.prototype.dispose.call(this)},i.prototype.showTileManagementContextMenu=function(){this.options.actions().forEach(function(n){var t=n.command;typeof t._getActionClassIdentifier=="function"&&t._getActionClassIdentifier()==="opencontextmenu"&&t.execute(!1)})},i.prototype.setFocus=function(){this.options.visible()&&this.element.findFirstTabbable().focus()},i.prototype._attachEventHandlers=function(){var n=this.options,t=this.element,u=this.lifetimeManager,i=function(t){t.stopPropagation();var i=ko.dataFor(t.target);i&&n!==i&&i.command&&(w({source:r.Source.TileAction,action:r.Action.TileActionClicked,name:i.command.commandName}),i.command.execute(!1))};t.on(h.click,i);ko.computed(this.lifetimeManager,function(
){var i=n.visible(),r=n.actions();t.css({visibility:i?"visible":"hidden"});ko.ignoreDependencies(function(){n.update()})});u.registerForDispose(function(){t.off(h.click,i)})},i.prototype._initContextMenu=function(n){var t=this,i=new f.ViewModel;this.contextMenuWidget=new f.Widget(n,i);ko.reactor(this.lifetimeManager,function(){var n=t.options.visible();ko.ignoreDependencies(function(){n||(t.contextMenuWidget.hide(),t.contextMenuWidget.options.menuItems.removeAll())})})},i}(u.Widget);n.Widget=o;v=function(){function n(n){this._getActions=n}return n.prototype.create=function(n){var t;return p.isFunction(this._getActions)&&(t=this._getActions(),ko.utils.arrayPushAll(n.options.actions,t)),new o(n.element,n.contextElement,n.options)},n}();n.FactoryImpl=v}(o||(o={})),o});define("_generated/Templates/WidgetsTile",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-tile-container" data-bind="visible: data.spinnerBehaviorFade(), css: { \'fxs-tile-progress-fade\': data.spinnerBehaviorFade() && data.locked() && data.loading() }"><\/div> <div class="fxs-tile-overlay fxs-br-primary"><\/div> <div class="fxs-tile-progress-transparent" data-bind="visible: data.showTransparentSpinner"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <fxs-progress class="fxs-tile-progress fxs-bg-muted-10" data-bind="visible: data.showOpaqueSpinner"><\/fxs-progress> <div class="fxs-tile-actionbarcontainer" data-bind="stopBindings: true"> <div class="fxs-tile-actions"><\/div> <div class="fxs-tile-actions-contextmenu"><\/div> <\/div>'}
});define("MsPortalImpl/Widgets/Widgets.Tile",["require","exports","f","../Interactions/Interactions.RightClick","./Widgets.TileActionBar","../../_generated/Templates/WidgetsTile","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function ut(n,t,i){return new v(n,t,new u.FactoryImpl(i))}var y=i.Base,nt=y.Diagnostics,h=y.EventTypes,p=i.Parts,w=p.PartSize,l=p.PartSizeHelper,tt=window,it=jQuery,rt=nt.createLog(n),b=tt.fx.environment.features,a=ko.computed,o=ko.observable,k=ko.observableArray,s="fxs-tile",d=s+"-overlay",c,g,v;t.widgetClassName=s;t.overlayClassName=d;t.actionBarContainerClassName=s+"-actionbarcontainer",function(n){n[n.None=0]="None";n[n.Transparent=1]="Transparent";n[n.Opaque=2]="Opaque"}(c||(c={}));g=function(n){function t(t,i){var r=this,f;n.call(this,t);this.isInBlockingLoadingState=o(!1);this.hasOngoingOperation=o(!1);this.spinnerBehaviorFade=o(b.spinnerbehavior==="fade");
this.spinnerBehaviorNone=o(b.spinnerbehavior==="none");this.size=o();this.gridHeight=o();this.gridWidth=o();this.largeInitialSize=o();this.supportedSizes=k();this.commands=[];this.actionBarViewModel=new u.ViewModel;this.selected=o(!1);this.selectedFromHover=o(!1);this.showEnhancedTileMgmtMillis=500;this.hideEnhancedTileMgmtMillis=333;this.userResizable=o(!1);this.inLockedContext=!1;this.applyViewSettings(i);f=a(function(){var n=!((r.spinnerBehaviorFade()||r.spinnerBehaviorNone())&&r.locked());if(n){if(r.isInBlockingLoadingState())return c.Opaque;if(r.hasOngoingOperation())return c.Transparent}return c.None});this.showTransparentSpinner=a(function(){return f()===c.Transparent});this.showOpaqueSpinner=a(function(){return f()===c.Opaque})}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{size:this.size()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.size!==undefined&&(this.size=o(n.NormalState.size))},t}(e.ViewModel);t.ViewModel=
g;t.createTileWidget=ut;v=function(n){function t(t,i,u){var a=this,e,v,h,c,y;n.call(this,t,i);i.size&&i.size()!==undefined||(rt.warning("No initial size was set on the Tile view model."),e=l.getDefaultSize(),i.size=o(e.name));this._actionBarWidgetFactory=u;e=l.getSize(i.size());v=f();t.addClass(s).addClass(e&&e.css).html(v);h=t.findByClassName(s+"-progress")[0];ko.applyBindingsToNode(h,null,{data:i});c=t.findByClassName(s+"-progress-transparent")[0];ko.applyBindingsToNode(c,null,{data:i});this._containerElement=t.findByClassName(s+"-container")[0];ko.applyBindingsToNode(this._containerElement,null,{data:i});this._attachEventHandlers();y=r.setup(t,k(i.commands));this.lifetimeManager.registerForDispose(function(){a._cleanNode(h);a._cleanNode(c);y.dispose()})}return __extends(t,n),t.prototype.dispose=function(){this._cleanNode(this._containerElement);this._containerElement=null;this._actionBarWidget&&(this._actionBarWidget.dispose(),this._actionBarWidget=null);this._cleanElement(l.AllCssClasses.
join(" "),s);n.prototype.dispose.call(this)},t.prototype._cleanNode=function(n){n&&ko.cleanNode(n)},t.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");var t=n.element||n;this.options.spinnerBehaviorFade()?t.appendTo(this._containerElement):t.insertBefore(it(this.element).findByClassName(d))},t.prototype.removeChild=function(){return!1},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.setSize=function(n,t){var s=this,i=l.getCorrespondingStandardSize(n,t),o;i||(i=l.getDefaultSize());var u=i.size,f=this.options,e=f.size(),r=this.element;if(e&&e===i.name){if(e!==w.Custom)return;if(parseInt(r.css("height"))===u.height&&parseInt(r.css("width"))===u.width)return}f.size(i.name);f.gridHeight(i.span.rowSpan);f.gridWidth(i.span.colSpan);r.css({height:"",width:""}).removeClass(l.AllCssClasses.join(" ")).addClass(i.css);i.name===w.Custom&&r.css({height:u.height,width:u.width});o=300;r.handleTransitionEndOnce("height",o,function(
){r.trigger(h.fxsizechanged,[i.name]);r.trigger(h.fxwidthchanged);s.setFocus()})},Object.defineProperty(t.prototype,"actionBarWidget",{get:function(){return this._actionBarWidget},enumerable:!0,configurable:!0}),t.prototype.setFocus=function(){var n=this._actionBarWidget,t;n&&n.options.visible()?n.setFocus():(t=this.element.find(".fxs-part"),t&&t.focus())},t.prototype.showTileManagementContextMenu=function(){var n=this.options,t=this.actionBarWidget;!n.locked()&&n.selected()&&t&&t.showTileManagementContextMenu()},t.prototype._createActionBarWidget=function(){!this._actionBarWidget&&this._actionBarWidgetFactory&&(this._actionBarWidget=this._actionBarWidgetFactory.create({element:this.element.findByClassName(s+"-actions"),contextElement:this.element.findByClassName(s+"-actions-contextmenu"),options:this.options.actionBarViewModel}))},t.prototype._attachEventHandlers=function(){var v=this,t=this.element,n=this.options,r=this.lifetimeManager;if(n.size.subscribe(r,function(){t.trigger(e.Widget.
viewSettingsChanged,v.saveViewSettings())}),a(r,function(){n.userResizable()&&ko.ignoreDependencies(function(){i.require("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize").then(function(n){n.addUserResizeBehavior(v)})})}),a(r,function(){n.locked();setTimeout(function(){t.trigger(h.fxwidthchanged)},50)}),a(r,function(){var i=n.selected(),r=n.selectedFromHover(),u=i||r;ko.ignoreDependencies(function(){u&&v._createActionBarWidget()});n.actionBarViewModel.visible(u);t.toggleClass(s+"-selected",i);t.toggleClass(s+"-selectedfromhover",r)}),!n.inLockedContext){var u,f,o=function(){clearTimeout(f);f=null;u=setTimeout(function(){n.selectedFromHover(!0);u=null},n.showEnhancedTileMgmtMillis)},c=function(){(clearTimeout(u),u=null,n.selectedFromHover())&&(f=setTimeout(function(){n.selectedFromHover(!1);f=null},n.hideEnhancedTileMgmtMillis))},l=t[0];t.on(h.mouseenter,o);t.on(h.mouseleave,c);l.addEventListener(h.focus,o,!0);l.addEventListener(h.blur,c,!0);r.registerForDispose(function(){t.
off(h.mouseenter,o);t.off(h.mouseleave,c);l.removeEventListener(h.focus,o,!0);l.removeEventListener(h.blur,c,!0)})}},t}(e.Widget);t.Widget=v}(o||(o={})),o});define("MsPortalImpl/UI/Commands/UI.ShellCommands",["require","exports","f","../../Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","../../Interactions/Interactions.Command","../../Base/Telemetry","./UI.Commands","../../Widgets/Widgets.WidgetBase","../../Widgets/Widgets.Tile","../../Widgets/Widgets.TileActionBar"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return function(n){function lt(){return tt("MsPortalImpl/UI/UI.Desktop.Actions")}function vi(n){var i=[],r=[{size:y.Mini,text:t.partSizeMini},{size:y.Small,text:t.partSizeSmall},{size:y.Normal,text:t.partSizeNormal},{size:y.Wide,text:t.partSizeWide},{size:y.Tall,text:t.partSizeTall},{size:y.Large,text:t.partSizeLarge},{size:y.HeroWide,text:t.partSizeHeroWide},{size:y.HeroTall,text:t.partSizeHeroTall},{size:y.Hero,text:t.partSizeHero}];return r.forEach(function(
t){var r=d.Mini();r.options={customClass:"msportalfx-contextmenu-grid-"+y[t.size].toLowerCase()};i.push(new et(t.text,t.size,r,n))}),i}var it=i.Base,hi=it.Diagnostics.Telemetry,k=it.EventTypes,v=it.Images,d=v.Shell,ot=i.Blades,p=ot.DisplayState,st=i.Parts,y=st.PartSize,nt=st.PartSizeHelper,ci=i.ViewModels,rt=ci.Dialogs,li=rt.DialogResult,ht=rt.MessageBoxButtons,ai=o.CompositionInstanceCommandContext,w=jQuery,ct=s.Widget.getWidget,t=u.ShellCommands,a="MsPortalImpl.UI.Commands.",b=1,tt=i.require,ut=v.Blank(),ft,l,at,vt,yt,pt,wt,et,g,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si;n.CommandNames={PinListItem:a+"PinListItem",DeleteListItem:a+"DeleteListItem",PinToStartboard:a+"PinToStartboard",UnpinFromStartboard:a+"UnpinFromStartboard",PinBlade:a+"PinBlade",PartSize:a+"PartSize",BladeDisplayState:a+"BladeDisplayState",ResetLayout:a+"ResetLayout",ResetStartBoard:a+"ResetStartBoard",EnterOrganizeMode:a+"EnterOrganizeMode",ExitOrganizeMode:a+"ExitOrganizeMode",AddParts:a+"AddParts",NewDashboard:a+"NewDashboard",
CloneDashboard:a+"CloneDashboard",DeleteDashboard:a+"DeleteDashboard",ShareDashboard:a+"ShareDashboard",FilterDashboard:a+"FilterDashboard",FullscreenDashboard:a+"FullscreenDashboard",OpenBrowseDashboardsPane:a+"OpenBrowseDashboardsPane"};ft=o.getBladeWidget;l=function(n){function t(t,i,r){n.call(this,i,r);this._services=t}return __extends(t,n),t.prototype.bind=function(t){t.formTarget||(t.formTarget=this._services&&this._services.portalFormTarget);n.prototype.bind.call(this,t)},t.prototype.execute=function(t){n.prototype.execute.call(this,t);hi.trace({source:o.getCommandSourceTelemetryName(this._currentContext),action:e.Action.CommandExecuted,name:this.commandName,data:{fromContextMenu:t,desktopMode:this._getDesktopMode()}})},t.prototype.createAction=function(n){var i=this,t=new c.TileActionViewModel;return t.command=this,t.bindCommand=function(){var t=n.widget;t?i.bind(new ai(t.element[0],null,n)):i.enabled(!1)},this._setActionClassName(t),t},t._getPartWidget=function(n){var t=ct(n,h.
Widget);return t||(t=ct(n.closest(".fxs-tile"),h.Widget)),t},t.prototype._getComposition=function(){return this._currentContext.compositionInstance},t.prototype._getDesktopMode=function(){return this._services?this._services.desktop.mode():null},t.prototype._setActionClassName=function(n){var t=this._getActionClassIdentifier();this._actionClassName="fxs-tile-actionbar-command-"+t;n.className=this._actionClassName},t.prototype._getActionClassIdentifier=function(){throw new Error("Not implemented.");},t.prototype._canEnable=function(){return this._services?this._getDesktopMode()!==b:!0},t}(f.CommandImpl);n.ShellCommand=l;at=function(n){function t(t){n.call(this,null,t.text);this._command=t}return __extends(t,n),t.prototype.execute=function(t){this._command.handler().execute();n.prototype.execute.call(this,t)},t}(l);n.ControlCommand=at;vt=function(i){function r(r){i.call(this,r,t.unpin,!0);this.commandName=n.CommandNames.UnpinFromStartboard;this.icon(v.Discard())}return __extends(r,i),r.prototype.
bind=function(n){i.prototype.bind.call(this,n);var t=this._getComposition();this.enabled(t.isOrganizable()&&t.parent&&t.parent.isOrganizable())},r.prototype.execute=function(n){var t=l._getPartWidget(w(this._currentContext.target));t&&t.trigger(k.fxunpin,null,{tileId:t.options.id});i.prototype.execute.call(this,n)},r.prototype._getActionClassIdentifier=function(){return"unpinfromstartboard"},r}(l);n.UnpinFromStartboard=vt;yt=function(n){function t(t,i){n.call(this,t,i,!0);this.icon(v.Ellipsis())}return __extends(t,n),t.prototype.bind=function(t){var r=this,i;n.prototype.bind.call(this,t);this._partWidget=l._getPartWidget(w(t.target));i=this._partWidget;this.enabled(i.options.commands.length>0);ko.computed(this,function(){var n=i.actionBarWidget.contextMenuWidget.options.visible(),t=i.element.findByClassName(r._actionClassName);t.toggleClass("fxs-tile-actionbar-action-pressed",n)})},t.prototype.execute=function(t){var f=this._partWidget,r=f.element,u=r.findByClassName(this._actionClassName),
i,e,o;if(u.length<=0)throw new Error("Context menu requires an anchor element.");i=w.Event(k.fxcontextmenu);this._getDesktopMode()!==b?(e=u.offset(),i.clientX=e.left,i.clientY=e.top+u.outerHeight(!1)):(o=r.offset(),i.clientX=o.left+r.outerWidth(!1),i.clientY=o.top-u.outerHeight(!1));r.trigger(i,{commands:f.options.commands,contextMenu:f.actionBarWidget.contextMenuWidget});n.prototype.execute.call(this,t)},t.prototype._getActionClassIdentifier=function(){return"opencontextmenu"},t}(l);n.OpenContextMenu=yt;pt=function(i){function r(r){i.call(this,r,t.pinToStartboard,!1);this.commandName=n.CommandNames.PinToStartboard;this.icon(v.Pin())}return __extends(r,i),r.getSingleton=function(n){return this._pinToStartboard||(this._pinToStartboard=new r(n)),this._pinToStartboard},r.prototype.bind=function(n){var u,t,r;if(i.prototype.bind.call(this,n),u=!1,this.baseInstance=this._getComposition(),u=this.baseInstance.allInputsSet(),t=l._getPartWidget(w(n.target)),r=!1,t){var o=nt.isVariableSize(t.options.
size()),e=ko.unwrap(t.options.supportedSizes),f=void 0,s=t.element.parentsUntil(".fxs-blade",".fxs-blade-summary-container").length>0;s?r=!1:o?(f=e&&e.first(function(n){return nt.isFixedSize(n)}),f!==null&&f>=0&&(r=!0)):r=!0}this.enabled(r&&u)},r.prototype.execute=function(n){var t=this;lt().then(function(n){return n.pinPartToStartboard(t.baseInstance,t._services)}).finally(function(){i.prototype.execute.call(t,n)})},r.prototype._getActionClassIdentifier=function(){return"pintostartboard"},r}(l);n.PinToStartboard=pt;wt=function(i){function r(r){i.call(this,r,t.pinToStartboard,!0);this.commandName=n.CommandNames.PinBlade;this.icon(v.Pin())}return __extends(r,i),r.prototype.execute=function(n){var t=this,r=this._getComposition();return Q.all([lt(),r.getPinOptions()]).spread(function(n,i){return n.pinBladeToStartboard(i,t._services)}).finally(function(){i.prototype.execute.call(t,n)})},r}(l);n.PinBlade=wt;et=function(t){function i(i,r,u,f){t.call(this,f,i,!0);this.commandName=n.CommandNames.
PartSize+y[r];this._sizeTarget=r;this.icon(u)}return __extends(i,t),i.prototype.execute=function(n){var i=l._getPartWidget(w(this._currentContext.target)),r;i&&(r=nt.AllSizes[this._sizeTarget],i.element.trigger(k.fxsizechange,[i.options.id,r.size.width,r.size.height]));t.prototype.execute.call(this,n)},i.prototype.bind=function(n){var i=l._getPartWidget(w(n.target)),r=i&&i.options;if(!i||this._sizeTarget===r.size()||nt.isVariableSize(r.size())||this._getDesktopMode()!==b){this.enabled(!1);return}this.enabled(r.supportedSizes().indexOf(this._sizeTarget)!==-1);t.prototype.bind.call(this,n)},i}(l);n.PartSizeCommand=et;n.CreatePartSizeCommandCollection=vi;g=function(t){function i(i,r){t.call(this,null,i,!0);this.commandName=n.CommandNames.BladeDisplayState+p[r];this._displayStateTarget=r;this.icon(ut)}return __extends(i,t),i.prototype.execute=function(n){var i=ft(w(this._currentContext.target));i&&(i.options.displayState(this._displayStateTarget),i.setFocus());t.prototype.execute.call(this,
n)},i.prototype.bind=function(n){var r=ft(w(n.target)),i,u;if(t.prototype.bind.call(this,n),i=n.compositionInstance,u=i.pairing&&i.pairing()!==ot.BladePairing.None,!r||u||this._displayStateTarget===r.options.displayState()){this.enabled(!1);return}this.enabled(!0)},Object.defineProperty(i.prototype,"displayStateTarget",{get:function(){return this._displayStateTarget},enumerable:!0,configurable:!0}),i}(l);n.BladeDisplayStateCommand=g;n.BladeDisplayStateCommandCollection=[];n.BladeDisplayStateCommandCollection[p.Minimized]=new g(t.bladeMinimize,p.Minimized);n.BladeDisplayStateCommandCollection[p.Normal]=new g(t.bladeRestore,p.Normal);n.BladeDisplayStateCommandCollection[p.Maximized]=new g(t.bladeMaximize,p.Maximized);bt=function(i){function r(r,u,f){i.call(this,f,t.resetLayout,r!==!0);this.commandName=n.CommandNames.ResetLayout;this._locked=r;this._displayStateTarget=u;this.icon(v.Refresh())}return __extends(r,i),r.create=function(n,t,i){return new r(n,t,i)},r.prototype.execute=function(
n){this._getComposition().resetLayout();i.prototype.execute.call(this,n)},r.prototype.bind=function(n){i.prototype.bind.call(this,n);this.enabled(this._locked!==!0&&(this._displayStateTarget()===p.Normal||this._displayStateTarget()===p.Maximized))},r}(l);n.ResetLayoutCommand=bt;kt=function(i){function r(r){i.call(this,r,t.resetLayout,!0);this.commandName=n.CommandNames.ResetStartBoard;this.icon(ut)}return __extends(r,i),r.prototype.execute=function(n){this._services.desktop.startBoard.resetLayout();i.prototype.execute.call(this,n)},r.prototype.bind=function(n){i.prototype.bind.call(this,n);this.enabled(this._getDesktopMode()===b)},r}(l);n.ResetStartBoardCommand=kt;dt=function(i){function r(r,u){u===void 0&&(u=!1);i.call(this,r,t.enterOrganizeMode,!0);this.commandName=n.CommandNames.EnterOrganizeMode;this.icon(v.Edit());this._locked=u}return __extends(r,i),r.prototype.execute=function(n){var t=this._getComposition();t&&t.widget?t.widget.element.trigger(k.fxenterorganizemode):this._services.
desktop.mode(b);i.prototype.execute.call(this,n)},r.prototype.bind=function(n){i.prototype.bind.call(this,n);var t=this._getComposition();this.enabled(t.isOrganizable()&&this._locked!==!0&&this._canEnable()&&!this._services.leftContextPane.opened.peek())},r}(l);n.EnterOrganizeMode=dt;gt=function(i){function r(r){i.call(this,r,t.exitOrganizeMode,!0);this.commandName=n.CommandNames.ExitOrganizeMode;this.icon(ut)}return __extends(r,i),r.prototype.execute=function(n){this._services.desktop.mode(0);i.prototype.execute.call(this,n)},r.prototype.bind=function(n){i.prototype.bind.call(this,n);this.enabled(this._getDesktopMode()===b)},r}(l);n.ExitOrganizeMode=gt;ni=function(n){function i(i){n.call(this,i,t.clonePart,!0);this.icon(v.Clone())}return __extends(i,n),i.prototype.bind=function(t){n.prototype.bind.call(this,t);var i=this._getComposition();this.enabled(i.canClone&&this._getDesktopMode()===b)},i.prototype.execute=function(t){var r=this._getComposition(),i=r.parent;i.widget.trigger(k.fxrearrange,
null,{partId:r.id,sourceId:i.id,targetId:i.id,forceClone:!0});n.prototype.execute.call(this,t)},i}(l);n.ClonePart=ni;ti=function(i){function r(r){i.call(this,r,t.addParts,!0);this.commandName=n.CommandNames.AddParts;this.icon(v.Add())}return __extends(r,i),r.prototype.bind=function(n){var t=this,r;i.prototype.bind.call(this,n);r=this._getComposition();ko.reactor(this,function(){var n=t._services.leftContextPane.opened(),i=!t._getComposition().widget.options.locked();t.enabled(r.isOrganizable()&&!n&&i)})},r.prototype.execute=function(n){i.prototype.execute.call(this,n);this._getComposition().widget.element.trigger(k.fxaddparts,{trigger:1})},r}(l);n.AddParts=ti;ii=function(i){function r(r){i.call(this,r,t.shareDashboard,!0);this.commandName=n.CommandNames.ShareDashboard;this.icon(d.Share())}return __extends(r,i),r.prototype.bind=function(n){i.prototype.bind.call(this,n);this.enabled(!this._services.contextPane.opened.peek())},r.prototype.execute=function(n){i.prototype.execute.call(this,
n);var t=this._services;tt("MsPortalImpl/Widgets/Widgets.ShareDashboardPane").then(function(n){t.contextPane.tryOpen(new n.ShareDashboardPane(t))})},r}(l);n.ShareDashboard=ii;ri=function(i){function r(r){i.call(this,r,t.deleteDashboard,!0);this.commandName=n.CommandNames.DeleteDashboard;this.icon(d.TrashOutline())}return __extends(r,i),r.prototype.execute=function(n){var u=this,r;i.prototype.execute.call(this,n);r=this._services;r.desktop.getDashboardManager().then(function(n){var i=n.isCurrentDashboardShared(),f=r.desktop.startBoard.notFound()?Q(!0):n.isCurrentDashboardWritable();f.then(function(f){r.getService("DialogManager").then(function(r){var e=new rt.MessageBox(t.deleteDashboard,f?t.deleteDashboardConfirm:t.noPermissionToDeleteDashboard,f?ht.OKCancel:ht.OK),o;e.confirmationRequired=f&&i;e.confirmationMessage=t.deleteDashboardConfirmation;o=u._currentContext;r.showShellDialog(e,o.formTarget,o.target).then(function(t){f&&t===li.Ok&&n.deleteCurrentDashboard()})})})})},r}(l);n.DeleteDashboard=
ri;ui=function(i){function r(r){i.call(this,r,t.newDashboard,!0);this.commandName=n.CommandNames.NewDashboard;this.icon(d.Add())}return __extends(r,i),r.prototype.execute=function(n){i.prototype.execute.call(this,n);this._services.desktop.getDashboardManager().then(function(n){n.startNewDashboard()})},r}(l);n.NewDashboard=ui;fi=function(i){function r(r){i.call(this,r,t.cloneDashboard,!0);this.commandName=n.CommandNames.CloneDashboard;this.icon(v.Clone())}return __extends(r,i),r.prototype.execute=function(n){i.prototype.execute.call(this,n);this._services.desktop.getDashboardManager().then(function(n){n.cloneCurrentDashboard()})},r}(l);n.CloneDashboard=fi;ei=function(i){function r(r,u){i.call(this,r,t.filterDashboard,!0);this.commandName=n.CommandNames.FilterDashboard;this._startboard=u;this.icon(d.Filter())}return __extends(r,i),r.prototype.execute=function(n){i.prototype.execute.call(this,n);var t=this._services,r=this._startboard;tt("MsPortalImpl/Widgets/Widgets.FilterPane").then(function(
n){var i=n.FilterPane.getSingleton(t.contextPane,r);i.open()})},r}(l);n.FilterDashboard=ei;oi=function(i){function u(r){i.call(this,r,t.fullscreenDashboard,!0);this.commandName=n.CommandNames.FullscreenDashboard;this.icon(d.Fullscreen())}return __extends(u,i),u.prototype.execute=function(n){i.prototype.execute.call(this,n);var u,f=document,t=document.documentElement;r.isFullscreen()?r.exitFullscreen():(u=t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen,u&&u.call(t))},u}(l);n.FullscreenDashboard=oi;si=function(t){function i(i){t.call(this,i,"",!0);this.commandName=n.CommandNames.OpenBrowseDashboardsPane}return __extends(i,t),i.prototype.execute=function(n){var u=this,r,i;t.prototype.execute.call(this,n);r=this._services;i=r.contextPane;Q.all([r.desktop.getDashboardManager(),tt("MsPortalImpl/UI/Dashboard/BrowseDashboardsPane")]).spread(function(n,t){var r=i.getContent(),f;if(r instanceof t.BrowseDashboardsPane){i.tryOpen(r);return}f=new t.BrowseDashboardsPane(
n,{defaultDashboardType:u._dashboardType,dashboardTypeChanged:function(n){return u._dashboardType=n}});i.tryOpen(f)})},i}(l);n.OpenBrowseDashboardsPane=si}(l||(l={})),l});define("MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",["require","exports","f","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Resources/ImplScriptResources","./UI.Composition","../Commands/UI.ShellCommands"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function c(n,t,i,r){if(l(t),i){var u=a(n,r);Array.prototype.push.apply(t,u)}}function l(n){n.filter(function(n){return n instanceof e.ShellCommand}).forEach(function(t){n.remove(t)})}function a(n,t){var i=[],r;return n.getCompositionType()===h.StartboardPart?(r=new e.UnpinFromStartboard(t),r.text(u.ShellCommands.unpinFromStartboard),i.push(r),i.push(new e.EnterOrganizeMode(t))):(i.push(e.PinToStartboard.getSingleton(t)),i.push(new e.UnpinFromStartboard(t)),i.push(new e.EnterOrganizeMode(t)),i.push(new e.ClonePart(t))),Array.prototype.
push.apply(i,e.CreatePartSizeCommandCollection(t)),i.push(new e.ExitOrganizeMode(t)),i}function v(n,t){var i,u;return(n instanceof r.SelectableSet2?i=t:n._msPortalFxCreateSelectionAsync?(u=o.Deferred(),n._msPortalFxCreateSelectionAsync(t).then(function(n){u.resolve(n)},function(n){u.reject(n)}),i=u.promise()):i=n.createSelection(t),Q.isPromiseAlike(i))?i:o.Deferred().resolve(i).promise()}var s=i.Base.Diagnostics,h=f.CompositionType,o=i.Helpers,y=s.createLog(n);t.composeShellCommands=c;t.createSelection=v}(o||(o={})),o});define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",["require","exports","f","u","./UI.Composition","./UI.Composition.PropertyBinding","../../Services/Services.Settings"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function h(n,i,r){var f=""+t.partIdentityStatePrefix+n.toString(),e;return r&&(f+="-"+r),i&&(e=i.hasOwnProperty(u.PartContainerModelIdProperty)&&[u.PartContainerModelIdProperty],f+="-"+l.toSortedString(ko.toJS(i),e)),f}function g(
n){var i=n.widget;i&&i.element.trigger(t.fxpartsettingchanged,{part:n})}function nt(n){var t;try{t=JSON.parse(JSON.stringify(n))}catch(i){t=n}return t}function ft(n){return n.some(function(n){var t=nt(n.propertyValue),r=nt(n.propertyOldValue);return!i.deepEquals(t,r)})}var p=i.Base,it=p.Diagnostics,l=p.Utilities,c=l.Internal.Serialization,o=e.SettingStore,a=u.CompositionType,v=f.PropertyBindings,s=f.PropertyBinding,rt=window,w=rt.fx.environment,y=it.createLog(n),b=Object.keys(w.trace.partsettings||{}),ut=b.length>0,k=w.features.multidashboards==="true",d=ko.toJSON,tt;t.partIdentityStatePrefix="[PartIdentityState]-";t.fxpartsettingchanged="fxpartsettingchanged";t.buildIdentitySettingKey=h;tt=function(){function n(){this._trace=!1}return n.prototype.configure=function(n){this._options=n},n.prototype.configureInstanceProperties=function(n){this._options.instanceProperties=n},n.prototype.initialize=function(){var n=this;this.dispose();this._registerPartIdentityStateChangeHandler();this._registerPartSharedKeyChangeHandler(
);this._registerPartInstanceChangedHandler();ut&&(this._trace=b.some(function(t){return n._options.partViewModelId.toLowerCase().indexOf(t)>=0}))},n.prototype.saveIdentityPartSettings=function(n){var u=this._options,f=u.part,s=u.services,e=s.sharedSettings,t=this.getKeyForIdentitySettings(n),i,r;k&&f.getCompositionType()===a.StartboardPart&&(i=t,t=h(f.locator,n));t&&(i&&e.deleteSettings({store:o.Part,keys:[i]}),r=c.toSerializableObject(this._identityState.targetModel),this._traceOperationWithSettings("Save identity part settings.",r,t),e.setSetting(o.Part,t,r),g(this._options.part))},n.prototype.clearIdentityPartSettings=function(){var t=this._options;if(t){var i=t.part,r=i.containerModel,n=[this.getKeyForIdentitySettings(r)];i.getCompositionType()===a.StartboardPart&&n.push(h(i.locator,r));n=n.filter(function(n){return!!n});n.length>0&&t.services.sharedSettings.deleteSettings({store:o.Part,keys:n})}},n.prototype.getPartSettingsAsync=function(){if(k&&this._options.part.getCompositionType(
)===a.StartboardPart)return this.getStartboardPartIdentitySettings();var n=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Q.all([n,t]).spread(function(n,t){var i={};return $.extend(!0,i,n),$.extend(!0,i,t),i})},n.prototype.registerInstanceStateProperty=function(n,t,i){i===void 0&&(i=!0);var r=this._options.part,u=this._getOrCreateInstanceStatePropertyBindings(),f=u.targetModel,e=r.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,e,f,u,function(){r.save()},n);i&&r.save()},n.prototype.savePart=function(){var n=this._options;n&&n.part.save()},n.prototype.dispose=function(){var i=this._partInstanceState,n,t;i&&(i.unbind(),this._partInstanceState=null);n=this._identityState;n&&(n.unbind(),this._identityState=null);t=this._sharedKey;t&&(t.unbind(),this._sharedKey=null)},n.prototype.getKeyForIdentitySettings=function(n){var f=null,t=this._options,i=t.part,e=t.partStateDefinition,r=t.identityInputs,s=i.getInputPropertyBindings(),o=e&&e.inputIdentityProperties,
u;return i.allInputsSet()&&o&&o.length>0&&(u="",r&&r.length>0&&(u=l.toSortedString(ko.toJS(s.targetModel),r)),f=h(i.locator,n,u)),f},n.prototype._registerPartIdentityStateChangeHandler=function(){var u=this,t=this._options,i=t.part,r=t.partStateDefinition,n=r&&r.inputIdentityProperties;n&&n.length>0&&(this._identityState=new v(i.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(n,this._identityState,function(n){var t=ft(n);t&&u.saveIdentityPartSettings(i.containerModel)}))},n.prototype._registerPartSharedKeyChangeHandler=function(){var f=this,t=this._options,e=t.part,r=t.partStateDefinition,h=t.services,n=r&&r.sharedProperties,u,i;n&&n.length>0&&(u=n.map(function(n){return n.property}),i={},this._sharedKey=new v(e.toString()+"-[PartSharedSettings]",i),this._registerViewModelChangeHandler(u,this._sharedKey,function(){var t={},r;n.forEach(function(n){var r=s.getModelValue(i,n.property).value;t[n.key]=c.toSerializableObject(r)});r={store:o.SharedPart,settings:t};
f._traceOperationWithSettings("Save shared part settings.",t);h.sharedSettings.setSettings(r)}))},n.prototype._registerPartInstanceChangedHandler=function(){var n=this._options,i,t=n.instanceProperties,r=function(n){return n.some(function(n){return n.propertyName==="content.pollingOptions"})};t&&t.length>0&&(i=this._getOrCreateInstanceStatePropertyBindings(),this._registerViewModelChangeHandler(t,this._partInstanceState,function(t){n.part.save();r(t)&&g(n.part)}))},n.prototype._registerViewModelChangeHandler=function(n,t,i){var r=this,u=t.targetModel,f=this._options.part.getSettingsModel();n.forEach(function(n){r._registerViewModelPropertyChangeHandler(n,f,u,t,i)})},n.prototype._registerViewModelPropertyChangeHandler=function(n,t,i,r,u,f){var e;s.getModelValue(i,n).exists||s.setModelValue(i,n,ko.toJS(s.getModelValue(t,n).value));e=r.addProperty(n).bind(this._options.partViewModelId,t,!1,u,function(n){y.error("[PartState] Failed to bind changes from viewmodel to part state. Error: "+n)}
);f&&f.registerForDispose(function(){r.removeProperty(e)})},n.prototype.getIdentityPartSettingsAsync=function(){var t=this,i=this._options,u=i.partStateDefinition,f=i.part.containerModel,e=u&&u.inputIdentityProperties,n,s;return(e&&e.length>0)?(n=this.getKeyForIdentitySettings(f),s={store:o.Part,keys:[n]},this._getPartSettingsAsync("Get identity part settings.",s,r).then(function(i){if(n===t.getKeyForIdentitySettings(f)){var r=t._identityState;return r&&$.extend(!0,r.targetModel,i),i}})):Q.resolve(null)},n.prototype.getStartboardPartIdentitySettings=function(){var t=this._options,n=t.part,i=t.partStateDefinition,u=i&&i.inputIdentityProperties,f;return(u&&u.length>0)?(f=[this.getKeyForIdentitySettings(n.containerModel),h(n.locator,n.containerModel)],this._getPartSettingsAsync("Get identity part settings.",{store:o.Part,keys:f},r)):Q.resolve(null)},n.prototype.getSharedPartSettingsAsync=function(){var f=this._options,r=f.partStateDefinition,n=r&&r.sharedProperties,t,i,u;return(n&&n.length>
0)?(t=[],i={},n.forEach(function(n){t.push(n.key);i[n.key]=n.property}),u={store:o.SharedPart,keys:t},this._getPartSettingsAsync("Get shared part settings.",u,i)):Q.resolve(null)},n.prototype._traceOperationWithSettings=function(n,t,i){if(this._trace){if(i){var r={};r[i]=t;t=r}y.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(n,this._options.part.toString(),d(t,null,2)))}},n.prototype._traceOperationWithKeys=function(n,t){this._trace&&y.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(n,this._options.part.toString(),d(t,null,2)))},n.prototype._getPartSettingsAsync=function(n,t,i){var f=this,u;return this._traceOperationWithKeys("BEGIN - "+n,t.keys),u=[this._options.services.sharedSettings.querySettings(t)],Q.all(u).then(function(u){var o,e={};return o=u[0]||{},t.keys.forEach(function(n){var t=o[n],f=c.isSerializedObject(t),u=f?c.fromSerializableObject(t):t;i?o[n]!==r&&i[n]&&s.setModelValue(e,i[n],u):$.extend(!0,e,u)}),f._traceOperationWithSettings("END - "+
n,e),e})},n.prototype._getOrCreateInstanceStatePropertyBindings=function(){if(!this._partInstanceState){var n=this._options.part;this._partInstanceState=new v(n.toString()+"-[PartInstanceState]",n.partState)}return this._partInstanceState},n}();t.PartSettingsManager=tt}(o||(o={})),o});define("MsPortalImpl/Parts/Parts.Error",["require","exports","f","./Parts","../Widgets/Widgets.PartError"],function(n,t,i,r,u){"use strict";var f;return function(){var n=i.Parts,t=n.PartKind,f=i.ViewModels,e=function(n){function t(t,i,r,u){n.call(this,t,i,r,u);i.container.contentState(f.ContentState.Error);i.internal.allowUiBlocking(!1)}return __extends(t,n),t.prototype._bindContent=function(n){var t=new u.ViewModel,i=this._viewModel.content,r;t.title=i.title||t.title;t.subtitle=i.subtitle||t.subtitle;t.reason=i.reason||t.reason;r=i.clickable;t.clickable=typeof r!="undefined"?r:t.clickable;this._control=new u.Widget($(n),t)},t.prototype.dispose=function(){i.disposeDisposable(this._control);n.prototype.dispose.
call(this)},t}(r.PartImpl);r.registerFactory(t[n.PartKind.Error],r.createPartFactory("",{partClass:e}))}(f||(f={})),f});define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","f","i","../../Base/Base.Events","../../Base/Base.Router","../../Base/Base.Selectable2","../../Base/Base.SelectableSet2","../../Extension/Extension.Definition.Locator","./UI.Composition.CloudName","MsPortalImpl/Resources/ImplScriptResources","../../Parts/Parts","../../Services/Services.AssetTypes.Utils","../../Services/Services.EditScopeManagement","../../Base/Telemetry","../Commands/UI.Commands","./UI.Composition","./UI.Composition.Base","./UI.Composition.BladeOpenerBase","./UI.Composition.CompositionBinder","./UI.Composition.ContextMenuContainer","./UI.Composition.PartSettingsManager","./UI.Composition.PropertyBinding","./UI.Composition.Security","../Commands/UI.ShellCommands","../../Widgets/Widgets.Common","../../Widgets/Widgets.Tile","../../Widgets/Widgets.UIElementBase","MsPortalImpl/Parts/Parts.Error"],
function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){"use strict";var ot;return function(t){function bi(n){return n&&n.toFriendlyString()}function nf(n,t){var i=!!t.first(function(t){return ru.isEqualDescriptor(t.extensionDescriptor,n.extension)});return i?Q(n.getAssetInstanceMetadataAsync()).then(function(i){var r=i&&t.first(function(n){return i.type===n.assetType&&a.compareAssetId(i.id,n.assetId)});r&&n.disableForAssetDeleted(!0,r.reason)}):Q()}function tf(n,t){return t.masterPartId===n.id&&ur(t.masterCommandName)}function fe(n,t){var i=n.services.desktop,r=i.tryCloseBlade.bind(i);return function(i,u){switch(i){case 1:case 2:var f=t.detailContainers.filter(function(t){var r=t.openInContextPane;return tf(n,t)&&i===1?!r:r});return f.length===0?!1:!f.some(function(n){return!r(n.id)});default:return t.returnValue=u,r(t.id,2)}}}function lr(n,t){t===void 0&&(t=!0);var i;return n&&(t&&!n.hasOwnProperty(w.PartContainerModelIdProperty)&&(n=ei(n),n[w.PartContainerModelIdProperty]=
ri.getUniqueId()),i=at.createObservableModel(n)),i}function nu(n,t){var i;return n&&t?(i={},gu(n,function(n){i[n]=null})):i=n,vi.toSerializableObject(i)}function tu(n){return vi.isSerializedObject(n)?vi.fromSerializableObject(n):{}}function rf(n,t,i,r,u){var f=new gr(n,t,null,i);return f.calculateInitialSize(),f.containerModel=lr(r),f.overridesModel=lr(u||{},!1),f}function gi(n){var t=n.partDefinition,i=n.adapter,r=t&&t.viewModel?t.viewModel:"N/A",u;return u=i?"AdapterPart. Extension: {0}, ViewModel: {1}, Wrapped ViewModel: {2}".format(i.extension.name,i.viewModelName,r):"ViewModel: {0}".format(r),"{0} ({1})".format(n.toString(),u)}function ee(n){var t=n.partDefinition;return t&&t.partKind===gt.Custom&&t.htmlTemplate&&!(t.htmlTemplate in n.extension.definition.htmlTemplates)}function oe(n,t,i){var r=n.getInputPropertyBindings();(i||[]).forEach(function(i){var u=r.properties.first(function(n){var r=n.compositionBindingDefinition;return n.sourceProperty===i.source.property&&r&&r.source&&
r.source.id===t.id});u||(er(n,r,[i]),i.source.id=t.id,n.bindings.push(i),n.save())})}function se(n,t){var i=n.getInputPropertyBindings(),r=n.bindings||[],u=r.filter(function(n){return n.source.scope!==fi.DetailsContainer});u.length!==r.length&&(i.properties.filter(function(n){var i=n.compositionBindingDefinition;return i&&i.source&&i.source.id===t.id}).forEach(function(n){i.removeProperty(n)}),n.bindings=u,n.save())}function uf(n){var t=n.adapter,i=t.inputPropertyBindings,r=i.targetModel;er(n,t.inputPropertyBindings,t.bindings,function(t){return r[t.targetProperty]=lt(),n.bindAgainstOverridesOrContainerModel(t)})}function he(n,t,i){var r=!!t;return t&&(t.assetType&&!t.assetIdInputProperty?(st.error("'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'{0}'.".format(n.locator.toString())),r=!1):!i&&!!t.editScopeType&&n.bindings&&n.bindings.some(function(n){return n.targetProperty===pi})&&(r=!1,st.error("Declaring an 'editScopeType' and an input binding with '"+
pi+"' as a target property is not supported. "+"A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '{0}'. Bindings: {1}.".format(n.toString(),JSON.stringify(n.bindings))))),r}function ce(n,t){var i=[],r=!0;return t&&t.invocationInputArguments&&t.invocationInputArguments.length&&(r=k.validateDetailsDefinition(t,i)),i.length&&yf.logDetailDefinitionError(i[0],n.toString(),t),r}function le(n,t){var i=[],r=at.validateInputBindings(n,t,i);return i.length&&st.error(i[0]+" Part:'"+n.toString()+"'."),r}function ae(n){var t=n.adapter,i=t?t.allInputsSet:n.allInputsSet;wi(n,function(){if(i()){var t=ff(n);t&&t.exists&&n.assetId(wt(t.value))}})}function ff(n){var i=n.adapter,r=i?i.inputPropertyBindings:n.getInputPropertyBindings(),t=r.properties.first(function(t){return t.targetProperty===n.assetInstanceDefinition.assetIdInputProperty});return t?ct(t.sourceModel,t.sourceProperty):null}function ve(n){var f,i,t,r,u;return n.isComposed&&(i=n.getViewModel(
),i&&(t=i.container,t&&(r=t.partTitle&&t.partTitle(),u=t.assetName&&t.assetName(),(r||u)&&(f={partTitle:r,assetName:u})))),f}function ef(n){return n&&n._msPortalFx_viewModelApiV2}function of(n){return n&&n._msPortalFx_viewModelApiV2_wrapper}function ye(t){if(!kr){var r=ht();kr=r.promise();i.require("./UI.Composition.BladeOpener",n).then(function(n){cr=n;r.resolve(n)})}return cr?t:kr.then(function(){return t})}function pe(){if(!dr){var t=ht();dr=t.promise();ti?t.resolve(ti):i.require("./UI.Composition.DynamicPartBinder",n).then(function(n){ti=n;t.resolve(n)})}return dr}function we(n){cr=n}function be(n){ti=n}function ke(n){return{property:n,modelType:t.inferredReferenceType,scope:fi.CurrentContainer,cardinality:tt.ReferenceCardinality.OneToOne}}function iu(n){return n&&n.modelType===t.inferredReferenceType}function sf(n){return n.isDynamicBinding&&!iu(n.source)}function de(t,i){return ir(t,"./UI.Composition.Selectable2Registrar",i,n)}var ii=s.Locator,bt=s.LocatorType,nr=r,ru=nr.Extension,
li=nr.TelemetryContext,uu=li.ContextType,fu=nr.ViewModels.Part,ai=i.Base,eu=ai.Diagnostics,ou=eu.Telemetry,ot=ai.EventTypes,ar=ai.Rpc.Internal,ki=ar.Measurement,kt=ai.Stopwatch.TelemetryStopwatch,ri=ai.Utilities,vi=ri.Internal.Serialization,su=i.Extension,dt=su.ReferenceType,hf=su.SetRequirement,si=i.Parts,gt=si.PartKind,ui=si.PartSize,tr=si.PartSizeHelper,hu=i.ViewModels,cf=hu.ShieldType,hi=w.CompositionType,at=d.CompositionBinder,pt=tt.PropertyBinding,fi=tt.ReferenceScope,cu=tt.PropertyBindings,lf=nr.Diagnostics,lu=v.EditScopeState,yi=y.Action,af=i.Helpers,vr=hu.PartLocation,ir=b.compositionRequire,au=ri.clone,vu=i.cloneAndRebindFunctions,yu=r.shellInterface,ht=af.Deferred,yr=ot.fxrecomposeframepart,pr=window,vt=jQuery,wr=pr.fx.environment,rr=wr.features,vf=c.Asset,ur=ri.isNullOrUndefined,st=eu.createLog(n),pu="fxs-part",yf={logDetailDefinitionError:function(n,t,i){st.error(n+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(i)))}},wu="-[ContainerModel]",pf="-[OverridesModel]",
wf="-[Inferred]",bf="-[Adapter]",kf="-[AdapterInputs]",df=k.PartContainerSelectable_ViewModelPath+".isSelected",gf=k.PartContainerSelectable_ViewModelPath+".isCommandSelected",ni=ou,fr=y.Source.Shell,ci=dt.Adapter,di=dt.AdapterInput,bu="internal.",pi=w.EditScopeIdPropertyName,er=at.setupPropertyBindings,wi=ko.computed,or=ko.isObservable,lt=ko.observable,sr=ko.reactor,ei=ko.toJS,ku=ko.toJSON,wt=ko.unwrap,ne=ko.utils,ge=Date.now,ct=pt.getModelValue,br=at.mapInputBindingDefinitions,hr=at.createAllInputsSetWatcherConfigExtended,te={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},ie=rr&&rr.autosettings,oi=rr.spinnerbehavior,du=rr.disablebladecustomization==="true",re=0,gu=i.forEachKey,ue=i.isFeatureEnabled("pov2"),cr=null,kr=null,ti=null,dr=null,yt,gr;t.handleAssetDeleted=nf;t.partName="Part";t.EmptyViewModel=fu.composePartViewModel(function(){return undefined});t.fxpartinputchanged="fxpartinputchanged",function(n){n[n.OldInputsNotHandled=
1]="OldInputsNotHandled";n[n.UnrecoverableError=2]="UnrecoverableError";n[n.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate";n[n.PartDefinitionNotFound=4]="PartDefinitionNotFound";n[n.IncorrectPartType=5]="IncorrectPartType";n[n.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition";n[n.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel";n[n.ViewModelMissing=8]="ViewModelMissing";n[n.ErrorLoadingControl=9]="ErrorLoadingControl";n[n.ErrorCreatingWidget=10]="ErrorCreatingWidget";n[n.TransitionedToErrorState=11]="TransitionedToErrorState"}(yt||(yt={}));gr=function(r){function s(n,i,u,f,e,o){o===void 0&&(o=1e3);r.call(this,n,i,[],u,f);this.bindings=[];this.editScopeId=lt();this.invocationThrottleDuration=25;this.allInputsSet=lt(!1);this.calledOnInputsSet=lt(!1);this.failedOnInputsSet=lt(!1);this.assetId=lt();this.triggeringLockedBladeSpinner=lt(!1);this._viewStateProperties=[];this._registrationDeferred=ht();this._disabled=!1;this._restoredFromJson=!1;this._perfData=
{instanceExtensionLoad:0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1};this._sequence=re++;this._rebindCount=0;this._hasRebindableInputs=!1;this._showShellCommands=!0;this._allInputPropertyBindingsBound=ht();this._onInputsSetCompleted=Q.defer();this._contentRevealed=Q.defer();this._contextMenuViewModels=null;this._containerInputsChanging=ko.observable(!1);this._updateRebindSequenceNumber();this._name=t.partName;this._vm=e||t.EmptyViewModel;this.partState={};this.bindings=[];this._showSpinnerTimeoutMillis=o;i&&(this._extensionName=ru.getWindowId(i.getExtensionLocator()));this.containerModel=null;this.overridesModel=lr({},!1);this.registerForDispose(this._partSettingsManager=new nt.PartSettingsManager)}return __extends(s,r),s.prototype.getViewModel=function(n,i){var r=t.EmptyViewModel,
u=this.adapter,f,e;if(n=n||dt.Part,n===dt.Part)r=this._vm;else if(n===dt.Command)if(f=this._contextMenuViewModels,f)r=f.getViewModel(n,i);else{var s=this._getCommands(),o=w.findCommand(s,i,this.toString()),h=o&&o.getViewModel();r=h||t.EmptyViewModel}else n===ci?r=u&&u.viewModel:n===di?(e=u&&u.inputPropertyBindings,r=e&&e.targetModel):st.error("Invalid model type '{0}' for part '{1}'.".format(n,this.locator.toString()));return r},s.prototype.getViewModelAsync=function(n,t){var i=this;return this._registrationDeferred.then(function(){var r,f,u;return n===dt.Command?(r=i._contextMenuViewModels,r?r.getViewModelAsync(n,t):(f=i._getCommands(),u=w.findCommand(f,t,i.toString()),u&&u.getViewModelAsync())):i.getViewModel(n)})},s.prototype.setViewModel=function(n){this._vm=n},s.prototype.setBladeOpener=function(n){this.registerForDispose(this._bladeOpener=n)},s.prototype.getBladeOpener=function(){return this._bladeOpener},Object.defineProperty(s.prototype,"isDisabled",{get:function(){return this.
_disabled},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"canClone",{get:function(){var n=this.awaitComposed().state()!=="pending",t=this.getInputPropertyBindings().allBound,i=this.partDefinition.partKind===gt.ResourceSummary;return n&&t&&!i},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"eligibleForBinding",{get:function(){return!this.containerModel},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"templateKey",{get:function(){var n=this.locator.toString(),t=this.containerModel;return t&&(n+="-"+ri.toSortedString(ei(t))),n},enumerable:!0,configurable:!0}),s.prototype.getTemplate=function(){var n=r.prototype.getTemplate.call(this),i=this.containerModel,t;return i&&(n.modelJson=ku(i)),n.overridesModelJson=ku(this.overridesModel),t=this.originalPartLocator,t&&(n.originalPartLocator=t.toJSON()),n},Object.defineProperty(s.prototype,"journeyPath",{get:function(){return this.getPartsContainer().journeyPath.concat(this.templateKey)},enumerable:
!0,configurable:!0}),Object.defineProperty(s.prototype,"dirtyAndNotSaving",{get:function(){return this.services.editScopeManager.getStateObservable(this.editScopeId())()===lu.Dirty},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"instanceDefinition",{get:function(){return this._partInstanceDefinition},enumerable:!0,configurable:!0}),s.prototype.getCompositionType=function(){return hi.Part},s.prototype.getPartSettingsManager=function(){return this._partSettingsManager},s.prototype.getPerfData=function(){return this._perfData},s.prototype.getSettingsModel=function(){var n=this._settingsModel,t;if(!n&&(t=this.getViewModel())){var u=ef(t.content),f=this.partDefinition,r=f&&f.partState,e=i.unique((r?(r.inputIdentityProperties||[]).concat((r.sharedProperties||[]).map(function(n){return n.property})):[]).concat(!u&&this._viewStateProperties||[]));this._settingsModel=n=au(t);n.content={};e.forEach(function(i){if(i.startsWith("content.")){var r=u?lt():ct(t,i).value;pt.setModelValue(
n,i,r)}})}return n},s.prototype.isOrganizable=function(){return du?!1:!0},s.prototype.dispose=function(n){this._releaseResources(n);[this._loadedMarker,this._readyMarker,this._revealedMarker,this._onInputsSetResolvedMarker].forEach(function(n){n&&ni.cancelTrace(n)});r.prototype.dispose.call(this,n)},s.prototype._setExtension=function(n){this.extension=n;this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)},s.prototype._releaseResources=function(n){var u,f,i,e,r,o;this._removeEventHandlers();this._clearLoadingReactor();u=this._inputBindings;u&&(u.unbind(),this._inputBindings=null);f=this._part;f&&(f.dispose(),this._part=null);i=this._vm;e=this.extension;e&&i&&i!==t.EmptyViewModel&&e.releaseViewModel(i);this._releaseAdapter();r=this._extenderVM;o=this._extenderVMExtn;r&&o&&(ri.disposeViewModelProperties(r),o.releaseViewModel(r));n||this._disposeEditScope();this._journey=null;this._vm=t.EmptyViewModel},s.prototype._clearLoadingReactor=
function(){var n=this._loadingReactorLifetime;n&&(n.dispose(),this._loadingReactorLifetime=null)},s.prototype._releaseAdapter=function(){var n=this.adapter,t;n&&(n.inputPropertyBindings.unbind(),ri.disposeViewModelProperties(n.viewModel),t=n.viewModel,t&&n.extension.releaseViewModel(t),this.adapter=null)},s.prototype.getInputPropertyBindings=function(){if(!this._inputBindings)this._inputBindings=new cu(gi(this),{},!1);return this._inputBindings},s.prototype.getAssetId=function(){var f=this,t=this.assetInstanceDefinition,e=t&&t.assetIdInputProperty;if(!e)return Q.reject();var i=function(n){var t=ff(f);t&&t.exists?n.resolve(wt(t.value)):n.reject()},n=Q.defer(),r=this.adapter,u=r?r.allInputsSet:this.allInputsSet;return u()?i(n):u.subscribe(this,function(t){t&&!n.promise.isFulfilled()&&i(n)}),n.promise},s.prototype.toJSON=function(){var n=r.prototype.toJSON.call(this),t,i;return n.assetInstanceDefinition=this.assetInstanceDefinition,n.partState=vi.toSerializableObject(this.partState||{}),n.
initialSize=this.initialSize,n.bindingsInitialized=this._bindingsInitialized,n.savedContainerState=ve(this),n.containerModel=nu(this.containerModel,this.modelContainsSensitiveData),n.overridesModel=nu(this.overridesModel,!1),n.originalPartLocator=this.originalPartLocator,t=this.adapter,i=this.bindings,n.adapterBindings=t&&t.bindings,n.bindings=t?i.filter(function(n){return n.source.scope===fi.DetailsContainer}):i,n},s.prototype.cloneAs=function(n){var i=this,u=ht(),t,r=this.widget?this.widget.options:null,f=[this.awaitComposed(),this.getInputPropertyBindings().awaitAllBound],e=this.adapter;return e&&f.push(e.inputPropertyBindings.awaitAllBound),vt.when.apply(vt,f).done(function(){var s=i.getNonDetailsContainerPropertyBindings(),e={},o,f;s.forEach(function(n){var t=ct(n.targetModel,n.targetProperty).value;pt.setModelValue(e,n.sourceProperty,ei(t))});o=ei(i.overridesModel);t=n(e,o);t.widgetState(vt.extend(!0,{},i.widgetState()));r&&r.size&&(t.initialSize=r.size(),t.initialSize===ui.Custom&&
(t.initialWidth=r.gridWidth(),t.initialHeight=r.gridHeight()));f=i._partSettingsManager;f&&f.saveIdentityPartSettings(t.containerModel);u.resolveWith(i,[t])}).fail(function(){u.rejectWith(i)}),u.promise()},s.prototype.clone=function(){var n=this;return this.cloneAs(function(t,i){return rf(n.services,n.locator,null,t,i)})},s.fromJSON=function(n,t){return w.createCompositionFromJSON(t,function(){var i=new s(n,ii.fromJSON(t.locator),t.widgetState,t.id);return i.loadPropertiesFromJson(t),i},function(i,r){var u=new s(n,i,null,t.id);return u.unrecoverableErrorMessage=r,u})},s.prototype.getAssetInstanceMetadataAsync=function(){var n=this,t=ht();return this._registrationDeferred.then(function(){var i;n.isDisabled||n.isDisposed()?t.resolve(i):n.getAssetId().then(function(t){i={id:t,type:n.assetType}}).finally(function(){t.resolve(i)})},function(){t.reject()}),t.promise()},Object.defineProperty(s.prototype,"assetType",{get:function(){var n=this.assetInstanceDefinition;return n&&n.assetType},enumerable:
!0,configurable:!0}),s.prototype.addWidgetToUI=function(n){var t=this.widget;n.parentElement.addChild(t);t.addChild(this._partContainer)},s.prototype.recompose=function(n){this._compose(n,ht(),!0)},s.prototype._compose=function(n,t,i,r){var u=this,o,e,h;i===void 0&&(i=!1);var f,c=this._getPrimaryExtensionName(),v=bi(this.locator),s=function(n,t){return u._completeTraceWithState(n,t)};r=r||{};o=function(n){return ni.startTrace({extension:c,source:fr,action:n,name:v})};this.calledOnInputsSet.subscribe(this,function(n){n&&(u._onInputsSetResolvedMarker=o(yi.OnInputsSetResolved))});this._onInputsSetCompleted.promise.then(function(){var t=u._readyMarker,n;t&&(u.readyTime=s(t,u._perfData),u._readyMarker=null);n=u._onInputsSetResolvedMarker;n&&(s(n,u._perfData),u._onInputsSetResolvedMarker=null)});this._contentRevealed.promise.then(function(n){var t=u._revealedMarker;t&&(u._perfData.contentRevealedCalled=n,u.revealedTime=s(t,u._perfData),u._revealedMarker=null)});this._registrationDeferred.then(
function(){nf(u,u.services.assetManager.deletedAssets);t.resolve()},function(){t.reject()});this._clearLoadingReactor();this.widget&&i?(this._partContainer=this.widget.element.find("."+pu),f=this.widget.options,f.commands.splice(0,f.commands.length),f.actionBarViewModel.update()):(this._partContainer=vt("<div class='"+pu+"'><\/div>"),f=new ft.ViewModel(this.id,this.widgetState()),f.inLockedContext=n.options.locked(),f.size()===undefined&&f.size(this.initialSize),f.size()===ui.Custom&&(f.gridWidth(Math.max(1,this.initialWidth)),f.gridHeight(Math.max(1,this.initialHeight))),f.largeInitialSize(this.largeInitialSize),(oi==="fade"||oi==="none")&&f.locked(n.options.locked()),this.widget=ft.createTileWidget(vt("<section/>"),f,this._getActions.bind(this)),this.widgetState(this.widget.saveViewSettings()),this.addWidgetToUI({parentElement:n,doNotSaveSettings:!0}));e=this.widget.element;this._recomposeHandler&&e.off(yr,this._recomposeHandler);e.on(yr,this._recomposeHandler=function(){var i=u.partDefinition;
i&&i.partKind===gt.Frame&&t.finally(function(){u._registrationDeferred=ht();u._compose(n,ht(),!0)})});oi==="delay"?(this._clearSpinnerTimeout(),f.isInBlockingLoadingState(!1),this._showSpinnerAfterTimeout(f)):oi==="fade"?f.isInBlockingLoadingState(!0):n.options.locked()||f.isInBlockingLoadingState(!0);e.data(w.CompositionInstanceDataName,this);h=function(n,t){u._menu=t};e.on(ot.fxregistermenu,h);this.registerForDispose(function(){e.off(ot.fxregistermenu,h)});var l=function(){if(u._loadedMarker=o(yi.PartLoaded),u._readyMarker=o(yi.PartReady),u._revealedMarker=o(yi.PartRevealed),u.unrecoverableErrorMessage&&u.unrecoverableErrorMessage.length>0)u._createErrorPart(u._partContainer[0],yt.UnrecoverableError,u.unrecoverableErrorMessage);else{u._locateDefinitionAndStartCompose(f);u._perfData.srcExtension=u._getSecondaryExtensionName(c);var t=u.createChildLifetime();n.options.locked.subscribe(t,function(n){u._toggleShellCommands(!n,f.commands)});u._toggleShellCommands(!n.options.locked(),f.commands)}
},y=r.delayLoad||function(n){return!ut.isElementFullyInViewport(n,0,!0).fullyVisible},a=r.delayLoadPromise;a&&y(e[0])?(this._loadDelayed=!0,a.finally(l)):l()},s.prototype._getPrimaryExtensionName=function(){var n=this.getPartsContainer(),i,t;return n&&(i=n.getCompositionType(),i===hi.Blade)?n.locator.getExtensionLocator().name:(t=this.locator,t&&t.getExtensionLocator().name)},s.prototype._getSecondaryExtensionName=function(n){var t=this.locator,i=this.extension,r=t&&t.getExtensionLocator().name,u=i&&i.name;return r!==n?r:u!==n?u:undefined},s.prototype._completeTraceWithState=function(n,t){var i=this,r=function(){return i._menu&&(t=vt.extend({},t,i._menu.getTelemetryInfo())),ni.completeTrace(n,t)};return this._creationState?li.usingState(r,this._creationState):r()},s.prototype._locateDefinitionAndStartCompose=function(n){var t=this,u=new kt,r,i=this._createErrorPart.bind(this);return this.services.finder.locateAsync(this.locator).then(function(n){return t._perfData.instanceExtensionLoad=
u.millisecondsElapsed,r=new kt,t._processLocatedDefinitionAsync(n)}).then(function(n){return pe().then(function(){return n})}).then(function(u){var s,f,o,e;if(t._perfData.referenceExtensionLoad=r.millisecondsElapsed,u){if(t._isRestoredPartLackingBinding(u))if(t.eligibleForBinding)t._bindingsInitialized=!1,t.bindings=[];else if(!u.canUseOldInputVersions){st.warning("[Definition Change] Bindings for part '{0}' have been changed in the definition in an incompatible way.".format(t));s={reason:lt(wr.isDevelopmentMode?c.PartError.titleSettingsDevMode:c.PartError.titleSettings),clickable:!1};i(t._partContainer[0],yt.OldInputsNotHandled,"Bindings for part have been changed in the definition in an incompatible way. Locator: {0}.".format(t.locator),s);return}if(f=t.adapter,t._restoredFromJson&&t._bindingsInitialized!==!1){var h=f?f.bindings:t.bindings,l=f?f.inputDefinitions:u.inputDefinitions,a=ti.inferInitialBindingsForInputDefinitions(t,l),v=a.filter(function(n){return h.every(function(t){return t.
targetProperty!==n.targetProperty})});[].push.apply(h,v)}else f?f.bindings=t._constructAdaptedBindings():t._setBindings(u),t.assetInstanceDefinition={assetType:u.assetType,assetIdInputProperty:u.assetIdInputProperty},f&&((f.assetType||f.adaptedPart.assetType)&&(t.assetInstanceDefinition.assetType=f.assetType||f.adaptedPart.assetType),f.assetIdInputProperty&&(t.assetInstanceDefinition.assetIdInputProperty=f.assetIdInputProperty)),o=t._partInstanceDefinition,e=o&&o.reference,e&&e.assetType&&(t.assetInstanceDefinition.assetType=e.assetType),t._bindingsInitialized=!0,t.save();if(t.partDefinition=u,ee(t))i(t._partContainer[0],yt.CustomPartWithMissingTemplate,c.UiCompositionPart.missingTemplateMessage);else return t._composeCommandsAndPart(n,t._partContainer)}else i(t._partContainer[0],yt.PartDefinitionNotFound,"Unable to find the definition for the part. Locator: {0}.".format(t.locator))}).then(null,function(n){i(t._partContainer[0],yt.ErrorLocatingPartDefinition,n)})},s.prototype._setBindings=
function(n){var r,t=this._partInstanceDefinition,i;t&&(r=t.inline?t.inline.bindings:t.reference.bindings);i=this._resolveInstanceAndTypeBindings(r,n.bindings);le(this,i)&&(this.bindings=this.bindings.concat(br(i,this)));this.bindings.length<=0&&this.locator.type===bt.PartType&&(this.bindings=ti.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions))},s.prototype._resolveInstanceAndTypeBindings=function(n,t){var r={},i;return(n&&t&&(t.forEach(function(n){n.isIdentityInput&&!!n.property&&(r[n.property]=!0)}),n.forEach(function(n){n.isIdentityInput=!!r[n.property]})),n&&t)?(i=n.slice(0),t.forEach(function(t){t.valuesFrom&&t.valuesFrom.length&&t.valuesFrom[0].referenceType===dt.Constant&&(n.some(function(n){return n.property===t.property})||i.push(t))}),i):n||t||[]},s.prototype._constructAdaptedBindings=function(){var n=this.adapter;return n.bindings.length<=0&&this.locator.type===bt.PartType?ti.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions):br(n.adaptedPart.bindings,
this)},s.prototype._isRestoredPartLackingBinding=function(n){if(this._restoredFromJson){var t=this.adapter,i=t?this._constructAdaptedBindings():br(n.bindings||[],this),r=t?t.bindings:this.bindings,u=function(n){return!n.optional&&r.firstIndex(function(t){return t.targetProperty===n.targetProperty})<0};return!!i.some(u)}return!1},s.prototype._getActions=function(){var n=this.services,t=new rt.UnpinFromStartboard(n).createAction(this),i=new rt.OpenContextMenu(n,c.ContextMenu.ariaLabel).createAction(this);return[i,t]},s.prototype.resetLayout=function(){var n=this.initialSize,r=tr.AllSizes[n>=0?n:tr.getDefaultSize().name],t=r.size,i=this.widget;i.element.trigger(ot.fxsizechange,[i.options.id,t.width,t.height])},s.prototype.clearIdentitySettings=function(){var n=this._partSettingsManager;n&&n.clearIdentityPartSettings()},s.prototype._processLocatedDefinitionAsync=function(n){var u=this,f=this.services.finder,r=n,t,i;switch(this.locator.type){case bt.PartInstance:case bt.StartboardPartInstance:
this._partInstanceDefinition=n;break;case bt.PartType:t=n;t&&t.reference&&(this._partInstanceDefinition={reference:{partTypeName:t.name,bindings:t.bindings,assetType:t.assetType,initialSize:t.initialSize}})}if(i=this._partInstanceDefinition,i){if(i.reference){var e=i.reference.extension||this.locator.getExtensionLocator().name,o=ii.forExtension(e,this.locator.getExtensionLocator().cloudName),s=o.withPartType(i.reference.partTypeName);return f.locateAsync(o).then(function(n){return u._setExtension(n),f.locateAsync(s)}).then(function(n){return n&&n.reference?u._processAdapterAsync(n,e,u.locator.getExtensionLocator().cloudName):n})}r=i.inline}return this.initialSize===ui.Custom&&(this.initialWidth=r.initialWidth,this.initialHeight=r.initialHeight),this._setExtension(f.locate(this.locator.getExtensionLocator())),ht().resolve(r).promise()},s.prototype._processAdapterAsync=function(n,t,i){var r=this,u=ii.forExtension(n.reference.extension||t,i),e=u.withPartType(n.reference.partTypeName),f=this.
services.finder;return f.locateAsync(u).then(function(t){var u="{0} (AdapterPart. Extension: {1}, ViewModel: {2})".format(r.toString(),r.extension.name,n.viewModel),i;return r.adapter={extension:r.extension,viewModel:null,viewModelName:n.viewModel,viewModelId:u,bindings:r._adapterBindings||[],inputDefinitions:n.inputDefinitions,adaptedPart:r._partInstanceDefinition.reference,allInputsSet:lt(!1),calledOnInputsSet:lt(!1),failedOnInputsSet:lt(!1),inputPropertyBindings:new cu(u,{},!1),assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},r._partInstanceDefinition={name:r._partInstanceDefinition.name,reference:n.reference},i=r.adapter.adaptedPart.assetType,i&&(r._partInstanceDefinition.reference.assetType=i),r._setExtension(t),f.locateAsync(e)}).then(function(i){var u=ht();return i&&i.reference?(st.error("Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(r.toString(),r.adapter.
extension.name,n.reference.partTypeName,i.reference.extension||t,i.reference.partTypeName)),u.reject()):(r._setBindings(i),u.resolve(i)),u.promise()})},s.prototype.getTitle=function(){var t=this.getViewModel(),n;return t&&(n=t.container,n)?n.partTitle&&n.partTitle()||"":""},s.prototype._composeCommands=function(n){var t=this,i=p.getCommandGroupForDefinitionItem(this.services.finder,this.extension.name,this.partDefinition,this.extension.cloudName),r=[],u={viewModelName:this.toString()+wu,viewModel:this.containerModel};i&&(i.commands.forEach(function(n){if(t._canPopulateCommand(n)){var i=new p.ExtensionCommandMenuItemImpl(t.extension,t,n,t.partDefinition,t.services,u);r.push(i)}}),n.splice.apply(n,[0,0].concat(r)))},s.prototype._canPopulateCommand=function(n){var t=this.parent&&this.getPartsContainer();return t?n.details&&t.openInContextPane?(st.error("Part '{0}' cannot have the open blade command '{1}', because it is inside the context blade.".format(this.toString(),n.name||n.text)),!1):
!0:!0},s.prototype.disableForAssetDeleted=function(n,t){var i,f,r,u;this._disabled=!0;i=this._vm;i&&i.container&&(f=this._getNotFoundMessage(),f(vf.deletedTitle));r=this.widget;r&&r.options&&(u=this.widget.options.commands,u.splice(0,u.length,new rt.UnpinFromStartboard(this.services)));this.save();st.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))},s.prototype._composeCommandsAndPart=function(n,t){try{this._composeCommands(n.commands);this._composePart(t,n);this._attachEventHandlers(t)}catch(i){return vt.Deferred().reject(i).promise()}},s.prototype._attachEventHandlers=function(n){var i=this,r=function(n,t){i.widgetState(t);i.save();n.stopPropagation()},f=function(n,t){i._setPartViewModelSize(t)},e=function(){i._setPartContainerSize(n.width(),n.height())},o=function(n,t){i._handleRightClick(n,t)},s=function(n,t){t.masterPartId=i.id},h=function(n,t){n.stopPropagation();var r=i.locator.getExtensionLocator();i.services.desktop.pinMultipleParts(t.partReferences,
r.name,r.cloudName)},t=this.widget.element;t.on(et.Widget.viewSettingsChanged,r);t.on(ot.fxsizechanged,f);t.on(ot.fxwidthchanged,e);t.on(ot.fxrightclick,o);t.on(ot.fxensurebladevisible,s);t.on(u.fxpinmultipleparts,h);this.registerForDispose(function(){t.off(et.Widget.viewSettingsChanged,r);t.off(ot.fxsizechanged,f);t.off(ot.fxwidthchanged,e);t.off(ot.fxrightclick,o);t.off(ot.fxensurebladevisible,s);t.off(u.fxpinmultipleparts,h)})},s.prototype._removeEventHandlers=function(){var n=this.widget&&this.widget.element;this._onControlError&&(n.off(ot.fxportalcontrolloadfailed,this._onControlError),this._onControlError=null);this._onErrorClick&&(n.off(ot.fxerrorpartclicked,this._onErrorClick),this._onErrorClick=null);this._recomposeHandler&&(n.off(yr,this._recomposeHandler),this._recomposeHandler=null);this._disposeOpenInTabListeners()},s.prototype._toggleShellCommands=function(n,t){this._showShellCommands=n;g.composeShellCommands(this,t,this._showShellCommands,this.services)},s.prototype._getPartContext=
function(){var n,t=this.getPartsContainer(),r=!1,u=!1,i;return t&&(i=t.getCompositionType(),i===hi.Blade&&(n=t,r=!0),u=i===hi.Startboard),n=n||{},{id:bi(this.locator),instanceId:this.instanceId,bladeId:bi(n.locator),bladeInstanceId:n.instanceId,onBlade:r,onStartBoard:u,bladeCustomized:n.isCustomized&&n.isCustomized(),loadDelayed:!!this._loadDelayed}},s.prototype._updateRebindSequenceNumber=function(){this.instanceId="Part_"+wr.sessionId+"_"+this._sequence+"_"+this._rebindCount++},s.prototype._getPartViewModelAsync=function(n,t,r,u,f,e,o){var s=this,c=k.needContainerSelectable(this.partDefinition.details),l=h.needInternalProperty(this.extension.name,this.partDefinition.details),a=new kt,v=li.provideContext(function(){s._creationState=li.getState();var i=s.parent&&s.getPartsContainer(),o=i?i.getCompositionType():hi.Unknown,h=i?o===hi.Startboard?vr.Dashboard:vr.Blade:vr._Internal_None,u=i&&i.bladeDefinition,a=u&&u.templateBlade?1:0;return s.extension.getPartViewModel(n,{initialState:ei(s.
partState),createSelectable:c,createHubsInternalCloudNameProperty:l,partSize:t,partLocation:h,collapsed:r,onInputsSetParameters:f,onViewModelAcquired:e&&function(n){of(n&&n.content)||e(n)},locator:s.locator,containerType:a})},uu.Part,this._getPartContext());return v.then(function(n){var u,t,f=n&&n.content,h,c,r;return of(f)?(t=vu(n),t.content=f.chrome,h=ht(),i.resolveWhen(h,s,f.viewModel),u=h.then(function(t){var i=vu(n);return i.content=t,e&&e(i),i}),s._setupLoadingReactor(o,n.container.operations)):u=t=n,s.partDefinition.shareVmWithParentBlade&&(c=s.parent,r=c.parent,r.setViewModelForTemplateOrMenuBlade(t),r.setInputsSetPromise(s._onInputsSetCompleted.promise),yu(n.container).closeBlade(fe(s,r))),u}).then(function(n){var r=s.services.finder,t=r.locate(s.locator),e=new kt,i=n&&n.content;return f&&at.notifyOnInputsSetCalled(u,f,n&&n.onInputsSetPromise),t&&t.reference&&t.reference.extenderViewModel?(s._extenderVMExtn=r.locate(s.locator.getExtensionLocator()),s._extenderVMExtn.getViewModel(
t.reference.extenderViewModel).then(function(r){return r&&r.content?i&&or(i.extenderViewModel)?(s._extenderVM=r,i.extenderViewModel(r.content)):st.error("Part '{0}' defines extender view model '{1}' but the referenced part is not marked as extensible.".format(s.toString(),t.reference.extenderViewModel)):st.error("Extender view model '{0}' for part '{1}' must be an object.".format(t.reference.extenderViewModel,s.toString())),n}).finally(function(){s._perfData.extenderViewModelLoad=e.millisecondsElapsed})):n}).finally(function(){s._perfData.partViewModelLoad=a.millisecondsElapsed})},s.prototype._getAdapterViewModelAsync=function(){var n=this;if(!this.adapter)return ht().resolve(null).promise();uf(this);var t=hr(this._getAdapterAllInputsSetWatcherConfig()),r=at.loadOnInputsSetParameters(t),i=this.adapter;return r.then(function(r){n._earlyAdapterOnInputsSet=!!r;n._perfData.earlyOnInputsSetAdapter=n._earlyAdapterOnInputsSet;var u=new kt;return i.extension.getViewModel(i.viewModelName,{onInputsSetParameters:
r}).then(function(n){return i.viewModel=n,r&&at.notifyOnInputsSetCalled(t,r,n&&n.onInputsSetPromise),t}).finally(function(){n._perfData.adapterViewModelLoad=u.millisecondsElapsed})})},s.prototype._bindAssetNameFromAdapter=function(){var i=this,n,t;this.adapter&&(n=ct(this.adapter.viewModel,"content.assetName"),n.exists)&&(or(n.value)?(t=n.value,wi(this,function(){var r=t(),n=i._vm;!ur(r)&&n&&n.container&&pt.setModelValue(n,"container.assetName",r)})):st.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(this.adapter.viewModelId)))},s.prototype._composePart=function(n,t){var i=this,o;if(!this.isDisposed()){var s=this.locator,h=this.partDefinition,p=h.partKind,u=l.getPartFactory(this._extensionName,h,this.extension.definition.htmlTemplates),r,f,a;if(u){t.supportedSizes(u.supportedSizes);this._inputBindings=null;this.getInputPropertyBindings();var v=this._getAdapterViewModelAsync(),e=this.services.finder.
locate(s),w=e&&e.reference&&e.reference.extenderViewModel,y=this.bindings||[],b=y.some(function(n){return n.source&&n.source.scope===fi.DetailsContainer}),k=this.adapter&&y.some(function(n){return n.source&&n.source.modelType===ci});w||b||!this.extension.canUseInputsSetParameters(s)?f=ht().resolve(null).promise():(o=function(){return i.isDisposed()?ht().resolve(null).promise():(i._registerInputPropertyBindings(),r=hr(i._getAllInputsSetWatcherConfig()),at.loadOnInputsSetParameters(r))},f=k?v.then(o):o());f=ye(f);this._vmPromise=f.then(function(f){if(i.isDisposed()){i._releaseResources();return}i._earlyOnInputsSet=!!f;i._perfData.earlyOnInputsSetPart=i._earlyOnInputsSet;var e=i.partDefinition,l=e.partKind===gt.ResourceSummary?i._getSummaryPartViewModelState():null,h=i.widget,o=h&&h.options,s=o?o.size():i.initialSize,a=i._getPartViewModelAsync(e.viewModel,s,l,r,f,r&&i._setupInvocationProperties.bind(i,u.viewStateProperties),t);return vt.when(a,v).fail(function(t){i._createErrorPart(n[0],yt.
ErrorAcquiringViewModel,t)}).done(function(f,h){var l=new kt;if(i._vm=f,f){if(i.isDisposed())i._releaseResources();else if(!i.isDisabled){i._bindAssetNameFromAdapter();i.widget.element.on(ot.fxportalcontrolloadfailed,i._onControlError=function(n,t){i._createErrorPart(i._partContainer[0],yt.ErrorLoadingControl,t)});e.partKind===gt.ResourceSummary&&i._autoOpenSettingsFromSummary();var a=o?o.size():i.initialSize,v=a!==s,y=e.partKind===gt.Provisioning;v&&i._setPartViewModelSize(a);ef(f.content)||i._setupLoadingReactor(t,f.container.operations);t.userResizable((!du||i.getCompositionType()===hi.StartboardPart)&&si.ResizeMode[e.resizeMode]===si.ResizeMode[si.ResizeMode.User]);v?i.extension.processMessages().finally(function(){i.isDisposed()||i._setupPartWidget(n,u,r,h,s,y,l)}):i._setupPartWidget(n,u,r,h,s,y,l)}}else i._createErrorPart(n[0],yt.ViewModelMissing,c.UiCompositionPart.viewModelRequired)})})}else a="Incorrect part type '{0}'.".format(p),this._createErrorPart(n[0],yt.IncorrectPartType,
a)}},s.prototype._setupPartWidget=function(n,t,i,r,u,f,o){var s=this,h=this.widget,v=this.getViewModel(),l,c,a;this._perfData.prepareViewModel=o.millisecondsElapsed;l=new kt;tr.isAdaptiveWidth(u)||(c=h.element.width(),a=h.element.height());e.setSelectableContext(this,this._vm,this._partContainer);this._createPartWidget(t,v,f).then(function(){var f,u;if(!s.isDisposed()&&(s.partDefinition.shareVmWithParentBlade||sr(s,function(){var n=s._getNotFoundMessage()();s._part.notFoundMessage(n)}),c||(c=h.element.width(),a=h.element.height()),s._setPartContainerSize(n.width(),n.height()),s.register(t.viewStateProperties,i,r),ae(s),s._ensureAssetAffinity(),s._perfData.finalizePartCompose=l.millisecondsElapsed,s.partDefinition.resizeMode===si.ResizeMode.Programmatic)){if(f=s.extension&&s.extension.name,f!=="AppInsightsExtension"&&f!=="SamplesExtension")return;u=yu(s._vm.container);u.autoSize.subscribe(s,function(n){if(n){u.autoSize(!1);var i=s.widget,t=i.element,r=t.find(".fxs-part-content"),f=r.find(
"> div");if(f.length!==1)return;var e=f[0],o=r[0],h=t.outerWidth()+Math.floor(e.clientWidth-o.clientWidth),c=t.outerHeight()+Math.floor(e.clientHeight-o.clientHeight);t.trigger(ot.fxsizechange,[i.options.id,h,c])}});u.resize.subscribe(s,function(n){if(n&&n.width&&n.height){var t=tr.getGridPixelSize(n.width,n.height);s.widget.element.trigger(ot.fxsizechange,[h.options.id,t.width,t.height])}})}},function(t){s._createErrorPart(n[0],yt.ErrorCreatingWidget,t)})},s.prototype.register=function(t,i,r){var u=this,o=this.parent&&this.getPartsContainer(),s,h,f,e;this._removeOutputArgumentValuesFromContainerModel();(this.bindings||[]).forEach(function(n){var t=n.source.modelType;u._hasRebindableInputs||n.source.scope!==fi.CurrentContainer||t!==dt.BladeInput&&t!==ci&&t!==di||(u._hasRebindableInputs=!0)});this._listenForPartMutation();this.adapter&&!r&&uf(this);i||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm));this._partSettingsManager.configureInstanceProperties(
this._viewStateProperties);this._partSettingsManager.initialize();ir(this,"./UI.Composition.SelectableRegistration",function(n){n.listenForRegistrationChanges(u,u._vm,u)},n);de(this,function(n){n.autoRegisterSelectables(u,u._vm,u);var t=n.RestoreContextMenuSelectableStatePipeline.createPipeline(u,{viewModel:u._vm},u);t.startTask(undefined)});s=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(o);h=new kt;f=function(){u._finishCompose(o,s,h)};this.partDefinition.shareVmWithParentBlade?setTimeout(f):this.extension.processMessages().finally(f);this.save();i||(i=hr(this._getAllInputsSetWatcherConfig()));i.bindableTarget.viewModel=this._vm;e=i.onInputsSetCoordinatorState;i.onInputsSetCoordinatorState=wi(this,function(){return u._containerInputsChanging()?0:e()});at.setupAllInputsSetWatcherFromExtendedConfig(i);this.adapter&&(r||(r=hr(this._getAdapterAllInputsSetWatcherConfig())),r.bindableTarget.viewModel=this.adapter.viewModel,at.setupAllInputsSetWatcherFromExtendedConfig(r));
ti.listenForConfigurationChanges(this,r&&r.onInputsSetCoordinatorState,e)},s.prototype._finishCompose=function(n,t,i){var r=this,u,e,f;this.isDisabled||this.isDisposed()||(n&&n.notifyPartComposed(this),this._registrationDeferred.resolve(),u=[t.awaitAllBound],this.adapter&&u.push(this.adapter.inputPropertyBindings.awaitAllBound),e=i.millisecondsElapsed,f=this._allInputPropertyBindingsBound,vt.when.apply(vt,u).done(function(){var n=r._perfData;f.resolve();n.allInputBindingsBoundPreprocess=e;n.allInputBindingsBound=i.millisecondsElapsed;r._loadedMarker&&(r.loadTime=r._completeTraceWithState(r._loadedMarker,n),ni.trace({source:fr,action:yi.PartLoadedNoExtensionDerived,actionModifier:ou.ActionModifier.Complete,name:bi(r.locator),duration:r.loadTime-n.referenceExtensionLoad-n.instanceExtensionLoad,data:n}),r._loadedMarker=null)}).fail(function(){f.reject()}),this.save())},s.prototype._registerInputPropertyBindings=function(){var n=this,i=[],r=[],u=[],t;this._journey=this.services.desktop.getActiveJourney(
);(this.bindings||[]).forEach(function(n){n.source.scope===fi.DetailsContainer?u.push(n):r.push(n);!n.isIdentityInput||i.push(n.targetProperty)});this._partSettingsManager.configure(this._getPartSettingsManagerConfig(i,this._viewStateProperties));t=this.getInputPropertyBindings();er(this,t,u);er(this,t,r,function(t){return n.adapter?n.adapter?n.bindAdaptedInput(t):void 0:n.bindAgainstOverridesOrContainerModel(t)});this._setEditScope();this._setupJourneyEditScopeReactor()},s.prototype.bindAdaptedInput=function(n){var t=n.source,i=t&&t.modelType;switch(i){case ci:return{sourceModel:this.adapter.viewModel,sourceModelName:this.toString()+bf};case di:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this.toString()+kf}}},s.prototype.getNonDetailsContainerPropertyBindings=function(n){n===void 0&&(n=!0);var t=this.adapter,r=n&&t?t.inputPropertyBindings:this.getInputPropertyBindings(),i=[];return r.properties.forEach(function(n){var t=n.compositionBindingDefinition,
r=t&&t.source&&t.source.scope;r!==fi.DetailsContainer&&i.push(n)}),i},s.prototype.bindAgainstOverridesOrContainerModel=function(n){var t,r,i,u;if(n.source.id!==this.id){if(sf(n))return null;if(t=n.source.property,r=this.overridesModel,ct(r,t).exists)return{overridesConstantBindings:!0,sourceModelName:this.toString()+pf,sourceModel:r};if(i=this.containerModel,i&&ct(i,t).exists)return{sourceModelName:this.toString()+wu,sourceModel:i};if(iu(n.source))return u={},pt.setModelValue(u,t,undefined),{sourceModelName:this.toString()+wf,sourceModel:u}}},s.prototype._setupInvocationProperties=function(n,t){var r=this,i=this.partDefinition;(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)||(this._setViewStateProperties(i.viewStateProperties,n),this.setBladeOpener(new cr.BladeOpener(this._getBladeOpenerConfig())),he(this,this.partDefinition,this._restoredFromJson)&&i.details&&i.details.length&&(i.details.forEach(function(n){ce(r,n)&&r._registerInvocationProperty(n)}),this._setupOpenInTabListenerForSelectables(
)))},s.prototype.selectOnReady=function(n,t){var i=this;return Q(this.awaitComposed().then(function(){return i._allInputPropertyBindingsBound.promise()}).then(function(){var r=ht(),u=i._part.selectOnReady(n||function(){return!0},t);return u.then(r.resolve,r.reject),r.promise()}))},s.prototype.activateSelection=function(n,t,i){var u=this,r,f,e;return i=i||function(){return!0},r=k.getSelectablePath(n),e=this.awaitComposed().then(function(){var n={selectablePath:r,execute:function(n){var i=ct(n,r);if(!i.exists){st.error("Part '{0}': Model '{1}' does not contain value under the selectable path '{2}'.".format(u.toString(),JSON.stringify(ei(n)),r?r:"NULL"));f=Q.resolve(!1);return}f=t(wt(i.value))}};return u._part.selectOnReady(i,n)}),Q.all([e,f]).then(function(n){return n[0]&&n[1]},function(n){return st.error("Fail to activate the selection for part '{0}'. The reason is {1}.".format(u.toString(),n.stack||n.message||n)),!1})},s.prototype.getSelectableAsync=function(n){return this.getViewModelAsync(
).then(function(t){var r=typeof n=="string"?n:k.getSelectablePath(n),i=ct(t,r);return i.exists?wt(i.value):null})},s.prototype._getBladeOpenerConfig=function(){var n=this;return{services:this.services,masterModelId:gi(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,isBladeOpenedByMaster:tf.bind(undefined,this),onBladeOpened:function(t){Q(t.awaitComposed()).then(function(){return Q.allSettled(t.children.map(function(n){return n.awaitChildrenOnInputsSetsResolved()}))}).finally(function(){var t=n._menu;t&&t.onDetailBladeReady()})},addOutputBindings:function(t,i){oe(n,t,i)},removeOutputBindings:function(t){se(n,t)},configureBladeDescriptor:function(t){t.masterPartId=n.id;t.bindings&&t.bindings.forEach(function(i){i.source&&i.source.id===n.id&&(t.model[i.targetProperty]=ei(ct(n._vm,i.source.property).value))})},initialViewModelState:ei(this.partState)}},s.prototype.loadState=function(
n){var i=this;this.partDefinition&&n&&this._vm&&this._vm!==t.EmptyViewModel&&this._viewStateProperties.forEach(function(t){var r=ct(n,t);r.exists&&t.substr(0,bu.length)!==bu&&pt.setModelValue(i._vm,t,r.value)})},s.prototype._setupLoadingReactor=function(n,t){var i=this,r;this.partDefinition.partKind!==gt.Provisioning&&(this._loadingReactorLifetime=this.createChildLifetime(),sr(this._loadingReactorLifetime,function(){var r=t.inProgress();n.hasOngoingOperation(r&&!n.locked());i.triggeringLockedBladeSpinner(r&&n.locked())}),r=this.getBindableContainer(),r&&r.bladeDefinition&&r.bladeDefinition.templateBlade&&(sr(this._loadingReactorLifetime,function(){r.shieldType&&r.shieldType(i._vm.container.operations.shieldType())}),sr(this._loadingReactorLifetime,function(){r.isUiBlocked&&r.isUiBlocked(i._vm.container.operations.blockingUi())})),t.blockingUi.subscribe(this._loadingReactorLifetime,function(t){var r,u;oi==="delay"?(i._clearSpinnerTimeout(),t?n.isInBlockingLoadingState()||i._showSpinnerAfterTimeout(
n):n.isInBlockingLoadingState(!1)):oi==="fade"?n.isInBlockingLoadingState(t):(r=i._vm.container.operations.shieldType()===cf.Translucent||n.locked(),n.isInBlockingLoadingState(t&&!r));t||(u=n.hasOngoingOperation(),i._contentRevealed.resolve(u),i._contentRevealedTime=i._contentRevealedTime||ki.getTimestamp())}),t.blockingUi()||(this._contentRevealed.resolve(t.inProgress()),this._contentRevealedTime=ki.getTimestamp(),this._clearSpinnerTimeout(),n.isInBlockingLoadingState(!1)))},s.prototype._traceRevealed=function(n){if(!this._revealTraced&&(this._revealTraced=!0,ar.messageContext)){var s=ar.messageContext,r=fr,u=this._getPrimaryExtensionName(),f=bi(this.locator),e=n||ki.getTimestamp(),o=s.initiatingTimestamps,t=o.operations[ki.ON_INPUTS_SET_CALLED],i=o.operations[ki.CONTENT_REVEALED];t&&i&&(ni.trace({timestamp:i.end,extension:u,source:r,action:"ExtPartInitialDataLoaded",name:f,actionModifier:ni.ActionModifier.Complete,duration:i.end-t.begin}),ni.trace({timestamp:e,extension:u,source:r,action:
"ExtPartInitialDataReceived",name:f,actionModifier:ni.ActionModifier.Complete,duration:e-t.begin}))}},s.prototype._showSpinnerAfterTimeout=function(n){this._spinnerTimeout=setTimeout(function(){n.isInBlockingLoadingState(!0)},this._showSpinnerTimeoutMillis)},s.prototype._removeOutputArgumentValuesFromContainerModel=function(){var n=this.partDefinition,t=this.containerModel;t&&n&&n.details&&n.details.forEach(function(n){n.outputArguments&&n.outputArguments.forEach(function(n){n.valuesFrom&&n.valuesFrom.forEach(function(n){ct(t,n.property).exists&&pt.setModelValue(t,n.property,undefined)})})})},s.prototype._getPartSettingsManagerConfig=function(n,t){return{services:this.services,part:this,instanceProperties:t,partViewModelId:gi(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:n}},s.prototype._listenForPartMutation=function(){var n=this,r=this.partDefinition,t,u=this._vm.container,i;u.mutate&&!r.shareVmWithParentBlade&&(i=this.createChildLifetime(
),u.mutate.subscribe(i,function(u){var f=n.locator.getExtensionLocator(),e;if(u.partName)t=u.extensionName?ii.forExtension(u.extensionName,f.cloudName).withPartType(u.partName):f.withPartType(u.partName);else{if(e=r.assetTypeDefinition,!e){st.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(n.locator.toString()));return}t=ii.forExtension(f.name,f.cloudName).withPartType(e.partName)}var o=n.getPartsContainer(),s=o&&o.locator&&o.locator.type===bt.Blade,h={newPartContainerModel:u.containerModel,preventNewPartActivation:u.preventActivation||s,caller:"mutation"};n.services.desktop.replacePart(n,t,h).fail(function(){var i="Unable to replace provisioning part '{0}' with the part for the created asset defined by the locator '{1}'.".format(n.locator.toString(),t.toString());st.error(i)}).finally(function(){n._disposeEditScope();i.dispose()})}))},s.prototype._updateForHasPermissions=function(n){var i=this;return this.
_vmPromise.then(function(){var r=i._vm,u,f;r===t.EmptyViewModel||i.isDisposed()?st.warning("Part '{0}' has not retrieved view model when checking permissions.".format(i.locator.toString())):(u=r.container,f=i.widget,n?u.unauthorizedMessage(null):(f&&f.options.isInBlockingLoadingState(!1),u.unauthorized(),r.updatePartForUnauthorized()))})},s.prototype._getAllInputsSetWatcherConfig=function(){var n=this,t=this.widget,i={bindableTarget:{viewModelName:gi(this)},propertyBindings:this.getInputPropertyBindings(),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:function(i,r){r.finally(function(){n._onInputsSetCompleted.resolve();ue||n._traceRevealed(n._contentRevealedTime);n._contentRevealed.resolve(!1);n._lastRebindOnInputsSetProperties&&(vt.isEmptyObject(n._lastRebindOnInputsSetProperties)||w.deepSubset(i,n._lastRebindOnInputsSetProperties))&&t&&t.
options.isInBlockingLoadingState(!1)})},beforeViewModelPropertyUpdate:function(t){if(n.partDefinition.permissions){var i=ht(),r=new kt,u=n.locator.toString();return it.checkPermissions(n.partDefinition.permissions,hf.All,t,n.partDefinition.assetType,n.extension.name,n.services,n.extension.cloudName,u).then(function(t){n._updateForHasPermissions(t).then(null,function(n){st.error(n)});i.resolve(t)}).catch(function(n){i.reject(n)}).finally(function(){n._perfData.checkPermissions=r.millisecondsElapsed}),i.promise()}return ht().resolve(!0).promise()},getInputsMetadata:function(){var t=ti.getConfigurableInputsMetadata(n);return Object.keys(t).forEach(function(n){var i=t[n];(i&&i.bindingSources||[]).forEach(function(n){delete n.sourceReference})}),t},onInputsSetCoordinatorState:lt(1)};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(i.getStateAsync=function(){var t=Q.defer();return n._partSettingsManager.getPartSettingsAsync().then(function(i){n._part&&n.
_part.partSettingFailed(!1);t.resolve(i)},function(i){st.error("Failed to retrieve part settings for part '{0}'.".format(n.toString()));n._part&&n._part.partSettingFailed(!0);t.reject("Failed to retrieve part settings for part '{0}'. Details: {1}".format(n.toString(),i))}),t.promise}),i},s.prototype._getAdapterAllInputsSetWatcherConfig=function(){var n=this.adapter;return{bindableTarget:{viewModelName:n.viewModelId},propertyBindings:n.inputPropertyBindings,allInputsSet:n.allInputsSet,calledOnInputsSet:n.calledOnInputsSet,failedOnInputsSet:n.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,onInputsSetCoordinatorState:lt(1)}},s.prototype.notifyDetailBladesRehydrated=function(n){!this.isComposed||this.isDisabled||this.isDisposed()||this._bladeOpener.notifyDetailBladesOpened(n)},s.prototype.notifyDetailBladeClosed=function(n){var t=this;this.awaitComposed().done(function(){var r=n.masterCommandName,i=t._vm.container;t.isDisabled||t.isDisposed()||!ur(r)||t.
_bladeOpener.notifyDetailBladeClosed(n);i&&i.selectable&&!ur(r)&&i.selectable.isCommandSelected(!1)})},s.prototype.beforeActivateCommandMenuItems=function(n){n.isControlContextMenu||(this._contextMenuViewModels=null)},s.prototype._handleRightClick=function(t,i){var r=this,u=i&&i.listData&&i.listData.selectableSet,f,e;this.isDisabled||this.isDisposed()||(u instanceof o.SelectableSet2&&u.commandGroupProvider?(f=ne.peekObservable(i.viewModel.data),u.commandGroupProvider(f).then(function(n){var u=au(i,!1,!1);u.viewModel=f;u.commandGroupOwner=n[0].owner;u.commandGroup=n[0].id;r._determineExtensionAndTriggerContextMenu(t,u)})):(e=o.isSelectableSet2(u)?undefined:u,e&&e._msPortalFxSupplyCommands?ir(this,"./UI.Composition.ContextMenuV2",function(n){var u={partComposition:r,services:r.services},f=n.OpenContextMenuPipeline.createPipeline(r,u,r);f.startTask({dataItem:i.viewModel,extension:r.extension,contextMenuArgs:i,evt:t})},n):this._determineExtensionAndTriggerContextMenu(t,i)))},s.prototype._determineExtensionAndTriggerContextMenu=
function(t,i){var u=this,e=this.services,r=this.extension,o=r.cloudName,s,f;r.extension.name===ai.Constants.ExtensionNames.Hubs&&(o=i.viewModel.browse_cloudName);s=function(n){var t=Q(e.finder.locateAsync(ii.forExtension(n.commandGroupOwner,o)));return t.fail(function(){st.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(n.commandGroupOwner,n.commandGroup,r.name))}),t};f=function(n,r){u._contextMenuViewModels=n.fireContextMenuEvent(e,u,r,t,i,u._showShellCommands,u._bladeOpener)};ir(this,"./UI.Composition.ContextMenuContainer.DemandLoad",function(n){i.commandGroupOwner&&i.commandGroupOwner!==r.name?s(i).then(function(t){f(n,t)}):f(n,r)},n)},s.prototype.isSelected=function(){var t=wt(this._vm.container).selectable,n=wt(t);return n&&wt(n.isSelected)},s.prototype.awaitComposed=function(){return this._registrationDeferred.promise()},s.prototype.awaitOnInputsSetComplete=function(){return this._onInputsSetCompleted.promise},s.prototype.awaitContentRevealed=
function(){return this._contentRevealed.promise},s.prototype._createErrorPart=function(n,t,i,r){var c=l.getPartFactory(this._extensionName,{partKind:gt.Error}),e=this.locator,o=this.extension,s=fu.composePartViewModel(function(){return r=r||{},r.title=lt(e&&e.name),r.subtitle=lt(o&&o.name),r}),h=lf.getLogFriendlyMessage(i),u,f;return this._traceErrorTelemetry(t,h),st.error("Error composing part '{0}'. Details: {1}".format(this.toString(),h),1),u=this._savedContainerState,f=s.container,u&&(f.partTitle(u.partTitle),f.assetName(u.assetName)),this._registrationDeferred.reject(i),this._createPartWidget(c,s,!0)},s.prototype._clearSpinnerTimeout=function(){this._spinnerTimeout&&(pr.clearTimeout(this._spinnerTimeout),this._spinnerTimeout=null)},s.prototype._createPartWidget=function(n,t,i){var r=this,u=this.locator,f={size:this.widget.options.size,locator:u,getDebugId:function(){return gi(r)},traceErrorTelemetry:function(n){r._traceErrorTelemetry(yt.TransitionedToErrorState,n)}};return i&&(this.
_clearSpinnerTimeout(),this.widget.options.isInBlockingLoadingState(!1)),n.createPart(this._partContainer[0],t,f,this.services).then(function(n){var t,i,f;r._part=n;t=r.partDefinition;n.setupContent({extensionName:r._extensionName,uniqueName:u.toFriendlyString("_"),styleSheets:t&&t.styleSheets});wi(r,function(){var n=r.parent,t=n&&n.widget,i=t&&t.options.locked();r.widget&&r.widget.options.locked(i);r._part&&r._part.lockedUiContext(i)});i=r.widget;f=i&&i.element;f&&f.on(ot.fxerrorpartclicked,r._onErrorClick=function(){r.services.desktop.replacePart(r,u,{newPartContainerModel:r.containerModel,newPartOverridesModel:r.overridesModel,doNotSaveSettings:!0})})})},s.prototype.loadPropertiesFromJson=function(n,t){t===void 0&&(t=!1);var i=n.partState;this.assetInstanceDefinition=n.assetInstanceDefinition;this.bindings=at.bindingsFromJSON(n.bindings)||[];this.initialSize=n.initialSize;this._bindingsInitialized=n.bindingsInitialized;this._restoredFromJson=!0;this.loadFromJson(n);this._savedContainerState=
n.savedContainerState;this.containerModel=tu(n.containerModel);this.overridesModel=tu(n.overridesModel)||{};this.partState=vi.isSerializedObject(i)?vi.fromSerializableObject(i):i;t&&this._removeSelectablesFromPartState(this.partState);n.originalPartLocator&&(this.originalPartLocator=ii.fromJSON(n.originalPartLocator));this._adapterBindings=at.bindingsFromJSON(n.adapterBindings)},s.prototype._removeSelectablesFromPartState=function(n){var t=this;n&&typeof n=="object"&&gu(n,function(i,r){te[i]?delete n[i]:typeof r=="object"&&t._removeSelectablesFromPartState(r)})},s.prototype.calculateInitialSize=function(){var n,s,h,v,y,i={},c=this.services.finder,u=this.locator,f=u.type,e,t,r,p,w,a,o;f===bt.PartInstance||f===bt.StartboardPartInstance?c.tryLocate(u,i)&&(e=i.value,e&&(t=e.inline,r=e.reference,s=t?t.initialSize:r.initialSize,h=t?t.largeInitialSize:r.largeInitialSize,v=t?t.initialWidth:r.initialWidth,y=t?t.initialHeight:r.initialHeight,t?n=t:(p=ii.forExtension(r.extension||u.getExtensionLocator(
).name,u.getExtensionLocator().cloudName),w=p.withPartType(r.partTypeName),i={},c.tryLocate(w,i)&&(n=i.value)))):f===bt.PartType?(i={},c.tryLocate(u,i)&&(n=i.value)):st.error("Unable to create Part composition. Invalid locator type: '{0}'".format(f));this._bindingsInitialized=!1;a=l.getPartSizeOrDefault(n);ui[s]?this.initialSize=s:n&&ui[n.initialSize]?this.initialSize=n.initialSize:n?(o=l.getPartFactory(this._extensionName,n,{}),this.initialSize=o&&o.defaultSize!==undefined?o.defaultSize:a):this.initialSize=a;ui[h]?this.largeInitialSize=h:n&&ui[n.largeInitialSize]&&(this.largeInitialSize=n.largeInitialSize);this.initialSize===ui.Custom&&(this.initialWidth=v||n&&n.initialWidth,this.initialHeight=y||n&&n.initialHeight)},s.prototype.getDiagnosticsData=function(){return vt.extend(r.prototype.getDiagnosticsData.call(this),{bindings:at.mapBindingsToFriendlyObjects(this.bindings)})},s.prototype._setPartViewModelSize=function(n){var t="content.size",i=this._vm,r=ct(i,t);r.exists&&or(r.value)&&
pt.setModelValue(i,t,n)},s.prototype._getSummaryPartViewModelState=function(){var n=ot.fxsummarycollapsed,t=vt.Event(n);return this.widget.trigger(n,t),t.result},s.prototype._autoOpenSettingsFromSummary=function(){var t=this,n;ie==="true"&&(this._restoredFromJson||(n=this.getPartsContainer(),Q.all([n.getPermissionPromise(),this.awaitComposed()]).then(function(){var u=ct(t._vm,"content.hasSettings"),i,r,f;u.exists&&wt(u.value)&&(i=ct(t._vm,"content.settingsSelectable"),i.exists&&(r=wt(i.value),f=n.detailContainers,r&&(f||[]).length<=0&&n.canAutoOpenSettings()&&(t.widget.element.trigger(ot.fxautosettings,{masterBladeId:n.instanceId,masterPartId:t.instanceId}),r.isSelected(!0))))})))},s.prototype._setPartContainerSize=function(n,t){var i=this._vm&&this._vm.container;i&&(i.width&&i.width(n),i.height&&i.height(t))},s.prototype._getEditScopeIdFromSettings=function(){var n=this._journey,t=n&&n.ambientSettings.getItem(this.journeyPath),i=t&&t.value,r=i&&i.editScope;return r&&r.editScopeId},s.prototype.
_setupJourneyEditScopeReactor=function(){var n=this.partDefinition,t=this._journey;n&&n.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})},s.prototype._setEditScope=function(){var r=this.partDefinition,n,t,u,i;if(r&&r.editScopeType){if(n=this._getEditScopeIdFromSettings(),n)this.editScopeId(n);else{this.editScopeId(ri.getUniqueId());this.services.editScopeManager.onEditScopeCreated(this.editScopeId())}t=this.getInputPropertyBindings();u=t.properties.some(function(n){return n.targetProperty===pi});u||(i={},i[pi]=this.editScopeId,t.mapProperty(pi,pi).bind(this.toString()+"-[EditScopeId]",i,!0))}},s.prototype._getCommands=function(){if(!this.isComposed||!this.widget)throw new Error("Part '{0}' needs to be composed before retrieving its commands.".format(this.toString()));var n=this.widget;return n.options.commands},s.prototype._setupBladeRebindingHandlers=function(n){var u=this;if(n&&n.onRebind){var t=this._beforeBladeRebind.
bind(this),i=this._afterBladeRebind.bind(this),r=function(){u._containerInputsChanging(!1)};n.onRebind(t,i,r);this.registerForDispose(function(){n.offRebind(t,i,r)})}},s.prototype._ensureAssetAffinity=function(){var t=this,n=this.parent&&this.getPartsContainer(),i=this.assetType;if(!n||!n.assetType||!i||n.assetType!==i||!or(n.assetId))return this._part.inContainerOfSameAsset(!1);wi(this,function(){var i=n.assetId(),r=t.assetId(),u=i&&r&&a.compareAssetId(i,r);t._part.inContainerOfSameAsset(u)})},s.prototype._ensureAdapterAtomicityForBindings=function(){var t=this.adapter,n;t&&(n=[],this.bindings.forEach(function(t){var i=t.source;i.modelType===ci&&n.push(i.property)}),n.forEach(function(n){pt.setModelValue(t.viewModel,n,undefined)}))},s.prototype._setupAdaptedInputsReboundReactor=function(){var n=this,t=this.adapter;t&&!t.allOutputsReboundComputed&&(t.allOutputsReboundComputed=wi(this,function(){var u=n.bindings.filter(function(n){var t=n.source.modelType;return t===ci||t===di}).every(function(
t){var i=n.bindAdaptedInput(t).sourceModel,r=ct(i,t.source.property).value;return wt(r)!==undefined}),i,r;u&&(i=tt.mapSourceModelToTargetModel(t.viewModel,n.bindings,ci,n.toString()),r=tt.mapSourceModelToTargetModel(t.inputPropertyBindings.targetModel,n.bindings,di,n.toString()),n._lastRebindOnInputsSetProperties=vt.extend(i,r))}))},s.prototype._beforeBladeRebind=function(n){var i=this,r,t,u,f,e,o;if(this._containerInputsChanging(!0),this._updateRebindSequenceNumber(),li.provideContext(function(){i._creationState=li.getState()},uu.Part,this._getPartContext()),r=this.editScopeId()&&this.services.editScopeManager.getStateObservable(this.editScopeId()),t=this.widget,this._onInputsSetCompleted.reject("Part binding canceled due to rebinding for part '{0}'".format(this.toString())),this._contentRevealed.reject("Part reveal canceled due to rebinding for part '{0}'".format(this.toString())),this._onInputsSetCompleted=Q.defer(),this._contentRevealed=Q.defer(),this._hasRebindableInputs&&(oi==="delay"||
oi==="fade"?t&&t.options.isInBlockingLoadingState(!0):(u=(this.parent.parent||this.parent).widget,!t||u&&u.options.locked()||t.options.isInBlockingLoadingState(!0)),this._lastRebindOnInputsSetProperties=tt.mapSourceModelToTargetModel(n,this.bindings,dt.BladeInput,this.toString()),this._setupAdaptedInputsReboundReactor()),r&&r()===lu.NotDirty)this.services.editScopeManager.onEditScopeDisposed(this.editScopeId());this.editScopeId(undefined);this._ensureAdapterAtomicityForBindings();this.bindings.forEach(function(n){if(n.source.scope===fi.DetailsContainer){var t=ct(i._vm,n.targetProperty);t.exists&&pt.setModelValue(i._vm,n.targetProperty,undefined)}});this._vm.container.unauthorizedMessage(null);this.partDefinition.shareVmWithParentBlade?(f=this.parent,e=f.parent,e.setInputsSetPromise(this._onInputsSetCompleted.promise)):(o=this._getNotFoundMessage(),o(null))},s.prototype._afterBladeRebind=function(){this.isComposed&&(this._setEditScope(),this.partDefinition.partKind===gt.ResourceSummary&&
this._autoOpenSettingsFromSummary())},s.prototype._disposeEditScope=function(){var t=this.editScopeId(),n;if(t){this.services.editScopeManager.onEditScopeDisposed(t);n=this._journey;n&&n.ambientSettings.removeItem(this.journeyPath)}},s.prototype._setViewStateProperties=function(n,t){var f=this,e=n||[],i=t||[],r,u;i=i.filter(function(n){var t=n.split(".");return t.length>1?(t.pop(),typeof ct(f._vm,t.join(".")).value=="object"):!0});this._viewStateProperties=e.concatUnique(i);r=this._vm;u=r&&r.container;u&&u.selectable&&(this._viewStateProperties=this._viewStateProperties.concatUnique([df,gf]))},s.prototype._registerInvocationProperty=function(n){var u=this,t=this._bladeOpener,i,f=k.detailsIsPartContainer(n),r;f&&(i=ko.pureComputed(function(){return!u._vm.container.isSelectable()}));r=t.registerInvocationProperty(n,i);this._viewStateProperties=t.modifyViewStateProperties(this._viewStateProperties,r)},s.prototype._setupOpenInTabListenerForSelectables=function(){var n=this;this.widget.element.
on(ot.fxopeninnewtab,this._onOpenTab=function(t,i){var r=i.selectable,u=k.getAssociatedDetailDefinition(r||i.selectableSet,n.getViewModel(),n.partDefinition),e,o;u&&(e=r?r.selectedValue():g.createSelection(i.selectableSet,i.item),o=Q(e).then(function(t){var i=n._bladeOpener.createBladeModelForSelectedItem(u,t),r=i&&i.locator;return r?f.getBladeDeepLink(r.getExtensionLocator(),r.name,pr.location.href,i.model):null}),n.services.openWindow(o))})},s.prototype._disposeOpenInTabListeners=function(){this._onOpenTab&&(this.widget.element.off(ot.fxopeninnewtab,this._onOpenTab),this._onOpenTab=null)},s.prototype._getNotFoundMessage=function(){var n=this._vm.container;return n.notFoundMessage},s.prototype._traceErrorTelemetry=function(n,t){var i=this.locator;ni.trace({extension:this._getPrimaryExtensionName(),source:fr,action:yi.PartErrored,actionModifier:yt[n],name:bi(i),data:{details:t}})},s}(b.Instance);t.Instance=gr;t.prepareContainerModel=lr;t.getSerializableContainerModel=nu;t.createContainerModel=
tu;t.create=rf;t.setBladeOpenerModule=we;t.setDynamicPartBinderModule=be;t.inferredReferenceType=-999;t.createOverridesOrContainerModelSourceReference=ke;t.isOverridesOrContainerModelSourceReference=iu;t.isDynamicBindingWithNonLocalSource=sf}(ot||(ot={})),ot});define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","f","../../Extension/Extension.Definition.Locator","./UI.Composition","./UI.Composition.CompositionBinder","./UI.Composition.ContextMenuContainer","./UI.Composition.Part","../../Services/Services.Settings","../../Services/Services.EditScopeManagement"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return function(t){function nt(n,i,r,u){u=u||{};var f=new c(n,i,null,u.id);return f.calculateInitialSize(),f.modelContainsSensitiveData=u.modelContainsSensitiveData,f.containerModel=o.prepareContainerModel(r||{}),f.overridesModel=o.prepareContainerModel(u.overridesModel||{}),f.validateBindings(r)||(t.log.error("Unable to create instance of startboard part '{0}', check log for errors.".
format(i.toString())),f.locator.name="##INVALID##"),u.doNotSaveSettings||f.save(),f}var l=r.Locator,v=r.LocatorType,y=i.Base,p=y.Diagnostics,w=i.Parts.PartKind,b=s.SettingStore,k=u.CompositionType,d=f.CompositionBinder,a=h.EditScopeState,g=window,tt=g.fx.environment,c;t.startboardPartName="StartboardPart";t.log=p.createLog(n);c=function(n){function i(i,r,u,f){n.call(this,i,r,u,f,null,100);this.dontSetupWidget=!1;this.containerModel={};this._name=t.startboardPartName;this._store=b.Startboard}return __extends(i,n),i.fromJSON=function(n,t){return u.createCompositionFromJSON(t,function(){var r=new i(n,l.fromJSON(t.locator),t.widgetState,t.id);return r.loadPropertiesFromJson(t,!0),r._storedEditScopeId=t.editScopeId,r.dontSetupWidget=t.dontSetupWidget,r.defaultMenuItemId=t.defaultMenuItemId,r.containerModel=r.containerModel||{},r.deepLink=t.deepLink,r},function(r,u){var f=new i(n,r,null,t.id);return f.unrecoverableErrorMessage=u,f})},i.prototype.getCompositionType=function(){return k.StartboardPart}
,i.prototype.register=function(t,i,r){var f=this,u,e;n.prototype.register.call(this,t,i,r);var o,s=this.deepLink,h=this._part,c=this.services;s&&(u=h.getSelectable(),o={isClickable:u.isClickable,isSelected:u.isSelected,value:u.value,onClick:function(){c.router.route(s)}});h.configure({onStartboard:!0,selectable:o});e=this.editScopeId();e&&this.partDefinition.partKind===w.Provisioning&&c.editScopeManager.getStateObservable(e).subscribe(this,function(n){var t=n===a.Dirty||n===a.DirtyAndSaving;t&&(f.dontSetupWidget=!1,f.addWidgetToUI({parentElement:f.getPartsContainer().widget}))})},i.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return t.editScopeId=this.editScopeId(),t.dontSetupWidget=this.dontSetupWidget,t.defaultMenuItemId=this.defaultMenuItemId,t.deepLink=this.deepLink,t},i.prototype.isOrganizable=function(){return!0},i.prototype.validateBindings=function(n){var r=this,t,i;return this.bindings&&this.bindings.length>0?(t=this.bindings.filter(function(n){return n.source.
id!==r.id}),i=t.map(function(n){return n.source.property}),d.modelHasProperties(this.toString(),i,n)):!0},i.prototype.matchesLocatorAndModel=function(n,t,i,r){return!this.locator.equals(t)&&!this._matchesPartReferenceLocator(n,t)?!1:this.defaultMenuItemId!==r?!1:u.deepSubset(this.containerModel,i||{})},i.prototype.addWidgetToUI=function(t){if(!this.dontSetupWidget){var i=this.widget;e.composeShellCommands(this,i.options.commands,!0,this.services);n.prototype.addWidgetToUI.call(this,t);t.doNotSaveSettings||this.save()}},i.prototype.save=function(t){return this.dontSetupWidget?n.prototype.save.call(this,t):Q()},i.prototype._forceSave=function(t){return n.prototype.save.call(this,t)},i.prototype._getEditScopeIdFromSettings=function(){return this._storedEditScopeId},i.prototype._setupJourneyEditScopeReactor=function(){},i.prototype._disposeEditScope=function(){var n=this.editScopeId();if(n)this.services.editScopeManager.onEditScopeDisposed(n)},i.prototype._getBladeOpenerConfig=function(){var
i=this,r=n.prototype._getBladeOpenerConfig.call(this),u=function(){var n=i.getPartsContainer().detailContainers;return n&&n.length>0&&n[0]};return r.onBladesOpening=function(){i.isDisposed()&&i.dontSetupWidget&&t.log.error("Cannot open new blades for part '{0}', it has already been disposed and removed from the starboard.".format(i.toString())+" If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.")},r.getCloseOwnedDetailBladesHandler=function(n){var r,f=n&&n.source&&n.source.property,t=u();return t&&t.masterPartId===i.id&&t.masterInvocationProperty===f&&!t.masterCommandName&&(r=function(){var n=i.services.desktop,t=n.getActiveJourney();return t?n.tryDiscardJourney(t.id):n.tryDeactivateJourney()}),r},r.getCloseOtherDetailBladesHandler=function(n){var r,f=n&&n.source&&n.source.property,t=u();return t&&(t.masterPartId!==i.id||t.masterInvocationProperty!==f)&&(r=function(){var n=i.services.desktop,t=n.getActiveJourney();return t.
isStartedWithContextBlade()?n.tryDiscardJourney(t.id):n.tryDeactivateJourney()}),r},r},i.prototype._matchesPartReferenceLocator=function(n,t){var u=!1,f={},r,i,e,o;return this.locator.type===v.StartboardPartInstance&&n.tryLocate(this.locator,f)&&(r=f.value,i=r&&r.reference,i&&(e=i.extension?l.forExtension(i.extension,this.locator.getExtensionLocator().cloudName):this.locator.getExtensionLocator(),o=e.withPartType(i.partTypeName),u=t.equals(o))),u},i}(o.Instance);t.Instance=c;t.create=nt}(c||(c={})),c});define("_generated/Templates/WidgetsDropMenu",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-dropmenu"> <button class="fxs-dropmenu-button fxs-has-hover" aria-haspopup="true" aria-expanded="false"><\/button> <div class="fxs-dropmenu-content" role="menu"><\/div> <\/div>'}});define("MsPortalImpl/Widgets/Widgets.DropMenu",["require","exports","f","../Interactions/Interactions.DismissHandler","./Widgets.WidgetBase","../../_generated/Templates/WidgetsDropMenu",
"../Interactions/Interactions.KeyboardNavigation","../../_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css"],function(n,t,i,r,u,f,e){"use strict";var o;return function(n){var c=i.Base,g=c.Utilities,o=c.EventTypes,et=window,l=jQuery,t="fxs-dropmenu",s=t+"-button",a=t+"-content",v=t+"-hidden",y=t+"-is-open",p=t+"-invisible",nt=t+"-left",tt=t+"-right",w="fxs-is-selected",it="fxs-popup-button",rt="fxs-popup",ut=220,b=g.getUniqueId(),k="aria-label",h=ko.observable,ft=function(n){function t(t,i,r){n.call(this);this.isMenuOpen=h(!1);this.defaultColors=!0;this.buttonLabel=h();this.buttonTooltip=h();this.menuLabel=h();this.buttonTemplate=t;this.menuTemplate=i;this.togglesVisibility=!!r}return __extends(t,n),t}(u.ViewModel),d;n.ViewModel=ft;d=function(n){function t(t,i){var u=this,o,e,r;n.call(this,t,i);this._validateForDismiss=function(n){return!(u._dropMenuButton[0]===n)&&!l.contains(u._dropMenu[0],n)};this._dismissHandle={dismissFn:function(){u.hide()},shouldDismissOnMouseDownFn:this.
_validateForDismiss,shouldDismissOnMouseWheelFn:this._validateForDismiss,restoreFocus:function(){u._dropMenuButton[0].focus()},logName:"dropMenu"};o=this._dropMenu=l(f());e=this._dropMenuButton=o.findByClassName(s).addClass(i.buttonClass);e.html(i.buttonTemplate);e.attr("aria-controls",b);r=this._dropMenuContent=o.findByClassName(a);r.html(i.menuTemplate);r.attr("id",b);i.defaultColors&&(e.addClass(it),r.addClass(rt));t.append(this._dropMenu);r.width(i.menuWidth||ut);switch(i.alignMenu){case 0:r.addClass(tt);break;case 1:default:r.addClass(nt)}i.isMenuOpen()||this._hideElement();this._attachEventHandlers()}return __extends(t,n),t.prototype._attachEventHandlers=function(){var i=this,r,u,f=this._dropMenu,e=this._dropMenuContent,n=this.element,t=this.options,h;f.on(o.click,"."+s,r=function(n){n.preventDefault();i.toggle()});e.on(o.click,"a",u=function(){i.hide()});n.on(o.contextmenu,h=function(){if(t.isMenuOpen())return!1});ko.reactor(this.lifetimeManager,function(){var i=n.findByClassName(
s);i.attr("title",t.buttonTooltip()).attr(k,t.buttonLabel());n.findByClassName(a).attr(k,t.menuLabel())});this.lifetimeManager.registerForDispose(function(){f.off(o.click,"."+s,r);n.off(o.contextmenu,h);e.off(o.click,"a",u)})},t.prototype._hideElement=function(){var n=this._dropMenuContent;this.options.togglesVisibility?n.addClass(p):n.addClass(v)},t.prototype.dispose=function(){this._dismissHandle&&(r.unregister(this._dismissHandle),this._dismissHandle=null);n.prototype.dispose.call(this)},t.prototype.updateMenuWidth=function(n){this._dropMenuContent.width(n)},t.prototype.show=function(){var n=this._dropMenuContent,t=this.options;this._dropMenuButton.addClass(w).attr("aria-expanded",!0);t.togglesVisibility?n.removeClass(p):n.removeClass(v);n.addClass(y);n.attr({"aria-hidden":!1});t.isMenuOpen(!0);r.register(this._dismissHandle);this._keyboardNavigation=new e.KeyboardNavigation(this.element)},t.prototype.hide=function(){var n=this._dropMenuContent;this._dropMenuButton.removeClass(w).attr(
"aria-expanded",!1);this._hideElement();n.removeClass(y);n.attr({"aria-hidden":!0});this.options.isMenuOpen(!1);r.unregister(this._dismissHandle);this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null)},t.prototype.toggle=function(){this.options.isMenuOpen()?this.hide():this.show()},t.prototype.setFocus=function(){this.element.findByClassName(s).focus()},t}(u.Widget);n.Widget=d}(o||(o={})),o});define("MsPortalImpl/Widgets/Widgets.LayoutBase",["require","exports","./Widgets.UIElementBase"],function(n,t,i){"use strict";var r;return function(n){var u=FxImpl,e=window,o=jQuery,f=ko.observable,t,r;n.Orientation=u.Widgets.Orientation;t=function(n){function t(t){n.call(this,t);this.positionUpdatedSignal=f(0);this.positions=[]}return __extends(t,n),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},set:function(n){this._positions=n?n:[]},enumerable:!0,configurable:!0}),t.prototype.applyViewSettings=function(n,t){this.positions&&
t&&t.transformId&&this.positions.forEach(function(n){n.id=t.transformId(n.id)})},t}(i.ViewModel);n.ViewModel=t;r=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.layoutUpdatedEventName="layoutUpdated",t}(i.Widget);n.Widget=r}(r||(r={})),r});define("MsPortalImpl/Widgets/Widgets.FlowLayout",["require","exports","f","i","./Widgets.WidgetBase","./Widgets.LayoutBase","./Widgets.Tile","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css"],function(n,t,i,r,u,f,e,o){"use strict";var s;return function(t){function wt(n){for(var r,u,f,e=new ut,i,c=!0,o=0;o<n.length;o++){var t=n[o],l=t.position,s=l.row,h=l.col,a=t.rowSpan,v=t.colSpan;if(e.isRectangleFree(h,s,a,v))e.markOccupancy(t);else{for(c=!1,i={misplacedPart:t.id,overlappedParts:[]},r=h;r<h+v;r++)for(u=s;u<s+a;u++)f=e.getItemAt(r,u),f&&i.overlappedParts.indexOf(f.id)===-1&&i.overlappedParts.push(f.id);break}}return{success:c,result:i}}var ft=i.Base,at=ft.Diagnostics,p=ft.EventTypes,
et=i.Parts,ot=et.PartSize,nt=et.PartSizeHelper,rt=i.Widgets.AzureGrid,tt=r.Widgets.Orientation,bt=window,c=jQuery,st=at.createLog(n),h=o.Widget.getId,w=u.Widget.getWidget,b="fxs-flowlayout",ht=b+"-childcontainer",k=b+"-element",vt=b+"-drop-placeholder",yt="<div class='"+ht+"'><\/div>",d=ko.observable,pt=250,v=function(n,t,i){return Math.min(25,Math.ceil((n+i)/(t+i)))},l=function(n,t,i){return n*t+(n-1)*i},y,ct,lt,s,it;t.validateGrid=wt;y={};y[38]=1;y[39]=2;y[40]=3;y[37]=4;ct=function(n){function t(t,i){n.call(this,t);this.minColumns=d(1);this.minRows=d(1);this.maxColumns=d(999);this.maxRows=d(999);this.columnSize=rt.CellWidth;this.rowSize=rt.CellHeight;this.gutterSize=rt.CellSpacingWidth;this.orientation=tt.Horizontal;this.allowReorder=!1;this.allowOverflow=!1;this.allowMaximized=!0;this.allowGaps=!1;this.resolutionGuides=!1;this.resolutionGuidesOffset={x:0,y:0};this.renderMaximized=d(!1);this.childWidgetType=null;this.maxPositions=[];this.applyViewSettings(i)}return __extends(t,n),t.prototype.
getViewSettings=function(){return{positions:this.positions,maxPositions:this.maxPositions}},t.prototype.applyViewSettings=function(t,i){t&&(t.positions&&(this.positions=t.positions,this.positionUpdatedSignal(this.positionUpdatedSignal()+1)),t.maxPositions&&(this.maxPositions=t.maxPositions),this.maxPositions&&i&&i.transformId&&this.maxPositions.forEach(function(n){n.id=i.transformId(n.id)}),n.prototype.applyViewSettings.call(this,t,i))},Object.defineProperty(t.prototype,"maxPositions",{get:function(){return this._maxPositions},set:function(n){this._maxPositions=n?n:[]},enumerable:!0,configurable:!0}),t}(f.ViewModel);t.ViewModel=ct;lt=function(n){function t(t,i){n.call(this,t,i);this._dropPlaceholder=null;this._childContainer=null;this._layoutEngineNormal=new a(i);this._layoutEngineNormal.positions=i.positions;i.allowMaximized?(this._layoutEngineMax=new a(i),this._layoutEngineMax.positions=i.maxPositions):i.renderMaximized=ko.computed(function(){return!1});t.addClass(b).html(yt);i.resolutionGuides&&
this._addResolutionGuides();this._childContainer=this.element.findByClassName(ht);this._initializeComputed();this._setContainerSize();this._relayoutStartingAtIndex(0,!1);this._attachEventHandlers()}return __extends(t,n),t.prototype.dispose=function(){var t=this.element;this._childElements.forEach(function(n){n.removeClass(k);ko.cleanNode(n[0]);n.remove()});ko.cleanNode(this._childContainer[0]);this._childContainer.remove();t.removeClass(b);n.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"_childElements",{get:function(){var t=this._childContainer.children("."+k),n=[];return c.each(t,function(t,i){n.push(c(i))}),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropPlaceholder",{get:function(){return this._dropPlaceholder},enumerable:!0,configurable:!0}),t.prototype.addChild=function(n){var i=this.options,e="visibility",t,r,u;if(!n)throw new Error("Cannot add a null child.");if(t=n.element?n.element:n,i.childWidgetType&&!w(t,i.childWidgetType))throw new
Error("The child argument is not an instance of the allowed widget type. Accepted widget type: {0}.".format(i.childWidgetType));t.css(e,"hidden");this._childContainer.append(t);t.addClass(k);r=this._getChildDimensions(t,!1);u=this._getChildDimensions(t,!0);try{i.positions=this._layoutEngineNormal.append(h(t),r.rowSpan,r.colSpan);i.allowMaximized&&(i.maxPositions=this._layoutEngineMax.append(h(t),u.rowSpan,u.colSpan))}catch(o){st.warning("New element could not be appended to the grid. {0}".format(o.toString()));t.removeClass(k);t.remove();return}this._setCurrentPositions(this._getCurrentPositioningEngine().positions);this._refreshElementSize(t);this._setContainerSize();this._relayoutStartingAtIndex(0,!1);this.element.trigger(f.Widget.layoutUpdatedEventName);this._ensureTabOrder();t.css(e,"")},t.prototype.removeChild=function(n,t){var u=this._childElements.firstIndex(function(t){return h(t)===n}),i=this._childElements[u],r;return i?(r=this.options,r.positions=this._layoutEngineNormal.remove(
n),r.allowMaximized&&(r.maxPositions=this._layoutEngineMax.remove(n)),this.element.trigger(f.Widget.layoutUpdatedEventName),i.removeClass(k),t?i.detach():i.remove(),this._setContainerSize(),this._relayoutStartingAtIndex(0,!0),this._ensureTabOrder(),!0):!1},t.prototype.resizeChild=function(n,t,i,r){var s=this.options,c=s.rowSize,a=s.columnSize,u=s.gutterSize,y=this._childElements.first(function(t){return h(t)===n}),p,k;if(y){p=this._getCurrentPositioningEngine().positions.first(function(t){return t.id===n});t=Math.max(t,a);i=Math.max(i,c);var d=v(i,c,u),g=v(t,a,u),b=this._getCurrentPositioningEngine().resize(n,g,d,r);this._setCurrentPositions(b);var e=b.first(function(t){return t.id===n}),nt=l(e.rowSpan,c,u),tt=l(e.colSpan,a,u);this._setContainerSize(!0);this._relayoutStartingAtIndex(0,!0);r&&((p.rowSpan!==e.rowSpan||p.colSpan!==e.colSpan)&&this.element.trigger(f.Widget.layoutUpdatedEventName),this._ensureTabOrder(),k=w(y,o.Widget),this._setElementSize(k,y,tt,nt))}},t.prototype.moveChild=
function(n,t,i,r){var e=h(n),u=this._getChildDimensions(n,!1),o=this._getCurrentPositioningEngine().move(e,{col:t,row:i},u.colSpan,u.rowSpan,r);this._setCurrentPositions(o);this._setContainerSize(!0);this._relayoutStartingAtIndex(0,!r);r&&(this.element.trigger(f.Widget.layoutUpdatedEventName),this._ensureTabOrder())},t.prototype.refreshLayout=function(n){this._setCurrentPositions(this._getCurrentPositioningEngine().positions);this._setContainerSize();this._relayoutStartingAtIndex(0,n);this._refreshSizes();this._ensureTabOrder()},t.prototype.saveViewSettings=function(){var n=this.options;return n.positions=this._layoutEngineNormal.positions,n.allowMaximized&&(n.maxPositions=this._layoutEngineMax.positions),n.getViewSettings()},t.prototype.createDropPlaceholder=function(n,t){this._dropPlaceholder&&this.disposeDropPlaceholder();this._dropPlaceholder=c('<div class="'+vt+'"><\/div>').css({width:n,height:t});this._childContainer.append(this._dropPlaceholder)},t.prototype.disposeDropPlaceholder=
function(){this._dropPlaceholder&&this._dropPlaceholder.remove();this._dropPlaceholder=null},t.prototype.moveDropPlaceholder=function(n){this._setElementPositioningCss(this.dropPlaceholder,n,!1)},t.prototype.resizeDropPlaceholder=function(n,t){var r=this.options,u=r.rowSize,f=r.columnSize,i=r.gutterSize,e=v(t,u,i),o=v(n,f,i),s=l(e,u,i),h=l(o,f,i);this._dropPlaceholder.css({width:h,height:s})},t.prototype.discardStateOfUnusedChildren=function(){var n=[],t={stateDiscarded:!1};return this._layoutEngineNormal&&(n=n.concat(this._layoutEngineNormal.discardUnusedPositions())),this.options.allowMaximized&&this._layoutEngineMax&&(n=n.concat(this._layoutEngineMax.discardUnusedPositions())),n.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(n)),t},t.prototype._initializeComputed=function(){var t=this,n=this.options,i=this.lifetimeManager;ko.computed(i,function(){n.minRows();n.maxRows();n.minColumns();n.maxColumns();t._setContainerSize()});ko.computed(i,function(){n.renderMaximized(
);t.refreshLayout(!0)});n.positionUpdatedSignal.subscribe(i,function(){t._layoutEngineNormal.positions=n.positions})},t.prototype._getChildDimensions=function(n,t){var u=this.options,s=w(n,e.Widget),i=s&&s.options,o=i&&i.size(),h=i&&i.largeInitialSize(),f,r,c,l;return t&&ot[h]?(f=nt.getSize(h),r=f.size):nt.isFixedSize(o)?(f=nt.getSize(o),r=o===ot.Custom?nt.getGridPixelSize(i.gridWidth(),i.gridHeight()):f.size):r=this._getChildAccurateDimensions(n),c=v(r.height,u.rowSize,u.gutterSize),l=v(r.width,u.columnSize,u.gutterSize),{rowSpan:c,colSpan:l}},t.prototype._getChildAccurateDimensions=function(n){if(!n[0])return st.warning("Attempted to measure a non-existant item in _getChildAccurateDimensions. Assuming 0 as size."),{height:0,width:0};var t=n[0].getBoundingClientRect(),i=Math.round(t.height),r=Math.round(t.width);return{height:i,width:r}},t.prototype._setContainerSize=function(n){var t=this.options,i=this._getCurrentPositioningEngine().getMaxOccupiedPositions(n?this._getCurrentPositions(
):null),r=Math.max(t.minRows(),i.row),u=Math.max(t.minColumns(),i.col),f=l(r,t.rowSize,t.gutterSize),e=l(u,t.columnSize,t.gutterSize);this._childContainer.css({height:f,width:e})},t.prototype._relayoutStartingAtIndex=function(n,t){for(var u,i,r,f;n<this._childElements.length;n++)i=this._childElements[n],u=h(i),r=this._getCurrentPositions().first(function(n){return n.id===u}),f=r?r.position:{row:0,col:0},this._setElementPositioningCss(i,f,t)},t.prototype._setElementPositioningCss=function(n,t,i){var r=this.options,f=t.col*(r.columnSize+r.gutterSize),e=t.row*(r.rowSize+r.gutterSize),u;u=this._isRtl()?{right:f,top:e}:{left:f,top:e};i?n.stop(!0,!1).animate(u,pt):n.stop(!0,!0).css(u)},t.prototype._refreshSizes=function(){this._childElements.forEach(this._refreshElementSize,this)},t.prototype._refreshElementSize=function(n){var t=this.options,i=w(n,o.Widget);if(i){var u=h(n),r=this._getCurrentPositions().first(function(n){return n.id===u}),f=l(r.rowSpan,t.rowSize,t.gutterSize),e=l(r.colSpan,
t.columnSize,t.gutterSize);this._setElementSize(i,n,e,f)}},t.prototype._setElementSize=function(n,t,i,r){n?n.setSize(i,r):t.css({width:i,height:r})},t.prototype._ensureTabOrder=function(){var t=this,i=this._getCurrentPositioningEngine().getNaturalDomElementOrder(),n=this._childElements,r=n.map(h);i.forEach(function(i){var u=n[r.indexOf(i)];u&&(u.appendTo(t._childContainer),u.trigger(p.fxrecomposeframepart))})},t.prototype._moveFocusInDirection=function(n){var u,t,f,i,r;this.options.childWidgetType===e.Widget&&(u=c(document.activeElement).closest("."+e.widgetClassName),t=h(u),t)&&(f=this._getCurrentPositioningEngine().getAdjacentElement(t,n),i=this._childElements.first(function(n){return f===h(n)}),i)&&(r=w(i,e.Widget),r&&r.setFocus())},t.prototype._attachEventHandlers=function(){var t=this,n=this.element,i=function(n,i,r,u,f){t.resizeChild(i,r,u,f===undefined?!0:f);n.stopPropagation()},r=function(n){var r=c(n.target),u,i;r.is("input[type=text], textarea, select")||t.options.childWidgetType!==
e.Widget||r.closest(".fxs-contextMenu").length||(u=n.which,i=y[u]||0,i!==0&&(n.preventDefault(),n.stopPropagation(),t._moveFocusInDirection(i)))};n.on(p.fxsizechange,i);n.on(p.keydown,r);this.lifetimeManager.registerForDispose(function(){n.off(p.fxsizechange,i);n.off(p.keydown,r)})},t.prototype._getCurrentPositioningEngine=function(){return this.options.renderMaximized()?this._layoutEngineMax:this._layoutEngineNormal},t.prototype._getCurrentPositions=function(){var n=this.options;return n.renderMaximized()?n.maxPositions:n.positions},t.prototype._setCurrentPositions=function(n){var t=this.options;t.renderMaximized()?t.maxPositions=n:t.positions=n},t.prototype._addResolutionGuides=function(){var t=this,i='<div class="fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-{0}x{1} fxs-hide-in-normal"><\/div>',n=this.options.resolutionGuidesOffset;[{x:1024,y:768},{x:1366,y:768},{x:1440,y:900},{x:1920,y:1080},{x:3840,y:2160},].forEach(function(r){var u=c(i.format(r.x,r.y));(n.x||n.y)&&
u.css({top:n.y+"px",left:n.x+"px"});t.element.prepend(u)})},t}(f.Widget);t.Widget=lt,function(n){function t(n){return n.position.row}function i(n){return n.position.row+n.rowSpan}function r(n){return n.position.col}function u(n){return n.position.col+n.colSpan}n.top=t;n.bottom=i;n.left=r;n.right=u}(s||(s={}));var ut=function(){function n(){this._occupancyGrid=[]}return n.prototype.reset=function(n){var t=this;this._occupancyGrid.length=0;n&&n.forEach(function(n){t.markOccupancy(n)})},n.prototype.isRectangleFree=function(n,t,i,r){for(var u,e=n+r,o=t+i,f=n;f<e;f++)for(u=t;u<o;u++)if(this.isPositionOccupied(f,u))return!1;return!0},n.prototype.isPositionOccupied=function(n,t){return!!this._occupancyGrid[n]&&!!this._occupancyGrid[n][t]},n.prototype.getItemAt=function(n,t){var i=this._occupancyGrid[n];return i?i[t]:null},n.prototype.markOccupancy=function(n,t){for(var r,f=s.top(n),e=s.bottom(n),o=s.left(n),h=s.right(n),u=this._occupancyGrid,i=o;i<h;i++)for(r=f;r<e;r++)u[i]||(u[i]=[]),u[i][r]||
(u[i][r]=null),u[i][r]=t?null:n},n}(),g={},a=function(){function n(n){this._occupancyGrid=new ut;this._items=[];this._filledPositions={};this._gridOptions=n}return n.prototype.append=function(n,t,i){var r=this._getExistingItem(n),u,f,e;if(this._filledPositions[n]=!0,!!r)return this._items;if(u=this._maxRows(),f=this._maxCols(),!this._gridOptions.allowOverflow&&(t>u||i>f))throw new Error("The element cannot fit in this grid. ElementRowSpan: {0}, ElementColSpan: {1}, GridMaxRowSpan: {2}, GridMaxColSpan: {3}".format(t,i,u,f));if(e=this._findNextAvailablePositionForRectangle(t,i),!e)throw new Error("The element cannot fit in the remaining space available in the grid.");return r={id:n,position:e,rowSpan:t,colSpan:i},this._items.push(r),this._occupancyGrid.markOccupancy(r),this._items},n.prototype.move=function(n,t,i,r,u){var o={id:n,position:t,colSpan:i,rowSpan:r},e,f;return this._applyGridConstraints(o),f=new it(this._items,o,this._gridOptions),e=f.resolved?f.getItems():this._items,u&&(f.resolved&&
(this._items.length=0),this._items=e,this._occupancyGrid.reset(this._items),this.collapseGaps()),e},n.prototype.resize=function(n,t,i,r){var e=this._getExistingItem(n),o=e.position,y={id:e.id,position:{col:o.col,row:o.row},colSpan:t,rowSpan:i},f=y.position,u,l,s,h,p,c;if(this._applyGridConstraints(y),f.row<0||f.col<0)return this._items;var w=Math.max(0,t-e.colSpan),b=Math.max(0,i-e.rowSpan),a=f.col,v=f.row;for(this._gridOptions.allowGaps||(a=Math.min(a,Math.max(0,o.col-w)),v=Math.min(v,Math.max(0,o.row-b))),s=a;s<=f.col;s++){for(h=v;h<=f.row;h++)if((p={id:n,position:{col:s,row:h},colSpan:t,rowSpan:i},c=new it(this._items,p,this._gridOptions),c.resolved)&&((!u||c.shiftCost<u.shiftCost)&&(u=c),u&&u.shiftCost===0))break;if(u&&u.shiftCost===0)break}return l=u?u.getItems():this._items,r&&(u&&(this._items.length=0),this._items=l,this._occupancyGrid.reset(this._items),this.collapseGaps()),l},n.prototype.remove=function(n){var i=this._getExistingItem(n),t;return(this._filledPositions[n]=!1,t=this.
_items.indexOf(i),t===-1)?this._items:(this._items.splice(t,1),this._occupancyGrid.markOccupancy(i,!0),this.collapseGaps(),this._items)},n.prototype.collapseGaps=function(){if(!this._gridOptions.allowGaps){var n={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(n,t)},getMaxPositions:function(){return this.grid.getMaxOccupiedPositions()},getMinSize:function(){return{col:this.grid._minCols(),row:this.grid._minRows()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(n,t)},shiftItem:function(n,t){n.position.col-=t}},t={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(t,n)},getMaxPositions:function(){var n=this.grid.getMaxOccupiedPositions();return{col:n.row,row:n.col}},getMinSize:function(){return{col:this.grid._minRows(),row:this.grid._minCols()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(t,n)},shiftItem:function(n,t){n.position.row-=t}};this._orientation()===
tt.Horizontal?(this._collapseGapsWithGridVisitor(n),this._collapseGapsWithGridVisitor(t)):(this._collapseGapsWithGridVisitor(t),this._collapseGapsWithGridVisitor(n))}},n.prototype.getNaturalDomElementOrder=function(){for(var n,t,u,i=[],f=this.getMaxOccupiedPositions(),r=0;r<f.row;r++)for(n=0;n<f.col;n++)t=this._occupancyGrid.getItemAt(n,r),t&&(u=t.id,i.indexOf(u)===-1&&i.push(u),n+=t.colSpan-1);return i},n.prototype.getAdjacentElement=function(n,t){var i=this._getExistingItem(n),r,u;return i?(r=g[t],u=r?r(this,i):i,u.id):n},Object.defineProperty(n.prototype,"positions",{get:function(){return this._items},set:function(n){this._items.length=0;this._items=n?n:[];this._occupancyGrid.reset(this._items)},enumerable:!0,configurable:!0}),n.prototype.discardUnusedPositions=function(){var n=this,t=[];return this._items.slice(0).forEach(function(i){n._filledPositions[i.id]||(t.push(i),n.remove(i.id))}),t},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._minRows=
function(){return this._gridOptions.minRows()},n.prototype._maxRows=function(){return this._gridOptions.maxRows()},n.prototype._minCols=function(){return this._gridOptions.minColumns()},n.prototype._maxCols=function(){return this._gridOptions.maxColumns()},n.prototype.getMaxOccupiedPositions=function(n){for(var e=n||this._items,r=0,u=0,i,f,t=0;t<e.length;t++)i=e[t],f=i.position,r=Math.max(r,f.col+i.colSpan),u=Math.max(u,f.row+i.rowSpan);return{col:r,row:u}},n.prototype._getExistingItem=function(n){return this._items.first(function(t){return t.id===n})},n.prototype._applyGridConstraints=function(n){var t,i;this._gridOptions.allowOverflow||(i=n.position,t=s.bottom(n)-this._maxRows(),t>0&&(i.row-=t),t=s.right(n)-this._maxCols(),t>0&&(i.col-=t))},n.prototype._findNextAvailablePositionForRectangle=function(n,t){var f=this._maxCols()-t+1,e=this._maxRows()-n+1,i,r,u;if(this._orientation()===tt.Horizontal){for(r=0;r<f;r++)for(i=0;i<e;i++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(
this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:0,row:u.row}}else{for(i=0;i<e;i++)for(r=0;r<f;r++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:u.col,row:0}}},n.prototype._isRectangleFree=function(n,t,i,r){var u=n+r,f=t+i;return!this._gridOptions.allowOverflow&&(f>this._maxRows()||u>this._maxCols())?!1:this._occupancyGrid.isRectangleFree(n,t,i,r)},n.prototype._collapseGapsWithGridVisitor=function(n){var i=n.getMaxPositions(),r=i.col,v=i.row,u=[],y=!1,p,f,o,t,h,e,l,a;if(!(r<=n.getMinSize().col))for(o=0;o<r;o++){for(f=null,t=0;t<v;t++){if(y=!1,u[t]=this._findGap(t,o,r,n),h=u[t].colSpan,h===0)return;if((!f||h<f)&&(f=h),t>0&&!this._gapsAreContiguous(u[t-1],u[t]))break;y=!0}if(y){for(p={},e=0;e<v;e++)for(l=s.right(u[e]);l<r;l++)a=n.getItemAt(l,e),a&&(p[a.id]=a);c.each(p,function(t,i){n.shiftItem(i,f)});this._occupancyGrid.reset(this._items);i=n.getMaxPositions();r=i.col;v=i.row}
}},n.prototype._gapsAreContiguous=function(n,t){var i=s.left(t),r=s.right(t),u=s.left(n),f=s.right(n);return f>=i&&u<=r},n.prototype._findGap=function(n,t,i,r){for(var u=t,f={id:"",position:{row:n,col:0},rowSpan:1,colSpan:0};u<i;){if(!r.isPositionOccupied(u,n))break;u++}for(f.position.col=u;u<i;){if(r.isPositionOccupied(u,n))break;f.colSpan++;u++}return f},n._scanAdjacentUp=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row-1,s=r.col+t.colSpan,u=o;u>=0;u--)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentRight=function(n,t){for(var i,f,r=t.position,e=r.col+t.colSpan,o=r.row,s=n.getMaxOccupiedPositions().col,h=r.row+t.rowSpan,u=e;u<s;u++)for(i=o;i<h;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n._scanAdjacentDown=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row+t.rowSpan,s=r.col+t.colSpan,h=n.getMaxOccupiedPositions().row,u=o;u<h;u++)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentLeft=
function(n,t){for(var i,f,r=t.position,e=r.col-1,o=r.row,s=r.row+t.rowSpan,u=e;u>=0;u--)for(i=o;i<s;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n}();t.FlowLayoutPositioningEngine=a;g[1]=a._scanAdjacentUp;g[2]=a._scanAdjacentRight;g[3]=a._scanAdjacentDown;g[4]=a._scanAdjacentLeft;it=function(){function n(n,t,i){var u=this,r;this.shiftCost=0;this.resolved=!1;this._resolvedItems=[];this._occupancyGrid=new ut;this._gridOptions=i;n.forEach(function(n){var i;t.id!==n.id&&(i=c.extend(!0,{},n),u._resolvedItems.push(i),u._occupancyGrid.markOccupancy(i))});this.resolved=this._resolveConflict(t);r=c.extend(!0,{},t);this._resolvedItems.push(r);this._occupancyGrid.markOccupancy(r)}return n.prototype.getItems=function(){return this._resolvedItems},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._maxRows=function(){return this._gridOptions.maxRows()||999},n.prototype._maxCols=function(){return this._gridOptions.maxColumns()||999},n.prototype._resolveConflict=
function(n){var t=!1;return this._orientation()===tt.Horizontal?(t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t):(t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t),t},n.prototype._tryMoveConflictsUp=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=s.left(n);u<s.right(n);u++)for(r=s.top(n);r<s.bottom(n);r++)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=s.bottom(i),e=s.top(n)-s.bottom(i),f=this._getConflictArea(i,0,e),s.bottom(f)>this._maxRows()||s.top(f)<0)||!this._tryMoveConflictsUp(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsDown=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=s.left(n);u<s.right(n);u++)for(r=s.bottom(n)-1;r>=s.top(n);r--)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=s.top(i),e=s.bottom(
n)-s.top(i),f=this._getConflictArea(i,0,e),s.bottom(f)>this._maxRows()||s.top(f)<0)||!this._tryMoveConflictsDown(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsLeft=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=s.top(n);u<s.bottom(n);u++)for(r=s.left(n);r<s.right(n);r++)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=s.right(i),e=s.left(n)-s.right(i),f=this._getConflictArea(i,e,0),s.right(f)>this._maxCols()||s.left(f)<0)||!this._tryMoveConflictsLeft(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsRight=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=s.top(n);u<s.bottom(n);u++)for(r=s.right(n)-1;r>=s.left(n);r--)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=s.left(i),e=s.right(n)-s.left(i),f=this._getConflictArea(i,e,0),s.right(f)>this._maxCols()||s.left(f)<0)||!this._tryMoveConflictsRight(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._getConflictArea=
function(n,t,i){var u=i<0,f=t<0,r=n.position;return{id:n.id,position:{row:u?r.row+i:r.row,col:f?r.col+t:r.col},rowSpan:n.rowSpan+Math.abs(i),colSpan:n.colSpan+Math.abs(t)}},n.prototype._moveItem=function(n,t,i){this._occupancyGrid.markOccupancy(n,!0);var r=n.position;r.col+=t;r.row+=i;this._occupancyGrid.markOccupancy(n);this.shiftCost+=n.colSpan*n.rowSpan},n}();t.FlowLayoutPositionConflictResolver=it}(s||(s={})),s});define("_generated/Templates/WidgetsStartboard",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-startboard-loadanimation"> <div class="fxs-splashscreen-loader-container"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <\/div> <div class="fxs-startboard-header"> <div class="fxs-startboard-title fxs-startboard-title-next fxs-br-default" id="startboard-title"><\/div> <div class="fxs-startboard-dropdown"><\/div> <input type="text" class="fxs-startboard-title-edit fxs-hide-in-normal" maxlength="200"> <div class="fxs-startboard-migration" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-migrate"><\/button> <\/div> <div class="fxs-startboard-actions" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-new"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-edit"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-share"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-fullscreen"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-clone"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-delete"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-filter"><\/button> <\/div> <\/div> <div class="fxs-startboard-layout"><\/div> <div class="fxs-startboard-message-container"><\/div>'}
});define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","f","../Base/Base.Events","../Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.RightClick","../Base/Base.KeyboardHelper","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.DropMenu","./Widgets.FlowLayout","./Widgets.LayoutBase","../../_generated/Templates/WidgetsStartboard","./Widgets.Tile","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";var w;return function(t){var ht=i.Base,ct=ht.Diagnostics,lt=ct.Telemetry,it=ht.EventTypes,b=s.Content.SvgStartup,at=h.Source,vt=h.Action,ri=window,yt=jQuery,ui=ct.createLog(n),w=f.Dashboard,pt="fxs-theme-context-start",nt,ti,ii;t.widgetClass="fxs-startboard";var rt=t.widgetClass+"-header",fi=t.widgetClass+"-layout",wt=t.widgetClass+"-title",ei=t.widgetClass+"-title-next",bt=t.widgetClass+"-title-edit";
t.headerButtonClass=t.widgetClass+"-button";var d=t.widgetClass+"-dropdown",ut=t.headerButtonClass+"-text",ft=t.headerButtonClass+"-icon",oi=t.headerButtonClass+"-new",kt=t.headerButtonClass+"-filter",si=t.headerButtonClass+"-clone",hi=t.headerButtonClass+"-delete",ci=t.headerButtonClass+"-share",li=t.headerButtonClass+"-edit",ai=t.headerButtonClass+"-fullscreen",vi=t.headerButtonClass+"-migrate",dt=t.headerButtonClass+"-browse",et=rt+"-normal",ot=rt+"-migration",yi=t.widgetClass+"-notfound",pi=t.widgetClass+"-loading",st=t.widgetClass+"-message",wi=st+"-container",bi=st+"-title",ki=st+"-body",tt=d+"-item",di=d+"-dashboard",gi=d+"-browseall",nr=d+"-subscriptions",tr=ri.fx.environment.features,ir=tr.filterdashboard==="true",k=ko.observable,gt=ko.observableArray,g=ko.reactor,ni="aria-label";t.fxstartboardtitlechanged="fxstartboardtitlechanged";t.fxmigratestartboard="fxmigratestartboard",function(n){n[n.Unknown=0]="Unknown";n[n.Normal=1]="Normal";n[n.Migration=2]="Migration"}(t.HeaderMode||
(t.HeaderMode={}));nt=t.HeaderMode;ti=function(n){function t(t,i){n.call(this,t);this.commands=[];this.filterButtonText=k("");this.title=k(f.NavBar.home);this.dashboardList=gt([]);this.loading=k(!1);this.notFound=k(!1);this.notFoundMessage=k("");this.subscriptionsInfo=k("");this.locked(!1);var r=this.flowLayoutOptions=new l.ViewModel("fxs-flowlayout-instanceid");r.allowReorder=!0;r.allowOverflow=!0;r.allowGaps=!0;r.allowMaximized=!1;r.resolutionGuides=!0;r.resolutionGuidesOffset.y=-88;r.orientation=a.Orientation.Horizontal;r.childWidgetType=y.Widget;r.minColumns(4);r.minRows(4);r.maxRows(4);r.locked(!1);this.headerMode=k(nt.Unknown);this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t}(p.ViewModel);t.ViewModel=ti;
ii=function(n){function i(i,r){var u,f;n.call(this,i,r);this._layout=null;u=this.lifetimeManager;i.addClass(pt).addClass(t.widgetClass).html(v());g(u,function(){var n=r.title();i.findByClassName(wt).text(n);i.findByClassName(bt).val(n)});g(u,function(){var t=r.headerMode(),n=i.findByClassName(rt);switch(t){case nt.Normal:n.addClass(et).removeClass(ot);break;case nt.Migration:n.removeClass(et).addClass(ot);break;case nt.Unknown:default:n.removeClass(et).removeClass(ot)}});g(u,function(){var n=r.notFound();i.toggleClass(yi,n)});g(u,function(){var n=r.loading();i.toggleClass(pi,n)});g(u,function(){var n=r.title();document.title=n});this._layout=new l.Widget(i.findByClassName(fi),r.flowLayoutOptions);this._initializeCommands(u,i);f=i.findByClassName(wi);f.html('<div class="'+bi+'">'+w.NotFound.title+"<\/div>"+('<div class="'+ki+'" data-bind="text: data.notFoundMessage"><\/div>'));ko.applyBindings({data:r},f[0]);this._attachEventHandlers(i);u.registerForDispose(e.setup(i,gt(r.commands)))}return __extends(
i,n),i.prototype.dispose=function(){this._layout.dispose();this._cleanElement(t.widgetClass,pt);n.prototype.dispose.call(this)},i.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},i.prototype.removeChild=function(n){return this._layout.removeChild(n)},i.prototype.moveChild=function(n,t,i,r){this._layout.moveChild(n,t,i,r)},i.prototype.setFocus=function(){var t=this._layout.element.findFirstTabbable(),n;t.length===1?t.focus():(n=this._selectorMenu,n&&n.setFocus())},i.prototype.saveViewSettings=function(){return this.options.getViewSettings()},i.prototype.discardStateOfUnusedChildren=function(){return ui.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},i.prototype._attachEventHandlers=function(n){var i=this,t=function(t){n.trigger(p.Widget.viewSettingsChanged,i.saveViewSettings());t.stopPropagation()};n.on(a.Widget.layoutUpdatedEventName,t);this.lifetimeManager.
registerForDispose({dispose:function(){n.off(a.Widget.layoutUpdatedEventName,t)}})},i.prototype._initializeCommands=function(n,i){var ti="title",y="aria-disabled",ii=w.create,ri=w.delete,ui=w.edit,fi=w.filter,yi=w.share,rt=w.fullscreen,pi=w.clone,f=this.options,et=function(n,t){n.attr(ti,t).findByClassName(ut).html(t)},wi='<div class="fxs-startboard-button-container">'+('<div class="'+ft+'"><\/div>')+('<div class="'+ut+'"><\/div>')+"<\/div>",e=function(n,t,r,u){var f=i.findByClassName(n).html(wi);et(f,t);f.findByClassName(ft).html(r.data);f.on(it.click,function(n){n.stopPropagation();yt(n.currentTarget).attr(y)!=="true"&&u(n)});return f},ot=e(li,ui,b.customize,function(){lt.trace({source:at.Dashboard,action:vt.CustomizeModeEntered});lt.trace({source:at.Dashboard,action:vt.DashboardEditCommandClicked});f.addPartsCommand.execute(!1)}),l,v,k,nt,st,bi,ht,tr;ko.computed(n,function(){var n=f.addPartsCommand,t=n&&n.enabled();t?ot.removeAttr(y):ot.attr(y,"true")});ir||i.findByClassName(kt).remove(
);l=i.findByClassName(bt);l.attr(ni,w.titleLabel);l.on(it.change,function(){f.title(l.val());i.trigger(t.fxstartboardtitlechanged)});var s="<!-- /ko -->",a="<\/div>",rr=i.findByClassName(d),p=new c.ViewModel('<div class="fxs-startboard-button-container">'+('<div class="'+wt+'"" data-bind="text: data.title, attr: { title: data.title }"><\/div>')+('<div class="'+ft+'">'+b.caretDown.data+"<\/div>")+a,"<div class='fx-dropmenu-dropdown'>"+('<ul class="fxs-dropmenu-list-system" role="menu" aria-label="'+w.recentMenuLabel+'">')+"<!-- ko ifnot: data.dashboardList -->"+("<li class='"+tt+'\' role="menuitem" tabindex="0">')+'<div class="fxs-tile-progress-transparent"><div><\/div><div><\/div><div><\/div><div><\/div><div><\/div><\/div><\/li>'+s+"<!-- ko if: data.dashboardList --><!-- ko ifnot: data.dashboardList().length -->"+("<li class='"+tt+'\' role="menuitem" tabindex="0">')+("<div class='fxs-dropmenu-list-content'>"+w.emptynext+"<\/div>")+"<\/li>"+s+"<!-- ko foreach: data.dashboardList -->"+("<li class='"+
tt+" "+di+' fxs-has-hover msportalfx-tooltip-overflow\' role="menuitem" data-bind="attr: { \'aria-label\': $parent.func.altText(title, id) }, event: { click: $parent.func.clickHandler, keydown: $parent.func.clickHandler }" tabindex="0">')+'<div class=\'fxs-dropmenu-list-content fxs-startboard-item-container\'><div class="fxs-startboard-item-icon"><!-- ko if: id.indexOf("private") === -1 -->'+b.share.data+s+a+"<div class=\"fxs-startboard-item-title\" data-bind='text: title'><\/div>"+a+"<\/li>"+s+s+('<li class="'+tt+" "+gi+' fxs-has-hover" role="menuitem" tabindex="0">')+('<div class="'+nr+'" data-bind="text: data.subscriptionsInfo"><\/div>')+('<a href="#" class="'+dt+' fxs-text-primary">'+w.browseAll+"<\/a>")+"<\/li><\/ul>"+a),h=i.findByClassName(d);p.alignMenu=0;v=this._selectorMenu=new c.Widget(h,p);p.isMenuOpen.subscribe(n,function(n){n&&f.refreshDashboardList?(k=new u.KeyboardNavigation(v.element),f.dashboardList(undefined),f.refreshDashboardList(function(n){f.dashboardList(n)}).then(
function(){})):k&&k.dispose()});nt=".fxs-dropmenu-content";h.find(nt).width("");g(this.lifetimeManager,function(){h.find(".fxs-dropmenu-button").attr(ni,w.switcherLabel.format(f.title()))});st=function(n,t){(t.type!==it.keydown||(t.keyCode===13||t.keyCode===32)&&o.getModifierKeys(t)===0)&&(t.preventDefault(),t.stopPropagation(),i.findByClassName(ei).text(n.title),f.switchDashboard&&f.switchDashboard(n).then(function(){var n=Math.min(Math.max(h.outerWidth()+50,400),560);h.find(nt).css({minWidth:n})}),v.hide())};ko.applyBindings({data:f,func:{clickHandler:st,altText:function(n,t){return n+" "+(t.indexOf("private")===-1?w.sharedStatusLabel:"")}}},v.element[0]);bi=e(oi,ii,b.add,function(){f.newCommand.execute(!1)});f.filterButtonText(fi);ht=e(kt,f.filterButtonText(),b.filter,function(){f.filterCommand.execute(!1)});f.filterButtonText.subscribe(n,function(n){ht.findByClassName(ut).html(n)});var ur=e(si,pi,b.clone,function(){f.cloneCommand.execute(!1)}),fr=e(ci,yi,b.share,function(){f.shareCommand.
execute(!1)}),er=e(hi,ri,b.trashOutline,function(){f.deleteCommand.execute(!1)}),ki=e(ai,rt,b.fullscreen,function(){f.fullscreenCommand.execute(!1)}),ct=function(){var n=r.isFullscreen()?w.exitFullscreen:rt;et(ki,n)},pt=yt(document),gt=r.fullscreen;pt.on(gt,ct);n.registerForDispose(function(){pt.off(gt,ct)});tr=e(vi,w.migrate,b.clone,function(){i.trigger(t.fxmigratestartboard)});i.findByClassName(dt).click(function(n){n.preventDefault();f.browseCommand.execute(!1)})},i}(p.Widget);t.Widget=ii}(w||(w={})),w});define("MsPortalImpl/Services/Services.SettingsProcessor",["require","exports","f","../Base/Telemetry"],function(n,t,i,r){"use strict";var u;return function(n){var u=i.Base.Diagnostics.Telemetry,e=window,f=function(){function n(){this._deferred=Q.defer();this.initialized=this._deferred.promise;this.flush=function(){return Q()}}return n.prototype.init=function(n,i,f,e,o){var c=this,l=u.startTrace({source:r.Source.Shell,action:e}),s={},h=Object.keys(i);h.forEach(function(r){s[r]=t.Default;
i[r].subscribe(function(i){s[r]!==t.ServerInProgress&&(s[r]=t.FromUser,n.setSetting(f,r,i),o&&n.flushSettings())})});this.flush=function(){return n.flushSettings()};n.queryStore(f).then(function(n){n=n||{};h.forEach(function(r){var u=n[r];u!==undefined&&s[r]===t.Default&&(s[r]=t.ServerInProgress,i[r](u),s[r]=t.ServerComplete)});u.completeTrace(l);c._deferred.resolve(i)})},n}(),t;n.SettingsProcessor=f,function(n){n[n.Default=0]="Default";n[n.ServerInProgress=1]="ServerInProgress";n[n.ServerComplete=2]="ServerComplete";n[n.FromUser=3]="FromUser"}(t||(t={}))}(u||(u={})),u});define("MsPortalImpl/Services/Services.GeneralSettings",["require","exports","f","i","./Services.Settings","./Services.SettingsProcessor"],function(n,t,i,r,u,f){"use strict";var e;return function(n){function a(t){if(o&&!l.isTestMode)throw new Error(e+" has already been called.");o=!0;s.Rpc.Internal.client.registerObjectFactory(r.Constants.RpcMethods.getSettings,{allowedOrigin:null,allowRemoteChanges:!1,handler:function(
){return Q.resolve(n.settings)}});n.processor.init(t,n.settings,c,e)}var s=i.Base,h=u.SettingStore,c=h.General,e="InitializeGeneralSettingsInternal",l=window.fx.environment,o=!1,t=ko.observable;n.processor=new f.SettingsProcessor;n.settings={animationEnabledKey:t(!0),rawLocale:t(""),relexHost:t(""),"fxs-theme":t(),npsTimeMs:t(0),sideBarCollapsedKey:t(!1),showCommandLabelsKey:t(!0),notificationToastEnabledKey:t(!0),sideBarBrowseDisplayModeKey:t(0)};n.init=a}(e||(e={})),e})