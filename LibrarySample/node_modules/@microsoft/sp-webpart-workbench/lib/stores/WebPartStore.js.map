{"version":3,"sources":["stores/WebPartStore.ts"],"names":[],"mappings":";;;;;;;AAAA,4BAAqD,aAAa,CAAC,CAAA;AACnE,QAAO,cAAc,CAAC,CAAA;AAEtB;IAKE,0BAA0B;IAE1B;QACE,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;QAC9B,IAAI,CAAC,KAAK,GAAG,yBAAW,CAAC,EAAE,CAAC,CAAC;QAE7B,yGAAyG;QACzG,mBAAmB;QACnB,wBAAwB;IAC1B,CAAC;IAEM,oCAAa,GAApB;QAAA,iBAiCC;QAhCC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YACpB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YAEtB,2BAA2B;YAC3B,EAAE,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC;gBACrC,IAAI,CAAC,KAAK,GAAI,MAAc,CAAC,gBAAgB,CAAC;gBAChD,0BAA0B;gBACxB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACzB,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,IAAM,0BAAwB,GAC5B,UAAC,OAA0B;oBACzB,OAAA,OAAO;yBACJ,IAAI,CAAC,UAAC,QAAkB,IAAK,OAAA,QAAQ,CAAC,IAAI,EAAE,EAAf,CAAe,CAAC;yBAC7C,IAAI,CAAC,UAAC,IAAS;wBACd,yBAAW,CAAC;4BACV,KAAI,CAAC,KAAK,GAAG,IAAI,CAAC;4BAClB,KAAI,CAAC,SAAS,GAAG,KAAK,CAAC;wBACzB,CAAC,CAAC,CAAC;oBACL,CAAC,CAAC;gBAPJ,CAOI,CAAC;gBAET,oBAAoB;gBACpB,sEAAsE;gBACtE,0BAAwB,CAAC,MAAM,CAAC,KAAK,CAAC,oCAAoC,CAAC,CAAC;qBAEzE,KAAK,CAAC,UAAC,EAAS,IAAK,OAAA,0BAAwB,CAAC,MAAM,CAAC,KAAK,CAAC,mCAAmC,CAAC,CAAC,EAA3E,CAA2E,CAAC;qBACjG,KAAK,CAAC,UAAC,EAAS;oBACf,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;oBAClB,KAAI,CAAC,YAAY,GAAG,EAAE,CAAC,OAAO,CAAC;oBAC/B,KAAI,CAAC,SAAS,GAAG,KAAK,CAAC;gBACzB,CAAC,CAAC,CAAC;YACP,CAAC;QACH,CAAC;IACH,CAAC;IAjDD;QAAC,wBAAU;sDAAA;IACX;QAAC,wBAAU;mDAAA;IAEX;QAAC,wBAAU;+CAAA;IA+Cb,mBAAC;AAAD,CAnDA,AAmDC,IAAA;AAnDD;8BAmDC,CAAA","file":"stores/WebPartStore.js","sourcesContent":["import { observable, transaction, asReference } from 'mobservable';\r\nimport 'whatwg-fetch';\r\n\r\nexport default class WebPartStore {\r\n  @observable public errorMessage: string;\r\n  @observable public isLoading: boolean;\r\n  /* tslint:disable:no-any */\r\n  @observable public parts: { [key: string]: any};\r\n  /* tslint:enable:no-any */\r\n\r\n  constructor() {\r\n    this.isLoading = false;\r\n    this.errorMessage = undefined;\r\n    this.parts = asReference({});\r\n\r\n    // @todo: removing this as this is not required right now. Will cleanup this with other workbench cleanup\r\n    // at a later date.\r\n    // this.fetchWebParts();\r\n  }\r\n\r\n  public fetchWebParts(): void {\r\n    if (!this.isLoading) {\r\n      this.isLoading = true;\r\n\r\n      /* tslint:disable:no-any */\r\n      if ((window as any).webpartManifests) {\r\n        this.parts = (window as any).webpartManifests;\r\n      /* tslint:enable:no-any */\r\n        this.isLoading = false;\r\n      } else {\r\n        const tryHandleWebpartsPromise: (promise: Promise<Response>) => Promise<void> =\r\n          (promise: Promise<Response>): Promise<void> =>\r\n            promise\r\n              .then((response: Response) => response.json())\r\n              .then((json: any) => { // tslint:disable-line:no-any\r\n                transaction(() => {\r\n                  this.parts = json;\r\n                  this.isLoading = false;\r\n                });\r\n              });\r\n\r\n        // Get the webparts!\r\n        // @todo: remove hardcoded url, add error handling, where is cancel...\r\n        tryHandleWebpartsPromise(window.fetch('https://localhost:5432/getwebparts'))\r\n          // If we error, try again with HTTPS\r\n          .catch((ex: Error) => tryHandleWebpartsPromise(window.fetch('http://localhost:5432/getwebparts')))\r\n          .catch((ex: Error) => {\r\n            console.error(ex);\r\n            this.errorMessage = ex.message;\r\n            this.isLoading = false;\r\n          });\r\n      }\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}